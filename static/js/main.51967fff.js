/*! For license information please see main.51967fff.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var r=n(853),i=n(43),a=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function u(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function c(e){if(l(e)!==e)throw Error(s(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),b=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope");var T=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var I=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var w=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=w&&e[w]||e["@@iterator"])?e:null}var U=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===U?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case _:return"Profiler";case m:return"StrictMode";case S:return"Suspense";case N:return"SuspenseList";case T:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case b:return(e.displayName||"Context")+".Provider";case E:return(e._context.displayName||"Context")+".Consumer";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return R(e(t))}catch(n){}}return null}var M=Array.isArray,L=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D={pending:!1,data:null,method:null,action:null},x=[],F=-1;function H(e){return{current:e}}function G(e){0>F||(e.current=x[F],x[F]=null,F--)}function j(e,t){F++,x[F]=e.current,e.current=t}var z=H(null),B=H(null),V=H(null),q=H(null);function K(e,t){switch(j(V,t),j(B,e),j(z,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?id(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=ad(t=id(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}G(z),j(z,e)}function Q(){G(z),G(B),G(V)}function Y(e){null!==e.memoizedState&&j(q,e);var t=z.current,n=ad(t,e.type);t!==n&&(j(B,e),j(z,n))}function W(e){B.current===e&&(G(z),G(B)),q.current===e&&(G(q),Yd._currentValue=D)}var J=Object.prototype.hasOwnProperty,$=r.unstable_scheduleCallback,X=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ie=r.unstable_UserBlockingPriority,ae=r.unstable_NormalPriority,se=r.unstable_LowPriority,oe=r.unstable_IdlePriority,le=r.log,ue=r.unstable_setDisableYieldValue,ce=null,de=null;function he(e){if("function"===typeof le&&ue(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ce,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/ge|0)|0},pe=Math.log,ge=Math.LN2;var ye=256,me=4194304;function _e(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ve(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,a=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~a)?i=_e(r):0!==(s&=o)?i=_e(s):n||0!==(n=o&~e)&&(i=_e(n)):0!==(o=r&~a)?i=_e(o):0!==s?i=_e(s):n||0!==(n=r&~e)&&(i=_e(n)),0===i?0:0!==t&&t!==i&&0===(t&a)&&((a=i&-i)>=(n=t&-t)||32===a&&0!==(4194048&n))?t:i}function Ee(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function be(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ce(){var e=ye;return 0===(4194048&(ye<<=1))&&(ye=256),e}function Se(){var e=me;return 0===(62914560&(me<<=1))&&(me=4194304),e}function Ne(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ae(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ke(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-fe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Te(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fe(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function we(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Oe(){var e=P.p;return 0!==e?e:void 0===(e=window.event)?32:uh(e.type)}var Ue=Math.random().toString(36).slice(2),Re="__reactFiber$"+Ue,Me="__reactProps$"+Ue,Le="__reactContainer$"+Ue,Pe="__reactEvents$"+Ue,De="__reactListeners$"+Ue,xe="__reactHandles$"+Ue,Fe="__reactResources$"+Ue,He="__reactMarker$"+Ue;function Ge(e){delete e[Re],delete e[Me],delete e[Pe],delete e[De],delete e[xe]}function je(e){var t=e[Re];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Le]||n[Re]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=vd(e);null!==e;){if(n=e[Re])return n;e=vd(e)}return t}n=(e=n).parentNode}return null}function ze(e){if(e=e[Re]||e[Le]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Be(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function Ve(e){var t=e[Fe];return t||(t=e[Fe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function qe(e){e[He]=!0}var Ke=new Set,Qe={};function Ye(e,t){We(e,t),We(e+"Capture",t)}function We(e,t){for(Qe[e]=t,e=0;e<t.length;e++)Ke.add(t[e])}var Je,$e,Xe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(i=t,J.call(et,i)||!J.call(Ze,i)&&(Xe.test(i)?et[i]=!0:(Ze[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function it(e){if(void 0===Je)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Je=t&&t[1]||"",$e=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Je+e+$e}var at=!1;function st(e,t){if(!e||at)return"";at=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(a){r=a}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(o){if(o&&r&&"string"===typeof o.stack)return[o.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=r.DetermineComponentFrameRoot(),s=a[0],o=a[1];if(s&&o){var l=s.split("\n"),u=o.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===u.length)for(r=l.length-1,i=u.length-1;1<=r&&0<=i&&l[r]!==u[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==u[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==u[i]){var c="\n"+l[r].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=r&&0<=i);break}}}finally{at=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return st(e.type,!1);case 11:return st(e.type.render,!1);case 1:return st(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ct(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ct(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ct(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function gt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function yt(e,t,n,r,i,a,s,o){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?_t(e,s,ut(t)):null!=n?_t(e,s,ut(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=a&&(e.defaultChecked=!!a),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ut(o):e.removeAttribute("name")}function mt(e,t,n,r,i,a,s,o){if(null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.type=a),null!=t||null!=n){if(!("submit"!==a&&"reset"!==a||void 0!==t&&null!==t))return;n=null!=n?""+ut(n):"",t=null!=t?""+ut(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function _t(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function vt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ut(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Et(e,t,n){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ut(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function bt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(M(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ut(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function Ct(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function At(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Nt(e,i,r)}else for(var a in t)t.hasOwnProperty(a)&&Nt(e,a,t[a])}function kt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wt(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Ot=null;function Ut(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Mt=null;function Lt(e){var t=ze(e);if(t&&(e=t.stateNode)){var n=e[Me]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Me]||null;if(!i)throw Error(s(90));yt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":Et(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&vt(e,!!n.multiple,t,!1)}}}var Pt=!1;function Dt(e,t,n){if(Pt)return e(t,n);Pt=!0;try{return e(t)}finally{if(Pt=!1,(null!==Rt||null!==Mt)&&(ju(),Rt&&(t=Rt,e=Mt,Mt=Rt=null,Lt(t),e)))for(t=0;t<e.length;t++)Lt(e[t])}}function xt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Me]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ft=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ht=!1;if(Ft)try{var Gt={};Object.defineProperty(Gt,"passive",{get:function(){Ht=!0}}),window.addEventListener("test",Gt,Gt),window.removeEventListener("test",Gt,Gt)}catch(Mh){Ht=!1}var jt=null,zt=null,Bt=null;function Vt(){if(Bt)return Bt;var e,t,n=zt,r=n.length,i="value"in jt?jt.value:jt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return Bt=i.slice(e,1<t?1-t:void 0)}function qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Kt(){return!0}function Qt(){return!1}function Yt(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Kt:Qt,this.isPropagationStopped=Qt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Kt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Kt)},persist:function(){},isPersistent:Kt}),t}var Wt,Jt,$t,Xt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Yt(Xt),en=h({},Xt,{view:0,detail:0}),tn=Yt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$t&&($t&&"mousemove"===e.type?(Wt=e.screenX-$t.screenX,Jt=e.screenY-$t.screenY):Jt=Wt=0,$t=e),Wt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),rn=Yt(nn),an=Yt(h({},nn,{dataTransfer:0})),sn=Yt(h({},en,{relatedTarget:0})),on=Yt(h({},Xt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Yt(h({},Xt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),un=Yt(h({},Xt,{data:0})),cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function pn(){return fn}var gn=Yt(h({},en,{key:function(e){if(e.key){var t=cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),yn=Yt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),mn=Yt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),_n=Yt(h({},Xt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=Yt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),En=Yt(h({},Xt,{newState:0,oldState:0})),bn=[9,13,27,32],Cn=Ft&&"CompositionEvent"in window,Sn=null;Ft&&"documentMode"in document&&(Sn=document.documentMode);var Nn=Ft&&"TextEvent"in window&&!Sn,An=Ft&&(!Cn||Sn&&8<Sn&&11>=Sn),kn=String.fromCharCode(32),Tn=!1;function In(e,t){switch(e){case"keyup":return-1!==bn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var On=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function Mn(e,t,n,r){Rt?Mt?Mt.push(r):Mt=[r]:Rt=r,0<(t=Vc(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ln=null,Pn=null;function Dn(e){Dc(e,0)}function xn(e){if(ht(Be(e)))return e}function Fn(e,t){if("change"===e)return t}var Hn=!1;if(Ft){var Gn;if(Ft){var jn="oninput"in document;if(!jn){var zn=document.createElement("div");zn.setAttribute("oninput","return;"),jn="function"===typeof zn.oninput}Gn=jn}else Gn=!1;Hn=Gn&&(!document.documentMode||9<document.documentMode)}function Bn(){Ln&&(Ln.detachEvent("onpropertychange",Vn),Pn=Ln=null)}function Vn(e){if("value"===e.propertyName&&xn(Pn)){var t=[];Mn(t,Pn,e,Ut(e)),Dt(Dn,t)}}function qn(e,t,n){"focusin"===e?(Bn(),Pn=n,(Ln=t).attachEvent("onpropertychange",Vn)):"focusout"===e&&Bn()}function Kn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return xn(Pn)}function Qn(e,t){if("click"===e)return xn(t)}function Yn(e,t){if("input"===e||"change"===e)return xn(t)}var Wn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Jn(e,t){if(Wn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!J.call(t,i)||!Wn(e[i],t[i]))return!1}return!0}function $n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xn(e,t){var n,r=$n(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$n(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Ft&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,ar=null,sr=!1;function or(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;sr||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ar&&Jn(ar,r)||(ar=r,0<(r=Vc(ir,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ur={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},cr={},dr={};function hr(e){if(cr[e])return cr[e];if(!ur[e])return e;var t,n=ur[e];for(t in n)if(n.hasOwnProperty(t)&&t in dr)return cr[e]=n[t];return e}Ft&&(dr=document.createElement("div").style,"AnimationEvent"in window||(delete ur.animationend.animation,delete ur.animationiteration.animation,delete ur.animationstart.animation),"TransitionEvent"in window||delete ur.transitionend.transition);var fr=hr("animationend"),pr=hr("animationiteration"),gr=hr("animationstart"),yr=hr("transitionrun"),mr=hr("transitionstart"),_r=hr("transitioncancel"),vr=hr("transitionend"),Er=new Map,br="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(e,t){Er.set(e,t),Ye(t,[e])}br.push("scrollEnd");var Sr=new WeakMap;function Nr(e,t){if("object"===typeof e&&null!==e){var n=Sr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Sr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Ar=[],kr=0,Tr=0;function Ir(){for(var e=kr,t=Tr=kr=0;t<e;){var n=Ar[t];Ar[t++]=null;var r=Ar[t];Ar[t++]=null;var i=Ar[t];Ar[t++]=null;var a=Ar[t];if(Ar[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==a&&Rr(n,i,a)}}function wr(e,t,n,r){Ar[kr++]=e,Ar[kr++]=t,Ar[kr++]=n,Ar[kr++]=r,Tr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Or(e,t,n,r){return wr(e,t,n,r),Mr(e)}function Ur(e,t){return wr(e,null,null,t),Mr(e)}function Rr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,a=e.return;null!==a;)a.childLanes|=n,null!==(r=a.alternate)&&(r.childLanes|=n),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;return 3===e.tag?(a=e.stateNode,i&&null!==t&&(i=31-fe(n),null===(r=(e=a.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),a):null}function Mr(e){if(50<Ru)throw Ru=0,Mu=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Lr={};function Pr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(e,t,n,r){return new Pr(e,t,n,r)}function xr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fr(e,t){var n=e.alternate;return null===n?((n=Dr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Hr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Gr(e,t,n,r,i,a){var o=0;if(r=e,"function"===typeof e)xr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,z.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case T:return(e=Dr(31,n,t,i)).elementType=T,e.lanes=a,e;case y:return jr(n.children,i,a,t);case m:o=8,i|=24;break;case _:return(e=Dr(12,n,t,2|i)).elementType=_,e.lanes=a,e;case S:return(e=Dr(13,n,t,i)).elementType=S,e.lanes=a,e;case N:return(e=Dr(19,n,t,i)).elementType=N,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case v:case b:o=10;break e;case E:o=9;break e;case C:o=11;break e;case A:o=14;break e;case k:o=16,r=null;break e}o=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Dr(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function jr(e,t,n,r){return(e=Dr(7,e,r,t)).lanes=n,e}function zr(e,t,n){return(e=Dr(6,e,null,t)).lanes=n,e}function Br(e,t,n){return(t=Dr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Vr=[],qr=0,Kr=null,Qr=0,Yr=[],Wr=0,Jr=null,$r=1,Xr="";function Zr(e,t){Vr[qr++]=Qr,Vr[qr++]=Kr,Kr=e,Qr=t}function ei(e,t,n){Yr[Wr++]=$r,Yr[Wr++]=Xr,Yr[Wr++]=Jr,Jr=e;var r=$r;e=Xr;var i=32-fe(r)-1;r&=~(1<<i),n+=1;var a=32-fe(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,$r=1<<32-fe(t)+i|n<<i|r,Xr=a+e}else $r=1<<a|n<<i|r,Xr=e}function ti(e){null!==e.return&&(Zr(e,1),ei(e,1,0))}function ni(e){for(;e===Kr;)Kr=Vr[--qr],Vr[qr]=null,Qr=Vr[--qr],Vr[qr]=null;for(;e===Jr;)Jr=Yr[--Wr],Yr[Wr]=null,Xr=Yr[--Wr],Yr[Wr]=null,$r=Yr[--Wr],Yr[Wr]=null}var ri=null,ii=null,ai=!1,si=null,oi=!1,li=Error(s(519));function ui(e){throw gi(Nr(Error(s(418,"")),e)),li}function ci(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Re]=e,t[Me]=r,n){case"dialog":xc("cancel",t),xc("close",t);break;case"iframe":case"object":case"embed":xc("load",t);break;case"video":case"audio":for(n=0;n<Lc.length;n++)xc(Lc[n],t);break;case"source":xc("error",t);break;case"img":case"image":case"link":xc("error",t),xc("load",t);break;case"details":xc("toggle",t);break;case"input":xc("invalid",t),mt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":xc("invalid",t);break;case"textarea":xc("invalid",t),bt(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Jc(t.textContent,n)?(null!=r.popover&&(xc("beforetoggle",t),xc("toggle",t)),null!=r.onScroll&&xc("scroll",t),null!=r.onScrollEnd&&xc("scrollend",t),null!=r.onClick&&(t.onclick=$c),t=!0):t=!1,t||ui(e)}function di(e){for(ri=e.return;ri;)switch(ri.tag){case 5:case 13:return void(oi=!1);case 27:case 3:return void(oi=!0);default:ri=ri.return}}function hi(e){if(e!==ri)return!1;if(!ai)return di(e),ai=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||sd(e.type,e.memoizedProps)),t=!t),t&&ii&&ui(e),di(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ii=md(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ii=null}}else 27===n?(n=ii,fd(e.type)?(e=_d,_d=null,ii=e):ii=n):ii=ri?md(e.stateNode.nextSibling):null;return!0}function fi(){ii=ri=null,ai=!1}function pi(){var e=si;return null!==e&&(null===vu?vu=e:vu.push.apply(vu,e),si=null),e}function gi(e){null===si?si=[e]:si.push(e)}var yi=H(null),mi=null,_i=null;function vi(e,t,n){j(yi,t._currentValue),t._currentValue=n}function Ei(e){e._currentValue=yi.current,G(yi)}function bi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var a=i.dependencies;if(null!==a){var o=i.child;a=a.firstContext;e:for(;null!==a;){var l=a;a=i;for(var u=0;u<t.length;u++)if(l.context===t[u]){a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),bi(a.return,n,e),r||(o=null);break e}a=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=n,null!==(a=o.alternate)&&(a.lanes|=n),bi(o,n,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function Si(e,t,n,r){e=null;for(var i=t,a=!1;null!==i;){if(!a)if(0!==(524288&i.flags))a=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var o=i.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=i.type;Wn(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===q.current){if(null===(o=i.alternate))throw Error(s(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Yd):e=[Yd])}i=i.return}null!==e&&Ci(t,e,n,r),t.flags|=262144}function Ni(e){for(e=e.firstContext;null!==e;){if(!Wn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ai(e){mi=e,_i=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ki(e){return Ii(mi,e)}function Ti(e,t){return null===mi&&Ai(e),Ii(e,t)}function Ii(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===_i){if(null===e)throw Error(s(308));_i=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else _i=_i.next=t;return n}var wi="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Oi=r.unstable_scheduleCallback,Ui=r.unstable_NormalPriority,Ri={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Mi(){return{controller:new wi,data:new Map,refCount:0}}function Li(e){e.refCount--,0===e.refCount&&Oi(Ui,(function(){e.controller.abort()}))}var Pi=null,Di=0,xi=0,Fi=null;function Hi(){if(0===--Di&&null!==Pi){null!==Fi&&(Fi.status="fulfilled");var e=Pi;Pi=null,xi=0,Fi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Gi=L.S;L.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Pi){var n=Pi=[];Di=0,xi=wc(),Fi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Di++,t.then(Hi,Hi)}(0,t),null!==Gi&&Gi(e,t)};var ji=H(null);function zi(){var e=ji.current;return null!==e?e:ru.pooledCache}function Bi(e,t){j(ji,null===t?ji.current:t.pool)}function Vi(){var e=zi();return null===e?null:{parent:Ri._currentValue,pool:e}}var qi=Error(s(460)),Ki=Error(s(474)),Qi=Error(s(542)),Yi={then:function(){}};function Wi(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Ji(){}function $i(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Ji,Ji),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ea(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ji,Ji);else{if(null!==(e=ru)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ea(e=t.reason),e}throw Xi=t,qi}}var Xi=null;function Zi(){if(null===Xi)throw Error(s(459));var e=Xi;return Xi=null,e}function ea(e){if(e===qi||e===Qi)throw Error(s(483))}var ta=!1;function na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ia(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function aa(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Mr(e),Rr(e,null,n),t}return wr(e,r,t,n),Mr(e)}function sa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Te(e,n)}}function oa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var la=!1;function ua(){if(la){if(null!==Fi)throw Fi}}function ca(e,t,n,r){la=!1;var i=e.updateQueue;ta=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,u=l.next;l.next=null,null===s?a=u:s.next=u,s=l;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==s&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(null!==a){var d=i.baseState;for(s=0,c=u=l=null,o=a;;){var f=-536870913&o.lane,p=f!==o.lane;if(p?(au&f)===f:(r&f)===f){0!==f&&f===xi&&(la=!0),null!==c&&(c=c.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=e,y=o;f=t;var m=n;switch(y.tag){case 1:if("function"===typeof(g=y.payload)){d=g.call(m,d,f);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(f="function"===typeof(g=y.payload)?g.call(m,d,f):g)||void 0===f)break e;d=h({},d,f);break e;case 2:ta=!0}}null!==(f=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[f]:p.push(f))}else p={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=p,l=d):c=c.next=p,s|=f;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(p=o).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null===a&&(i.shared.lanes=0),fu|=s,e.lanes=s,e.memoizedState=d}}function da(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function ha(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)da(n[e],t)}var fa=H(null),pa=H(0);function ga(e,t){j(pa,e=du),j(fa,t),du=e|t.baseLanes}function ya(){j(pa,du),j(fa,fa.current)}function ma(){du=pa.current,G(fa),G(pa)}var _a=0,va=null,Ea=null,ba=null,Ca=!1,Sa=!1,Na=!1,Aa=0,ka=0,Ta=null,Ia=0;function wa(){throw Error(s(321))}function Oa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Wn(e[n],t[n]))return!1;return!0}function Ua(e,t,n,r,i,a){return _a=a,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=null===e||null===e.memoizedState?qs:Ks,Na=!1,a=n(r,i),Na=!1,Sa&&(a=Ma(t,n,r,i)),Ra(e),a}function Ra(e){L.H=Vs;var t=null!==Ea&&null!==Ea.next;if(_a=0,ba=Ea=va=null,Ca=!1,ka=0,Ta=null,t)throw Error(s(300));null===e||To||null!==(e=e.dependencies)&&Ni(e)&&(To=!0)}function Ma(e,t,n,r){va=e;var i=0;do{if(Sa&&(Ta=null),ka=0,Sa=!1,25<=i)throw Error(s(301));if(i+=1,ba=Ea=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}L.H=Qs,a=t(n,r)}while(Sa);return a}function La(){var e=L.H,t=e.useState()[0];return t="function"===typeof t.then?Ga(t):t,e=e.useState()[0],(null!==Ea?Ea.memoizedState:null)!==e&&(va.flags|=1024),t}function Pa(){var e=0!==Aa;return Aa=0,e}function Da(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function xa(e){if(Ca){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ca=!1}_a=0,ba=Ea=va=null,Sa=!1,ka=Aa=0,Ta=null}function Fa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ba?va.memoizedState=ba=e:ba=ba.next=e,ba}function Ha(){if(null===Ea){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=Ea.next;var t=null===ba?va.memoizedState:ba.next;if(null!==t)ba=t,Ea=e;else{if(null===e){if(null===va.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(Ea=e).memoizedState,baseState:Ea.baseState,baseQueue:Ea.baseQueue,queue:Ea.queue,next:null},null===ba?va.memoizedState=ba=e:ba=ba.next=e}return ba}function Ga(e){var t=ka;return ka+=1,null===Ta&&(Ta=[]),e=$i(Ta,e,t),t=va,null===(null===ba?t.memoizedState:ba.next)&&(t=t.alternate,L.H=null===t||null===t.memoizedState?qs:Ks),e}function ja(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Ga(e);if(e.$$typeof===b)return ki(e)}throw Error(s(438,String(e)))}function za(e){var t=null,n=va.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=va.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=I;return t.index++,n}function Ba(e,t){return"function"===typeof t?t(e):t}function Va(e){return qa(Ha(),Ea,e)}function qa(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,a=r.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}t.baseQueue=i=a,r.pending=null}if(a=e.baseState,null===i)e.memoizedState=a;else{var l=o=null,u=null,c=t=i.next,d=!1;do{var h=-536870913&c.lane;if(h!==c.lane?(au&h)===h:(_a&h)===h){var f=c.revertLane;if(0===f)null!==u&&(u=u.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===xi&&(d=!0);else{if((_a&f)===f){c=c.next,f===xi&&(d=!0);continue}h={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(l=u=h,o=a):u=u.next=h,va.lanes|=f,fu|=f}h=c.action,Na&&n(a,h),a=c.hasEagerState?c.eagerState:n(a,h)}else f={lane:h,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(l=u=f,o=a):u=u.next=f,va.lanes|=h,fu|=h;c=c.next}while(null!==c&&c!==t);if(null===u?o=a:u.next=l,!Wn(a,e.memoizedState)&&(To=!0,d&&null!==(n=Fi)))throw n;e.memoizedState=a,e.baseState=o,e.baseQueue=u,r.lastRenderedState=a}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Ka(e){var t=Ha(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);Wn(a,t.memoizedState)||(To=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Qa(e,t,n){var r=va,i=Ha(),a=ai;if(a){if(void 0===n)throw Error(s(407));n=n()}else n=t();var o=!Wn((Ea||i).memoizedState,n);if(o&&(i.memoizedState=n,To=!0),i=i.queue,ys(2048,8,Ja.bind(null,r,i,e),[e]),i.getSnapshot!==t||o||null!==ba&&1&ba.memoizedState.tag){if(r.flags|=2048,fs(9,{destroy:void 0,resource:void 0},Wa.bind(null,r,i,n,t),null),null===ru)throw Error(s(349));a||0!==(124&_a)||Ya(r,t,n)}return n}function Ya(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Wa(e,t,n,r){t.value=n,t.getSnapshot=r,$a(t)&&Xa(e)}function Ja(e,t,n){return n((function(){$a(t)&&Xa(e)}))}function $a(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Wn(e,n)}catch(r){return!0}}function Xa(e){var t=Ur(e,2);null!==t&&Du(t,e,2)}function Za(e){var t=Fa();if("function"===typeof e){var n=e;if(e=n(),Na){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:e},t}function es(e,t,n,r){return e.baseState=n,qa(e,Ea,"function"===typeof r?r:Ba)}function ts(e,t,n,r,i){if(js(e))throw Error(s(485));if(null!==(e=t.action)){var a={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==L.T?n(!0):a.isTransition=!1,r(a),null===(n=t.pending)?(a.next=t.pending=a,ns(t,a)):(a.next=n.next,t.pending=n.next=a)}}function ns(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=L.T,s={};L.T=s;try{var o=n(i,r),l=L.S;null!==l&&l(s,o),rs(e,t,o)}catch(u){as(e,t,u)}finally{L.T=a}}else try{rs(e,t,a=n(i,r))}catch(c){as(e,t,c)}}function rs(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){is(e,t,n)}),(function(n){return as(e,t,n)})):is(e,t,n)}function is(e,t,n){t.status="fulfilled",t.value=n,ss(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ns(e,n)))}function as(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,ss(t),t=t.next}while(t!==r)}e.action=null}function ss(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function os(e,t){return t}function ls(e,t){if(ai){var n=ru.formState;if(null!==n){e:{var r=va;if(ai){if(ii){t:{for(var i=ii,a=oi;8!==i.nodeType;){if(!a){i=null;break t}if(null===(i=md(i.nextSibling))){i=null;break t}}i="F!"===(a=i.data)||"F"===a?i:null}if(i){ii=md(i.nextSibling),r="F!"===i.data;break e}}ui(r)}r=!1}r&&(t=n[0])}}return(n=Fa()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:t},n.queue=r,n=Fs.bind(null,va,r),r.dispatch=n,r=Za(!1),a=Gs.bind(null,va,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=Fa()).queue=i,n=ts.bind(null,va,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function us(e){return cs(Ha(),Ea,e)}function cs(e,t,n){if(t=qa(e,t,os)[0],e=Va(Ba)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Ga(t)}catch(s){if(s===qi)throw Qi;throw s}else r=t;var i=(t=Ha()).queue,a=i.dispatch;return n!==t.memoizedState&&(va.flags|=2048,fs(9,{destroy:void 0,resource:void 0},ds.bind(null,i,n),null)),[r,a,e]}function ds(e,t){e.action=t}function hs(e){var t=Ha(),n=Ea;if(null!==n)return cs(t,n,e);Ha(),t=t.memoizedState;var r=(n=Ha()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function fs(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=va.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ps(){return Ha().memoizedState}function gs(e,t,n,r){var i=Fa();r=void 0===r?null:r,va.flags|=e,i.memoizedState=fs(1|t,{destroy:void 0,resource:void 0},n,r)}function ys(e,t,n,r){var i=Ha();r=void 0===r?null:r;var a=i.memoizedState.inst;null!==Ea&&null!==r&&Oa(r,Ea.memoizedState.deps)?i.memoizedState=fs(t,a,n,r):(va.flags|=e,i.memoizedState=fs(1|t,a,n,r))}function ms(e,t){gs(8390656,8,e,t)}function _s(e,t){ys(2048,8,e,t)}function vs(e,t){return ys(4,2,e,t)}function Es(e,t){return ys(4,4,e,t)}function bs(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Cs(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ys(4,4,bs.bind(null,t,e),n)}function Ss(){}function Ns(e,t){var n=Ha();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Oa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function As(e,t){var n=Ha();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Oa(t,r[1]))return r[0];if(r=e(),Na){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r}function ks(e,t,n){return void 0===n||0!==(1073741824&_a)?e.memoizedState=t:(e.memoizedState=n,e=Pu(),va.lanes|=e,fu|=e,n)}function Ts(e,t,n,r){return Wn(n,t)?n:null!==fa.current?(e=ks(e,n,r),Wn(e,t)||(To=!0),e):0===(42&_a)?(To=!0,e.memoizedState=n):(e=Pu(),va.lanes|=e,fu|=e,t)}function Is(e,t,n,r,i){var a=P.p;P.p=0!==a&&8>a?a:8;var s=L.T,o={};L.T=o,Gs(e,!1,t,n);try{var l=i(),u=L.S;if(null!==u&&u(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Hs(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(l,r),Lu());else Hs(e,t,r,Lu())}catch(c){Hs(e,t,{then:function(){},status:"rejected",reason:c},Lu())}finally{P.p=a,L.T=s}}function ws(){}function Os(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=Us(e).queue;Is(e,i,t,D,null===n?ws:function(){return Rs(e),n(r)})}function Us(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:D,baseState:D,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:D},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Rs(e){Hs(e,Us(e).next.queue,{},Lu())}function Ms(){return ki(Yd)}function Ls(){return Ha().memoizedState}function Ps(){return Ha().memoizedState}function Ds(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Lu(),r=aa(t,e=ia(n),n);return null!==r&&(Du(r,t,n),sa(r,t,n)),t={cache:Mi()},void(e.payload=t)}t=t.return}}function xs(e,t,n){var r=Lu();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},js(e)?zs(t,n):null!==(n=Or(e,t,n,r))&&(Du(n,e,r),Bs(n,t,r))}function Fs(e,t,n){Hs(e,t,n,Lu())}function Hs(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(js(e))zs(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,Wn(o,s))return wr(e,t,i,0),null===ru&&Ir(),!1}catch(l){}if(null!==(n=Or(e,t,i,r)))return Du(n,e,r),Bs(n,t,r),!0}return!1}function Gs(e,t,n,r){if(r={lane:2,revertLane:wc(),action:r,hasEagerState:!1,eagerState:null,next:null},js(e)){if(t)throw Error(s(479))}else null!==(t=Or(e,n,r,2))&&Du(t,e,2)}function js(e){var t=e.alternate;return e===va||null!==t&&t===va}function zs(e,t){Sa=Ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Bs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Te(e,n)}}var Vs={readContext:ki,use:ja,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useLayoutEffect:wa,useInsertionEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useSyncExternalStore:wa,useId:wa,useHostTransitionStatus:wa,useFormState:wa,useActionState:wa,useOptimistic:wa,useMemoCache:wa,useCacheRefresh:wa},qs={readContext:ki,use:ja,useCallback:function(e,t){return Fa().memoizedState=[e,void 0===t?null:t],e},useContext:ki,useEffect:ms,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gs(4194308,4,bs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gs(4194308,4,e,t)},useInsertionEffect:function(e,t){gs(4,2,e,t)},useMemo:function(e,t){var n=Fa();t=void 0===t?null:t;var r=e();if(Na){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Fa();if(void 0!==n){var i=n(t);if(Na){he(!0);try{n(t)}finally{he(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=xs.bind(null,va,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Fa().memoizedState=e},useState:function(e){var t=(e=Za(e)).queue,n=Fs.bind(null,va,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ss,useDeferredValue:function(e,t){return ks(Fa(),e,t)},useTransition:function(){var e=Za(!1);return e=Is.bind(null,va,e.queue,!0,!1),Fa().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=va,i=Fa();if(ai){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===ru)throw Error(s(349));0!==(124&au)||Ya(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,ms(Ja.bind(null,r,a,e),[e]),r.flags|=2048,fs(9,{destroy:void 0,resource:void 0},Wa.bind(null,r,a,n,t),null),n},useId:function(){var e=Fa(),t=ru.identifierPrefix;if(ai){var n=Xr;t="\xab"+t+"R"+(n=($r&~(1<<32-fe($r)-1)).toString(32)+n),0<(n=Aa++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ia++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ms,useFormState:ls,useActionState:ls,useOptimistic:function(e){var t=Fa();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Gs.bind(null,va,!0,n),n.dispatch=t,[e,t]},useMemoCache:za,useCacheRefresh:function(){return Fa().memoizedState=Ds.bind(null,va)}},Ks={readContext:ki,use:ja,useCallback:Ns,useContext:ki,useEffect:_s,useImperativeHandle:Cs,useInsertionEffect:vs,useLayoutEffect:Es,useMemo:As,useReducer:Va,useRef:ps,useState:function(){return Va(Ba)},useDebugValue:Ss,useDeferredValue:function(e,t){return Ts(Ha(),Ea.memoizedState,e,t)},useTransition:function(){var e=Va(Ba)[0],t=Ha().memoizedState;return["boolean"===typeof e?e:Ga(e),t]},useSyncExternalStore:Qa,useId:Ls,useHostTransitionStatus:Ms,useFormState:us,useActionState:us,useOptimistic:function(e,t){return es(Ha(),0,e,t)},useMemoCache:za,useCacheRefresh:Ps},Qs={readContext:ki,use:ja,useCallback:Ns,useContext:ki,useEffect:_s,useImperativeHandle:Cs,useInsertionEffect:vs,useLayoutEffect:Es,useMemo:As,useReducer:Ka,useRef:ps,useState:function(){return Ka(Ba)},useDebugValue:Ss,useDeferredValue:function(e,t){var n=Ha();return null===Ea?ks(n,e,t):Ts(n,Ea.memoizedState,e,t)},useTransition:function(){var e=Ka(Ba)[0],t=Ha().memoizedState;return["boolean"===typeof e?e:Ga(e),t]},useSyncExternalStore:Qa,useId:Ls,useHostTransitionStatus:Ms,useFormState:hs,useActionState:hs,useOptimistic:function(e,t){var n=Ha();return null!==Ea?es(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:za,useCacheRefresh:Ps},Ys=null,Ws=0;function Js(e){var t=Ws;return Ws+=1,null===Ys&&(Ys=[]),$i(Ys,e,t)}function $s(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Xs(e,t){if(t.$$typeof===f)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zs(e){return(0,e._init)(e._payload)}function eo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Fr(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=zr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var a=n.type;return a===y?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===k&&Zs(a)===t.type)?($s(t=i(t,n.props),n),t.return=e,t):($s(t=Gr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Br(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=jr(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=zr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return $s(n=Gr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Br(t,e.mode,n)).return=e,t;case k:return h(e,t=(0,t._init)(t._payload),n)}if(M(t)||O(t))return(t=jr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,Js(t),n);if(t.$$typeof===b)return h(e,Ti(e,t),n);Xs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?u(e,t,n,r):null;case g:return n.key===i?c(e,t,n,r):null;case k:return f(e,t,n=(i=n._init)(n._payload),r)}if(M(n)||O(n))return null!==i?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,Js(n),r);if(n.$$typeof===b)return f(e,t,Ti(e,n),r);Xs(e,n)}return null}function m(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return m(e,t,n,r=(0,r._init)(r._payload),i)}if(M(r)||O(r))return d(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return m(e,t,n,Js(r),i);if(r.$$typeof===b)return m(e,t,n,Ti(t,r),i);Xs(t,r)}return null}function _(l,u,c,d){if("object"===typeof c&&null!==c&&c.type===y&&null===c.key&&(c=c.props.children),"object"===typeof c&&null!==c){switch(c.$$typeof){case p:e:{for(var v=c.key;null!==u;){if(u.key===v){if((v=c.type)===y){if(7===u.tag){n(l,u.sibling),(d=i(u,c.props.children)).return=l,l=d;break e}}else if(u.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===k&&Zs(v)===u.type){n(l,u.sibling),$s(d=i(u,c.props),c),d.return=l,l=d;break e}n(l,u);break}t(l,u),u=u.sibling}c.type===y?((d=jr(c.props.children,l.mode,d,c.key)).return=l,l=d):($s(d=Gr(c.type,c.key,c.props,null,l.mode,d),c),d.return=l,l=d)}return o(l);case g:e:{for(v=c.key;null!==u;){if(u.key===v){if(4===u.tag&&u.stateNode.containerInfo===c.containerInfo&&u.stateNode.implementation===c.implementation){n(l,u.sibling),(d=i(u,c.children||[])).return=l,l=d;break e}n(l,u);break}t(l,u),u=u.sibling}(d=Br(c,l.mode,d)).return=l,l=d}return o(l);case k:return _(l,u,c=(v=c._init)(c._payload),d)}if(M(c))return function(i,s,o,l){for(var u=null,c=null,d=s,p=s=0,g=null;null!==d&&p<o.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var y=f(i,d,o[p],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),s=a(y,s,p),null===c?u=y:c.sibling=y,c=y,d=g}if(p===o.length)return n(i,d),ai&&Zr(i,p),u;if(null===d){for(;p<o.length;p++)null!==(d=h(i,o[p],l))&&(s=a(d,s,p),null===c?u=d:c.sibling=d,c=d);return ai&&Zr(i,p),u}for(d=r(d);p<o.length;p++)null!==(g=m(d,i,p,o[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),s=a(g,s,p),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),ai&&Zr(i,p),u}(l,u,c,d);if(O(c)){if("function"!==typeof(v=O(c)))throw Error(s(150));return function(i,o,l,u){if(null==l)throw Error(s(151));for(var c=null,d=null,p=o,g=o=0,y=null,_=l.next();null!==p&&!_.done;g++,_=l.next()){p.index>g?(y=p,p=null):y=p.sibling;var v=f(i,p,_.value,u);if(null===v){null===p&&(p=y);break}e&&p&&null===v.alternate&&t(i,p),o=a(v,o,g),null===d?c=v:d.sibling=v,d=v,p=y}if(_.done)return n(i,p),ai&&Zr(i,g),c;if(null===p){for(;!_.done;g++,_=l.next())null!==(_=h(i,_.value,u))&&(o=a(_,o,g),null===d?c=_:d.sibling=_,d=_);return ai&&Zr(i,g),c}for(p=r(p);!_.done;g++,_=l.next())null!==(_=m(p,i,g,_.value,u))&&(e&&null!==_.alternate&&p.delete(null===_.key?g:_.key),o=a(_,o,g),null===d?c=_:d.sibling=_,d=_);return e&&p.forEach((function(e){return t(i,e)})),ai&&Zr(i,g),c}(l,u,c=v.call(c),d)}if("function"===typeof c.then)return _(l,u,Js(c),d);if(c.$$typeof===b)return _(l,u,Ti(l,c),d);Xs(l,c)}return"string"===typeof c&&""!==c||"number"===typeof c||"bigint"===typeof c?(c=""+c,null!==u&&6===u.tag?(n(l,u.sibling),(d=i(u,c)).return=l,l=d):(n(l,u),(d=zr(c,l.mode,d)).return=l,l=d),o(l)):n(l,u)}return function(e,t,n,r){try{Ws=0;var i=_(e,t,n,r);return Ys=null,i}catch(s){if(s===qi||s===Qi)throw s;var a=Dr(29,s,null,e.mode);return a.lanes=r,a.return=e,a}}}var to=eo(!0),no=eo(!1),ro=H(null),io=null;function ao(e){var t=e.alternate;j(uo,1&uo.current),j(ro,e),null===io&&(null===t||null!==fa.current||null!==t.memoizedState)&&(io=e)}function so(e){if(22===e.tag){if(j(uo,uo.current),j(ro,e),null===io){var t=e.alternate;null!==t&&null!==t.memoizedState&&(io=e)}}else oo()}function oo(){j(uo,uo.current),j(ro,ro.current)}function lo(e){G(ro),io===e&&(io=null),G(uo)}var uo=H(0);function co(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||yd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ho(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fo={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Lu(),i=ia(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=aa(e,i,r))&&(Du(t,e,r),sa(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Lu(),i=ia(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=aa(e,i,r))&&(Du(t,e,r),sa(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lu(),r=ia(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=aa(e,r,n))&&(Du(t,e,n),sa(t,e,n))}};function po(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!Jn(n,r)||!Jn(i,a))}function go(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fo.enqueueReplaceState(t,t.state,null)}function yo(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=h({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var mo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function _o(e){mo(e)}function vo(e){console.error(e)}function Eo(e){mo(e)}function bo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function Co(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function So(e,t,n){return(n=ia(n)).tag=3,n.payload={element:null},n.callback=function(){bo(e,t)},n}function No(e){return(e=ia(e)).tag=3,e}function Ao(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){Co(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Co(t,n,r),"function"!==typeof i&&(null===Nu?Nu=new Set([this]):Nu.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var ko=Error(s(461)),To=!1;function Io(e,t,n,r){t.child=null===e?no(t,null,n,r):to(t,e.child,n,r)}function wo(e,t,n,r,i){n=n.render;var a=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return Ai(t),r=Ua(e,t,n,s,a,i),o=Pa(),null===e||To?(ai&&o&&ti(t),t.flags|=1,Io(e,t,r,i),t.child):(Da(e,t,i),Wo(e,t,i))}function Oo(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||xr(a)||void 0!==a.defaultProps||null!==n.compare?((e=Gr(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Uo(e,t,a,r,i))}if(a=e.child,!Jo(e,i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(s,r)&&e.ref===t.ref)return Wo(e,t,i)}return t.flags|=1,(e=Fr(a,r)).ref=t.ref,e.return=t,t.child=e}function Uo(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(Jn(a,r)&&e.ref===t.ref){if(To=!1,t.pendingProps=r=a,!Jo(e,i))return t.lanes=e.lanes,Wo(e,t,i);0!==(131072&e.flags)&&(To=!0)}}return Po(e,t,n,r,i)}function Ro(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==a?a.baseLanes|n:n,null!==e){for(i=t.child=e.child,a=0;null!==i;)a=a|i.lanes|i.childLanes,i=i.sibling;t.childLanes=a&~r}else t.childLanes=0,t.child=null;return Mo(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Mo(e,t,null!==a?a.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Bi(0,null!==a?a.cachePool:null),null!==a?ga(t,a):ya(),so(t)}else null!==a?(Bi(0,a.cachePool),ga(t,a),oo(),t.memoizedState=null):(null!==e&&Bi(0,null),ya(),oo());return Io(e,t,i,n),t.child}function Mo(e,t,n,r){var i=zi();return i=null===i?null:{parent:Ri._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Bi(0,null),ya(),so(t),null!==e&&Si(e,t,r,!0),null}function Lo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Po(e,t,n,r,i){return Ai(t),n=Ua(e,t,n,r,void 0,i),r=Pa(),null===e||To?(ai&&r&&ti(t),t.flags|=1,Io(e,t,n,i),t.child):(Da(e,t,i),Wo(e,t,i))}function Do(e,t,n,r,i,a){return Ai(t),t.updateQueue=null,n=Ma(t,r,n,i),Ra(e),r=Pa(),null===e||To?(ai&&r&&ti(t),t.flags|=1,Io(e,t,n,a),t.child):(Da(e,t,a),Wo(e,t,a))}function xo(e,t,n,r,i){if(Ai(t),null===t.stateNode){var a=Lr,s=n.contextType;"object"===typeof s&&null!==s&&(a=ki(s)),a=new n(r,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=fo,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=r,a.state=t.memoizedState,a.refs={},na(t),s=n.contextType,a.context="object"===typeof s&&null!==s?ki(s):Lr,a.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(ho(t,n,s,r),a.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(s=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&fo.enqueueReplaceState(a,a.state,null),ca(t,r,a,i),ua(),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){a=t.stateNode;var o=t.memoizedProps,l=yo(n,o);a.props=l;var u=a.context,c=n.contextType;s=Lr,"object"===typeof c&&null!==c&&(s=ki(c));var d=n.getDerivedStateFromProps;c="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate,o=t.pendingProps!==o,c||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o||u!==s)&&go(t,a,r,s),ta=!1;var h=t.memoizedState;a.state=h,ca(t,r,a,i),ua(),u=t.memoizedState,o||h!==u||ta?("function"===typeof d&&(ho(t,n,d,r),u=t.memoizedState),(l=ta||po(t,n,l,r,h,u,s))?(c||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=s,r=l):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,ra(e,t),c=yo(n,s=t.memoizedProps),a.props=c,d=t.pendingProps,h=a.context,u=n.contextType,l=Lr,"object"===typeof u&&null!==u&&(l=ki(u)),(u="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||h!==l)&&go(t,a,r,l),ta=!1,h=t.memoizedState,a.state=h,ca(t,r,a,i),ua();var f=t.memoizedState;s!==d||h!==f||ta||null!==e&&null!==e.dependencies&&Ni(e.dependencies)?("function"===typeof o&&(ho(t,n,o,r),f=t.memoizedState),(c=ta||po(t,n,c,r,h,f,l)||null!==e&&null!==e.dependencies&&Ni(e.dependencies))?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return a=r,Lo(e,t),r=0!==(128&t.flags),a||r?(a=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&r?(t.child=to(t,e.child,null,i),t.child=to(t,null,n,i)):Io(e,t,n,i),t.memoizedState=a.state,e=t.child):e=Wo(e,t,i),e}function Fo(e,t,n,r){return fi(),t.flags|=256,Io(e,t,n,r),t.child}var Ho={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Go(e){return{baseLanes:e,cachePool:Vi()}}function jo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=yu),e}function zo(e,t,n){var r,i=t.pendingProps,a=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&uo.current)),r&&(a=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ai){if(a?ao(t):oo(),ai){var l,u=ii;if(l=u){e:{for(l=u,u=oi;8!==l.nodeType;){if(!u){u=null;break e}if(null===(l=md(l.nextSibling))){u=null;break e}}u=l}null!==u?(t.memoizedState={dehydrated:u,treeContext:null!==Jr?{id:$r,overflow:Xr}:null,retryLane:536870912,hydrationErrors:null},(l=Dr(18,null,null,0)).stateNode=u,l.return=t,t.child=l,ri=t,ii=null,l=!0):l=!1}l||ui(t)}if(null!==(u=t.memoizedState)&&null!==(u=u.dehydrated))return yd(u)?t.lanes=32:t.lanes=536870912,null;lo(t)}return u=i.children,i=i.fallback,a?(oo(),u=Vo({mode:"hidden",children:u},a=t.mode),i=jr(i,a,n,null),u.return=t,i.return=t,u.sibling=i,t.child=u,(a=t.child).memoizedState=Go(n),a.childLanes=jo(e,r,n),t.memoizedState=Ho,i):(ao(t),Bo(t,u))}if(null!==(l=e.memoizedState)&&null!==(u=l.dehydrated)){if(o)256&t.flags?(ao(t),t.flags&=-257,t=qo(e,t,n)):null!==t.memoizedState?(oo(),t.child=e.child,t.flags|=128,t=null):(oo(),a=i.fallback,u=t.mode,i=Vo({mode:"visible",children:i.children},u),(a=jr(a,u,n,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,to(t,e.child,null,n),(i=t.child).memoizedState=Go(n),i.childLanes=jo(e,r,n),t.memoizedState=Ho,t=a);else if(ao(t),yd(u)){if(r=u.nextSibling&&u.nextSibling.dataset)var c=r.dgst;r=c,(i=Error(s(419))).stack="",i.digest=r,gi({value:i,source:null,stack:null}),t=qo(e,t,n)}else if(To||Si(e,t,n,!1),r=0!==(n&e.childLanes),To||r){if(null!==(r=ru)&&(0!==(i=0!==((i=0!==(42&(i=n&-n))?1:Ie(i))&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Ur(e,i),Du(r,e,i),ko;"$?"===u.data||Qu(),t=qo(e,t,n)}else"$?"===u.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ii=md(u.nextSibling),ri=t,ai=!0,si=null,oi=!1,null!==e&&(Yr[Wr++]=$r,Yr[Wr++]=Xr,Yr[Wr++]=Jr,$r=e.id,Xr=e.overflow,Jr=t),(t=Bo(t,i.children)).flags|=4096);return t}return a?(oo(),a=i.fallback,u=t.mode,c=(l=e.child).sibling,(i=Fr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==c?a=Fr(c,a):(a=jr(a,u,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,null===(u=e.child.memoizedState)?u=Go(n):(null!==(l=u.cachePool)?(c=Ri._currentValue,l=l.parent!==c?{parent:c,pool:c}:l):l=Vi(),u={baseLanes:u.baseLanes|n,cachePool:l}),a.memoizedState=u,a.childLanes=jo(e,r,n),t.memoizedState=Ho,i):(ao(t),e=(n=e.child).sibling,(n=Fr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Bo(e,t){return(t=Vo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Vo(e,t){return(e=Dr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function qo(e,t,n){return to(t,e.child,null,n),(e=Bo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ko(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),bi(e.return,t,n)}function Qo(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Yo(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Io(e,t,r.children,n),0!==(2&(r=uo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ko(e,n,t);else if(19===e.tag)Ko(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(j(uo,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===co(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Qo(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===co(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Qo(t,!0,n,null,a);break;case"together":Qo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),fu|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Si(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Fr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Jo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ni(e))}function $o(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)To=!0;else{if(!Jo(e,n)&&0===(128&t.flags))return To=!1,function(e,t,n){switch(t.tag){case 3:K(t,t.stateNode.containerInfo),vi(0,Ri,e.memoizedState.cache),fi();break;case 27:case 5:Y(t);break;case 4:K(t,t.stateNode.containerInfo);break;case 10:vi(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ao(t),t.flags|=128,null):0!==(n&t.child.childLanes)?zo(e,t,n):(ao(t),null!==(e=Wo(e,t,n))?e.sibling:null);ao(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Si(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return Yo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),j(uo,uo.current),r)break;return null;case 22:case 23:return t.lanes=0,Ro(e,t,n);case 24:vi(0,Ri,e.memoizedState.cache)}return Wo(e,t,n)}(e,t,n);To=0!==(131072&e.flags)}else To=!1,ai&&0!==(1048576&t.flags)&&ei(t,Qr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===C){t.tag=11,t=wo(null,t,r,e,n);break e}if(i===A){t.tag=14,t=Oo(null,t,r,e,n);break e}}throw t=R(r)||r,Error(s(306,t,""))}xr(r)?(e=yo(r,e),t.tag=1,t=xo(null,t,r,e,n)):(t.tag=0,t=Po(null,t,r,e,n))}return t;case 0:return Po(e,t,t.type,t.pendingProps,n);case 1:return xo(e,t,r=t.type,i=yo(r,t.pendingProps),n);case 3:e:{if(K(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var a=t.memoizedState;i=a.element,ra(e,t),ca(t,r,null,n);var o=t.memoizedState;if(r=o.cache,vi(0,Ri,r),r!==a.cache&&Ci(t,[Ri],n,!0),ua(),r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Fo(e,t,r,n);break e}if(r!==i){gi(i=Nr(Error(s(424)),t)),t=Fo(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ii=md(e.firstChild),ri=t,ai=!0,si=null,oi=!0,n=no(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===i){t=Wo(e,t,n);break e}Io(e,t,r,n)}t=t.child}return t;case 26:return Lo(e,t),null===e?(n=Id(t.type,null,t.pendingProps,null))?t.memoizedState=n:ai||(n=t.type,e=t.pendingProps,(r=rd(V.current).createElement(n))[Re]=t,r[Me]=e,ed(r,n,e),qe(r),t.stateNode=r):t.memoizedState=Id(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&ai&&(r=t.stateNode=Ed(t.type,t.pendingProps,V.current),ri=t,oi=!0,i=ii,fd(t.type)?(_d=i,ii=md(r.firstChild)):ii=i),Io(e,t,t.pendingProps.children,n),Lo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ai&&((i=r=ii)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[He])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(a=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(a!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((a=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var a=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===a)return e}if(null===(e=md(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,oi))?(t.stateNode=r,ri=t,ii=md(r.firstChild),oi=!1,i=!0):i=!1),i||ui(t)),Y(t),i=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,r=a.children,sd(i,a)?r=null:null!==o&&sd(i,o)&&(t.flags|=32),null!==t.memoizedState&&(i=Ua(e,t,La,null,null,n),Yd._currentValue=i),Lo(e,t),Io(e,t,r,n),t.child;case 6:return null===e&&ai&&((e=n=ii)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=md(e.nextSibling)))return null}return e}(n,t.pendingProps,oi))?(t.stateNode=n,ri=t,ii=null,e=!0):e=!1),e||ui(t)),null;case 13:return zo(e,t,n);case 4:return K(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=to(t,null,r,n):Io(e,t,r,n),t.child;case 11:return wo(e,t,t.type,t.pendingProps,n);case 7:return Io(e,t,t.pendingProps,n),t.child;case 8:case 12:return Io(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,vi(0,t.type,r.value),Io(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ai(t),r=r(i=ki(i)),t.flags|=1,Io(e,t,r,n),t.child;case 14:return Oo(e,t,t.type,t.pendingProps,n);case 15:return Uo(e,t,t.type,t.pendingProps,n);case 19:return Yo(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=Vo(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Fr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ro(e,t,n);case 24:return Ai(t),r=ki(Ri),null===e?(null===(i=zi())&&(i=ru,a=Mi(),i.pooledCache=a,a.refCount++,null!==a&&(i.pooledCacheLanes|=n),i=a),t.memoizedState={parent:r,cache:i},na(t),vi(0,Ri,i)):(0!==(e.lanes&n)&&(ra(e,t),ca(t,null,null,n),ua()),i=e.memoizedState,a=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),vi(0,Ri,r)):(r=a.cache,vi(0,Ri,r),r!==i.cache&&Ci(t,[Ri],n,!0))),Io(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Xo(e){e.flags|=4}function Zo(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!jd(t)){if(null!==(t=ro.current)&&((4194048&au)===au?null!==io:(62914560&au)!==au&&0===(536870912&au)||t!==io))throw Xi=Yi,Ki;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Se():536870912,e.lanes|=t,mu|=t)}function tl(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ei(Ri),Q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?Xo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pi())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Xo(t),null!==n?(nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Xo(t),nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Xo(t),nl(t),t.flags&=-16777217),null;case 27:W(t),n=V.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Xo(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}e=z.current,hi(t)?ci(t):(e=Ed(i,r,n),t.stateNode=e,Xo(t))}return nl(t),null;case 5:if(W(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Xo(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}if(e=z.current,hi(t))ci(t);else{switch(i=rd(V.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Re]=t,e[Me]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(ed(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Xo(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Xo(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=V.current,hi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ri))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Re]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Jc(e.nodeValue,n)))||ui(t)}else(e=rd(e).createTextNode(r))[Re]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[Re]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),i=!1}else i=pi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(lo(t),t):(lo(t),null)}if(lo(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var a=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(a=r.memoizedState.cachePool.pool),a!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return Q(),null===e&&Gc(t.stateNode.containerInfo),nl(t),null;case 10:return Ei(t.type),nl(t),null;case 19:if(G(uo),null===(i=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(a=i.rendering))if(r)tl(i,!1);else{if(0!==hu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(a=co(e))){for(t.flags|=128,tl(i,!1),e=a.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Hr(n,e),n=n.sibling;return j(uo,1&uo.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Cu&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=co(a))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!a.alternate&&!ai)return nl(t),null}else 2*te()-i.renderingStartTime>Cu&&536870912!==n&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=i.last)?e.sibling=a:t.child=a,i.last=a)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=uo.current,j(uo,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return lo(t),ma(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&G(ji),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ei(Ri),nl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function il(e,t){switch(ni(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ei(Ri),Q(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return W(t),null;case 13:if(lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return G(uo),null;case 4:return Q(),null;case 10:return Ei(t.type),null;case 22:case 23:return lo(t),ma(),null!==e&&G(ji),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ei(Ri),null;default:return null}}function al(e,t){switch(ni(t),t.tag){case 3:Ei(Ri),Q();break;case 26:case 27:case 5:W(t);break;case 4:Q();break;case 13:lo(t);break;case 19:G(uo);break;case 10:Ei(t.type);break;case 22:case 23:lo(t),ma(),null!==e&&G(ji);break;case 24:Ei(Ri)}}function sl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var a=n.create,s=n.inst;r=a(),s.destroy=r}n=n.next}while(n!==i)}}catch(o){cc(t,t.return,o)}}function ol(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var a=i.next;r=a;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,i=t;var l=n,u=o;try{u()}catch(c){cc(i,l,c)}}}r=r.next}while(r!==a)}}catch(c){cc(t,t.return,c)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ha(t,n)}catch(r){cc(e,e.return,r)}}}function ul(e,t,n){n.props=yo(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){cc(e,t,r)}}function cl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){cc(e,t,i)}}function dl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){cc(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(a){cc(e,t,a)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){cc(e,e.return,i)}}function fl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,o=null,l=null,u=null,c=null,d=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":u=h;default:r.hasOwnProperty(p)||Xc(e,t,p,null,r,h)}}for(var f in r){var p=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=p||null!=h))switch(f){case"type":a=p;break;case"name":i=p;break;case"checked":c=p;break;case"defaultChecked":d=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==h&&Xc(e,t,f,p,r,h)}}return void yt(e,o,l,u,c,d,a,i);case"select":for(a in p=o=l=f=null,n)if(u=n[a],n.hasOwnProperty(a)&&null!=u)switch(a){case"value":break;case"multiple":p=u;default:r.hasOwnProperty(a)||Xc(e,t,a,null,r,u)}for(i in r)if(a=r[i],u=n[i],r.hasOwnProperty(i)&&(null!=a||null!=u))switch(i){case"value":f=a;break;case"defaultValue":l=a;break;case"multiple":o=a;default:a!==u&&Xc(e,t,i,a,r,u)}return t=l,n=o,r=p,void(null!=f?vt(e,!!n,f,!1):!!r!==!!n&&(null!=t?vt(e,!!n,t,!0):vt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Xc(e,t,l,null,r,i)}for(o in r)if(i=r[o],a=n[o],r.hasOwnProperty(o)&&(null!=i||null!=a))switch(o){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==a&&Xc(e,t,o,i,r,a)}return void Et(e,f,p);case"option":for(var g in n)if(f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else Xc(e,t,g,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))if("selected"===u)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Xc(e,t,u,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&Xc(e,t,y,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))switch(c){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:Xc(e,t,c,f,r,p)}return;default:if(kt(t)){for(var m in n)f=n[m],n.hasOwnProperty(m)&&void 0!==f&&!r.hasOwnProperty(m)&&Zc(e,t,m,void 0,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||void 0===f&&void 0===p||Zc(e,t,d,f,r,p);return}}for(var _ in n)f=n[_],n.hasOwnProperty(_)&&null!=f&&!r.hasOwnProperty(_)&&Xc(e,t,_,null,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||null==f&&null==p||Xc(e,t,h,f,r,p)}(r,e.type,n,t),r[Me]=t}catch(i){cc(e,e.return,i)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fd(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$c));else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function ml(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(ml(e,t,n),e=e.sibling;null!==e;)ml(e,t,n),e=e.sibling}function _l(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);ed(t,r,n),t[Re]=e,t[Me]=n}catch(a){cc(e,e.return,a)}}var vl=!1,El=!1,bl=!1,Cl="function"===typeof WeakSet?WeakSet:Set,Sl=null;function Nl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:xl(e,n),4&r&&sl(5,n);break;case 1:if(xl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){cc(n,n.return,s)}else{var i=yo(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){cc(n,n.return,o)}}64&r&&ll(n),512&r&&cl(n,n.return);break;case 3:if(xl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ha(e,t)}catch(s){cc(n,n.return,s)}}break;case 27:null===t&&4&r&&_l(n);case 26:case 5:xl(e,n),null===t&&4&r&&hl(n),512&r&&cl(n,n.return);break;case 12:xl(e,n);break;case 13:xl(e,n),4&r&&Ol(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=pc.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||vl)){t=null!==t&&null!==t.memoizedState||El,i=vl;var a=El;vl=r,(El=t)&&!a?Hl(e,n,0!==(8772&n.subtreeFlags)):xl(e,n),vl=i,El=a}break;case 30:break;default:xl(e,n)}}function Al(e){var t=e.alternate;null!==t&&(e.alternate=null,Al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ge(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var kl=null,Tl=!1;function Il(e,t,n){for(n=n.child;null!==n;)wl(e,t,n),n=n.sibling}function wl(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ce,n)}catch(a){}switch(n.tag){case 26:El||dl(n,t),Il(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:El||dl(n,t);var r=kl,i=Tl;fd(n.type)&&(kl=n.stateNode,Tl=!1),Il(e,t,n),bd(n.stateNode),kl=r,Tl=i;break;case 5:El||dl(n,t);case 6:if(r=kl,i=Tl,kl=null,Il(e,t,n),Tl=i,null!==(kl=r))if(Tl)try{(9===kl.nodeType?kl.body:"HTML"===kl.nodeName?kl.ownerDocument.body:kl).removeChild(n.stateNode)}catch(s){cc(n,t,s)}else try{kl.removeChild(n.stateNode)}catch(s){cc(n,t,s)}break;case 18:null!==kl&&(Tl?(pd(9===(e=kl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Th(e)):pd(kl,n.stateNode));break;case 4:r=kl,i=Tl,kl=n.stateNode.containerInfo,Tl=!0,Il(e,t,n),kl=r,Tl=i;break;case 0:case 11:case 14:case 15:El||ol(2,n,t),El||ol(4,n,t),Il(e,t,n);break;case 1:El||(dl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&ul(n,t,r)),Il(e,t,n);break;case 21:Il(e,t,n);break;case 22:El=(r=El)||null!==n.memoizedState,Il(e,t,n),El=r;break;default:Il(e,t,n)}}function Ol(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Th(e)}catch(n){cc(t,t.return,n)}}function Ul(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Cl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Cl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach((function(t){var r=gc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function Rl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(fd(l.type)){kl=l.stateNode,Tl=!1;break e}break;case 5:kl=l.stateNode,Tl=!1;break e;case 3:case 4:kl=l.stateNode.containerInfo,Tl=!0;break e}l=l.return}if(null===kl)throw Error(s(160));wl(a,o,i),kl=null,Tl=!1,null!==(a=i.alternate)&&(a.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ll(t,e),t=t.sibling}var Ml=null;function Ll(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Rl(t,e),Pl(e),4&r&&(ol(3,e,e.return),sl(3,e),ol(5,e,e.return));break;case 1:Rl(t,e),Pl(e),512&r&&(El||null===n||dl(n,n.return)),64&r&&vl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Ml;if(Rl(t,e),Pl(e),512&r&&(El||null===n||dl(n,n.return)),4&r){var a=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(a=i.getElementsByTagName("title")[0])||a[He]||a[Re]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=i.createElement(r),i.head.insertBefore(a,i.querySelector("head > title"))),ed(a,r,n),a[Re]=e,qe(a),r=a;break e;case"link":var o=Hd("link","href",i).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((a=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&a.getAttribute("rel")===(null==n.rel?null:n.rel)&&a.getAttribute("title")===(null==n.title?null:n.title)&&a.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}ed(a=i.createElement(r),r,n),i.head.appendChild(a);break;case"meta":if(o=Hd("meta","content",i).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((a=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&a.getAttribute("name")===(null==n.name?null:n.name)&&a.getAttribute("property")===(null==n.property?null:n.property)&&a.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&a.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}ed(a=i.createElement(r),r,n),i.head.appendChild(a);break;default:throw Error(s(468,r))}a[Re]=e,qe(a),r=a}e.stateNode=r}else Gd(i,e.type,e.stateNode);else e.stateNode=Ld(i,r,e.memoizedProps);else a!==r?(null===a?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):a.count--,null===r?Gd(i,e.type,e.stateNode):Ld(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&fl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Rl(t,e),Pl(e),512&r&&(El||null===n||dl(n,n.return)),null!==n&&4&r&&fl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Rl(t,e),Pl(e),512&r&&(El||null===n||dl(n,n.return)),32&e.flags){i=e.stateNode;try{Ct(i,"")}catch(p){cc(e,e.return,p)}}4&r&&null!=e.stateNode&&fl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(bl=!0);break;case 6:if(Rl(t,e),Pl(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){cc(e,e.return,p)}}break;case 3:if(Fd=null,i=Ml,Ml=Nd(t.containerInfo),Rl(t,e),Ml=i,Pl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Th(t.containerInfo)}catch(p){cc(e,e.return,p)}bl&&(bl=!1,Dl(e));break;case 4:r=Ml,Ml=Nd(e.stateNode.containerInfo),Rl(t,e),Pl(e),Ml=r;break;case 12:default:Rl(t,e),Pl(e);break;case 13:Rl(t,e),Pl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(bu=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ul(e,r)));break;case 22:i=null!==e.memoizedState;var u=null!==n&&null!==n.memoizedState,c=vl,d=El;if(vl=c||i,El=d||u,Rl(t,e),El=d,vl=c,Pl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||u||vl||El||Fl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){u=n=t;try{if(a=u.stateNode,i)"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=u.stateNode;var h=u.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){cc(u,u.return,p)}}}else if(6===t.tag){if(null===n){u=t;try{u.stateNode.nodeValue=i?"":u.memoizedProps}catch(p){cc(u,u.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Ul(e,n))));break;case 19:Rl(t,e),Pl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ul(e,r)));case 30:case 21:}}function Pl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(pl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;ml(e,gl(e),i);break;case 5:var a=n.stateNode;32&n.flags&&(Ct(a,""),n.flags&=-33),ml(e,gl(e),a);break;case 3:case 4:var o=n.stateNode.containerInfo;yl(e,gl(e),o);break;default:throw Error(s(161))}}catch(l){cc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Dl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Dl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function xl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Nl(e,t.alternate,t),t=t.sibling}function Fl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ol(4,t,t.return),Fl(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&ul(t,t.return,n),Fl(t);break;case 27:bd(t.stateNode);case 26:case 5:dl(t,t.return),Fl(t);break;case 22:null===t.memoizedState&&Fl(t);break;default:Fl(t)}e=e.sibling}}function Hl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,a=t,s=a.flags;switch(a.tag){case 0:case 11:case 15:Hl(i,a,n),sl(4,a);break;case 1:if(Hl(i,a,n),"function"===typeof(i=(r=a).stateNode).componentDidMount)try{i.componentDidMount()}catch(u){cc(r,r.return,u)}if(null!==(i=(r=a).updateQueue)){var o=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)da(l[i],o)}catch(u){cc(r,r.return,u)}}n&&64&s&&ll(a),cl(a,a.return);break;case 27:_l(a);case 26:case 5:Hl(i,a,n),n&&null===r&&4&s&&hl(a),cl(a,a.return);break;case 12:Hl(i,a,n);break;case 13:Hl(i,a,n),n&&4&s&&Ol(i,a);break;case 22:null===a.memoizedState&&Hl(i,a,n),cl(a,a.return);break;case 30:break;default:Hl(i,a,n)}t=t.sibling}}function Gl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Li(n))}function jl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Li(e))}function zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Bl(e,t,n,r),t=t.sibling}function Bl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:zl(e,t,n,r),2048&i&&sl(9,t);break;case 1:case 13:default:zl(e,t,n,r);break;case 3:zl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Li(e)));break;case 12:if(2048&i){zl(e,t,n,r),e=t.stateNode;try{var a=t.memoizedProps,s=a.id,o=a.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){cc(t,t.return,l)}}else zl(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,s=t.alternate,null!==t.memoizedState?2&a._visibility?zl(e,t,n,r):ql(e,t):2&a._visibility?zl(e,t,n,r):(a._visibility|=2,Vl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&Gl(s,t);break;case 24:zl(e,t,n,r),2048&i&&jl(t.alternate,t)}}function Vl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var a=e,s=t,o=n,l=r,u=s.flags;switch(s.tag){case 0:case 11:case 15:Vl(a,s,o,l,i),sl(8,s);break;case 23:break;case 22:var c=s.stateNode;null!==s.memoizedState?2&c._visibility?Vl(a,s,o,l,i):ql(a,s):(c._visibility|=2,Vl(a,s,o,l,i)),i&&2048&u&&Gl(s.alternate,s);break;case 24:Vl(a,s,o,l,i),i&&2048&u&&jl(s.alternate,s);break;default:Vl(a,s,o,l,i)}t=t.sibling}}function ql(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:ql(n,r),2048&i&&Gl(r.alternate,r);break;case 24:ql(n,r),2048&i&&jl(r.alternate,r);break;default:ql(n,r)}t=t.sibling}}var Kl=8192;function Ql(e){if(e.subtreeFlags&Kl)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Ql(e),e.flags&Kl&&null!==e.memoizedState&&function(e,t,n){if(null===zd)throw Error(s(475));var r=zd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=wd(n.href),a=e.querySelector(Od(i));if(a)return null!==(e=a._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Vd.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=a,void qe(a);a=e.ownerDocument||e,n=Ud(n),(i=Cd.get(i))&&Dd(n,i),qe(a=a.createElement("link"));var o=a;o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),ed(a,"link",n),t.instance=a}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Vd.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Ml,e.memoizedState,e.memoizedProps);break;case 5:default:Ql(e);break;case 3:case 4:var t=Ml;Ml=Nd(e.stateNode.containerInfo),Ql(e),Ml=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Kl,Kl=16777216,Ql(e),Kl=t):Ql(e))}}function Wl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Sl=r,Zl(r,e)}Wl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)$l(e),e=e.sibling}function $l(e){switch(e.tag){case 0:case 11:case 15:Jl(e),2048&e.flags&&ol(9,e,e.return);break;case 3:case 12:default:Jl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Xl(e)):Jl(e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Sl=r,Zl(r,e)}Wl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ol(8,t,t.return),Xl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Xl(t));break;default:Xl(t)}e=e.sibling}}function Zl(e,t){for(;null!==Sl;){var n=Sl;switch(n.tag){case 0:case 11:case 15:ol(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Li(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Sl=r;else e:for(n=e;null!==Sl;){var i=(r=Sl).sibling,a=r.return;if(Al(r),r===n){Sl=null;break e}if(null!==i){i.return=a,Sl=i;break e}Sl=a}}}var eu={getCacheForType:function(e){var t=ki(Ri),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tu="function"===typeof WeakMap?WeakMap:Map,nu=0,ru=null,iu=null,au=0,su=0,ou=null,lu=!1,uu=!1,cu=!1,du=0,hu=0,fu=0,pu=0,gu=0,yu=0,mu=0,_u=null,vu=null,Eu=!1,bu=0,Cu=1/0,Su=null,Nu=null,Au=0,ku=null,Tu=null,Iu=0,wu=0,Ou=null,Uu=null,Ru=0,Mu=null;function Lu(){if(0!==(2&nu)&&0!==au)return au&-au;if(null!==L.T){return 0!==xi?xi:wc()}return Oe()}function Pu(){0===yu&&(yu=0===(536870912&au)||ai?Ce():536870912);var e=ro.current;return null!==e&&(e.flags|=32),yu}function Du(e,t,n){(e!==ru||2!==su&&9!==su)&&null===e.cancelPendingCommit||(Bu(e,0),Gu(e,au,yu,!1)),Ae(e,n),0!==(2&nu)&&e===ru||(e===ru&&(0===(2&nu)&&(pu|=n),4===hu&&Gu(e,au,yu,!1)),Cc(e))}function xu(e,t,n){if(0!==(6&nu))throw Error(s(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||Ee(e,t),i=r?function(e,t){var n=nu;nu|=2;var r=qu(),i=Ku();ru!==e||au!==t?(Su=null,Cu=te()+500,Bu(e,t)):uu=Ee(e,t);e:for(;;)try{if(0!==su&&null!==iu){t=iu;var a=ou;t:switch(su){case 1:su=0,ou=null,Zu(e,t,a,1);break;case 2:case 9:if(Wi(a)){su=0,ou=null,Xu(t);break}t=function(){2!==su&&9!==su||ru!==e||(su=7),Cc(e)},a.then(t,t);break e;case 3:su=7;break e;case 4:su=5;break e;case 7:Wi(a)?(su=0,ou=null,Xu(t)):(su=0,ou=null,Zu(e,t,a,7));break;case 5:var o=null;switch(iu.tag){case 26:o=iu.memoizedState;case 5:case 27:var l=iu;if(!o||jd(o)){su=0,ou=null;var u=l.sibling;if(null!==u)iu=u;else{var c=l.return;null!==c?(iu=c,ec(c)):iu=null}break t}}su=0,ou=null,Zu(e,t,a,5);break;case 6:su=0,ou=null,Zu(e,t,a,6);break;case 8:zu(),hu=6;break e;default:throw Error(s(462))}}Ju();break}catch(d){Vu(e,d)}return _i=mi=null,L.H=r,L.A=i,nu=n,null!==iu?0:(ru=null,au=0,Ir(),hu)}(e,t):Yu(e,t,!0),a=r;;){if(0===i){uu&&!r&&Gu(e,t,0,!1);break}if(n=e.current.alternate,!a||Hu(n)){if(2===i){if(a=t,e.errorRecoveryDisabledLanes&a)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;i=_u;var u=l.current.memoizedState.isDehydrated;if(u&&(Bu(l,o).flags|=256),2!==(o=Yu(l,o,!1))){if(cu&&!u){l.errorRecoveryDisabledLanes|=a,pu|=a,i=4;break e}a=vu,vu=i,null!==a&&(null===vu?vu=a:vu.push.apply(vu,a))}i=o}if(a=!1,2!==i)continue}}if(1===i){Bu(e,0),Gu(e,t,0,!0);break}e:{switch(r=e,a=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Gu(r,t,yu,!lu);break e;case 2:vu=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=bu+300-te())){if(Gu(r,t,yu,!lu),0!==ve(r,0,!0))break e;r.timeoutHandle=ld(Fu.bind(null,r,n,vu,Su,Eu,t,yu,pu,mu,lu,a,2,-0,0),i)}else Fu(r,n,vu,Su,Eu,t,yu,pu,mu,lu,a,0,-0,0)}break}i=Yu(e,t,!1),a=!1}Cc(e)}function Fu(e,t,n,r,i,a,o,l,u,c,d,h,f,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(zd={stylesheets:null,count:0,unsuspend:Bd},Yl(t),null!==(h=function(){if(null===zd)throw Error(s(475));var e=zd;return e.stylesheets&&0===e.count&&Kd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Kd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nc.bind(null,e,t,a,n,r,i,o,l,u,d,1,f,p)),void Gu(e,a,o,!c);nc(e,t,a,n,r,i,o,l,u)}function Hu(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Wn(a(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gu(e,t,n,r){t&=~gu,t&=~pu,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-fe(i),s=1<<a;r[a]=-1,i&=~s}0!==n&&ke(e,n,t)}function ju(){return 0!==(6&nu)||(Sc(0,!1),!1)}function zu(){if(null!==iu){if(0===su)var e=iu.return;else _i=mi=null,xa(e=iu),Ys=null,Ws=0,e=iu;for(;null!==e;)al(e.alternate,e),e=e.return;iu=null}}function Bu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ud(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),zu(),ru=e,iu=n=Fr(e.current,null),au=t,su=0,ou=null,lu=!1,uu=Ee(e,t),cu=!1,mu=yu=gu=pu=fu=hu=0,vu=_u=null,Eu=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-fe(r),a=1<<i;t|=e[i],r&=~a}return du=t,Ir(),n}function Vu(e,t){va=null,L.H=Vs,t===qi||t===Qi?(t=Zi(),su=3):t===Ki?(t=Zi(),su=4):su=t===ko?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ou=t,null===iu&&(hu=1,bo(e,Nr(t,e.current)))}function qu(){var e=L.H;return L.H=Vs,null===e?Vs:e}function Ku(){var e=L.A;return L.A=eu,e}function Qu(){hu=4,lu||(4194048&au)!==au&&null!==ro.current||(uu=!0),0===(134217727&fu)&&0===(134217727&pu)||null===ru||Gu(ru,au,yu,!1)}function Yu(e,t,n){var r=nu;nu|=2;var i=qu(),a=Ku();ru===e&&au===t||(Su=null,Bu(e,t)),t=!1;var s=hu;e:for(;;)try{if(0!==su&&null!==iu){var o=iu,l=ou;switch(su){case 8:zu(),s=6;break e;case 3:case 2:case 9:case 6:null===ro.current&&(t=!0);var u=su;if(su=0,ou=null,Zu(e,o,l,u),n&&uu){s=0;break e}break;default:u=su,su=0,ou=null,Zu(e,o,l,u)}}Wu(),s=hu;break}catch(c){Vu(e,c)}return t&&e.shellSuspendCounter++,_i=mi=null,nu=r,L.H=i,L.A=a,null===iu&&(ru=null,au=0,Ir()),s}function Wu(){for(;null!==iu;)$u(iu)}function Ju(){for(;null!==iu&&!Z();)$u(iu)}function $u(e){var t=$o(e.alternate,e,du);e.memoizedProps=e.pendingProps,null===t?ec(e):iu=t}function Xu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Do(n,t,t.pendingProps,t.type,void 0,au);break;case 11:t=Do(n,t,t.pendingProps,t.type.render,t.ref,au);break;case 5:xa(t);default:al(n,t),t=$o(n,t=iu=Hr(t,du),du)}e.memoizedProps=e.pendingProps,null===t?ec(e):iu=t}function Zu(e,t,n,r){_i=mi=null,xa(t),Ys=null,Ws=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Si(t,n,i,!0),null!==(n=ro.current)){switch(n.tag){case 13:return null===io?Qu():null===n.alternate&&0===hu&&(hu=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===Yi?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),dc(e,r,i)),!1;case 22:return n.flags|=65536,r===Yi?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),dc(e,r,i)),!1}throw Error(s(435,n.tag))}return dc(e,r,i),Qu(),!1}if(ai)return null!==(t=ro.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==li&&gi(Nr(e=Error(s(422),{cause:r}),n))):(r!==li&&gi(Nr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Nr(r,n),oa(e,i=So(e.stateNode,r,i)),4!==hu&&(hu=2)),!1;var a=Error(s(520),{cause:r});if(a=Nr(a,n),null===_u?_u=[a]:_u.push(a),4!==hu&&(hu=2),null===t)return!0;r=Nr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,oa(n,e=So(n.stateNode,r,e)),!1;case 1:if(t=n.type,a=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==a&&"function"===typeof a.componentDidCatch&&(null===Nu||!Nu.has(a))))return n.flags|=65536,i&=-i,n.lanes|=i,Ao(i=No(i),e,n,r),oa(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,au))return hu=1,bo(e,Nr(n,e.current)),void(iu=null)}catch(a){if(null!==i)throw iu=i,a;return hu=1,bo(e,Nr(n,e.current)),void(iu=null)}32768&t.flags?(ai||1===r?e=!0:uu||0!==(536870912&au)?e=!1:(lu=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ro.current)&&13===r.tag&&(r.flags|=16384))),tc(t,e)):ec(t)}function ec(e){var t=e;do{if(0!==(32768&t.flags))return void tc(t,lu);e=t.return;var n=rl(t.alternate,t,du);if(null!==n)return void(iu=n);if(null!==(t=t.sibling))return void(iu=t);iu=t=e}while(null!==t);0===hu&&(hu=5)}function tc(e,t){do{var n=il(e.alternate,e);if(null!==n)return n.flags&=32767,void(iu=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(iu=e);iu=e=n}while(null!==e);hu=6,iu=null}function nc(e,t,n,r,i,a,o,l,u){e.cancelPendingCommit=null;do{oc()}while(0!==Au);if(0!==(6&nu))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(a=t.lanes|t.childLanes,function(e,t,n,r,i,a){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,u=e.hiddenUpdates;for(n=s&~n;0<n;){var c=31-fe(n),d=1<<c;o[c]=0,l[c]=-1;var h=u[c];if(null!==h)for(u[c]=null,c=0;c<h.length;c++){var f=h[c];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&ke(e,r,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(s&~t))}(e,n,a|=Tr,o,l,u),e===ru&&(iu=ru=null,au=0),Tu=t,ku=e,Iu=n,wu=a,Ou=i,Uu=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,$(ae,(function(){return lc(),null}))):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=L.T,L.T=null,i=P.p,P.p=2,o=nu,nu|=4;try{!function(e,t){if(e=e.containerInfo,td=nh,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(y){n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(u=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===i&&(l=o),f===a&&++d===r&&(u=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},nh=!1,Sl=t;null!==Sl;)if(e=(t=Sl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,Sl=e;else for(;null!==Sl;){switch(a=(t=Sl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==a){e=void 0,n=t,i=a.memoizedProps,a=a.memoizedState,r=n.stateNode;try{var g=yo(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(g,a),r.__reactInternalSnapshotBeforeUpdate=e}catch(m){cc(n,n.return,m)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))gd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,Sl=e;break}Sl=t.return}}(e,t)}finally{nu=o,P.p=i,L.T=r}}Au=1,rc(),ic(),ac()}}function rc(){if(1===Au){Au=0;var e=ku,t=Tu,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=L.T,L.T=null;var r=P.p;P.p=2;var i=nu;nu|=4;try{Ll(t,e);var a=nd,s=er(e.containerInfo),o=a.focusedElem,l=a.selectionRange;if(s!==o&&o&&o.ownerDocument&&Zn(o.ownerDocument.documentElement,o)){if(null!==l&&tr(o)){var u=l.start,c=l.end;if(void 0===c&&(c=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(c,o.value.length);else{var d=o.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),p=o.textContent.length,g=Math.min(l.start,p),y=void 0===l.end?g:Math.min(l.end,p);!f.extend&&g>y&&(s=y,y=g,g=s);var m=Xn(o,g),_=Xn(o,y);if(m&&_&&(1!==f.rangeCount||f.anchorNode!==m.node||f.anchorOffset!==m.offset||f.focusNode!==_.node||f.focusOffset!==_.offset)){var v=d.createRange();v.setStart(m.node,m.offset),f.removeAllRanges(),g>y?(f.addRange(v),f.extend(_.node,_.offset)):(v.setEnd(_.node,_.offset),f.addRange(v))}}}}for(d=[],f=o;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var E=d[o];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}nh=!!td,nd=td=null}finally{nu=i,P.p=r,L.T=n}}e.current=t,Au=2}}function ic(){if(2===Au){Au=0;var e=ku,t=Tu,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=L.T,L.T=null;var r=P.p;P.p=2;var i=nu;nu|=4;try{Nl(e,t.alternate,t)}finally{nu=i,P.p=r,L.T=n}}Au=3}}function ac(){if(4===Au||3===Au){Au=0,ee();var e=ku,t=Tu,n=Iu,r=Uu;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Au=5:(Au=0,Tu=ku=null,sc(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Nu=null),we(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ce,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=L.T,i=P.p,P.p=2,L.T=null;try{for(var a=e.onRecoverableError,s=0;s<r.length;s++){var o=r[s];a(o.value,{componentStack:o.stack})}}finally{L.T=t,P.p=i}}0!==(3&Iu)&&oc(),Cc(e),i=e.pendingLanes,0!==(4194090&n)&&0!==(42&i)?e===Mu?Ru++:(Ru=0,Mu=e):Ru=0,Sc(0,!1)}}function sc(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Li(t)))}function oc(e){return rc(),ic(),ac(),lc()}function lc(){if(5!==Au)return!1;var e=ku,t=wu;wu=0;var n=we(Iu),r=L.T,i=P.p;try{P.p=32>n?32:n,L.T=null,n=Ou,Ou=null;var a=ku,o=Iu;if(Au=0,Tu=ku=null,Iu=0,0!==(6&nu))throw Error(s(331));var l=nu;if(nu|=4,$l(a.current),Bl(a,a.current,o,n),nu=l,Sc(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ce,a)}catch(u){}return!0}finally{P.p=i,L.T=r,sc(e,t)}}function uc(e,t,n){t=Nr(n,t),null!==(e=aa(e,t=So(e.stateNode,t,2),2))&&(Ae(e,2),Cc(e))}function cc(e,t,n){if(3===e.tag)uc(e,e,n);else for(;null!==t;){if(3===t.tag){uc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Nu||!Nu.has(r))){e=Nr(n,e),null!==(r=aa(t,n=No(2),2))&&(Ao(n,r,t,e),Ae(r,2),Cc(r));break}}t=t.return}}function dc(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tu;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(cu=!0,i.add(n),e=hc.bind(null,e,t,n),t.then(e,e))}function hc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ru===e&&(au&n)===n&&(4===hu||3===hu&&(62914560&au)===au&&300>te()-bu?0===(2&nu)&&Bu(e,0):gu|=n,mu===au&&(mu=0)),Cc(e)}function fc(e,t){0===t&&(t=Se()),null!==(e=Ur(e,t))&&(Ae(e,t),Cc(e))}function pc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),fc(e,n)}function gc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),fc(e,n)}var yc=null,mc=null,_c=!1,vc=!1,Ec=!1,bc=0;function Cc(e){e!==mc&&null===e.next&&(null===mc?yc=mc=e:mc=mc.next=e),vc=!0,_c||(_c=!0,dd((function(){0!==(6&nu)?$(re,Nc):Ac()})))}function Sc(e,t){if(!Ec&&vc){Ec=!0;do{for(var n=!1,r=yc;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var a=0;else{var s=r.suspendedLanes,o=r.pingedLanes;a=(1<<31-fe(42|e)+1)-1,a=201326741&(a&=i&~(s&~o))?201326741&a|1:a?2|a:0}0!==a&&(n=!0,Ic(r,a))}else a=au,0===(3&(a=ve(r,r===ru?a:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ee(r,a)||(n=!0,Ic(r,a));r=r.next}}while(n);Ec=!1}}function Nc(){Ac()}function Ac(){vc=_c=!1;var e=0;0!==bc&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==od&&(od=e,!0);return od=null,!1}()&&(e=bc),bc=0);for(var t=te(),n=null,r=yc;null!==r;){var i=r.next,a=kc(r,t);0===a?(r.next=null,null===n?yc=i:n.next=i,null===i&&(mc=n)):(n=r,(0!==e||0!==(3&a))&&(vc=!0)),r=i}Sc(e,!1)}function kc(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var s=31-fe(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=be(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}if(n=au,n=ve(e,e===(t=ru)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===su||9===su)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&X(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ee(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&X(r),we(n)){case 2:case 8:n=ie;break;case 32:default:n=ae;break;case 268435456:n=oe}return r=Tc.bind(null,e),n=$(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&X(r),e.callbackPriority=2,e.callbackNode=null,2}function Tc(e,t){if(0!==Au&&5!==Au)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(oc()&&e.callbackNode!==n)return null;var r=au;return 0===(r=ve(e,e===ru?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(xu(e,r,t),kc(e,te()),null!=e.callbackNode&&e.callbackNode===n?Tc.bind(null,e):null)}function Ic(e,t){if(oc())return null;xu(e,t,!0)}function wc(){return 0===bc&&(bc=Ce()),bc}function Oc(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:wt(""+e)}function Uc(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Rc=0;Rc<br.length;Rc++){var Mc=br[Rc];Cr(Mc.toLowerCase(),"on"+(Mc[0].toUpperCase()+Mc.slice(1)))}Cr(fr,"onAnimationEnd"),Cr(pr,"onAnimationIteration"),Cr(gr,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(yr,"onTransitionRun"),Cr(mr,"onTransitionStart"),Cr(_r,"onTransitionCancel"),Cr(vr,"onTransitionEnd"),We("onMouseEnter",["mouseout","mouseover"]),We("onMouseLeave",["mouseout","mouseover"]),We("onPointerEnter",["pointerout","pointerover"]),We("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pc=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lc));function Dc(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=u;try{a(i)}catch(c){mo(c)}i.currentTarget=null,a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=u;try{a(i)}catch(c){mo(c)}i.currentTarget=null,a=l}}}}function xc(e,t){var n=t[Pe];void 0===n&&(n=t[Pe]=new Set);var r=e+"__bubble";n.has(r)||(jc(t,e,2,!1),n.add(r))}function Fc(e,t,n){var r=0;t&&(r|=4),jc(n,e,r,t)}var Hc="_reactListening"+Math.random().toString(36).slice(2);function Gc(e){if(!e[Hc]){e[Hc]=!0,Ke.forEach((function(t){"selectionchange"!==t&&(Pc.has(t)||Fc(t,!1,e),Fc(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hc]||(t[Hc]=!0,Fc("selectionchange",!1,t))}}function jc(e,t,n,r){switch(uh(t)){case 2:var i=rh;break;case 8:i=ih;break;default:i=ah}n=i.bind(null,t,n,e),i=void 0,!Ht||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function zc(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i)break;if(4===s)for(s=r.return;null!==s;){var u=s.tag;if((3===u||4===u)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==o;){if(null===(s=je(o)))return;if(5===(u=s.tag)||6===u||26===u||27===u){r=a=s;continue e}o=o.parentNode}}r=r.return}Dt((function(){var r=a,i=Ut(n),s=[];e:{var o=Er.get(e);if(void 0!==o){var u=Zt,c=e;switch(e){case"keypress":if(0===qt(n))break e;case"keydown":case"keyup":u=gn;break;case"focusin":c="focus",u=sn;break;case"focusout":c="blur",u=sn;break;case"beforeblur":case"afterblur":u=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=mn;break;case fr:case pr:case gr:u=on;break;case vr:u=_n;break;case"scroll":case"scrollend":u=tn;break;case"wheel":u=vn;break;case"copy":case"cut":case"paste":u=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=yn;break;case"toggle":case"beforetoggle":u=En}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==o?o+"Capture":null:o;d=[];for(var p,g=r;null!==g;){var y=g;if(p=y.stateNode,5!==(y=y.tag)&&26!==y&&27!==y||null===p||null===f||null!=(y=xt(g,f))&&d.push(Bc(g,y,p)),h)break;g=g.return}0<d.length&&(o=new u(o,c,null,n,i),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Ot||!(c=n.relatedTarget||n.fromElement)||!je(c)&&!c[Le])&&(u||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?je(c):null)&&(h=l(c),d=c.tag,c!==h||5!==d&&27!==d&&6!==d)&&(c=null)):(u=null,c=r),u!==c)){if(d=rn,y="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=yn,y="onPointerLeave",f="onPointerEnter",g="pointer"),h=null==u?o:Be(u),p=null==c?o:Be(c),(o=new d(y,g+"leave",u,n,i)).target=h,o.relatedTarget=p,y=null,je(i)===r&&((d=new d(f,g+"enter",c,n,i)).target=p,d.relatedTarget=h,y=d),h=y,u&&c)e:{for(f=c,g=0,p=d=u;p;p=qc(p))g++;for(p=0,y=f;y;y=qc(y))p++;for(;0<g-p;)d=qc(d),g--;for(;0<p-g;)f=qc(f),p--;for(;g--;){if(d===f||null!==f&&d===f.alternate)break e;d=qc(d),f=qc(f)}d=null}else d=null;null!==u&&Kc(s,o,u,d,!1),null!==c&&null!==h&&Kc(s,h,c,d,!0)}if("select"===(u=(o=r?Be(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===u&&"file"===o.type)var m=Fn;else if(Rn(o))if(Hn)m=Yn;else{m=Kn;var _=qn}else!(u=o.nodeName)||"input"!==u.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&kt(r.elementType)&&(m=Fn):m=Qn;switch(m&&(m=m(e,r))?Mn(s,m,n,i):(_&&_(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&_t(o,"number",o.value)),_=r?Be(r):window,e){case"focusin":(Rn(_)||"true"===_.contentEditable)&&(rr=_,ir=r,ar=null);break;case"focusout":ar=ir=rr=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,or(s,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":or(s,n,i)}var v;if(Cn)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else On?In(e,n)&&(E="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(E="onCompositionStart");E&&(An&&"ko"!==n.locale&&(On||"onCompositionStart"!==E?"onCompositionEnd"===E&&On&&(v=Vt()):(zt="value"in(jt=i)?jt.value:jt.textContent,On=!0)),0<(_=Vc(r,E)).length&&(E=new un(E,e,null,n,i),s.push({event:E,listeners:_}),v?E.data=v:null!==(v=wn(n))&&(E.data=v))),(v=Nn?function(e,t){switch(e){case"compositionend":return wn(t);case"keypress":return 32!==t.which?null:(Tn=!0,kn);case"textInput":return(e=t.data)===kn&&Tn?null:e;default:return null}}(e,n):function(e,t){if(On)return"compositionend"===e||!Cn&&In(e,t)?(e=Vt(),Bt=zt=jt=null,On=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return An&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(E=Vc(r,"onBeforeInput")).length&&(_=new un("onBeforeInput","beforeinput",null,n,i),s.push({event:_,listeners:E}),_.data=v)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var a=Oc((i[Me]||null).action),s=r.submitter;s&&null!==(t=(t=s[Me]||null)?Oc(t.formAction):s.getAttribute("formAction"))&&(a=t,s=null);var o=new Zt("action","action",null,r,i);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==bc){var e=s?Uc(i,s):new FormData(i);Os(n,{pending:!0,data:e,method:i.method,action:a},null,e)}}else"function"===typeof a&&(o.preventDefault(),e=s?Uc(i,s):new FormData(i),Os(n,{pending:!0,data:e,method:i.method,action:a},a,e))},currentTarget:i}]})}}(s,e,r,n,i)}Dc(s,t)}))}function Bc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vc(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===a||(null!=(i=xt(e,n))&&r.unshift(Bc(e,i,a)),null!=(i=xt(e,t))&&r.push(Bc(e,i,a))),3===e.tag)return r;e=e.return}return[]}function qc(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Kc(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===u||(l=u,i?null!=(u=xt(n,a))&&s.unshift(Bc(n,u,l)):i||null!=(u=xt(n,a))&&s.push(Bc(n,u,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qc=/\r\n?/g,Yc=/\u0000|\uFFFD/g;function Wc(e){return("string"===typeof e?e:""+e).replace(Qc,"\n").replace(Yc,"")}function Jc(e,t){return t=Wc(t),Wc(e)===t}function $c(){}function Xc(e,t,n,r,i,a){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Ct(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Ct(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":At(e,r,a);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=wt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof a&&("formAction"===n?("input"!==t&&Xc(e,t,"name",i.name,i,null),Xc(e,t,"formEncType",i.formEncType,i,null),Xc(e,t,"formMethod",i.formMethod,i,null),Xc(e,t,"formTarget",i.formTarget,i,null)):(Xc(e,t,"encType",i.encType,i,null),Xc(e,t,"method",i.method,i,null),Xc(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=wt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=$c);break;case"onScroll":null!=r&&xc("scroll",e);break;case"onScrollEnd":null!=r&&xc("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=wt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":xc("beforetoggle",e),xc("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Tt.get(n)||n,r)}}function Zc(e,t,n,r,i,a){switch(n){case"style":At(e,r,a);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Ct(e,r):("number"===typeof r||"bigint"===typeof r)&&Ct(e,""+r);break;case"onScroll":null!=r&&xc("scroll",e);break;case"onScrollEnd":null!=r&&xc("scrollend",e);break;case"onClick":null!=r&&(e.onclick=$c);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Qe.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(a=null!=(a=e[Me]||null)?a[n]:null)&&e.removeEventListener(t,a,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof a&&null!==a&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xc("error",e),xc("load",e);var r,i=!1,a=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":i=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Xc(e,t,r,o,n,null)}}return a&&Xc(e,t,"srcSet",n.srcSet,n,null),void(i&&Xc(e,t,"src",n.src,n,null));case"input":xc("invalid",e);var l=r=o=a=null,u=null,c=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":a=d;break;case"type":o=d;break;case"checked":u=d;break;case"defaultChecked":c=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:Xc(e,t,i,d,n,null)}}return mt(e,r,l,u,c,o,a,!1),void dt(e);case"select":for(a in xc("invalid",e),i=o=r=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":i=l;default:Xc(e,t,a,l,n,null)}return t=r,n=o,e.multiple=!!i,void(null!=t?vt(e,!!i,t,!1):null!=n&&vt(e,!!i,n,!0));case"textarea":for(o in xc("invalid",e),r=a=i=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":i=l;break;case"defaultValue":a=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Xc(e,t,o,l,n,null)}return bt(e,i,a,r),void dt(e);case"option":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))if("selected"===u)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Xc(e,t,u,i,n,null);return;case"dialog":xc("beforetoggle",e),xc("toggle",e),xc("cancel",e),xc("close",e);break;case"iframe":case"object":xc("load",e);break;case"video":case"audio":for(i=0;i<Lc.length;i++)xc(Lc[i],e);break;case"image":xc("error",e),xc("load",e);break;case"details":xc("toggle",e);break;case"embed":case"source":case"link":xc("error",e),xc("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Xc(e,t,c,i,n,null)}return;default:if(kt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&Zc(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Xc(e,t,l,i,n,null))}var td=null,nd=null;function rd(e){return 9===e.nodeType?e:e.ownerDocument}function id(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ad(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function sd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var od=null;var ld="function"===typeof setTimeout?setTimeout:void 0,ud="function"===typeof clearTimeout?clearTimeout:void 0,cd="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof cd?function(e){return cd.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout((function(){throw e}))}function fd(e){return"head"===e}function pd(e,t){var n=t,r=0,i=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&bd(s.documentElement),2&n&&bd(s.body),4&n)for(bd(n=s.head),s=n.firstChild;s;){var o=s.nextSibling,l=s.nodeName;s[He]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=o}}if(0===i)return e.removeChild(a),void Th(t);i--}else"$"===n||"$?"===n||"$!"===n?i++:r=n.charCodeAt(0)-48;else r=0;n=a}while(n);Th(t)}function gd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":gd(n),Ge(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function yd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function md(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var _d=null;function vd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Ed(e,t,n){switch(t=rd(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function bd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ge(e)}var Cd=new Map,Sd=new Set;function Nd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Ad=P.d;P.d={f:function(){var e=Ad.f(),t=ju();return e||t},r:function(e){var t=ze(e);null!==t&&5===t.tag&&"form"===t.type?Rs(t):Ad.r(e)},D:function(e){Ad.D(e),Td("dns-prefetch",e,null)},C:function(e,t){Ad.C(e,t),Td("preconnect",e,t)},L:function(e,t,n){Ad.L(e,t,n);var r=kd;if(r&&e&&t){var i='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+gt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+gt(n.imageSizes)+'"]')):i+='[href="'+gt(e)+'"]';var a=i;switch(t){case"style":a=wd(e);break;case"script":a=Rd(e)}Cd.has(a)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Cd.set(a,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Od(a))||"script"===t&&r.querySelector(Md(a))||(ed(t=r.createElement("link"),"link",e),qe(t),r.head.appendChild(t)))}},m:function(e,t){Ad.m(e,t);var n=kd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+gt(r)+'"][href="'+gt(e)+'"]',a=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Rd(e)}if(!Cd.has(a)&&(e=h({rel:"modulepreload",href:e},t),Cd.set(a,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Md(a)))return}ed(r=n.createElement("link"),"link",e),qe(r),n.head.appendChild(r)}}},X:function(e,t){Ad.X(e,t);var n=kd;if(n&&e){var r=Ve(n).hoistableScripts,i=Rd(e),a=r.get(i);a||((a=n.querySelector(Md(i)))||(e=h({src:e,async:!0},t),(t=Cd.get(i))&&xd(e,t),qe(a=n.createElement("script")),ed(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}},S:function(e,t,n){Ad.S(e,t,n);var r=kd;if(r&&e){var i=Ve(r).hoistableStyles,a=wd(e);t=t||"default";var s=i.get(a);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(Od(a)))o.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Cd.get(a))&&Dd(e,n);var l=s=r.createElement("link");qe(l),ed(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){o.loading|=1})),l.addEventListener("error",(function(){o.loading|=2})),o.loading|=4,Pd(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:o},i.set(a,s)}}},M:function(e,t){Ad.M(e,t);var n=kd;if(n&&e){var r=Ve(n).hoistableScripts,i=Rd(e),a=r.get(i);a||((a=n.querySelector(Md(i)))||(e=h({src:e,async:!0,type:"module"},t),(t=Cd.get(i))&&xd(e,t),qe(a=n.createElement("script")),ed(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}}};var kd="undefined"===typeof document?null:document;function Td(e,t,n){var r=kd;if(r&&"string"===typeof t&&t){var i=gt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),Sd.has(i)||(Sd.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(ed(t=r.createElement("link"),"link",e),qe(t),r.head.appendChild(t)))}}function Id(e,t,n,r){var i,a,o,l,u=(u=V.current)?Nd(u):null;if(!u)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=wd(n.href),(r=(n=Ve(u).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=wd(n.href);var c=Ve(u).hoistableStyles,d=c.get(e);if(d||(u=u.ownerDocument||u,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=u.querySelector(Od(e)))&&!c._p&&(d.instance=c,d.state.loading=5),Cd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Cd.set(e,n),c||(i=u,a=e,o=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=i.createElement("link"),l.preload=a,a.addEventListener("load",(function(){return l.loading|=1})),a.addEventListener("error",(function(){return l.loading|=2})),ed(a,"link",o),qe(a),i.head.appendChild(a))))),t&&null===r)throw Error(s(528,""));return d}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Rd(n),(r=(n=Ve(u).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function wd(e){return'href="'+gt(e)+'"'}function Od(e){return'link[rel="stylesheet"]['+e+"]"}function Ud(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Rd(e){return'[src="'+gt(e)+'"]'}function Md(e){return"script[async]"+e}function Ld(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+gt(n.href)+'"]');if(r)return t.instance=r,qe(r),r;var i=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return qe(r=(e.ownerDocument||e).createElement("style")),ed(r,"style",i),Pd(r,n.precedence,e),t.instance=r;case"stylesheet":i=wd(n.href);var a=e.querySelector(Od(i));if(a)return t.state.loading|=4,t.instance=a,qe(a),a;r=Ud(n),(i=Cd.get(i))&&Dd(r,i),qe(a=(e.ownerDocument||e).createElement("link"));var o=a;return o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),ed(a,"link",r),t.state.loading|=4,Pd(a,n.precedence,e),t.instance=a;case"script":return a=Rd(n.src),(i=e.querySelector(Md(a)))?(t.instance=i,qe(i),i):(r=n,(i=Cd.get(a))&&xd(r=h({},n),i),qe(i=(e=e.ownerDocument||e).createElement("script")),ed(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Pd(r,n.precedence,e));return t.instance}function Pd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,a=i,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===t)a=o;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Dd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function xd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Fd=null;function Hd(e,t,n){if(null===Fd){var r=new Map,i=Fd=new Map;i.set(n,r)}else(r=(i=Fd).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var a=n[i];if(!(a[He]||a[Re]||"link"===e&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var s=a.getAttribute(t)||"";s=e+s;var o=r.get(s);o?o.push(a):r.set(s,[a])}}return r}function Gd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function jd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var zd=null;function Bd(){}function Vd(){if(this.count--,0===this.count)if(this.stylesheets)Kd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var qd=null;function Kd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,qd=new Map,t.forEach(Qd,e),qd=null,Vd.call(e))}function Qd(e,t){if(!(4&t.state.loading)){var n=qd.get(e);if(n)var r=n.get(null);else{n=new Map,qd.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var s=i[a];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(a=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=Vd.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),a?a.parentNode.insertBefore(i,a.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Yd={$$typeof:b,Provider:null,Consumer:null,_currentValue:D,_currentValue2:D,_threadCount:0};function Wd(e,t,n,r,i,a,s,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ne(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ne(0),this.hiddenUpdates=Ne(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Jd(e,t,n,r,i,a,s,o,l,u,c,d){return e=new Wd(e,t,n,s,o,l,u,d),t=1,!0===a&&(t|=24),a=Dr(3,null,null,t),e.current=a,a.stateNode=e,(t=Mi()).refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:r,isDehydrated:n,cache:t},na(a),e}function $d(e){return e?e=Lr:Lr}function Xd(e,t,n,r,i,a){i=$d(i),null===r.context?r.context=i:r.pendingContext=i,(r=ia(t)).payload={element:n},null!==(a=void 0===a?null:a)&&(r.callback=a),null!==(n=aa(e,r,t))&&(Du(n,0,t),sa(n,e,t))}function Zd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Zd(e,t),(e=e.alternate)&&Zd(e,t)}function th(e){if(13===e.tag){var t=Ur(e,67108864);null!==t&&Du(t,0,67108864),eh(e,67108864)}}var nh=!0;function rh(e,t,n,r){var i=L.T;L.T=null;var a=P.p;try{P.p=2,ah(e,t,n,r)}finally{P.p=a,L.T=i}}function ih(e,t,n,r){var i=L.T;L.T=null;var a=P.p;try{P.p=8,ah(e,t,n,r)}finally{P.p=a,L.T=i}}function ah(e,t,n,r){if(nh){var i=sh(r);if(null===i)zc(e,t,r,oh,n),_h(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return dh=vh(dh,e,t,n,r,i),!0;case"dragenter":return hh=vh(hh,e,t,n,r,i),!0;case"mouseover":return fh=vh(fh,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return ph.set(a,vh(ph.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,gh.set(a,vh(gh.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(_h(e,r),4&t&&-1<mh.indexOf(e)){for(;null!==i;){var a=ze(i);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var s=_e(a.pendingLanes);if(0!==s){var o=a;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-fe(s);o.entanglements[1]|=l,s&=~l}Cc(a),0===(6&nu)&&(Cu=te()+500,Sc(0,!1))}}break;case 13:null!==(o=Ur(a,2))&&Du(o,0,2),ju(),eh(a,2)}if(null===(a=sh(r))&&zc(e,t,r,oh,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else zc(e,t,r,null,n)}}function sh(e){return lh(e=Ut(e))}var oh=null;function lh(e){if(oh=null,null!==(e=je(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return oh=e,null}function uh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ie:return 8;case ae:case se:return 32;case oe:return 268435456;default:return 32}default:return 32}}var ch=!1,dh=null,hh=null,fh=null,ph=new Map,gh=new Map,yh=[],mh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _h(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":fh=null;break;case"pointerover":case"pointerout":ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gh.delete(t.pointerId)}}function vh(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=ze(t))&&th(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Eh(e){var t=je(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=u(n)))return e.blockedOn=t,void function(e,t){var n=P.p;try{return P.p=e,t()}finally{P.p=n}}(e.priority,(function(){if(13===n.tag){var e=Lu();e=Ie(e);var t=Ur(n,e);null!==t&&Du(t,0,e),eh(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function bh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=sh(e.nativeEvent);if(null!==n)return null!==(t=ze(n))&&th(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ot=r,n.target.dispatchEvent(r),Ot=null,t.shift()}return!0}function Ch(e,t,n){bh(e)&&n.delete(t)}function Sh(){ch=!1,null!==dh&&bh(dh)&&(dh=null),null!==hh&&bh(hh)&&(hh=null),null!==fh&&bh(fh)&&(fh=null),ph.forEach(Ch),gh.forEach(Ch)}function Nh(e,t){e.blockedOn===t&&(e.blockedOn=null,ch||(ch=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Sh)))}var Ah=null;function kh(e){Ah!==e&&(Ah=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){Ah===e&&(Ah=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===lh(r||n))continue;break}var a=ze(n);null!==a&&(e.splice(t,3),t-=3,Os(a,{pending:!0,data:i,method:n.method,action:r},r,i))}})))}function Th(e){function t(t){return Nh(t,e)}null!==dh&&Nh(dh,e),null!==hh&&Nh(hh,e),null!==fh&&Nh(fh,e),ph.forEach(t),gh.forEach(t);for(var n=0;n<yh.length;n++){var r=yh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<yh.length&&null===(n=yh[0]).blockedOn;)Eh(n),null===n.blockedOn&&yh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],a=n[r+1],s=i[Me]||null;if("function"===typeof a)s||kh(n);else if(s){var o=null;if(a&&a.hasAttribute("formAction")){if(i=a,s=a[Me]||null)o=s.formAction;else if(null!==lh(i))continue}else o=s.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),kh(n)}}}function Ih(e){this._internalRoot=e}function wh(e){this._internalRoot=e}wh.prototype.render=Ih.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Xd(t.current,Lu(),e,t,null,null)},wh.prototype.unmount=Ih.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Xd(e.current,2,null,e,null,null),ju(),t[Le]=null}},wh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Oe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yh.length&&0!==t&&t<yh[n].priority;n++);yh.splice(n,0,e),0===n&&Eh(e)}};var Oh=i.version;if("19.1.0"!==Oh)throw Error(s(527,Oh,"19.1.0"));P.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return c(i),e;if(a===r)return c(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=a;break}if(u===r){o=!0,r=i,n=a;break}u=u.sibling}if(!o){for(u=a.child;u;){if(u===n){o=!0,n=a,r=i;break}if(u===r){o=!0,r=a,n=i;break}u=u.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Uh={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rh.isDisabled&&Rh.supportsFiber)try{ce=Rh.inject(Uh),de=Rh}catch(Lh){}}t.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,r="",i=_o,a=vo,l=Eo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Jd(e,1,!1,null,0,n,r,i,a,l,0,null),e[Le]=t.current,Gc(e),new Ih(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var r=!1,i="",a=_o,l=vo,u=Eo,c=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(a=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(u=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(c=n.formState)),(t=Jd(e,1,!0,t,0,r,i,a,l,u,0,c)).context=$d(null),n=t.current,(i=ia(r=Ie(r=Lu()))).callback=null,aa(n,i,r),n=r,t.current.lanes=n,Ae(t,n),Cc(t),e[Le]=t.current,Gc(e),new wh(t)},t.version="19.1.0"},24:(e,t,n)=>{"use strict";var r=n(267),i=n(989);e.exports=function(e,t,n){var a=this||i;return r.forEach(n,(function(n){e=n.call(a,e,t)})),e}},43:(e,t,n)=>{"use strict";e.exports=n(288)},55:e=>{e.exports=null},101:(e,t,n)=>{"use strict";var r=n(267),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,a,s={};return e?(r.forEach(e.split("\n"),(function(e){if(a=e.indexOf(":"),t=r.trim(e.substr(0,a)).toLowerCase(),n=r.trim(e.substr(a+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},104:e=>{e.exports={version:"0.27.2"}},121:(e,t,n)=>{"use strict";var r=n(267);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},125:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},198:e=>{"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},229:(e,t,n)=>{"use strict";var r=n(702);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new r("Request failed with status code "+n.status,[r.ERR_BAD_REQUEST,r.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}},267:(e,t,n)=>{"use strict";var r,i=n(973),a=Object.prototype.toString,s=(r=Object.create(null),function(e){var t=a.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())});function o(e){return e=e.toLowerCase(),function(t){return s(t)===e}}function l(e){return Array.isArray(e)}function u(e){return"undefined"===typeof e}var c=o("ArrayBuffer");function d(e){return null!==e&&"object"===typeof e}function h(e){if("object"!==s(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var f=o("Date"),p=o("File"),g=o("Blob"),y=o("FileList");function m(e){return"[object Function]"===a.call(e)}var _=o("URLSearchParams");function v(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),l(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var E,b=(E="undefined"!==typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(e){return E&&e instanceof E});e.exports={isArray:l,isArrayBuffer:c,isBuffer:function(e){return null!==e&&!u(e)&&null!==e.constructor&&!u(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){var t="[object FormData]";return e&&("function"===typeof FormData&&e instanceof FormData||a.call(e)===t||m(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&c(e.buffer)},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:d,isPlainObject:h,isUndefined:u,isDate:f,isFile:p,isBlob:g,isFunction:m,isStream:function(e){return d(e)&&m(e.pipe)},isURLSearchParams:_,isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:v,merge:function e(){var t={};function n(n,r){h(t[r])&&h(n)?t[r]=e(t[r],n):h(n)?t[r]=e({},n):l(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)v(arguments[r],n);return t},extend:function(e,t,n){return v(t,(function(t,r){e[r]=n&&"function"===typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n){var r,i,a,s={};t=t||{};do{for(i=(r=Object.getOwnPropertyNames(e)).length;i-- >0;)s[a=r[i]]||(t[a]=e[a],s[a]=!0);e=Object.getPrototypeOf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:s,kindOfTest:o,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;var t=e.length;if(u(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},isTypedArray:b,isFileList:y}},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function m(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function _(){}function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=m.prototype;var E=v.prototype=new _;E.constructor=v,g(E,m.prototype),E.isPureReactComponent=!0;var b=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function N(e,t,r,i,a,s){return r=s.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:s}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(){}function w(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,u,c=!1;if(null===e)c=!0;else switch(o){case"bigint":case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0;break;case h:return w((c=e._init)(e._payload),t,i,a,s)}}if(c)return s=s(e),c=""===a?"."+T(e,0):a,b(s)?(i="",null!=c&&(i=c.replace(k,"$&/")+"/"),w(s,t,i,"",(function(e){return e}))):null!=s&&(A(s)&&(l=s,u=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+c,s=N(l.type,u,void 0,0,0,l.props)),t.push(s)),1;c=0;var d,p=""===a?".":a+":";if(b(e))for(var g=0;g<e.length;g++)c+=w(a=e[g],t,i,o=p+T(a,g),s);else if("function"===typeof(g=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=g.call(e),g=0;!(a=e.next()).done;)c+=w(a=a.value,t,i,o=p+T(a,g++),s);else if("object"===o){if("function"===typeof e.then)return w(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(I,I):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,a,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return c}function O(e,t,n){if(null==e)return e;var r=[],i=0;return w(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function U(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function M(){}t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=s,t.PureComponent=v,t.StrictMode=a,t.Suspense=c,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return C.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(a in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!S.call(t,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===t.ref||(r[a]=t[a]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var s=Array(a),o=0;o<a;o++)s[o]=arguments[o+2];r.children=s}return N(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,i={},a=null;if(null!=t)for(r in void 0!==t.key&&(a=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];i.children=o}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return N(e,a,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:U}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.T,n={};C.T=n;try{var r=e(),i=C.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(M,R)}catch(a){R(a)}finally{C.T=t}},t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},t.use=function(e){return C.H.use(e)},t.useActionState=function(e,t,n){return C.H.useActionState(e,t,n)},t.useCallback=function(e,t){return C.H.useCallback(e,t)},t.useContext=function(e){return C.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return C.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=C.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return C.H.useId()},t.useImperativeHandle=function(e,t,n){return C.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return C.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return C.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return C.H.useMemo(e,t)},t.useOptimistic=function(e,t){return C.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return C.H.useReducer(e,t,n)},t.useRef=function(e){return C.H.useRef(e)},t.useState=function(e){return C.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return C.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return C.H.useTransition()},t.version="19.1.0"},289:(e,t,n)=>{"use strict";var r=n(267);e.exports=function(e,t){t=t||new FormData;var n=[];function i(e){return null===e?"":r.isDate(e)?e.toISOString():r.isArrayBuffer(e)||r.isTypedArray(e)?"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}return function e(a,s){if(r.isPlainObject(a)||r.isArray(a)){if(-1!==n.indexOf(a))throw Error("Circular reference detected in "+s);n.push(a),r.forEach(a,(function(n,a){if(!r.isUndefined(n)){var o,l=s?s+"."+a:a;if(n&&!s&&"object"===typeof n)if(r.endsWith(a,"{}"))n=JSON.stringify(n);else if(r.endsWith(a,"[]")&&(o=r.toArray(n)))return void o.forEach((function(e){!r.isUndefined(e)&&t.append(l,i(e))}));e(n,l)}})),n.pop()}else t.append(s,i(a))}(e),t}},291:(e,t,n)=>{"use strict";var r=n(267),i=n(973),a=n(938),s=n(438);var o=function e(t){var n=new a(t),o=i(a.prototype.request,n);return r.extend(o,a.prototype,n),r.extend(o,n),o.create=function(n){return e(s(t,n))},o}(n(989));o.Axios=a,o.CanceledError=n(482),o.CancelToken=n(690),o.isCancel=n(767),o.VERSION=n(104).version,o.toFormData=n(289),o.AxiosError=n(702),o.Cancel=o.CanceledError,o.all=function(e){return Promise.all(e)},o.spread=n(125),o.isAxiosError=n(738),e.exports=o,e.exports.default=o},335:e=>{"use strict";e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},370:(e,t,n)=>{"use strict";var r=n(267),i=n(229),a=n(903),s=n(735),o=n(638),l=n(101),u=n(705),c=n(335),d=n(702),h=n(482),f=n(403);e.exports=function(e){return new Promise((function(t,n){var p,g=e.data,y=e.headers,m=e.responseType;function _(){e.cancelToken&&e.cancelToken.unsubscribe(p),e.signal&&e.signal.removeEventListener("abort",p)}r.isFormData(g)&&r.isStandardBrowserEnv()&&delete y["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var E=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";y.Authorization="Basic "+btoa(E+":"+b)}var C=o(e.baseURL,e.url);function S(){if(v){var r="getAllResponseHeaders"in v?l(v.getAllResponseHeaders()):null,a={data:m&&"text"!==m&&"json"!==m?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:e,request:v};i((function(e){t(e),_()}),(function(e){n(e),_()}),a),v=null}}if(v.open(e.method.toUpperCase(),s(C,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=S:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(S)},v.onabort=function(){v&&(n(new d("Request aborted",d.ECONNABORTED,e,v)),v=null)},v.onerror=function(){n(new d("Network Error",d.ERR_NETWORK,e,v,v)),v=null},v.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||c;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new d(t,r.clarifyTimeoutError?d.ETIMEDOUT:d.ECONNABORTED,e,v)),v=null},r.isStandardBrowserEnv()){var N=(e.withCredentials||u(C))&&e.xsrfCookieName?a.read(e.xsrfCookieName):void 0;N&&(y[e.xsrfHeaderName]=N)}"setRequestHeader"in v&&r.forEach(y,(function(e,t){"undefined"===typeof g&&"content-type"===t.toLowerCase()?delete y[t]:v.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),m&&"json"!==m&&(v.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(p=function(e){v&&(n(!e||e&&e.type?new h:e),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(p),e.signal&&(e.signal.aborted?p():e.signal.addEventListener("abort",p))),g||(g=null);var A=f(C);A&&-1===["http","https","file"].indexOf(A)?n(new d("Unsupported protocol "+A+":",d.ERR_BAD_REQUEST,e)):v.send(g)}))}},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},395:(e,t,n)=>{"use strict";var r=n(267),i=n(24),a=n(767),s=n(989),o=n(482);function l(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new o}e.exports=function(e){return l(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return l(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(l(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},403:e=>{"use strict";e.exports=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}},438:(e,t,n)=>{"use strict";var r=n(267);e.exports=function(e,t){t=t||{};var n={};function i(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function a(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(e[n],t[n])}function s(e){if(!r.isUndefined(t[e]))return i(void 0,t[e])}function o(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(void 0,t[n])}function l(n){return n in t?i(e[n],t[n]):n in e?i(void 0,e[n]):void 0}var u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||a,i=t(e);r.isUndefined(i)&&t!==l||(n[e]=i)})),n}},478:(e,t,n)=>{"use strict";var r=n(104).version,i=n(702),a={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){a[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var s={};a.transitional=function(e,t,n){function a(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,o){if(!1===e)throw new i(a(r," has been removed"+(t?" in "+t:"")),i.ERR_DEPRECATED);return t&&!s[r]&&(s[r]=!0,console.warn(a(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,o)}},e.exports={assertOptions:function(e,t,n){if("object"!==typeof e)throw new i("options must be an object",i.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),a=r.length;a-- >0;){var s=r[a],o=t[s];if(o){var l=e[s],u=void 0===l||o(l,s,e);if(!0!==u)throw new i("option "+s+" must be "+u,i.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new i("Unknown option "+s,i.ERR_BAD_OPTION)}},validators:a}},482:(e,t,n)=>{"use strict";var r=n(702);function i(e){r.call(this,null==e?"canceled":e,r.ERR_CANCELED),this.name="CanceledError"}n(267).inherits(i,r,{__CANCEL__:!0}),e.exports=i},523:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},579:(e,t,n)=>{"use strict";e.exports=n(799)},638:(e,t,n)=>{"use strict";var r=n(762),i=n(523);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},664:(e,t,n)=>{"use strict";var r=n(267);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},672:(e,t,n)=>{"use strict";var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(i(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=u(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,a="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:a}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:a,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=u(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=u(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=u(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},690:(e,t,n)=>{"use strict";var r=n(482);function i(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},702:(e,t,n)=>{"use strict";var r=n(267);function i(e,t,n,r,i){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}r.inherits(i,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var a=i.prototype,s={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(e){s[e]={value:e}})),Object.defineProperties(i,s),Object.defineProperty(a,"isAxiosError",{value:!0}),i.from=function(e,t,n,s,o,l){var u=Object.create(a);return r.toFlatObject(e,u,(function(e){return e!==Error.prototype})),i.call(u,e.message,t,n,s,o),u.name=e.name,l&&Object.assign(u,l),u},e.exports=i},705:(e,t,n)=>{"use strict";var r=n(267);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},735:(e,t,n)=>{"use strict";var r=n(267);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var a;if(n)a=n(t);else if(r.isURLSearchParams(t))a=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),a=s.join("&")}if(a){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}},738:(e,t,n)=>{"use strict";var r=n(267);e.exports=function(e){return r.isObject(e)&&!0===e.isAxiosError}},762:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},767:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},778:e=>{e.exports="object"==typeof self?self.FormData:window.FormData},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var a in r={},t)"key"!==a&&(r[a]=t[a]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},818:function(e,t,n){e.exports=function(e,t,r){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=i(e),s=i(t),o=i(r);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=b(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},C.apply(this,arguments)}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return a}}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=A(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}var I=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return"3.1.33"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}(),w={},O=function(){function e(e){this._container=e}return e.create=function(t,n){return w[t]=new e(n),w[t]},e.get=function(e){return e||(e=Pi.getInstance()._iid),w[e]},Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this._container[e]},e.prototype.set=function(e,t){this._container[e]=t},e.prototype.remove=function(e){this._container.hasOwnProperty(e)&&delete this._container[e]},e}(),U=function(e,t){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},U(e,t)};function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var M=function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},M.apply(this,arguments)};function L(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}function P(e,t){var n,r,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function D(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var x,F=function(e){function t(n,r){var i=e.call(this,r)||this;return i.name="SendBirdException",i.code=r||0,i.message=n,Object.setPrototypeOf(i,t.prototype),i}return R(t,e),Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===t.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===t.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===t.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenRevokedError",{get:function(){return this.code===t.SESSION_TOKEN_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVALID_TOKEN",{get:function(){return 400111},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_KEY_EXPIRED",{get:function(){return 400309},enumerable:!1,configurable:!0}),Object.defineProperty(t,"USER_DEACTIVATED",{get:function(){return 400300},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NON_EXISTING_USER",{get:function(){return 400301},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_TOKEN_EXPIRED",{get:function(){return 400302},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_TOKEN_REVOKED",{get:function(){return 400310},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVALID_INITIALIZATION",{get:function(){return 800100},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CONNECTION_REQUIRED",{get:function(){return 800101},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CONNECTION_CANCELED",{get:function(){return 800102},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVALID_PARAMETER",{get:function(){return 800110},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NETWORK_ERROR",{get:function(){return 800120},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NETWORK_ROUTING_ERROR",{get:function(){return 800121},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MALFORMED_DATA",{get:function(){return 800130},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MALFORMED_ERROR_DATA",{get:function(){return 800140},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WRONG_CHANNEL_TYPE",{get:function(){return 800150},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MARK_AS_READ_RATE_LIMIT_EXCEEDED",{get:function(){return 800160},enumerable:!1,configurable:!0}),Object.defineProperty(t,"QUERY_IN_PROGRESS",{get:function(){return 800170},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ACK_TIMEOUT",{get:function(){return 800180},enumerable:!1,configurable:!0}),Object.defineProperty(t,"LOGIN_TIMEOUT",{get:function(){return 800190},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WEBSOCKET_CONNECTION_CLOSED",{get:function(){return 800200},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WEBSOCKET_CONNECTION_FAILED",{get:function(){return 800210},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_FAILED",{get:function(){return 800220},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILE_UPLOAD_CANCEL_FAILED",{get:function(){return 800230},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_CANCELED",{get:function(){return 800240},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_DUPLICATED",{get:function(){return 800250},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILE_SIZE_LIMIT_EXCEEDED",{get:function(){return 800260},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_TOKEN_REQUEST_FAILED",{get:function(){return 800500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_REFRESH_SUCCESS",{get:function(){return 800501},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_REFRESH_FAILED",{get:function(){return 800502},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANNEL_NOT_FOUND",{get:function(){return 900500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"USER_NOT_MEMBER",{get:function(){return 900020},enumerable:!1,configurable:!0}),t}(Error),H=function(){function e(){this.sessionToken=null,this.sessionKey=null,this.eKey=null}return e.prototype.hasSession=function(){return!!this.sessionKey},e}(),G={},j=function(){function e(e,t){void 0===t&&(t={});var n=this;this._iid=e,Object.keys(t).forEach((function(e){var r=t[e];"function"==typeof r&&(n[e]=n.getClonedClass(r))})),G[e]=this}return e.get=function(e){return e?G[e]:{}},e.prototype.getClonedClass=function(e){var t=this._iid,n=function(n){function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(this,e)||this}return R(r,n),Object.defineProperty(r,"_iid",{get:function(){return t},enumerable:!1,configurable:!0}),Object.defineProperty(r,"_name",{get:function(){return e.name},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_iid",{get:function(){return t},enumerable:!1,configurable:!0}),r}(e);return n},e}(),z={verbose:"VERBOSE",info:"INFO",debug:"DEBUG",warn:"WARN",error:"ERROR",none:"NONE"},B=function(e){g(n,e);var t=E(n);function n(){return d(this,n),t.apply(this,arguments)}return f(n,[{key:"log",value:function(e){for(var t,n,r,i,a,s=this.getLogLevelText(e);s.length<8;)s+=" ";for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];switch(l.unshift("[".concat(s,"]")),e){case"verbose":(t=console).log.apply(t,l);break;case"debug":(n=console).log.apply(n,l);break;case"info":(r=console).info.apply(r,l);break;case"warn":(i=console).warn.apply(i,l);break;case"error":(a=console).error.apply(a,l)}}},{key:"groupStart",value:function(){var e;(e=console).group.apply(e,arguments)}},{key:"groupEnd",value:function(){var e;(e=console).groupEnd.apply(e,arguments)}}]),n}(function(){function e(){d(this,e)}return f(e,[{key:"getLogLevelText",value:function(e){return z[e]}}]),e}()),V={DEBUG:"debug",PRODUCTION:"production"},q=V.PRODUCTION,K={VERBOSE:"verbose",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error",NONE:"none"},Q=[K.NONE,K.ERROR,K.WARN,K.INFO,K.DEBUG,K.VERBOSE],Y=K.WARN,W=Q.indexOf(Y),J=[new B],$=function(){function e(){d(this,e)}return f(e,null,[{key:"Mode",get:function(){return V}},{key:"mode",get:function(){return q},set:function(t){Object.keys(e.Mode).map((function(t){return e.Mode[t]})).indexOf(t)>-1&&(q=t)}},{key:"supportedLogLevels",get:function(){return K}},{key:"logLevel",get:function(){return Q[W]},set:function(e){Q.includes(e)||(e=Y),W=Q.indexOf(e)}},{key:"defaultLogLevel",get:function(){return Y}},{key:"isDisplayableLogLevel",value:function(e){var t=Q.indexOf(e);return 0<=t&&t<=W}},{key:"log",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.isDisplayableLogLevel(t)&&J.forEach((function(e){return e.log.apply(e,[t].concat(r))}))}},{key:"verbose",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[K.VERBOSE].concat(n))}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[K.DEBUG].concat(n))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[K.INFO].concat(n))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[K.WARN].concat(n))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[K.ERROR].concat(n))}},{key:"group",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=[];Array.isArray(n[n.length-1])&&(i=n.pop()),i.some((function(t){return e.isDisplayableLogLevel(t.level)}))&&J.filter((function(e){return e instanceof B})).forEach((function(e){e.groupStart.apply(e,n),i.forEach((function(t){return e.log.apply(e,[t.level].concat(N(t.messages)))})),e.groupEnd()}))}}]),e}(),X=function(){function e(){d(this,e),this._queue=[],this.locked=!1}return f(e,[{key:"lock",value:function(e){var t=this;this.locked?this._queue.push(e):(this.locked=!0,e((function(){return t.unlock()})))}},{key:"unlock",value:function(){if(this.locked=!1,this._queue.length>0){var e=this._queue.shift();this.lock(e)}}}]),e}(),Z=function(){function e(t){d(this,e),this.sb=t,this.mutex=new X,this.pingTimer=null,this.pingTimeoutTimer=null}return f(e,[{key:"ping",value:function(){var e=this,t=j.get(this.sb._iid).Command.bPing(),n=O.get(this.sb._iid).container,r=n.wsAdapter,i=n.pongTimeout;r.client.send(t),$.debug("`PING`"),this.pingTimeoutTimer=setTimeout((function(){$.debug("`PING` timeout."),e.stop(),r.client.handler&&r.client.handler.onError()}),i)}},{key:"pong",value:function(){this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null)}},{key:"refreshTimer",value:function(){var e=this,t=O.get(this.sb._iid).container.pingInterval;this.mutex.lock((function(n){e.stop(),e.pingTimer=setInterval((function(){e.ping()}),t),n()}))}},{key:"start",value:function(){this.refreshTimer(),this.ping()}},{key:"stop",value:function(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null),this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null)}}]),e}(),ee=function(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product},te=function(){return"undefined"==typeof window&&"undefined"!=typeof process&&("node"===process.title||void 0!==process.versions&&process.versions.node||"[object process]"===String(process))};!function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url"}(x||(x={}));var ne=function(){function e(){}var t;return e.isFileLikeObject=function(e){return"object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type},t=e,e.convertFileToDataUrl=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){return t(r.result)},r.onerror=function(e){return n(r.error)},r.readAsDataURL(e)}))},e.convertFileToArrayBuffer=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){return t(r.result)},r.onerror=function(e){return n(r.error)},r.readAsArrayBuffer(e)}))},e.convertDataUrlToByteArray=function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,a=new Uint8Array(i);i--;)a[i]=r.charCodeAt(i);return[a,n]},e.convertDataURLtoFile=function(e,n){var r=t.convertDataUrlToByteArray(e),i=r[0],a=r[1];return new File([i],n,{type:a})},e.convertDataURLtoBlob=function(e){var n=t.convertDataUrlToByteArray(e),r=n[0],i=n[1];return new Blob([r],{type:i})},e.convertArrayBufferToFile=function(e,t){return new File([e],t)},e.isFile=function(e){return"undefined"!=typeof window&&"File"in window&&"undefined"!=typeof File&&e instanceof File},e.isBlob=function(e){return"undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob},e.isFileTypeBlob=function(e){return e===x.BLOB||e===x.FILE},e.convertBlobToBuffer=function(n){return L(void 0,void 0,void 0,(function(){var r;return P(t,(function(t){switch(t.label){case 0:return[4,e.convertFileToArrayBuffer(n)];case 1:return r=t.sent(),[2,Buffer.from(r)]}}))}))},e}(),re=[F.CONNECTION_REQUIRED,F.NETWORK_ERROR,F.ACK_TIMEOUT,F.WEBSOCKET_CONNECTION_CLOSED,F.WEBSOCKET_CONNECTION_FAILED,F.FILE_UPLOAD_CANCEL_FAILED,F.REQUEST_CANCELED,500901,500910,900200],ie=[F.SESSION_TOKEN_EXPIRED,F.SESSION_TOKEN_REVOKED,F.USER_DEACTIVATED,F.NON_EXISTING_USER],ae=[F.WEBSOCKET_CONNECTION_CLOSED,F.WEBSOCKET_CONNECTION_FAILED],se=function(){function e(){}return e.deepEqual=function(e,t){if(e!==t){var n=M({},e),r=M({},t);return(!n.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||n.messageId===r.messageId)&&(!n.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||n.reqId===r.reqId)&&(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)===JSON.stringify(r))}return!0},e.isResendableError=function(e){return e>0&&re.indexOf(e)>=0},e.isAutoResendableError=function(e){return e>0&&ae.indexOf(e)>=0},e.isNonAutoReconnectableError=function(e){return e>0&&ie.indexOf(e)>=0},e.isFile=function(e){return ne.isFileLikeObject(e)||(te()?"undefined"!=typeof Buffer&&e instanceof Buffer:"undefined"!=typeof Blob?e instanceof Blob:"undefined"!=typeof File&&e instanceof File)},e}(),oe=function(){function e(e){var t=this;this.fields={},e&&Object.keys(e).forEach((function(n){t.fields[n]={value:e[n]},se.isFile(e[n])&&(t.fields[n].filename=e[n].name)})),this.options={},this.internal=!1,this.upload={reqId:null,deleteRequest:null,progressHandler:null}}return e.prototype.add=function(e,t,n){void 0===n&&(n=null),this.fields[e]={value:t,filename:n}},e.prototype.remove=function(e){this.fields.hasOwnProperty(e)&&delete this.fields[e]},e.prototype.yield=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i,a,o,l,u,c,d,h,f=this;return P(this,(function(p){switch(p.label){case 0:for(e=!1,t=Object.keys(this.fields),n=0,r=t;n<r.length;n++)if(l=r[n],se.isFile(this.fields[l].value)){e=!0;break}if(!e)return[3,10];i=new s.default,a=0,o=t,p.label=1;case 1:return a<o.length?(l=o[a],u=this.fields[l],se.isFile(u.value)?(c=u.value).filename||c.name?(i.append(l,u.value,c.filename||c.name),[3,6]):[3,2]:[3,7]):[3,9];case 2:return c.data?(i.append(l,u.value,c.data.name),[3,6]):[3,3];case 3:return d=u.value,"undefined"!=typeof window&&"undefined"!=typeof process&&process.title.endsWith("node")&&process.versions&&process.versions.node&&"undefined"!=typeof Blob&&d instanceof Blob||"undefined"!=typeof File&&d instanceof File?[4,ne.convertBlobToBuffer(d)]:[3,5];case 4:d=p.sent(),p.label=5;case 5:i.append(l,d,"unnamed"),p.label=6;case 6:return[3,8];case 7:ee()&&Array.isArray(u.value)?i.append(l,String(u.value)):i.append(l,u.value),p.label=8;case 8:return a++,[3,1];case 9:return[2,i];case 10:return h={},Object.keys(this.fields).forEach((function(e){h[e]=f.fields[e].value})),[2,h]}}))}))},e}(),le=function(e,t,n){return void 0===n&&(n=null),new Promise((function(r,i){var a=function(t,a){void 0===a&&(a=null),n&&(O.get(e).get("isErrorFirstInCallback")?n(t,a):n(a,t)),t?i(t):r(a)};a.isPromisifyCallback=!0,t(a)}))},ue=888e3,ce=function(){function e(t){d(this,e),this.sb=t,this.cls=j.get(this.sb._iid)}return f(e,[{key:"checkRouting",value:function(e){if(this.sb.customApiHost&&this.sb.customWsHost)"function"==typeof e&&e(null,{apiHost:this.sb.customApiHost,wsHost:this.sb.customWsHost});else{var t=this.sb.getApplicationId();e(null,{apiHost:"https://api-".concat(t,".sendbird.com"),wsHost:"wss://ws-".concat(t,".sendbird.com")})}}},{key:"_buildUrl",value:function(e){var t=e.apiHost,n=e.url,r=e.params;return n?r&&r.internal?"".concat(t,"/v").concat(I.SDK_MAJOR_VERSION,"/sdk").concat(n):"".concat(t,"/v").concat(I.SDK_MAJOR_VERSION).concat(n):t}},{key:"_createHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.noSessionKey,r=void 0!==n&&n,i=t.accessToken,a=void 0===i?null:i,o=e instanceof s.default&&"function"==typeof e.getHeaders?e.getHeaders():{},l=O.get(this.sb._iid).container,u=l.appId,c=l.auth,d=l.extensions,h=l.getUserAgentWithExtensions,f=Pi.getAppVersion(),p="JS,".concat(I.OS_VERSION,",").concat(I.SDK_VERSION,",").concat(u);return f&&(p+=",".concat(f)),o.SendBird=p,o["SB-User-Agent"]=encodeURIComponent(h(d)),!r&&c.sessionKey&&(o["Session-Key"]=c.sessionKey),a&&(o["App-Id"]=u,o["Access-Token"]=a),o["Request-Sent-Timestamp"]=(new Date).getTime().toString(),e instanceof s.default&&ee()&&(o["Content-Type"]="multipart/form-data"),o}},{key:"_createQuery",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=[];return Object.keys(t).forEach((function(e){var r=t[e];if(null!=r){var i="";i="object"===c(r)?Array.isArray(r)?r.map((function(e){return encodeURIComponent("string"==typeof e?e.trim():e)})).join(","):encodeURIComponent(JSON.stringify(r)):encodeURIComponent(r),n.push("".concat(e,"=").concat(i))}})),n.length>0?"".concat(e,"?").concat(n.join("&")):e}catch(t){return $.debug("createWithEncodedGetParams is failed. - ",t),e}}},{key:"_request",value:function(e,t,n,r){var i=this;this.checkRouting((function(o,l){if(o)r(new F("Request failed.",F.REQUEST_FAILED),null);else{var u=i._buildUrl({apiHost:l.apiHost,url:t,params:n});(n?n.yield():Promise.resolve({})).then((function(o){var l=i._createHeader(o,n?n.options:{}),c=[{level:$.supportedLogLevels.DEBUG,messages:["url:",t]},{level:$.supportedLogLevels.DEBUG,messages:["data:",o]}],d=null;switch(e){case"GET":case"DELETE":d=i._createQuery(u,o);break;case"POST":case"PUT":d=u}var h=null;if(("undefined"==typeof ServiceWorker||"undefined"==typeof ServiceWorkerRegistration||"undefined"!=typeof ServiceWorkerContainer)&&"undefined"==typeof Worker||te()||"function"!=typeof fetch)switch(e){case"GET":h=a.default.get(d,{headers:l,validateStatus:i._validateStatus});break;case"POST":var f={headers:l,validateStatus:i._validateStatus,onUploadProgress:function(e){n.upload.progressHandler&&n.upload.progressHandler(e,n.upload.reqId)}};if(o instanceof s.default){var p=null;"function"==typeof AbortController?(p=new AbortController,f.signal=p.signal):(p=a.default.CancelToken.source(),f.cancelToken=p.token);var g=i.cls.FileMessageQueue,y=n.upload.reqId;y&&(c.push({level:$.supportedLogLevels.DEBUG,messages:["request id:",y]}),g.uploadRequest[y]=p)}h=a.default.post(d,"function"==typeof o.getBuffer?o.getBuffer():o,f);break;case"PUT":h=a.default.put(d,o,{headers:l,validateStatus:i._validateStatus});break;case"DELETE":h=a.default.delete(d,{headers:l,validateStatus:i._validateStatus})}else{var m={method:e,headers:l};switch(e){case"GET":break;case"POST":if(o instanceof s.default){if("function"==typeof AbortController){var _=new AbortController,v=_.signal;m.signal=v;var E=i.cls.FileMessageQueue,b=n.upload.reqId;b&&(c.push({level:$.supportedLogLevels.DEBUG,messages:["request id:",b]}),E.uploadRequest[b]=_)}m.body="function"==typeof o.getBuffer?o.getBuffer():o}else l["Content-Type"]="application/json; charset=utf-8",m.body=JSON.stringify(o);break;case"PUT":o instanceof s.default?m.body="function"==typeof o.getBuffer?o.getBuffer():o:(l["Content-Type"]="application/json; charset=utf-8",m.body=JSON.stringify(o))}h=fetch(d,m).then((function(e){return e.json().then((function(t){if(!i._validateStatus(e.status))throw{request:{isAbort:!1},response:{data:t}};return Promise.resolve({data:t})}))}))}$.group("".concat(e," request"),c),c=[],h.then((function(t){try{var i=t.data;"POST"===e&&"function"==typeof n.upload.deleteRequest&&n.upload.deleteRequest(),c.push({level:$.supportedLogLevels.DEBUG,messages:["data:",i]}),r(null,i)}catch(e){throw{code:ue,rawError:e}}})).catch((function(a){if(a.code===ue)throw a.rawError;"POST"===e&&"function"==typeof n.upload.deleteRequest&&n.upload.deleteRequest();var s=i._handleError(a);if(c.push({level:$.supportedLogLevels.DEBUG,messages:["error:",s]}),t&&n)if(n.options&&n.options.isSessionRefresh)r(s,null);else{var o=O.get(i.sb._iid).container.sessionManager;o.isSessionError(s)?o.refreshSessionIfExpiredError(s).then((function(){return r(new F("Session is refreshed successfully.",F.SESSION_REFRESH_SUCCESS),null)})).catch((function(e){return r(new F("Session refresh failed.",F.SESSION_REFRESH_FAILED),null)})):r(s,null)}else r(s,null)})).finally((function(){return $.group("".concat(e," response"),c)}))}))}}))}},{key:"_validateStatus",value:function(e){return e>=200&&e<400}},{key:"_handleError",value:function(e){var t=e.request,n=e.response;if(t){if(t.isAbort||t.aborted)return new F("Request has been canceled.",F.REQUEST_CANCELED);if(n){var r=n.data,i=r?r.message:"Request failed.",a=r?r.code:F.REQUEST_FAILED;return new F(i,a)}return new F("Request failed.",F.REQUEST_FAILED)}return new F("There was a network error.",F.NETWORK_ERROR)}},{key:"get",value:function(e,t,n){this._request("GET",e,t,n)}},{key:"dummyCall",value:function(e){this._request("GET",null,null,e)}},{key:"post",value:function(e,t,n){this._request("POST",e,t,n)}},{key:"put",value:function(e,t,n){this._request("PUT",e,t,n)}},{key:"delete",value:function(e,t,n){this._request("DELETE",e,t,n)}},{key:"refreshSessionKey",value:function(t,n){var r=this,i=t.accessToken;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_SESSION_KEY.replace("%s",encodeURIComponent(a.userId)),o=new oe;o.add("expiring_session",!0),o.options.isSessionRefresh=!0,o.options.noSessionKey=!0,o.options.accessToken=i,r.post(s,o,n)}}))}},{key:"updateCurrentUserInfo",value:function(t,n){var r=this,i=t.nickname,a=t.profileUrl,s=t.profileImage,o=t.preferredLanguages;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=e.Path.USERS_USERID.replace("%s",encodeURIComponent(l.userId)),c=new oe;i&&c.add("nickname",i),a&&c.add("profile_url",a),s&&c.add("profile_file",s,s.name),o&&c.add("preferred_languages",o),r.put(u,c,n)}}))}},{key:"getMyGroupChannelChangeLogs",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.ts,a=t.token,s=t.customTypes,o=t.includeEmpty,l=t.includeFrozen;r.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS.replace("%s",encodeURIComponent(u.userId)),d=new oe({show_read_receipt:!0,show_delivery_receipt:!0,show_member:!0});a&&d.add("token",a),i&&d.add("change_ts",i),s&&s.length>0&&d.add("custom_types",s),"boolean"==typeof o&&d.add("show_empty",o),"boolean"==typeof l&&d.add("show_frozen",l),r.get(c,d,n)}}))}),n)}},{key:"getChannelInvitationPreference",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"getGroupChannelCount",value:function(t,n){var r=this,i=t.memberStateFilter;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=r.cls.GroupChannel,o=e.Path.USERS_USERID_GROUP_CHANNEL_COUNT.replace("%s",encodeURIComponent(a.userId)),l="";switch(i){case s.MemberStateFilter.JOINED:l="joined";break;case s.MemberStateFilter.INVITED:l="invited";break;case s.MemberStateFilter.INVITED_BY_FRIEND:l="invited_by_friend";break;case s.MemberStateFilter.INVITED_BY_NON_FRIEND:l="invited_by_non_friend";break;case s.MemberStateFilter.LEFT:l="left";default:l="all"}var u=new oe({state:l});r.get(o,u,n)}}))}},{key:"getUnreadItemCount",value:function(t,n){var r=this,i=t.keys;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_UNREAD_ITEM_COUNT.replace("%s",encodeURIComponent(a.userId)),o=new oe({item_keys:i});r.get(s,o,n)}}))}},{key:"getTotalUnreadMessageCount",value:function(t,n){var r=this,i=t.customTypesFilter,a=t.superChannelFilter;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_USERID_UNREAD_MESSAGE_COUNT.replace("%s",encodeURIComponent(s.userId)),l=new oe({super_mode:a});null!==i&&i.length>0&&l.add("custom_types",i),r.get(o,l,n)}}))}},{key:"getTotalUnreadChannelCount",value:function(t,n){var r=this,i=t.customTypesFilter,a=t.superChannelFilter;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_USERID_UNREAD_CHANNEL_COUNT.replace("%s",encodeURIComponent(s.userId)),l=new oe({super_mode:a});null!==i&&i.length>0&&l.add("custom_types",i),r.get(o,l,n)}}))}},{key:"searchMessages",value:function(t,n){var r=this,i=t.keyword,a=t.limit,s=t.reverse,o=t.exactMatch,l=t.channelUrl,u=t.channelCustomType,c=t.messageTimestampFrom,d=t.messageTimestampTo,h=t.order,f=t.nextToken,p=t.advancedQuery,g=t.targetFields;this.sb.ConnectionManager.ready((function(t,y){if(t)n(t,null);else{var m=e.Path.SEARCH_MESSAGE,_=new oe({limit:a,reverse:s,query:i,custom_type:u});c&&_.add("message_ts_from",c),d&&_.add("message_ts_to",d),l&&_.add("channel_url",l),h&&_.add("sort_field",h),"boolean"==typeof o&&_.add("exact_match",o),null!==f&&f.length>0&&_.add("after",f),"boolean"==typeof p&&_.add("advanced_query",p),g&&Array.isArray(g)&&_.add("target_fields",g),r.get(m,_,n)}}))}},{key:"markAsReadAll",value:function(t,n){var r=this,i=t.channelUrls;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_MARKASREADALL.replace("%s",encodeURIComponent(a.userId)),o=new oe;i&&o.add("channel_urls",i),r.put(s,o,n)}}))}},{key:"markAsDelivered",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED.replace("%s",encodeURIComponent(i)),l=new oe;a&&l.add("user_id",a),r.put(o,l,n)}}))}},{key:"setChannelInvitationPreference",value:function(t,n){var r=this,i=t.isAutoAccept;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(a.userId)),o=new oe({auto_accept:i});r.put(s,o,n)}}))}},{key:"blockUser",value:function(t,n){var r=this,i=t.blockedUserId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(a.userId)),o=new oe({target_id:i});r.post(s,o,n)}}))}},{key:"unblockUser",value:function(t,n){var r=this,i=t.unblockedUserId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_BLOCK_TARGETID.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"getPushTriggerOption",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setPushTriggerOption",value:function(t,n){var r=this,i=t.pushTriggerOption;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(a.userId)),o=new oe({push_trigger_option:i});r.put(s,o,n)}}))}},{key:"getPushTokens",value:function(t,n){var r=this,i=t.ts,a=t.token,s=t.type;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSH_DEVICE_TOKENS.replace("%s",encodeURIComponent(o.userId)).replace("%s",encodeURIComponent(s)),u=new oe;a&&u.add("token",a),i&&u.add("created_ts",i),r.get(l,u,n)}}))}},{key:"getPushTemplate",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setPushTemplate",value:function(t,n){var r=this,i=t.templateName;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(a.userId)),o=new oe({name:i});r.put(s,o,n)}}))}},{key:"getDoNotDisturb",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setDoNotDisturb",value:function(t,n){var r=this,i=t.doNotDisturbOn,a=t.startHour,s=t.startMin,o=t.endHour,l=t.endMin,u=t.timezone;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(c.userId)),h=new oe({do_not_disturb:i,start_hour:a,start_min:s,end_hour:o,end_min:l,timezone:u});r.put(d,h,n)}}))}},{key:"getSnoozePeriod",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setSnoozePeriod",value:function(t,n){var r=this,i=t.snoozeOn,a=t.startTs,s=t.endTs;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(o.userId)),u=new oe({snooze_enabled:i,snooze_start_ts:a,snooze_end_ts:s});r.put(l,u,n)}}))}},{key:"registerGCMPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(a.userId)),o=new oe({gcm_reg_token:i,always_push:!0});r.post(s,o,n)}}))}},{key:"unregisterGCMPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_GCM_TOKEN.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"unregisterAllGCMPushTokens",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"registerAPNSPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(a.userId)),o=new oe({apns_device_token:i,always_push:!0});r.post(s,o,n)}}))}},{key:"unregisterAPNSPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_APNS_TOKEN.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"unregisterAllAPNSPushTokens",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"unregisterAllPushTokens",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"loadFriendList",value:function(t,n){var r=this,i=t.token,a=t.limit;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.FRIENDS.replace("%s",encodeURIComponent(s.userId)),l=new oe({limit:a,token:i});r.get(o,l,n)}}))}},{key:"getFriendChangeLogsByToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS_CHANGE_LOGS.replace("%s",encodeURIComponent(a.userId)),o=new oe;i&&o.add("token",i),r.get(s,o,n)}}))}},{key:"addFriends",value:function(t,n){var r=this,i=t.userIds;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS.replace("%s",encodeURIComponent(a.userId)),o=new oe({user_ids:i});r.post(s,o,n)}}))}},{key:"deleteFriends",value:function(t,n){var r=this,i=t.userIds;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS.replace("%s",encodeURIComponent(a.userId)),o=new oe({user_ids:i});r.delete(s,o,n)}}))}},{key:"uploadFriendDiscoveries",value:function(t,n){var r=this,i=t.discoveries;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(a.userId)),o=[];i.forEach((function(e){o.push({friend_discovery_key:e.friendDiscoveryKey,friend_name:"string"==typeof e.friendName||e.friendName?e.friendName:null})}));var l=new oe({friend_discoveries:o});r.put(s,l,n)}}))}},{key:"deleteFriendDiscoveries",value:function(t,n){var r=this,i=t.discoveryKeys;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(a.userId)),o=new oe({friend_discovery_keys:i});r.delete(s,o,n)}}))}},{key:"loadUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.userIdsFilter,o=t.metaDataKeyFilter,l=t.metaDataValuesFilter,u=t.nicknameStartsWithFilter;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.USERS,h=new oe({token:i,limit:a});s&&s.length>0&&h.add("user_ids",s),o&&l&&l.length>0&&(h.add("metadatakey",o),h.add("metadatavalues_in",l)),u&&h.add("nickname_startswith",u),r.get(d,h,n)}}))}},{key:"loadBlockedUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.userIdsFilter;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(o.userId)),u=new oe({token:i,limit:a});s&&s.length>0&&u.add("user_ids",s),r.get(l,u,n)}}))}},{key:"createUserMetaData",value:function(t,n){var r=this,i=t.metaData;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(a.userId)),o=new oe({metadata:i});r.post(s,o,n)}}))}},{key:"updateUserMetaData",value:function(t,n){var r=this,i=t.metaData,a=t.upsert;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(s.userId)),l=new oe({metadata:i,upsert:a});r.put(o,l,n)}}))}},{key:"deleteUserMetaData",value:function(t,n){var r=this,i=t.metaDataKey;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_METADATA_KEY.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"deleteAllUserMetaData",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"getMessageChangeLogs",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.channelUrl,a=t.ts,s=t.timestamp,o=t.token,l=t.isOpenChannel,u=t.includeMetaArray,c=t.includeReaction,d=t.includeReactions,h=t.includeReplies,f=t.includeParentMessageText,p=t.includeThreadInfo,g=t.replyType,y=t.includeParentMessageInfo;r.sb.ConnectionManager.ready((function(t,m){if(t)n(t,null);else{var _=l?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(i)),v=new oe;o&&v.add("token",o),a&&v.add("change_ts",a),s&&v.add("change_ts",s),"boolean"==typeof u&&v.add("with_sorted_meta_array",u),"boolean"==typeof d?v.add("include_reactions",d):v.add("include_reactions","boolean"==typeof c&&c),"boolean"==typeof p&&v.add("include_thread_info",p),"string"==typeof g?v.add("include_reply_type",g):v.add("include_reply_type","boolean"==typeof h&&h?r.cls.BaseMessage.ReplyType.ALL:r.cls.BaseMessage.ReplyType.NONE),"boolean"==typeof y?v.add("include_parent_message_info",y):v.add("include_parent_message_info","boolean"==typeof f&&f),r.get(_,v,n)}}))}),n)}},{key:"getMyMutedInfo",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a));r.get(l,null,n)}}))}},{key:"loadBannedUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.channelUrl,o=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=o?e.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(s)),c=new oe({token:i,limit:a});r.get(u,c,n)}}))}},{key:"loadMutedUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.channelUrl,o=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=o?e.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(s)),c=new oe({token:i,limit:a});r.get(u,c,n)}}))}},{key:"getMessageList",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.channel,a=t.token,s=t.tokenType,o=t.isInclusive,l=t.prevResultSize,u=void 0===l?0:l,c=t.nextResultSize,d=void 0===c?0:c,h=t.shouldReverse,f=t.messageType,p=t.customType,g=t.customTypes,y=t.senderUserIds,m=t.includeMetaArray,_=t.includeReaction,v=t.includeReactions,E=t.includeReplies,b=t.includeParentMessageText,C=t.includeThreadInfo,S=t.replyType,N=t.includeParentMessageInfo,A=t.showSubchannelMessagesOnly,k=t.rootMessageId,T=t.parentMessageId;r.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var c=i.isOpenChannel()?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",i.url):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",i.url),I=new oe({is_sdk:String(!0),prev_limit:String(u),next_limit:String(d),include:String(o),reverse:String(h)});"timestamp"===s?I.add("message_ts",a):"messageId"===s&&I.add("message_id",String(a)),f&&I.add("message_type",String(f)),Array.isArray(g)&&(0===g.length&&("string"==typeof p?g.push(p):g.push("*")),I.add("custom_types",g)),Array.isArray(y)&&y.length>0&&I.add("sender_ids",y),"boolean"==typeof m&&I.add("with_sorted_meta_array",m),"boolean"==typeof v?I.add("include_reactions",v):I.add("include_reactions","boolean"==typeof _&&_),"boolean"==typeof C&&I.add("include_thread_info",C),"string"==typeof S?I.add("include_reply_type",S):I.add("include_reply_type","boolean"==typeof E&&E?r.cls.BaseMessage.ReplyType.ALL:r.cls.BaseMessage.ReplyType.NONE),"boolean"==typeof N?I.add("include_parent_message_info",N):I.add("include_parent_message_info","boolean"==typeof b&&b),"boolean"==typeof A&&i.isOpenChannel()&&I.add("show_subchannel_messages_only",A),k&&I.add("root_message_id",k),T&&I.add("parent_message_id",T),r.get(c,I,n)}}))}),n)}},{key:"checkMessageHugeGap",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.channelUrl;t.channelType;var a=t.messageType,s=void 0===a?"":a,o=t.customTypes,l=void 0===o?["*"]:o,u=t.senderUserIds,c=void 0===u?[]:u,d=t.includeReactions,h=void 0===d||d,f=t.includeMetaArray,p=void 0!==f&&f,g=t.showSubchannelMessagesOnly,y=void 0!==g&&g,m=t.threshold,_=t.previous,v=t.next,E="".concat(e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_GAP.replace("%s",encodeURIComponent(i))),b=new oe({huge_gap_threshold:m,prev_start_ts:_.from,prev_end_ts:_.to,prev_cache_count:_.cachedCount,next_start_ts:v.from,next_end_ts:v.to,next_cache_count:v.cachedCount,reverse:!0,custom_types:l,message_type:s,include_reactions:h,with_sorted_meta_array:p,show_subchannel_messages_only:y});Array.isArray(c)&&c.length>0&&b.add("sender_ids",c),r.get(E,b,n)}),n)}},{key:"translateUserMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.messageId,o=t.translationTargetLanguages;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=a?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(i)).replace("%s",s):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(i)).replace("%s",s),c=new oe({target_langs:o});r.post(u,c,n)}}))}},{key:"getMessage",value:function(t,n){var r=this,i=t.channel,a=t.messageId,s=t.includeMetaArray,o=t.includeReactions,l=t.includeParentMessageText,u=t.includeThreadInfo,c=t.includeParentMessageInfo;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=i.isOpenChannel()?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i.url)).replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i.url)).replace("%s",encodeURIComponent(a)),f=new oe({is_sdk:String(!0)});"boolean"==typeof s&&f.add("with_sorted_meta_array",s),"boolean"==typeof o&&f.add("include_reactions",o),"boolean"==typeof u&&f.add("include_thread_info",u),"boolean"==typeof c?f.add("include_parent_message_info",c):f.add("include_parent_message_info","boolean"==typeof l&&l),r.get(h,f,n)}}))}},{key:"deleteMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.messageId;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(s));r.delete(l,null,n)}}))}},{key:"muteUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.description,o=t.seconds,l=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=l?e.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(i)):e.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(i)),d=new oe({user_id:a});o&&(o>0||-1!==o)&&d.add("seconds",o),s&&d.add("description",s),r.post(c,d,n)}}))}},{key:"unmuteUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a));r.delete(l,null,n)}}))}},{key:"banUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.description,o=t.seconds,l=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=l?e.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(i)):e.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(i)),d=new oe({user_id:a});s&&d.add("description",s),d.add("seconds",String(o)),r.post(c,d,n)}}))}},{key:"unbanUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a));r.delete(l,null,n)}}))}},{key:"getMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.keys;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)),u=new oe({keys:s});r.get(l,u,n)}}))}},{key:"createMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaCounter;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)),u=new oe({metacounter:s});r.post(l,u,n)}}))}},{key:"updateMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaCounter,o=t.upsert,l=t.mode;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)),d=new oe({metacounter:s,upsert:o,mode:l});r.put(c,d,n)}}))}},{key:"deleteMetaCounter",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.key;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s);r.delete(l,null,n)}}))}},{key:"deleteAllMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i));r.delete(o,null,n)}}))}},{key:"getMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.keys;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),u=new oe({keys:s,include_ts:!0});r.get(l,u,n)}}))}},{key:"createMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaData;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),u=new oe({metadata:s,include_ts:!0});r.post(l,u,n)}}))}},{key:"updateMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaData,o=t.upsert;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),c=new oe({metadata:s,upsert:o,include_ts:!0});r.put(u,c,n)}}))}},{key:"deleteMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.key;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s):e.Path.GROUPCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s),u=new oe({include_ts:!0});r.delete(l,u,n)}}))}},{key:"deleteAllMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),l=new oe({include_ts:!0});r.delete(o,l,n)}}))}},{key:"loadOperatorList",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.token,o=t.limit;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=a?e.Path.OPENCHANNELS_OPERATORS.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_OPERATORS.replace("%s",encodeURIComponent(i)),c=new oe({token:s,limit:o});r.get(u,c,n)}}))}},{key:"getOpenChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.internalCall;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i)),l=new oe({});l.internal=a===I.INTERNAL_CALL,r.get(o,l,n)}}))}},{key:"loadOpenChannelList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.nameKeyword,o=t.urlKeyword,l=t.customTypes,u=t.includeFrozen,c=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.OPENCHANNELS,f=new oe({token:i,limit:a});s&&f.add("name_contains",s),o&&f.add("url_contains",o),l&&l.length>0&&f.add("custom_types",l),"boolean"==typeof u&&f.add("show_frozen",u),"boolean"==typeof c&&f.add("show_metadata",c),r.get(h,f,n)}}))}},{key:"loadParticipantList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.channelUrl;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.OPENCHANNELS_CHANNELURL_PARTICIPANTS.replace("%s",encodeURIComponent(s)),u=new oe({token:i,limit:a});r.get(l,u,n)}}))}},{key:"createOpenChannel",value:function(t,n){var r=this,i=t.name,a=t.coverUrlOrImage,s=t.data,o=t.operatorUserIds,l=t.customType,u=t.channelUrl;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.OPENCHANNELS,h=new oe;"string"==typeof a&&h.add("cover_url",a),se.isFile(a)&&h.add("cover_file",a),null!==u&&"string"==typeof u&&h.add("channel_url",u),null!==i&&"string"==typeof i&&h.add("name",i),s&&h.add("data",s),o&&(Array.isArray(o)?h.add("operators",o):h.add("operators",[o])),l&&h.add("custom_type",l),r.post(d,h,n)}}))}},{key:"updateOpenChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.name,s=t.coverUrlOrImage,o=t.data,l=t.operatorUserIds,u=t.customType;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i)),h=new oe;"string"==typeof s&&h.add("cover_url",s),se.isFile(s)&&h.add("cover_file",s,s.name),null!==a&&"string"==typeof a&&h.add("name",a),null!==o&&"string"==typeof o&&h.add("data",o),null!==l&&(Array.isArray(l)?h.add("operator_ids",l):h.add("operator_ids",[l])),null!==u&&"string"==typeof u&&h.add("custom_type",u),r.put(d,h,n)}}))}},{key:"deleteOpenChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"getGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.showMember,s=t.internalCall;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i)),u=new oe({show_member:a,show_read_receipt:!0,show_delivery_receipt:!0});u.internal=s===I.INTERNAL_CALL,r.get(l,u,n)}}))}},{key:"loadGroupChannelList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.includeEmpty,o=t.order,l=t.userIdsFilter,u=t.nicknameContainsFilter,c=t.nicknameStartsWithFilter,d=t.nicknameExactMatchFilter,h=t.channelNameContainsFilter,f=t.channelUrlsFilter,p=t.customTypesFilter,g=t.customTypeStartsWithFilter,y=t.memberStateFilter,m=t.superChannelFilter,_=t.publicChannelFilter,v=t.unreadChannelFilter,E=t.metadataOrderKeyFilter,b=t.metadataKey,C=t.metadataValues,S=t.metadataValueStartsWith,N=t.hiddenChannelFilter,A=t.searchFilter,k=t.includeFrozen,T=t.includeMetaData;return le(this.sb._iid,(function(t){r.sb.ConnectionManager.ready((function(n,I){if(n)t(n,null);else{var w=e.Path.MYGROUPCHANNELS.replace("%s",encodeURIComponent(I.userId)),O=new oe({token:i,limit:a,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(s),member_state_filter:y});p&&p.length>0&&O.add("custom_types",p),u&&O.add("members_nickname_contains",u),c&&O.add("members_nickname_startswith",c),d&&O.add("members_nickname",d),h&&O.add("name_contains",h),A&&A.hasOwnProperty("search_query")&&A.hasOwnProperty("search_fields")&&(O.add("search_query",A.search_query),O.add("search_fields",A.search_fields)),l&&l.userIds&&l.userIds.length>0&&(l.includeMode?(O.add("members_include_in",l.userIds),O.add("query_type",l.queryType.toUpperCase())):O.add("members_exactly_in",l.userIds)),f&&f.length>0&&O.add("channel_urls",f),O.add("super_mode",m),O.add("public_mode",_),O.add("unread_filter",v),E&&O.add("metadata_order_key",E),b&&O.add("metadata_key",b),C&&C.length>0&&O.add("metadata_values",C),S&&O.add("metadata_value_startswith",S),g&&O.add("custom_type_startswith",g),N&&O.add("hidden_mode",N),"boolean"==typeof k&&O.add("show_frozen",k),"boolean"==typeof T&&O.add("show_metadata",T),r.get(w,O,t)}}))}),n)}},{key:"loadPublicGroupChannelList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.includeEmpty,o=t.order,l=t.channelNameContainsFilter,u=t.channelUrlsFilter,c=t.customTypesFilter,d=t.customTypeStartsWithFilter,h=t.superChannelFilter,f=t.membershipFilter,p=t.metadataOrderKeyFilter,g=t.metadataKey,y=t.metadataValues,m=t.metadataValueStartsWith,_=t.includeFrozen,v=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,E){if(t)n(t,null);else{var b=r.cls.GroupChannel,C=e.Path.GROUPCHANNELS,S=new oe({token:i,limit:a,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(s),public_mode:b.PublicChannelFilter.PUBLIC,public_membership_mode:f});c&&c.length>0&&S.add("custom_types",c),l&&S.add("name_contains",l),u&&u.length>0&&S.add("channel_urls",u),S.add("super_mode",h),p&&S.add("metadata_order_key",p),g&&S.add("metadata_key",g),y&&y.length>0&&S.add("metadata_values",y),m&&S.add("metadata_value_startswith",m),d&&S.add("custom_type_startswith",d),"boolean"==typeof _&&S.add("show_frozen",_),"boolean"==typeof v&&S.add("show_metadata",v),r.get(C,S,n)}}))}},{key:"createGroupChannel",value:function(t,n){var r=this,i=t.isDistinct,a=t.isSuper,s=t.isBroadcast,o=t.isPublic,l=t.channelUrl,u=t.isDiscoverable,c=t.isStrict,d=t.name,h=t.data,f=t.customType,p=t.coverUrl,g=t.coverImage,y=t.accessCode,m=t.isEphemeral,_=t._invitedUserIds,v=void 0===_?[]:_,E=t.operatorUserIds,b=t.messageSurvivalSeconds;this.sb.ConnectionManager.ready((function(t,_){if(t)n(t,null);else{var C=e.Path.GROUPCHANNELS,S=new oe({user_ids:[_.userId].concat(N(v)).filter((function(e,t,n){return t===n.indexOf(e)}))});null!==p&&"string"==typeof p&&S.add("cover_url",p),se.isFile(g)&&S.add("cover_file",g,g.name),null!==l&&S.add("channel_url",l),null!==i&&S.add("is_distinct",i),null!==a&&S.add("is_super",a),null!==s&&S.add("is_broadcast",s),null!==o&&S.add("is_public",o),null!==u&&S.add("is_discoverable",u),null!==c&&S.add("strict",c),null!==m&&S.add("is_ephemeral",m),y&&S.add("access_code",y),null!==d&&"string"==typeof d&&S.add("name",d),h&&S.add("data",h),f&&S.add("custom_type",f),Array.isArray(E)&&E.length>0&&S.add("operator_ids",E),null!==b&&b>-1&&S.add("message_survival_seconds",b),r.post(C,S,n)}}))}},{key:"updateGroupChannel",value:function(t,n){var r=this,i=t.isDistinct,a=t.isPublic,s=t.channelUrl,o=t.isDiscoverable,l=t.name,u=t.data,c=t.customType,d=t.coverUrl,h=t.coverImage,f=t.accessCode,p=t.operatorUserIds,g=t.messageSurvivalSeconds;this.sb.ConnectionManager.ready((function(t,y){if(t)n(t,null);else{var m=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(s)),_=new oe;null!==i&&_.add("is_distinct",i),null!==a&&_.add("is_public",a),null!==o&&_.add("is_discoverable",o),null!==f&&_.add("access_code",f),null!==d&&"string"==typeof d&&_.add("cover_url",d),se.isFile(h)&&_.add("cover_file",h,h.name),null!==l&&"string"==typeof l&&_.add("name",l),null!==u&&"string"==typeof u&&_.add("data",u),null!==c&&"string"==typeof c&&_.add("custom_type",c),null!==p&&(Array.isArray(p)?_.add("operator_ids",p):p&&_.add("operator_ids",[p])),null!==g&&g>-1&&_.add("message_survival_seconds",g),r.put(m,_,n)}}))}},{key:"addOperators",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=void 0!==a&&a,o=t.operatorUserIds;this.sb.ConnectionManager.ready((function(t,a){if(!t){var l=(s?e.Path.OPENCHANNELS_CHANNELURL_OPERATORS:e.Path.GROUPCHANNELS_CHANNELURL_OPERATORS).replace("%s",encodeURIComponent(i)),u=new oe({operator_ids:o});r.post(l,u,n)}}))}},{key:"removeOperators",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=void 0!==a&&a,o=t.operatorUserIds;this.sb.ConnectionManager.ready((function(t,a){if(!t){var l=(s?e.Path.OPENCHANNELS_CHANNELURL_OPERATORS:e.Path.GROUPCHANNELS_CHANNELURL_OPERATORS).replace("%s",encodeURIComponent(i)),u=new oe({operator_ids:o});r.delete(l,u,n)}}))}},{key:"inviteToGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.userIds;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_INVITE.replace("%s",encodeURIComponent(i)),l=new oe({user_ids:a});r.post(o,l,n)}}))}},{key:"acceptInvitation",value:function(t,n){var r=this,i=t.channelUrl,a=t.accessCode;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION.replace("%s",encodeURIComponent(i)),l=new oe({user_id:s.userId});a&&l.add("access_code",a),r.put(o,l,n)}}))}},{key:"declineInvitation",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION.replace("%s",encodeURIComponent(i)),o=new oe({user_id:a.userId});r.put(s,o,n)}}))}},{key:"joinGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.accessCode;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_JOIN.replace("%s",encodeURIComponent(i)),l=new oe({user_id:s.userId});a&&l.add("access_code",a),r.put(o,l,n)}}))}},{key:"leaveGroupChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL_LEAVE.replace("%s",encodeURIComponent(i)),o=new oe({user_id:a.userId});r.put(s,o,n)}}))}},{key:"hideGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.hidePreviousMessages,s=t.allowAutoUnhide;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(i)),u=new oe({user_id:o.userId,hide_previous_messages:a,allow_auto_unhide:s});r.put(l,u,n)}}))}},{key:"unhideGroupChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"freeze",value:function(t,n){var r=this,i=t.channelUrl,a=t.isGroupChannel,s=t.freezing;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.GROUPCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(i)):e.Path.OPENCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(i)),u=new oe({freeze:s});r.put(l,u,n)}}))}},{key:"deleteGroupChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"loadMemberList",value:function(t,n){var r=this,i=t.channelUrl,a=t.token,s=t.limit,o=t.mutedMemberFilter,l=t.order,u=t.memberStateFilter,c=t.nicknameStartsWithFilter;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.GROUPCHANNELS_MEMBERS.replace("%s",encodeURIComponent(i)),f=new oe({token:a,limit:s,order:l.toLowerCase(),muted_member_filter:o.toLowerCase(),member_state_filter:u,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0});c&&f.add("nickname_startswith",c),r.get(h,f,n)}}))}},{key:"report",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.reportCategory,o=t.reportingUserId,l=t.reportDescription;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.REPORT_CHANNELS.replace("%s",encodeURIComponent(a?"open_channels":"group_channels")).replace("%s",encodeURIComponent(i)),d=new oe({report_category:s});null!=o&&d.add("reporting_user_id",o),null!=l&&d.add("report_description",l),r.post(c,d,n)}}))}},{key:"reportUser",value:function(t,n){var r=this,i=t.offendingUserId,a=t.channelUrl,s=t.isOpenChannel,o=t.reportCategory,l=t.reportingUserId,u=t.reportDescription;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.REPORT_USERS.replace("%s",encodeURIComponent(i)),h=new oe({channel_url:a,channel_type:s?"open_channels":"group_channels",report_category:o});null!=l&&h.add("reporting_user_id",l),null!=u&&h.add("report_description",u),r.post(d,h,n)}}))}},{key:"reportMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.messageId,o=t.reportCategory,l=t.reportingUserId,u=t.reportDescription,c=t.offendingUserId;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.REPORT_MESSAGES.replace("%s",encodeURIComponent(a?"open_channels":"group_channels")).replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(s)),f=new oe({report_category:o,offending_user_id:c});null!=l&&f.add("reporting_user_id",l),null!=u&&f.add("report_description",u),r.post(h,f,n)}}))}},{key:"sendUserMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.message,o=t.data,l=t.customType,u=t.translationTargetLanguages,c=t.metaArrays,d=t.mentionType,h=t.mentionedUserIds,f=t.mentionedMessageTemplate,p=t.pushNotificationDeliveryOption,g=t.rootMessageId,y=t.parentMessageId,m=t.appleCriticalAlertOptions,_=t.isReplyToChannel;this.sb.ConnectionManager.ready((function(t,v){if(t)n(t,null);else{var E=r.cls.FileMessageParams,b=a?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(i)),C=new oe({message_type:"MESG",user_id:v.userId,message:s,mention_type:d,mentioned_user_ids:[]});null!=o&&C.add("data",o),null!=l&&C.add("custom_type",l),u&&C.add("translation_target_langs",u),c&&c.length>0&&C.add("sorted_metaarray",c.map((function(e){return e.encode()}))),d===r.cls.BaseMessageParams.MentionType.CHANNEL?C.add("mentioned_user_ids",[]):Array.isArray(h)&&h.length>0&&C.add("mentioned_user_ids",h),f&&C.add("mentioned_message_template",f),p&&p!==E.PushNotificationDeliveryOption.DEFAULT&&C.add("push_option",p),g&&C.add("root_message_id",g),y&&C.add("parent_message_id",y),m&&C.add("apple_critical_alert_options",m.serialize()),_&&C.add("reply_to_channel",_),r.post(b,C,n)}}))}},{key:"sendFileMessage",value:function(t,n){var r=this,i=t.reqId,a=t.channelUrl,s=t.isOpenChannel,o=t.fileUrl,l=t.fileName,u=t.fileSize,c=t.fileType,d=t.data,h=t.customType,f=t.thumbnailSizes,p=t.requireAuth,g=t.metaArrays,y=t.mentionType,m=t.mentionedUserIds,_=t.pushNotificationDeliveryOption,v=t.rootMessageId,E=t.parentMessageId,b=t.appleCriticalAlertOptions,C=t.isReplyToChannel;this.sb.ConnectionManager.ready((function(t,S){if(t)n(t,null);else{var N=r.cls.FileMessageParams,A=s?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(a)),k=new oe({message_type:"FILE",user_id:S.userId,url:o,mention_type:y,mentioned_user_ids:[],req_id:i});null!=l&&k.add("file_name",l),null!=u&&k.add("file_size",u),null!=c&&k.add("file_type",c),null!=d&&k.add("custom_field",d),null!=h&&k.add("custom_type",h),f&&k.add("thumbnails",f),p&&k.add("require_auth",p),g&&g.length>0&&k.add("sorted_metaarray",g.map((function(e){return e.encode()}))),y===r.cls.BaseMessageParams.MentionType.CHANNEL?k.add("mentioned_user_ids",[]):Array.isArray(m)&&m.length>0&&k.add("mentioned_user_ids",m),_&&_!==N.PushNotificationDeliveryOption.DEFAULT&&k.add("push_option",_),v&&k.add("root_message_id",v),E&&k.add("parent_message_id",E),b&&k.add("apple_critical_alert_options",b.serialize()),C&&k.add("reply_to_channel",C),r.post(A,k,n)}}))}},{key:"uploadFile",value:function(t,n){var r=this,i=t.file,a=t.thumbnailSizes,s=t.channelUrl,o=t.progressHandler,l=t.reqId;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=O.get(r.sb._iid).container.appInfo;if(c)if("number"==typeof i.size||i.size||(i.size=0),"number"==typeof i.size)if(i.size<=c.uploadSizeLimit){var d=e.Path.STORAGE_FILE,h=new oe;if(h.add("file",i,i.name),s&&"string"==typeof s&&h.add("channel_url",s),a)for(var f=0;f<a.length;f++)h.add("thumbnail"+(f+1),a[f].maxWidth+","+a[f].maxHeight);h.upload.reqId=l,h.upload.deleteRequest=function(){var e=r.cls.FileMessageQueue;e.uploadRequest[l]&&delete e.uploadRequest[l]},h.upload.progressHandler=function(e){o&&"function"==typeof o&&o(e,l)},r.post(d,h,n)}else n(new F("The file size exceeded the upload limit: ".concat(c.uploadSizeLimit),F.FILE_SIZE_LIMIT_EXCEEDED),null);else n(new F("Invalid file size: ".concat(i.size),F.INVALID_PARAMETER),null);else n(new F("Connection should be made first.",F.CONNECTION_REQUIRED),null)}}))}},{key:"registerScheduledUserMessage",value:function(t,n){var r=this,i=t.groupChannelParams,a=t.channelUrl,s=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(a)),u=new oe({scheduled_dt:i._getScheduleString(),user_id:o.userId,message:i.message,data:i.data});i.customType&&u.add("custom_type",i.customType),i.metaArrayKeys&&Object.keys(i.metaArrayKeys).length>0&&u.add("metaarray",i.metaArrayKeys),i.mentionType&&u.add("mention_type",i._mentionType),i._mentionType===r.cls.BaseMessageParams.MentionType.CHANNEL?u.add("mentioned_user_ids",[]):Array.isArray(i._mentionedUserIds)&&i._mentionedUserIds.length>0&&u.add("mentioned_user_ids",i._mentionedUserIds),i.translationTargetLanguages&&i.translationTargetLanguages.length>0&&u.add("translation_target_langs",i.translationTargetLanguages),i.pushNotificationDeliveryOption&&i.pushNotificationDeliveryOption!==r.cls.BaseMessageParams.PushNotificationDeliveryOption.DEFAULT&&u.add("push_option",i.pushNotificationDeliveryOption),i.appleCriticalAlertOptions&&u.add("apple_critical_alert_options",i.appleCriticalAlertOptions.serialize()),r.post(l,u,n)}}))}},{key:"getMyPushTriggerOption",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.get(s,null,n)}}))}},{key:"setMyPushTriggerOption",value:function(t,n){var r=this,i=t.channelUrl,a=t.pushTriggerOption,s=t.enable;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(o.userId)).replace("%s",encodeURIComponent(i)),u=new oe;a&&u.add("push_trigger_option",a),"boolean"==typeof s&&u.add("enable",s),r.put(l,u,n)}}))}},{key:"setMyCountPreference",value:function(t,n){var r=this,i=t.channelUrl,a=t.countPreference;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_COUNT_PREFERENCE.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(i)),l=new oe({count_preference:a});r.put(o,l,n)}}))}},{key:"resetMyHistory",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_RESET_USER_HISTORY.replace("%s",encodeURIComponent(i));r.put(s,null,n)}}))}},{key:"addReaction",value:function(t,n){var r=this,i=t.isGroupChannel,a=t.channelUrl,s=t.messageId,o=t.key;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=i?e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)),c=new oe({reaction:o});r.post(u,c,n)}}))}},{key:"deleteReaction",value:function(t,n){var r=this,i=t.isGroupChannel,a=t.channelUrl,s=t.messageId,o=t.key;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=i?e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)),c=new oe({reaction:o});r.delete(u,c,n)}}))}},{key:"getAllEmoji",value:function(t){var n=this;this.sb.ConnectionManager.ready((function(r,i){r?t(r,null):n.get(e.Path.EMOJI_CATEGORIES,null,t)}))}},{key:"getEmojiCategory",value:function(t,n){var r=this,i=t.categoryId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.EMOJI_CATEGORIES_CATEGORYID.replace("%s",i);r.get(s,null,n)}}))}},{key:"getEmoji",value:function(t,n){var r=this,i=t.emojiKey;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.EMOJIS_EMOJIKEY.replace("%s",i);r.get(s,null,n)}}))}},{key:"getAllowFriendDiscovery",value:function(t){var n=this;this.sb.ConnectionManager.ready((function(r,i){if(r)t(r,null);else{var a=e.Path.USERS_USERID_ALLOW_FRIEND_DISCOVERY.replace("%s",encodeURIComponent(i.userId));n.get(a,null,t)}}))}},{key:"setAllowFriendDiscovery",value:function(t,n){var r=this,i=t.allowFriendDiscovery;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_ALLOW_FRIEND_DISCOVERY.replace("%s",encodeURIComponent(a.userId)),o=new oe;"boolean"==typeof i&&o.add("allow_friend_discovery",i),r.put(s,o,n)}}))}}],[{key:"Path",get:function(){return{USERS:"/users",USERS_USERID:"/users/%s",USERS_USERID_LOGIN:"/users/%s/login",USERS_USERID_SESSION_KEY:"/users/%s/session_key",USERS_USERID_METADATA:"/users/%s/metadata",USERS_USERID_METADATA_KEY:"/users/%s/metadata/%s",USERS_USERID_MARKASREADALL:"/users/%s/mark_as_read_all",USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS:"/users/%s/my_group_channels/changelogs",USERS_USERID_UNREAD_ITEM_COUNT:"/users/%s/unread_item_count",USERS_USERID_UNREAD_MESSAGE_COUNT:"/users/%s/unread_message_count",USERS_USERID_UNREAD_CHANNEL_COUNT:"/users/%s/unread_channel_count",USERS_USERID_PUSH_GCM_TOKEN:"/users/%s/push/gcm/%s",USERS_USERID_PUSH_GCM:"/users/%s/push/gcm",USERS_USERID_PUSH_DEVICE_TOKENS:"/users/%s/push/%s/device_tokens",USERS_USERID_PUSHPREFERENCE_CHANNELURL:"/users/%s/push_preference/%s",USERS_USERID_PUSHPREFERENCE:"/users/%s/push_preference/",USERS_USERID_PUSH_TEMPLATE:"/users/%s/push/template",USERS_USERID_BLOCK:"/users/%s/block",USERS_USERID_BLOCK_TARGETID:"/users/%s/block/%s",USERS_USERID_PUSH_APNS_TOKEN:"/users/%s/push/apns/%s",USERS_USERID_PUSH_APNS:"/users/%s/push/apns",USERS_USERID_PUSH:"/users/%s/push",USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE:"/users/%s/channel_invitation_preference",USERS_USERID_GROUP_CHANNEL_COUNT:"/users/%s/group_channel_count",USERS_COUNT_PREFERENCE:"/users/%s/count_preference/%s",USERS_USERID_ALLOW_FRIEND_DISCOVERY:"/users/%s/allow_friend_discovery",OPENCHANNELS:"/open_channels",OPENCHANNELS_CHANNELURL:"/open_channels/%s",OPENCHANNELS_CHANNELURL_MESSAGES:"/open_channels/%s/messages",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/open_channels/%s/messages/%s",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/open_channels/%s/messages/%s/translation",OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/open_channels/%s/messages/changelogs",OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/open_channels/%s/scheduled_messages",OPENCHANNELS_CHANNELURL_PARTICIPANTS:"/open_channels/%s/participants",OPENCHANNELS_CHANNELURL_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_METADATA:"/open_channels/%s/metadata",OPENCHANNELS_CHANNELURL_METADATA_KEY:"/open_channels/%s/metadata/%s",OPENCHANNELS_CHANNELURL_METACOUNTER:"/open_channels/%s/metacounter",OPENCHANNELS_CHANNELURL_METACOUNTER_KEY:"/open_channels/%s/metacounter/%s",OPENCHANNELS_CHANNELURL_BAN:"/open_channels/%s/ban",OPENCHANNELS_CHANNELURL_BAN_USERID:"/open_channels/%s/ban/%s",OPENCHANNELS_CHANNELURL_MUTE:"/open_channels/%s/mute",OPENCHANNELS_CHANNELURL_MUTE_USERID:"/open_channels/%s/mute/%s",OPENCHANNELS_CHANNELURL_FREEZE:"/open_channels/%s/freeze",OPENCHANNELS_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/open_channels/%s/messages/%s/reactions",GROUPCHANNELS:"/group_channels",MYGROUPCHANNELS:"/users/%s/my_group_channels",GROUPCHANNELS_CHANNELURL:"/group_channels/%s",GROUPCHANNELS_CHANNELURL_INVITE:"/group_channels/%s/invite",GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION:"/group_channels/%s/accept",GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION:"/group_channels/%s/decline",GROUPCHANNELS_CHANNELURL_HIDE:"/group_channels/%s/hide",GROUPCHANNELS_CHANNELURL_LEAVE:"/group_channels/%s/leave",GROUPCHANNELS_CHANNELURL_JOIN:"/group_channels/%s/join",GROUPCHANNELS_CHANNELURL_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_CHANNELURL_MESSAGES:"/group_channels/%s/messages",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD:"/group_channels/%s/messages/mark_as_read",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED:"/group_channels/%s/messages/mark_as_delivered",GROUPCHANNELS_CHANNELURL_MESSAGES_TOTALCOUNT:"/group_channels/%s/messages/total_count",GROUPCHANNELS_CHANNELURL_MESSAGES_UNREADCOUNT:"/group_channels/%s/messages/unread_count",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/group_channels/%s/messages/%s",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/group_channels/%s/messages/%s/translation",GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/group_channels/%s/messages/changelogs",GROUPCHANNELS_CHANNELURL_MESSAGES_GAP:"/group_channels/%s/messages_gap",GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/group_channels/%s/scheduled_messages",GROUPCHANNELS_CHANNELURL_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_METADATA:"/group_channels/%s/metadata",GROUPCHANNELS_CHANNELURL_METADATA_KEY:"/group_channels/%s/metadata/%s",GROUPCHANNELS_CHANNELURL_METACOUNTER:"/group_channels/%s/metacounter",GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY:"/group_channels/%s/metacounter/%s",GROUPCHANNELS_RESET_USER_HISTORY:"/group_channels/%s/reset_user_history",GROUPCHANNELS_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_BAN:"/group_channels/%s/ban",GROUPCHANNELS_CHANNELURL_BAN_USERID:"/group_channels/%s/ban/%s",GROUPCHANNELS_CHANNELURL_MUTE:"/group_channels/%s/mute",GROUPCHANNELS_CHANNELURL_MUTE_USERID:"/group_channels/%s/mute/%s",GROUPCHANNELS_CHANNELURL_FREEZE:"/group_channels/%s/freeze",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/group_channels/%s/messages/%s/reactions",STORAGE_FILE:"/storage/file",STORAGE_PROFILE:"/storage/profile_image",FRIENDS:"/users/%s/friends",FRIENDS_CHANGE_LOGS:"/users/%s/friends/changelogs",FRIENDS_DISCOVERIES:"/users/%s/friend_discoveries",SEARCH_MESSAGE:"/search/messages",REPORT_USERS:"/report/users/%s",REPORT_CHANNELS:"/report/%s/%s",REPORT_MESSAGES:"/report/%s/%s/messages/%s",EMOJIS_EMOJIKEY:"/emojis/%s",EMOJI_CATEGORIES:"/emoji_categories",EMOJI_CATEGORIES_CATEGORYID:"/emoji_categories/%s"}}}]),e}(),de=function(){function e(t,n){d(this,e),this.sb=t,this.ws=null,this.wsHost=null,this.WebSocket=null,this.handler=n||new e.ConnectionHandler,this.explicitDisconnect=!1,this.lastActiveMillis=0;try{this.WebSocket="undefined"==typeof WebSocket?o.default:WebSocket}catch(e){this.WebSocket=WebSocket}}return f(e,[{key:"connect",value:function(e,t,n){var r=this;$.debug("`WebSocketClient.connect` called.");var i=O.get(this.sb._iid).container,a=i.pinger,s=i.auth,o=i.extensions,l=i.getUserAgentWithExtensions,u=i.sessionManager,c=Pi.getAppVersion();this.wsHost=n;try{var d="/?p=JS"+"&pv=".concat(encodeURIComponent(I.OS_VERSION))+"&sv=".concat(encodeURIComponent(I.SDK_VERSION))+"&ai=".concat(encodeURIComponent(this.sb.getApplicationId()));if(c&&(d+="&av=".concat(encodeURIComponent(c))),s.sessionKey?d+="&key=".concat(encodeURIComponent(s.sessionKey)):d+="&user_id=".concat(encodeURIComponent(e),"&access_token=").concat(encodeURIComponent(t)),d+="&active=1",d+="&SB-User-Agent=".concat(encodeURIComponent(l(o))),d+="&Request-Sent-Timestamp=".concat((new Date).getTime().toString()),d+="&include_extra_data=".concat(encodeURIComponent(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash"].join(","))),u.handler&&(d+="&expiring_session=1"),d+="&use_local_cache=1",this.ws=new this.WebSocket(this.wsHost+d),!this.ws)return this.sb.isReconnectingOnError=!0,void this.handler.onError({message:"ws does not exist."})}catch(e){return this.sb.isReconnectingOnError=!0,void this.handler.onError(e)}try{this.sb.getDebugMode()&&"undefined"!=typeof window&&(window.ws=this.ws)}catch(e){$.debug("`window` object does not exist.")}var h=!1;this.ws.onopen=function(e){$.debug("`WebSocket.onopen` called."),r.handler.onOpen(e)},this.ws.onmessage=function(e){r.active();for(var t=e.data.split("\n"),n=0;n<t.length;n++){var i=t[n];if(i&&"string"==typeof i){try{if("PONG"===i.substring(0,4)){a.pong();continue}}catch(e){$.debug("`WebSocket.onmessage` command check error:",e)}r.handler.onMessage(i)}}},this.ws.onerror=function(e){$.debug("`WebSocket.onerror` called:",e),a&&a.stop(),h=!0,r.sb.isReconnectingOnError=!0,r.handler.onError(e)},this.ws.onclose=function(e){$.group("`WebSocket.onclose` called.",[{level:$.supportedLogLevels.DEBUG,messages:["e",e]},{level:$.supportedLogLevels.DEBUG,messages:["explicitDisconnect",r.explicitDisconnect]}]),a&&a.stop(),r.explicitDisconnect?r.handler.onClose(e):h||r.handler.onError(e),r.explicitDisconnect=!1}}},{key:"disconnect",value:function(e,t){$.group("`WebSocketClient.onclose` called.",[{level:$.supportedLogLevels.DEBUG,messages:["explicit",e]}]);var n=O.get(this.sb._iid).container.pinger;n&&n.stop(),this.explicitDisconnect=!0===e,this.ws&&(this.ws.onopen=function(){},this.ws.onmessage=function(){},this.ws.onclose=function(){t&&t()},this.ws.onerror=function(){},this.ws.close(),this.ws=null),this.explicitDisconnect?this.handler.onClose():this.handler.onError(),this.explicitDisconnect=!1}},{key:"send",value:function(e,t){if(1!==this.ws.readyState)t&&t(new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),null);else{var n=O.get(this.sb._iid).container.pinger;this.ws.send(e.encode()),"PING"!==e.command&&n.refreshTimer(),t&&t(null,null)}}},{key:"active",value:function(){this.lastActiveMillis=(new Date).getTime()}},{key:"getConnectionState",value:function(){try{return 1===this.ws.readyState?this.sb.ConnectionState.OPEN:0===this.ws.readyState?this.sb.ConnectionState.CONNECTING:this.sb.ConnectionState.CLOSED}catch(e){return this.sb.ConnectionState.CLOSED}}}]),e}();de.ConnectionHandler=f((function e(){d(this,e),this.onReady=function(){},this.onOpen=function(){},this.onClose=function(){},this.onMessage=function(){},this.onError=function(){}}));var he,fe={},pe=function(){function e(){this._observers=[]}return e.of=function(t){return fe[t]||(fe[t]=new e),fe[t]},e.prototype.invokeConnect=function(){for(var e=0,t=this._observers;e<t.length;e++){var n=t[e];n.onConnect&&n.onConnect()}},e.prototype.invokeDisconnect=function(){for(var e=0,t=this._observers;e<t.length;e++){var n=t[e];n.onDisconnect&&n.onDisconnect()}},e.prototype.addObserver=function(e){this._observers.push(e)},e.prototype.removeObserver=function(e){var t=this._observers.indexOf(e);t>-1&&this._observers.splice(t,1)},e}();!function(e){e[e.EVENT_CHANNEL_CHANGED=0]="EVENT_CHANNEL_CHANGED",e[e.EVENT_USER_RECEIVED_INVITATION=1]="EVENT_USER_RECEIVED_INVITATION",e[e.EVENT_USER_DECLINED_INVITATION=2]="EVENT_USER_DECLINED_INVITATION",e[e.EVENT_USER_JOINED=3]="EVENT_USER_JOINED",e[e.EVENT_USER_LEFT=4]="EVENT_USER_LEFT",e[e.EVENT_CHANNEL_ENTER=5]="EVENT_CHANNEL_ENTER",e[e.EVENT_CHANNEL_EXIT=6]="EVENT_CHANNEL_EXIT",e[e.EVENT_CHANNEL_FROZEN=7]="EVENT_CHANNEL_FROZEN",e[e.EVENT_CHANNEL_UNFROZEN=8]="EVENT_CHANNEL_UNFROZEN",e[e.EVENT_CHANNEL_HIDDEN=9]="EVENT_CHANNEL_HIDDEN",e[e.EVENT_CHANNEL_UNHIDDEN=10]="EVENT_CHANNEL_UNHIDDEN",e[e.EVENT_TYPING_STATUS_UPDATED=11]="EVENT_TYPING_STATUS_UPDATED",e[e.EVENT_OPERATOR_UPDATED=12]="EVENT_OPERATOR_UPDATED",e[e.EVENT_CHANNEL_METADATA_UPDATED=13]="EVENT_CHANNEL_METADATA_UPDATED",e[e.EVENT_CHANNEL_METADATA_DELETED=14]="EVENT_CHANNEL_METADATA_DELETED",e[e.EVENT_CHANNEL_METACOUNTER_UPDATED=15]="EVENT_CHANNEL_METACOUNTER_UPDATED",e[e.EVENT_CHANNEL_METACOUNTER_DELETED=16]="EVENT_CHANNEL_METACOUNTER_DELETED",e[e.EVENT_CHANNEL_DELETED=17]="EVENT_CHANNEL_DELETED",e[e.EVENT_USER_MUTED=18]="EVENT_USER_MUTED",e[e.EVENT_USER_UNMUTED=19]="EVENT_USER_UNMUTED",e[e.EVENT_USER_BANNED=20]="EVENT_USER_BANNED",e[e.EVENT_USER_UNBANNED=21]="EVENT_USER_UNBANNED",e[e.EVENT_MESSAGE_RECEIVED=22]="EVENT_MESSAGE_RECEIVED",e[e.EVENT_MESSAGE_SENT=23]="EVENT_MESSAGE_SENT",e[e.EVENT_MESSAGE_UPDATED=24]="EVENT_MESSAGE_UPDATED",e[e.EVENT_MESSAGE_DELETED=25]="EVENT_MESSAGE_DELETED",e[e.EVENT_READ_RECEIPT_UPDATED=26]="EVENT_READ_RECEIPT_UPDATED",e[e.EVENT_DELIVERY_RECEIPT_UPDATED=27]="EVENT_DELIVERY_RECEIPT_UPDATED",e[e.EVENT_MENTION=28]="EVENT_MENTION",e[e.EVENT_REACTION_UPDATED=29]="EVENT_REACTION_UPDATED",e[e.EVENT_THREAD_INFO_UPDATED=30]="EVENT_THREAD_INFO_UPDATED",e[e.CHANNEL_BACKGROUND=1e3]="CHANNEL_BACKGROUND",e[e.CHANNEL_CHANGELOG=1001]="CHANNEL_CHANGELOG",e[e.MESSAGE_BACKGROUND=1002]="MESSAGE_BACKGROUND",e[e.MESSAGE_FILL=1003]="MESSAGE_FILL",e[e.MESSAGE_CHANGELOG=1004]="MESSAGE_CHANGELOG",e[e.LOCAL_MESSAGE_PENDING_CREATED=2e3]="LOCAL_MESSAGE_PENDING_CREATED",e[e.LOCAL_MESSAGE_FAILED=2001]="LOCAL_MESSAGE_FAILED",e[e.LOCAL_MESSAGE_CANCELED=2002]="LOCAL_MESSAGE_CANCELED",e[e.LOCAL_MESSAGE_RESEND_STARTED=2003]="LOCAL_MESSAGE_RESEND_STARTED",e[e.MESSAGE_COLLECTION_FILTER_MISMATCH=2004]="MESSAGE_COLLECTION_FILTER_MISMATCH"}(he||(he={}));var ge,ye={},me=function(){function e(){this._observers=[]}return e.of=function(t){return ye[t]||(ye[t]=new e),ye[t]},e.prototype.addObserver=function(e){this._observers.push(e)},e.prototype.removeObserver=function(e){var t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)},e.prototype.send=function(e){for(var t=0,n=this._observers;t<n.length;t++)n[t].onevent(e)},e}(),_e=function(){function e(t){d(this,e),this.sb=t,this.cls=j.get(this.sb._iid),this.client=new de(this.sb),this.connectParams={retryCount:1},this.reconnectParams={interval:3,retryCount:3,multiplier:2,maxInterval:24},this.connectCount=0,this.reconnectCount=0,this.reconnectDelay=0}return f(e,[{key:"isConnected",get:function(){return this.client&&this.client.getConnectionState()===this.sb.ConnectionState.OPEN}},{key:"connect",value:function(e,t){var n=this,r=O.get(this.sb._iid).container,i=r.auth,a=r.apiClient,s=r.commandHandler;i.sessionToken=t||null;var o=this.cls.GroupChannel,l=null,u=new de.ConnectionHandler;this.client=new de(this.sb,u),u.onMessage=function(e){s.onRawCommandReceived(e)},this.sb.loginHandler=function(e,t){if(n.sb.connecting=!1,n.sb.reconnecting=!1,e)n.disconnect({clearSession:!0,err:e},null);else{clearInterval(n.sb.globalTimer);var r=me.of(n.sb._iid),i=function(){o.cachedChannels&&Object.keys(o.cachedChannels).forEach((function(e){var t=o.cachedChannels[e];t.invalidateTypingStatus()&&(Object.keys(n.sb.channelHandlers).forEach((function(e){n.sb.channelHandlers[e].onTypingStatusUpdated(t)})),r.send({source:he.EVENT_TYPING_STATUS_UPDATED,payload:{channel:t}}))}))};i(),n.sb.globalTimer=setInterval((function(){return i()}),1e3),n.flushConnectionCallbacks(null,t),n.sb.ConnectionManager.processAllReadyHandler(null)}},u.onOpen=function(){n.connectCount=0,n.sb.loginTimer=setTimeout((function(){n.sb.loginTimer=null,n.sb.onLoginTimerCancel=null,n.flushConnectionCallbacks(new F("Connection timeout.",F.LOGIN_TIMEOUT),null),n.sb.disconnect(null)}),n.sb.Options.websocketResponseTimeout),n.sb.onLoginTimerCancel=function(){n.connectCount=0,n.flushConnectionCallbacks(new F("Connection has been canceled.",F.REQUEST_FAILED),null)},n.sb.connecting=!1},u.onError=function(r){if($.debug("Connect: `WebSocketClient.ConnectionHandler.onError` called.",r),i.sessionKey)n.sb.isReconnectingOnError=!0,n.sb.ConnectionManager.errorAllReadyHandler(),n.reconnect(e,!0),n.sb.connecting=!1;else if(n.connectCount<n.connectParams.retryCount)n.connectCount++,n.client.connect(e,t,l);else{var a=r?r.message:"Unknown error occurred.";n.connectCount=0,n.flushConnectionCallbacks(new F("Websocket connection failed. ".concat(a),F.WEBSOCKET_CONNECTION_FAILED),null),n.sb.connecting=!1}},u.onClose=function(){$.debug("Connect: `WebSocketClient.ConnectionHandler.onClose` called."),n.connectCount=0,n.sb.connecting=!1},a.checkRouting((function(r,i){if(r)return n.sb.connecting=!1,void n.flushConnectionCallbacks(new F("Connection routing failed.",F.REQUEST_FAILED),null);l=i.wsHost,a.dummyCall((function(e){e&&$.error("API dummy call failed:",e)})),n.client.connect(e,t,l)}))}},{key:"reconnect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=O.get(this.sb._iid).container,i=r.auth,a=r.apiClient,s=r.commandHandler,o=r.ackStateMap,l=r.sessionManager,u=this.cls.OpenChannel;if(this.sb.connecting=!1,this.sb.reconnecting=!0,this.sb.reconnectTimer)$.debug("Reconnect: still reconnecting.");else{if(this.reconnectCount+=1,this.reconnectCount<=1?(n&&(Object.keys(o).forEach((function(e){var t=o[e];t&&(clearTimeout(t.timer),(0,t.handler)(new F("Command received no ack.",F.ACK_TIMEOUT),null)),delete o[e]})),pe.of(this.sb._iid).invokeDisconnect(),Object.keys(this.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectStarted()}))),this.reconnectDelay=0):this.reconnectDelay=Math.min(1e3*this.reconnectParams.interval*Math.pow(this.reconnectParams.multiplier,this.reconnectCount-2),this.reconnectParams.maxInterval>0?1e3*this.reconnectParams.maxInterval:Number.MAX_SAFE_INTEGER),!e||!i.sessionKey||this.reconnectParams.retryCount>0&&this.reconnectCount>this.reconnectParams.retryCount)return this.disconnect({clearSession:!1,err:new F("Websocket connection failed with a number of retries.",F.WEBSOCKET_CONNECTION_FAILED)},null),this.reconnectCount=0,Object.keys(this.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectFailed()})),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1,void this.sb.ConnectionManager.errorAllReadyHandler();this.sb.onReconnectTimerCancel=function(){t.reconnectCount=0},this.sb.reconnectTimer=setTimeout((function(){t.sb.reconnectTimer=null,t.sb.onReconnectTimerCancel=null,t.client&&t.client.disconnect(!0);var n=new de.ConnectionHandler;t.client=new de(t.sb,n),t.sb.loginHandler=function(n,r){n?l.isSessionError(n)?l.refreshSessionIfExpiredError(n).then((function(){clearTimeout(t.sb.reconnectTimer),t.sb.reconnectTimer=null,t.reconnectCount=0,t.reconnect(e,!1)})).catch((function(){})):(clearTimeout(t.sb.reconnectTimer),t.sb.reconnectTimer=null,t.reconnect(e,!1)):(t.reconnectCount=0,t.sb.connecting=!1,t.sb.reconnecting=!1,t.sb.isReconnectingOnError=!1,pe.of(t.sb._iid).invokeConnect(),Object.keys(t.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectSucceeded()})),t.sb.ConnectionManager.processAllReadyHandler(null),t.sb.isReconnectingOnError&&Object.keys(t.sb.ConnectionManager.networkHandlers).forEach((function(e){t.sb.ConnectionManager.networkHandlers[e].onReconnected()})),Object.keys(u.enteredChannels).forEach((function(e){u.enteredChannels[e].enter((function(n,r){if(n){var i=t.cls.FileMessageQueue;delete u.enteredChannels[e],i.delete(e)}}))})))},n.onOpen=function(){$.debug("Reconnect: `WebSocketClient.ConnectionHandler.onOpen` called."),t.sb.loginTimer=setTimeout((function(){$.debug("Reconnect: `loginTimer` timeout."),t.sb.loginTimer=null,t.reconnect(e,!0)}),t.sb.Options.websocketResponseTimeout),t.sb.onLoginTimerCancel=null},n.onMessage=function(e){s.onRawCommandReceived(e)},n.onError=function(n){$.debug("Reconnect: `WebSocketClient.ConnectionHandler.onError` called.",n),t.sb.isReconnectingOnError=!0,t.sb.ConnectionManager.errorAllReadyHandler(),t.reconnect(e,!0)},n.onClose=function(){$.debug("Reconnect: `WebSocketClient.ConnectionHandler.onClose` called."),t.sb.reconnecting=!1},a.checkRouting((function(n,r){n?t.reconnect(e,!0):(t.sb.getCurrentApiHost()!==r.apiHost&&a.get("/",null,(function(){})),t.client.connect(e,null,r.wsHost))}))}),this.reconnectDelay)}}},{key:"disconnect",value:function(e,t){var n=O.get(this.sb._iid),r=n.container.ackStateMap,i=this.cls,a=i.GroupChannel,s=i.OpenChannel,o=e.clearSession,l=e.err;this.sb.loginTimer&&(clearTimeout(this.sb.loginTimer),this.sb.onLoginTimerCancel&&(this.sb.onLoginTimerCancel(),this.sb.onLoginTimerCancel=null),this.sb.loginTimer=null),this.sb.reconnectTimer&&(clearTimeout(this.sb.reconnectTimer),this.sb.onReconnectTimerCancel&&(this.sb.onReconnectTimerCancel(),this.sb.onReconnectTimerCancel=null),this.sb.reconnectTimer=null),this.client&&(this.reconnectCount=0,this.client.disconnect(!0),this.client=null),Object.keys(r).forEach((function(e){var t=r[e];t&&(clearTimeout(t.timer),(0,t.handler)(new F("WebSocket connection must be made first.",F.WEBSOCKET_CONNECTION_CLOSED),null))})),n.set("ackStateMap",{}),o&&(s.clearEnteredChannels(),s.clearCache(),a.clearCache(),this.sb.globalTimer&&(clearInterval(this.sb.globalTimer),this.sb.globalTimer=null),this.sb.currentUser=null,n.set("subscribedUnreadMessageCount",{all:0,custom_types:{},ts:0}),n.set("auth",new H)),l&&(this.flushConnectionCallbacks(l,null),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1),t&&t(null,null)}},{key:"flushConnectionCallbacks",value:function(e,t){var n=this,r=O.get(this.sb._iid).container,i=r.store,a=r.localCacheEnabled,s=this.sb.connectionCallbacks;if(this.sb.connectionCallbacks=[],e)if(a){var o=this.sb._getCurrentUserDataKey();se.isNonAutoReconnectableError(e.code)?i.remove(o).catch((function(e){return $.debug("Sendbird connect store remove error: ",e)})).finally((function(){return s.forEach((function(t){return t(e,null)}))})):i.get(o).then((function(e){n.sb._populateVaultFromCurrentUserData(e)})).catch((function(e){$.debug("Sendbird connect store fetch error: ",e)})).finally((function(){n.sb.currentUser?s.forEach((function(t){return t(e,n.sb.currentUser)})):s.forEach((function(t){return t(e,null)}))}))}else s.forEach((function(t){return t(e,null)}));else pe.of(this.sb._iid).invokeConnect(),a?i.set({key:this.sb._getCurrentUserDataKey(),value:this._createCurrentUserData(t),generation:1}).catch((function(e){return $.debug("Sendbird connect store write error: ",e)})).finally((function(){return s.forEach((function(e){return e(null,n.sb.currentUser)}))})):s.forEach((function(e){return e(null,t)}))}},{key:"_createCurrentUserData",value:function(e){var t=O.get(this.sb._iid).container,n=t.auth,r=t.maxUnreadCountOfSuperGroupChannel,i=t.profileImageEncryption,a=t.appInfo,s=t.connectedAt,o=t.firstConnectedAt,l=t.concurrentCallLimit,u=t.backOffDelay,c={currentUser:(e||this.sb.currentUser).serialize(),maxUnreadCountOfSuperGroupChannel:I.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,profileImageEncryption:!1};return n.sessionKey&&(c.sessionKey=n.sessionKey),n.eKey&&(c.eKey=n.eKey),r&&(c.maxUnreadCountOfSuperGroupChannel=r),i&&(c.profileImageEncryption=i),a&&(c.appInfo=a._objectify()),s&&o&&(c.connectedAt=s,c.firstConnectedAt=o),l&&u&&(c.concurrentCallLimit=l,c.backOffDelay=u),c}}]),e}(),ve=function(){function e(t){var n=t.type,r=t.nullable,i=void 0!==r&&r,a=t.optional,s=void 0!==a&&a,o=t.optionalIf,l=void 0===o?null:o,u=t.ignoreIf,c=void 0===u?null:u,h=t.defaultValue,f=void 0===h?null:h,p=t.constraint,g=void 0===p?null:p;d(this,e),this.type=n,this.nullable=i,this.optional=s,this.optionalIf=l,this.ignoreIf=c,this.defaultValue=f,this.constraint=g}return f(e,[{key:"isMatchingType",value:function(e){var t=function(t,n){return"string"==typeof n?c(t)===n||"array"===n&&Array.isArray(t)||"file"===n&&se.isFile(t)||"null"===n&&null===t||"date"===n&&t instanceof Date:"function"==typeof n?t instanceof n:"object"===c(n)&&Object.keys(n).map((function(e){return n[e]})).indexOf(e)>-1};return t(e,this.type)||Array.isArray(this.type)&&this.type.some((function(n){return t(e,n)}))||this.nullable&&null===e}}],[{key:"parse",value:function(t,n){for(t=e.toArray(t);t.length>0&&void 0===t[t.length-1];)t.pop();var r=!1,i=null;"callback"===n[n.length-1].type&&("function"==typeof t[t.length-1]&&(i=t.pop()),n.pop(),r=!0);var a=[],s=null,o=0;return n.forEach((function(n){"function"==typeof n.ignoreIf&&n.ignoreIf(t)?a.push(n.hasOwnProperty("defaultValue")?n.defaultValue:null):n.isMatchingType(t[o])?(n.nullable&&null===t[o]||!n.constraint||n.constraint(t[o])||(s=e.error),a.push(t[o]),o++):n.optional||"function"==typeof n.optionalIf&&n.optionalIf(t)?a.push(n.hasOwnProperty("defaultValue")?n.defaultValue:null):(s=e.error,a.push(t[o]),o++)})),r&&i&&a.push(i),t.length!==o&&(s=e.error),[s].concat(a)}},{key:"error",get:function(){return new F("Invalid parameter.",F.INVALID_PARAMETER)}},{key:"toArray",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}}]),e}(),Ee=function(){function e(t){d(this,e),this.sb=t,this.authCount=0,this.readyHandlers=[],this.networkHandlers={},this.authenticateTimer=1e4,this.authInfoRequester=null}return f(e,[{key:"addReadyHandler",value:function(e){e&&"function"==typeof e&&this.readyHandlers.push(e)}},{key:"ready",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=O.get(this.sb._iid).container,r=n.auth,i=n.isInBackground;t&&r.hasSession()?e&&(this.sb.currentUser?e(null,this.sb.currentUser):(this.addReadyHandler(e),this.errorAllReadyHandler()),this.sb.getConnectionState()!==this.sb.ConnectionState.CLOSED||i||this.sb.reconnect()):(this.addReadyHandler(e),this.sb.isReconnectingOnError?this.errorAllReadyHandler():this.sb.getConnectionState()===this.sb.ConnectionState.OPEN?this.processAllReadyHandler(null):this.sb.getConnectionState()===this.sb.ConnectionState.CONNECTING||this.errorAllReadyHandler())}},{key:"processAllReadyHandler",value:function(e){if(this.readyHandlers.length>0){var t=this.sb.currentUser,n=this.readyHandlers;this.readyHandlers=[],n.forEach((function(n){n&&"function"==typeof n&&n(e,t)}))}}},{key:"errorAllReadyHandler",value:function(){var e=O.get(this.sb._iid).container.auth;this.processAllReadyHandler(e&&e.hasSession()?new F("WebSocket connection must be made first.",F.WEBSOCKET_CONNECTION_CLOSED):new F("Connection should be made first.",F.CONNECTION_REQUIRED))}},{key:"NetworkHandler",value:function(){this.onReconnected=function(){}}},{key:"addNetworkHandler",value:function(e,t){$.warn("`ConnectionManager` will be deprecated."),this.networkHandlers[e]=t}},{key:"removeNetworkHandler",value:function(e){$.warn("`ConnectionManager` will be deprecated."),delete this.networkHandlers[e]}},{key:"removeAllNetworkHandler",value:function(){$.warn("`ConnectionManager` will be deprecated."),this.networkHandlers={}}},{key:"authenticate",value:function(e){var t=this;if($.warn("`ConnectionManager` will be deprecated."),this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnecting)this.sb.connecting=!1,e(null,this.sb.currentUser);else if(this.authInfoRequester&&"function"==typeof this.authInfoRequester){this.sb.connecting=!0,this.authCount++;var n=setTimeout((function(){n=null,t.authCount--,0===t.authCount&&0===t.sb.connectionCallbacks.length&&(t.sb.connecting=!1),t.errorAllReadyHandler(),e(new F("Connection should be made first.",F.CONNECTION_REQUIRED),null)}),this.authenticateTimer);this.authInfoRequester((function(r){if(n){clearTimeout(n),n=null,t.authCount--;var i=function(n,r){t.sb.connecting=!1,e(n,null)};r&&r.hasOwnProperty("userId")?r.accessToken?r.apiHost&&r.wsHost?t.sb.connect(r.userId,r.accessToken,r.apiHost,r.wsHost,i):t.sb.connect(r.userId,r.accessToken,i):r.apiHost&&r.wsHost?t.sb.connect(r.userId,r.apiHost,r.wsHost,i):t.sb.connect(r.userId,i):e(ve.error,null)}}))}else e(ve.error,null)}}]),e}(),be=function(){this.onSessionExpired=function(){},this.onSessionTokenRequired=function(e,t){return e(null)},this.onSessionError=function(e){},this.onSessionRefreshed=function(){},this.onSessionClosed=function(){}},Ce=function(){function e(){d(this,e),this.handler=null,this.resolvers=[]}return f(e,[{key:"_refreshSessionToken",value:function(){var t=this;return new Promise((function(n,r){var i=null,a=function(){i&&(clearTimeout(i),i=null)},s=function(){i&&(a(),r(e.sessionTokenRequestFailedError))};i=setTimeout((function(){return s()}),3e4),t.handler.onSessionTokenRequired((function(e){i&&(a(),n(e))}),s)}))}},{key:"_refreshSessionKey",value:function(){var t=this;return new Promise((function(n,r){var i=O.get(t._iid).container,a=i.auth,s=i.wsAdapter;a.sessionToken?s.isConnected?t._refreshSessionKeyByCommand().then((function(){return n()})).catch((function(e){e.isSessionTokenExpiredError?r(e):t._refreshSessionKeyByApi().then((function(){return n()})).catch((function(e){return r(e)}))})):t._refreshSessionKeyByApi().then((function(){return n()})).catch((function(e){return r(e)})):r(e.sessionTokenNotFoundError)}))}},{key:"_refreshSessionKeyByCommand",value:function(){var t=this;return new Promise((function(n,r){var i=Pi.getInstance(t._iid),a=O.get(t._iid).container.auth,s=j.get(t._iid).Command,o=s.bSessionRefresh({token:a.sessionToken,requestId:s.generateRequestId()});i.sendCommand(o,(function(t,s){if(!i.getErrorFirstCallback()){var o=[t,s];s=o[0],t=o[1]}t?r(t):s?s.hasOwnProperty("error")?r(e.sessionKeyRefreshFailedError):(s.hasOwnProperty("new_key")&&(a.sessionKey=s.new_key),n()):r(e.sessionKeyRefreshFailedError)}))}))}},{key:"_refreshSessionKeyByApi",value:function(){var t=this;return new Promise((function(n,r){!function i(a){if(a<3){var s=O.get(t._iid).container,o=s.auth,l=s.apiClient,u={};o.sessionToken&&(u.accessToken=o.sessionToken),l.refreshSessionKey(u,(function(e,t){if(e)e.isSessionTokenExpiredError||e.isSessionTokenRevokedError?r(e):i(a+1);else{var s=t.key;o.sessionKey=s,n()}}))}else r(e.sessionKeyRefreshFailedError)}(0)}))}},{key:"_handleSessionToken",value:function(t){var n=this;t?(O.get(this._iid).container.auth.sessionToken=t,this._refreshSessionKey().then((function(){return n._handleSessionRefreshSuccess()})).catch((function(){return n._handleSessionRefreshError(e.sessionTokenRequestFailedError)}))):this._handleSessionClosed(e.sessionTokenRequestFailedError)}},{key:"_handleSessionRefreshSuccess",value:function(){this.handler.onSessionRefreshed(),this._flushResolvers(null)}},{key:"_handleSessionRefreshError",value:function(e){this._cancelConnection(),this.handler.onSessionError(e),this._flushResolvers(e)}},{key:"_handleSessionClosed",value:function(e){this._cancelConnection(),this.handler.onSessionClosed(),this._flushResolvers(e)}},{key:"_cancelConnection",value:function(){var e=Pi.getInstance(this._iid);e.reconnecting&&(Object.keys(e.connectionHandlers).forEach((function(t){e.connectionHandlers[t].onReconnectFailed()})),e.reconnecting=!1),e.disconnect()}},{key:"_flushResolvers",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;n<this.resolvers.length;n++)e?this.resolvers[n].reject(e):this.resolvers[n].resolve(t);this.resolvers=[]}},{key:"setHandler",value:function(e){e instanceof be&&(this.handler=e)}},{key:"isSessionError",value:function(e){return e.isSessionTokenExpiredError||e.isSessionTokenRevokedError||e.isSessionKeyExpiredError}},{key:"refreshSessionToken",value:function(){var t=this;return new Promise((function(n,r){t.handler?(t.resolvers.push({resolve:n,reject:r}),1===t.resolvers.length&&t._refreshSessionToken().then((function(e){return t._handleSessionToken(e)})).catch((function(){return t._handleSessionRefreshError(e.sessionTokenRequestFailedError)}))):n()}))}},{key:"refreshSessionKey",value:function(){var e=this;return new Promise((function(t,n){e.handler?(e.resolvers.push({resolve:t,reject:n}),1===e.resolvers.length&&e._refreshSessionKey().then((function(){return e._handleSessionRefreshSuccess()})).catch((function(t){t.isSessionTokenExpiredError?e._refreshSessionToken().then((function(t){return e._handleSessionToken(t)})).catch((function(t){return e._handleSessionRefreshError(t)})):t.isSessionTokenRevokedError?e._handleSessionClosed(t):e._handleSessionRefreshError(t)}))):t()}))}},{key:"refreshSessionIfExpiredError",value:function(e){var t=this;return e.isSessionTokenExpiredError?this.refreshSessionToken():e.isSessionKeyExpiredError?this.refreshSessionKey():e.isSessionTokenRevokedError?new Promise((function(e,n){return n(t.closeSession())})):Promise.reject(e)}},{key:"closeSession",value:function(){var t=e.sessionTokenRequestFailedError;return this._handleSessionClosed(t),t}}],[{key:"sessionTokenNotFoundError",get:function(){return new F("Session token is not found.",F.SESSION_TOKEN_EXPIRED)}},{key:"sessionTokenExpiredError",get:function(){return new F("Session token is expired.",F.SESSION_TOKEN_EXPIRED)}},{key:"sessionKeyRefreshFailedError",get:function(){return new F("Failed to refresh the session key.",F.SESSION_KEY_REFRESH_FAILED)}},{key:"sessionTokenRequestFailedError",get:function(){return new F("Failed to get the session token.",F.SESSION_TOKEN_REQUEST_FAILED)}}]),e}(),Se=function(){function e(e){var t=this;this.sb=e,this.unsubscribes=[],this.isOnline=!1,this.onlineWorker=function(){t.isOnline=!0;var e=O.get(t.sb._iid).container.auth;t.sb.reconnecting||t.sb.connecting||!e.sessionKey||t.sb.getConnectionState()===t.sb.ConnectionState.OPEN||t.sb.reconnect()},this.offlineWorker=function(){t.isOnline=!1,t.sb.setIsProcessingAutoResend(!1);var e=O.get(t.sb._iid).container,n=e.auth,r=e.pinger;t.sb.reconnecting||t.sb.connecting||!n.sessionKey||(r&&r.stop(),t.sb.reconnect())},this.onlineListener=function(e){try{if("undefined"!=typeof window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&"boolean"==typeof navigator.onLine)return window.addEventListener("online",e),function(){return window.removeEventListener("online",e,!1)}}catch(e){$.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}return function(){}},this.offlineListener=function(e){try{if("undefined"!=typeof window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&"boolean"==typeof navigator.onLine)return window.addEventListener("offline",e),function(){return window.removeEventListener("offline",e,!1)}}catch(e){$.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}return function(){}},this.setOnlineListener=function(e){Boolean(e)&&"function"==typeof e&&(t.onlineListener=e)},this.setOfflineListener=function(e){Boolean(e)&&"function"==typeof e&&(t.offlineListener=e)},this.sb=e,"undefined"!=typeof window&&"undefined"!=typeof navigator&&"boolean"==typeof navigator.onLine&&(this.isOnline=window.navigator.onLine)}return e.prototype.start=function(){this.unsubscribes=[this.onlineListener(this.onlineWorker),this.offlineListener(this.offlineWorker)]},e.prototype.stop=function(){this.unsubscribes.forEach((function(e){try{null==e||e()}catch(e){}}))},e}(),Ne=(new Date).getTime(),Ae=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(d(this,e),this.command=t,this.requestId=r,arguments.length){case 1:if(!t||t.length<=4)this.command="NOOP",this.payload="{}";else if(this.decode(t),this.isRequestIdCommand){var i=this.getJsonElement();i&&(this.requestId=i.req_id||"")}break;case 2:case 3:!this.requestId&&this.isRequestIdCommand&&(this.requestId=e.generateRequestId()),n.req_id=this.requestId||"",this.payload=JSON.stringify(n)}}return f(e,[{key:"isRequestIdCommand",get:function(){return this.isAckRequired||"EROR"===this.command}},{key:"isAckRequired",get:function(){return"LOGI"===this.command||"MESG"===this.command||"FILE"===this.command||"ENTR"===this.command||"EXIT"===this.command||"READ"===this.command||"MEDI"===this.command||"FEDI"===this.command}},{key:"encode",value:function(){return this.command+this.payload+"\n"}},{key:"decode",value:function(e){e=e.trim(),this.command=e.substring(0,4),this.payload=e.substring(4)}},{key:"getJsonElement",value:function(){return JSON.parse(this.payload)}}],[{key:"bSessionRefresh",value:function(e){return new this("LOGI",{token:e.token,expiring_session:1},e.requestId)}},{key:"bPing",value:function(){return new this("PING",{id:(new Date).getTime(),active:1})}},{key:"bMessage",value:function(e){var t=e.channelUrl,n=e.message,r=e.data,i=e.customType,a=e.metaArrays,s=e.mentionType,o=e.mentionedUserIds,l=e.mentionedMessageTemplate,u=e.translationTargetLanguages,c=e.pushNotificationDeliveryOption,d=e.appleCriticalAlertOptions,h=e.requestId,f=void 0===h?null:h,p=e.silent,g=void 0!==p&&p,y=e.rootMessageId,m=void 0===y?null:y,_=e.parentMessageId,v=void 0===_?null:_,E=e.isReplyToChannel,b=void 0!==E&&E,C=j.get(this._iid),S=C.UserMessageParams,N=C.BaseMessageParams,A={};return A.channel_url=t,A.message=n,A.data=r,a&&a.length>0&&(A.metaarray=a.map((function(e){return e.encode()}))),s&&(A.mention_type=s),A.mentioned_user_ids=[],s===N.MentionType.CHANNEL?A.mentioned_user_ids=[]:Array.isArray(o)&&o.length>0&&(A.mentioned_user_ids=o),l&&(A.mentioned_message_template=l),i&&(A.custom_type=i),u&&u.length>0&&(A.target_langs=u),c&&c!==S.PushNotificationDeliveryOption.DEFAULT&&(A.push_option=c),d&&(A.apple_critical_alert_options=d.serialize()),g&&(A.silent=g),m&&(A.root_message_id=m),v&&(A.parent_message_id=v),b&&(A.reply_to_channel=b),new this("MESG",A,f)}},{key:"bFile",value:function(e){var t=e.channelUrl,n=e.url,r=e.name,i=e.type,a=e.size,s=e.data,o=e.customType,l=e.thumbnailSizes,u=e.requireAuth,c=e.metaArrays,d=e.mentionType,h=e.mentionedUserIds,f=e.pushNotificationDeliveryOption,p=e.appleCriticalAlertOptions,g=e.requestId,y=void 0===g?null:g,m=e.silent,_=void 0!==m&&m,v=e.rootMessageId,E=void 0===v?null:v,b=e.parentMessageId,C=void 0===b?null:b,S=e.isReplyToChannel,N=void 0!==S&&S,A=j.get(this._iid),k=A.BaseMessageParams,T=A.FileMessageParams,I={};return I.channel_url=t,I.url=n,I.name=r||"",I.type=i||"",I.size=a||0,I.custom=s,o&&(I.custom_type=o),l&&(I.thumbnails=l),u&&(I.require_auth=u),c&&c.length>0&&(I.metaarray=c.map((function(e){return e.encode()}))),d&&(I.mention_type=d),I.mentioned_user_ids=[],d===k.MentionType.CHANNEL?I.mentioned_user_ids=[]:Array.isArray(h)&&h.length>0&&(I.mentioned_user_ids=h),f&&f!==T.PushNotificationDeliveryOption.DEFAULT&&(I.push_option=f),p&&(I.apple_critical_alert_options=p.serialize()),_&&(I.silent=_),E&&(I.root_message_id=E),C&&(I.parent_message_id=C),N&&(I.reply_to_channel=N),new this("FILE",I,y)}},{key:"bUpdateUserMessage",value:function(e){var t=e.channelUrl,n=e.messageId,r=e.appleCriticalAlertOptions,i=e.message,a=void 0===i?null:i,s=e.data,o=void 0===s?null:s,l=e.customType,u=void 0===l?null:l,c=e.mentionType,d=void 0===c?null:c,h=e.mentionedUserIds,f=void 0===h?null:h,p=e.mentionedMessageTemplate,g=void 0===p?null:p,y=e.metaArrayParams,m=void 0===y?null:y,_=j.get(this._iid).BaseMessageParams,v={};return v.channel_url=t,v.msg_id=n,null!=a&&void 0!==a&&(v.message=a),null!=o&&void 0!==o&&(v.data=o),null!=u&&void 0!==u&&(v.custom_type=u),d&&(v.mention_type=d),d===_.MentionType.CHANNEL?v.mentioned_user_ids=[]:Array.isArray(f)&&f.length>=0&&(v.mentioned_user_ids=f),g&&(v.mentioned_message_template=g),m&&(v.metaarray=m),r&&(v.apple_critical_alert_options=r.serialize()),new this("MEDI",v)}},{key:"bUpdateFileMessage",value:function(e){var t=e.channelUrl,n=e.messageId,r=e.appleCriticalAlertOptions,i=e.data,a=void 0===i?null:i,s=e.customType,o=void 0===s?null:s,l=e.mentionType,u=void 0===l?null:l,c=e.mentionedUserIds,d=void 0===c?null:c,h=e.metaArrayParams,f=void 0===h?null:h,p=j.get(this._iid).BaseMessageParams,g={};return g.channel_url=t,g.msg_id=n,null!=a&&void 0!==a&&(g.data=a),null!=o&&void 0!==o&&(g.custom_type=o),u&&(g.mention_type=u),u===p.MentionType.CHANNEL?g.mentioned_user_ids=[]:Array.isArray(d)&&d.length>=0&&(g.mentioned_user_ids=d),f&&(g.metaarray=f),r&&(g.apple_critical_alert_options=r.serialize()),new this("FEDI",g)}},{key:"bRead",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("READ",n)}},{key:"bMessageAck",value:function(e){var t=e.channelUrl,n=e.messageId,r={};return r.channel_url=t,r.msg_id=n,new this("MACK",r)}},{key:"bTypeStart",value:function(e){var t=e.channelUrl,n=e.time,r={};return r.channel_url=t,r.time=n,new this("TPST",r)}},{key:"bTypeEnd",value:function(e){var t=e.channelUrl,n=e.time,r={};return r.channel_url=t,r.time=n,new this("TPEN",r)}},{key:"bEnter",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("ENTR",n)}},{key:"bExit",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("EXIT",n)}},{key:"generateRequestId",value:function(){return Ne++,String(Ne)}}]),e}(),ke=1048576,Te=function(){function e(e){void 0===e&&(e={}),this._emojiHash=e.emoji_hash||"",this._uploadSizeLimit=e.file_upload_size_limit?e.file_upload_size_limit*ke:Number.MAX_VALUE,this._useReaction=!!e.use_reaction,this._applicationAttributes=e.application_attributes||[],this._premiumFeatureList=e.premium_feature_list||[],this._disableSupergroupMack=e.disable_supergroup_mack||!1}return Object.defineProperty(e.prototype,"emojiHash",{get:function(){return this._emojiHash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uploadSizeLimit",{get:function(){return this._uploadSizeLimit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUsingReaction",{get:function(){return this._useReaction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationAttributes",{get:function(){return this._applicationAttributes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"premiumFeatureList",{get:function(){return this._premiumFeatureList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupergroupMackDisabled",{get:function(){return this._disableSupergroupMack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enabledChannelMemberShipHistory",{get:function(){return this._applicationAttributes.includes("channel_membership_history")},enumerable:!1,configurable:!0}),e.prototype._objectify=function(){var e={};return e.emoji_hash=this._emojiHash,this._uploadSizeLimit!==Number.MAX_VALUE&&(e.file_upload_size_limit=this._uploadSizeLimit/ke),e.use_reaction=this._useReaction,e.application_attributes=this._applicationAttributes,e.premium_feature_list=this._premiumFeatureList,e.disable_supergroup_mack=this._disableSupergroupMack,e},e}(),Ie=function(){function e(e){this._source=e}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFromEvent",{get:function(){return this._source>=2e3},enumerable:!1,configurable:!0}),e}(),we=function(e){return L(void 0,void 0,void 0,(function(){return P(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},Oe=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},Ue=new Map,Re=new Map,Me=function(){function e(t){var n=t.key,r=t.concurrentCallLimit,i=void 0===r?2:r,a=t.backOffDelay,s=void 0===a?0:a;this._holdersKey=e.createSemaphoreHoldersKey(n),this._resolversKey=e.createSemaphoreResolversKey(n),this._numLocks=i,this._backOffDelay=s,this.holders||(this.holders=[]),this.resolvers||(this.resolvers=[])}return e.createSemaphoreHoldersKey=function(e){return"collection@semaphore_holders_for:"+e},e.createSemaphoreResolversKey=function(e){return"collection@semaphore_resolvers_for:"+e},e.createChainProcessStateKey=function(e){return"collection@semaphore_chain_process_state_for:"+e},Object.defineProperty(e.prototype,"numLocksAvailable",{get:function(){return this._numLocks-this.holders.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolvers",{get:function(){return Re[this._resolversKey]},set:function(e){Re[this._resolversKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"holders",{get:function(){return Ue[this._holdersKey]},set:function(e){Ue[this._holdersKey]=e},enumerable:!1,configurable:!0}),e.prototype.tryObtainLock=function(){this.numLocksAvailable>0&&this.resolvers.length>0&&this.giveLockToFirstResolver()},e.prototype.giveLockToFirstResolver=function(){var e=this.resolvers.shift();this.holders=D(D([],this.holders,!0),[e.key],!1),e.resolver(e.key)},e.prototype.queueForLock=function(){return L(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){return[2,new Promise((function(t){var n={key:Oe(),resolver:function(e){return t(e)}};e.resolvers.push(n),e.tryObtainLock()}))]}))}))},e.prototype.releaseLock=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return(t=this.holders.indexOf(e))>=0?(this.holders.splice(t,1),[4,we(this._backOffDelay)]):[3,2];case 1:n.sent(),this.tryObtainLock(),n.label=2;case 2:return[2]}}))}))},e}();!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"}(ge||(ge={}));var Le,Pe=function(){},De=function(){function e(e,t,n,r){void 0===n&&(n=2),void 0===r&&(r=10),this._worker=null,this._state=ge.IDLE,this._retryCount=0,this._retryLimit=3,this._isPaused=!1,this.onProgress=Pe,this.onStop=Pe,this.onError=Pe,this.onEnd=Pe,this._key=e,this._worker=t,this._semaphore=new Me({key:e,concurrentCallLimit:n,backOffDelay:r})}return Object.defineProperty(e.prototype,"isIdle",{get:function(){return this._state===ge.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._state===ge.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDone",{get:function(){return this._state===ge.END},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return this._isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),e.prototype.resume=function(e,t){return void 0===t&&(t=!1),this._isPaused=!1,this.isDone&&t&&(this._state=ge.IDLE),this.run(e)},e.prototype.run=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return this._isPaused||!this.isIdle?[3,5]:(t=this,[4,this._semaphore.queueForLock()]);case 1:t._key=i.sent(),this._state=ge.RUNNING,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._worker(e)];case 3:return n=i.sent(),this._retryCount=0,this.onProgress(n),n.hasNext?(this._state=ge.IDLE,this._isPaused?(this._semaphore.releaseLock(this._key),this.onStop()):(this.run(n.nextParams),this._semaphore.releaseLock(this._key))):(this._state=ge.END,this._semaphore.releaseLock(this._key),this.onEnd(),this._isPaused&&this.onStop()),[3,5];case 4:return r=i.sent(),$.warn("Collection sync run error: ",r),this._state=ge.IDLE,this._semaphore.releaseLock(this._key),this.onError(r),this._retryCount<this._retryLimit?(this._retryCount++,$.debug("Failed collection sync retry count: ",this._retryCount),this.run(e)):($.debug("Failed collection sync all retries failed."),this.stop(),this.onStop()),[3,5];case 5:return[2]}}))}))},e.prototype.stop=function(){this._isPaused=!0},e}(),xe=function(){function e(e){var t=e.top,n=e.bottom;this.top=t,this.bottom=n}return e.prototype.include=function(e){return this.top<=e&&e<=this.bottom},e.prototype.overlap=function(e){return this.include(e.top)||this.include(e.bottom)},e}(),Fe={},He=function(){function e(e){var t=e.iid,n=e.limit,r=void 0===n?Je:n,i=this;this._token="",this._sync=null,this._syncRange=new xe({top:Number.MAX_SAFE_INTEGER,bottom:0}),this._completed=!1,this._pkIndex=Date.now(),this._iid=t,this._limit=r;var a=j.get(this._iid).GroupChannel,s=O.get(this._iid),o=s.get("currentUserId"),l=s.get("apiClient"),u=s.get("store"),c=et.of(this._iid),d=me.of(this._iid),h="sendbird:".concat(o,"@groupchannel/sync");this._sync=new De(h,(function(e){return L(i,void 0,void 0,(function(){var e,t,n,r,i,s,o=this;return P(this,(function(f){switch(f.label){case 0:return e={hasNext:!0,nextParams:""},[4,u.get(h)];case 1:if((t=f.sent())&&t.completed)return[3,10];t&&(this._token=t.token,this._syncRange=t.range,this._pkIndex=t.primaryKeyIndex),n={token:this._token,limit:this._limit,includeEmpty:!0,order:"chronological"},f.label=2;case 2:return f.trys.push([2,6,,9]),[4,l.loadGroupChannelList(n)];case 3:return r=f.sent(),i=r.channels.map((function(e){return r.ts&&(e.ts=r.ts),e.cached_primary_key=o._pkIndex--,a.upsert(e)})),this._syncRange.top=Math.min(this._syncRange.top,Math.min.apply(Math,i.map((function(e){return e.createdAt})))),this._syncRange.bottom=Math.max(this._syncRange.bottom,Math.max.apply(Math,i.map((function(e){return e.createdAt})))),e.hasNext=i.length>=this._limit,e.nextParams=this._token=r.next,this._token||(e.hasNext=!1),this._completed=!e.hasNext,$.debug("Group channel collection background sync fetched channels count: ",i.length),[4,c.upsert(i)];case 4:return f.sent(),[4,u.set({key:h,value:{token:this._token,range:this._syncRange,completed:this._completed,primaryKeyIndex:this._pkIndex},generation:1})];case 5:return f.sent(),s={source:he.CHANNEL_BACKGROUND,payload:{channels:i}},d.send(s),[3,9];case 6:return f.sent().isInvalidTokenError?[4,u.remove(h)]:[3,8];case 7:f.sent(),f.label=8;case 8:return[3,9];case 9:return[3,11];case 10:$.debug("Group channel collection background sync has finished."),e.hasNext=!1,f.label=11;case 11:return[2,e]}}))}))}))}return e.of=function(t,n){return void 0===n&&(n=Je),Fe[t]||(Fe[t]=new e({iid:t,limit:n})),Fe[t]},Object.defineProperty(e.prototype,"range",{get:function(){return this._syncRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){return this._completed},enumerable:!1,configurable:!0}),e.prototype.resume=function(){$.debug("Group channel collection background sync has resumed."),this._sync.resume("")},e.prototype.pause=function(){$.debug("Group channel collection background sync has paused."),this._sync.stop()},e}(),Ge={},je=function(){function e(e){var t=e.iid,n=this;this._token=0,this._sync=null,this._pkIndex=Date.now(),this._iid=t;var r=j.get(this._iid).GroupChannel,i=O.get(this._iid);this._token=i.get("firstConnectedAt")/1e3;var a=i.get("currentUserId"),s=i.get("store"),o=i.get("apiClient"),l=i.container.localCacheEnabled,u=et.of(this._iid),c=me.of(this._iid),d="sendbird:".concat(a,"@groupchannel/changelogs");this._sync=new De(d,(function(e){return L(n,void 0,void 0,(function(){var e,t,n,i,a,h,f,p,g=this;return P(this,(function(y){switch(y.label){case 0:return e={hasNext:!0,nextParams:""},l?[4,s.get(d)]:[3,2];case 1:return n=y.sent(),[3,3];case 2:n=null,y.label=3;case 3:(t=n)&&(this._token=t.token,this._pkIndex=t.primaryKeyIndex),i={},"number"==typeof this._token?i.ts=this._token:i.token=this._token,y.label=4;case 4:return y.trys.push([4,10,,13]),[4,o.getMyGroupChannelChangeLogs(i)];case 5:return a=y.sent(),h={updatedChannels:a.updated.map((function(e){return e.cached_primary_key=g._pkIndex--,r.upsert(e)})),deletedChannelUrls:a.deleted},e.hasNext=a.has_more,(h.updatedChannels.length>0||h.deletedChannelUrls.length>0)&&(e.nextParams=this._token=a.next),$.debug("Group channel collection changelog sync update channels count: ",h.updatedChannels.length),$.debug("Group channel collection changelog sync deleted channel urls count: ",h.deletedChannelUrls.length),l?[4,u.upsert(h.updatedChannels)]:[3,9];case 6:return y.sent(),[4,u.remove(h.deletedChannelUrls)];case 7:return y.sent(),[4,s.set({key:d,value:{token:this._token,primaryKeyIndex:this._pkIndex},generation:1})];case 8:y.sent(),y.label=9;case 9:return f={source:he.CHANNEL_CHANGELOG,payload:h},c.send(f),[2,e];case 10:return(p=y.sent()).isInvalidTokenError?[4,s.remove(d)]:[3,12];case 11:y.sent(),y.label=12;case 12:throw p;case 13:return[2]}}))}))}))}return e.of=function(t){return Ge[t]||(Ge[t]=new e({iid:t})),Ge[t]},e.prototype.resume=function(){$.debug("Group channel collection changelog sync has resumed."),this._sync.resume(0,!0)},e.prototype.pause=function(){$.debug("Group channel collection changelog sync has paused."),this._sync.stop()},e}(),ze=function(e,t){for(var n=0;n<e.length;n++)if(e[n].url===t.url)return n;return-1},Be=function(e,t,n){if(e.length>0){for(var r=0,i=e.length-1,a=Math.floor((r+i)/2);r<i;){var s=qe(e[a],t,n);if(s>0)i=a,a=Math.floor((r+i)/2);else{if(!(s<0))return a;r=a+1,a=Math.floor((r+i)/2)}}return qe(e[a],t,n)>0?a:a+1}return e.length},Ve=function(e,t){return t-e},qe=function(e,t,n){switch(n){case Le.LATEST_LAST_MESSAGE:if(e.lastMessage&&!t.lastMessage)return-1;if(!e.lastMessage&&t.lastMessage)return 1;if(e.lastMessage&&t.lastMessage){var r=e.lastMessage.createdAt;if(0===(a=t.lastMessage.createdAt-r)){var i=e.createdAt;0===(a=t.createdAt-i)&&(a=Ve(e.cachedPrimaryKey,t.cachedPrimaryKey))}return a}return r=e.createdAt,0===(a=t.createdAt-r)&&(a=Ve(e.cachedPrimaryKey,t.cachedPrimaryKey)),a;case Le.CHRONOLOGICAL:return 0===(a=t.createdAt-e.createdAt)&&(a=Ve(e.cachedPrimaryKey,t.cachedPrimaryKey)),a;case Le.CHANNEL_NAME_ALPHABETICAL:var a;return 0===(a=e.name.localeCompare(t.name))&&(a=Ve(e.cachedPrimaryKey,t.cachedPrimaryKey)),a}},Ke=function(){},Qe={NAME_ALPHABETICAL:["name","-pk"],CHRONOLOGICAL:["-createdAt","-pk"],LATEST_LAST_MESSAGE:["-lastMessageCreatedAt","-createdAt","-pk"]},Ye={LATEST:["channelUrl","-createdAt","-messageId"],LATEST_UNSENT:["channelUrl","sendingStatus","createdAt"],CHILD_MESSAGE_FIRST:["channelUrl","-parentMessageId","-createdAt"]},We=function(){function e(){}return e.prototype.isNetworkConnected=function(){return!("undefined"==typeof navigator||!navigator.onLine)},e.ready=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){return"undefined"!=typeof navigator&&navigator&&"boolean"==typeof navigator.onLine?[2,navigator.onLine]:[2,new Promise((function(e,t){a.default.get("https://www.google.com").then((function(){return e(!0)})).catch((function(){return e(!1)}))}))]}))}))},e}(),Je=40;!function(e){e.LATEST_LAST_MESSAGE="latest_last_message",e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical"}(Le||(Le={}));var $e,Xe=function(){function e(e){var t=e.iid,n=e.filter,r=e.order,i=e.limit,a=void 0===i?20:i,s=this;this._channels=[],this._token=null,this._hasMore=!0,this._iid=t,this._filter=n,this._order=r,this._limit=a,this._syncLimit=Math.max(a,Je),this._eventObserver={onevent:function(e){return L(s,void 0,void 0,(function(){return P(this,(function(t){return[2,this._handleEvent(e)]}))}))}},this._eventHandler={onChannelsAdded:Ke,onChannelsUpdated:Ke,onChannelsDeleted:Ke};var o=O.get(this._iid);this._localCacheEnabled=o.container.localCacheEnabled,this._localCacheEnabled&&(this._backgroundSync=He.of(this._iid,this._syncLimit),this._backgroundSync.resume()),this._changelogSync=je.of(this._iid),this._changelogSync.resume(),me.of(this._iid).addObserver(this._eventObserver),this._connectionStateObserver={onConnect:function(){s._localCacheEnabled&&s._backgroundSync.resume(),s._changelogSync.resume()},onDisconnect:function(){return L(s,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return[4,We.ready()];case 1:return e.sent()||(this._localCacheEnabled&&this._backgroundSync.pause(),this._changelogSync.pause()),[2]}}))}))}},pe.of(this._iid).addObserver(this._connectionStateObserver)}return e.prototype._handleEvent=function(e){var t=this,n=e.source,r=e.payload,i=O.get(this._iid),a=new Ie(n);switch(n){case he.CHANNEL_BACKGROUND:break;case he.CHANNEL_CHANGELOG:var s=r,o=s.updatedChannels,l=s.deletedChannelUrls,u=o.filter((function(e){return t._filter.match(e)}));this._addChannelsToView(u,{context:a}),this._removeChannelsFromView(l,{context:a});break;case he.EVENT_USER_DECLINED_INVITATION:var c=i.get("currentUserId"),d=r,h=d.channel;d.invitee.userId===c?this._removeChannelsFromView([h.url],{context:a}):this._filter.match(h)?this._addChannelsToView([h],{context:a}):this._removeChannelsFromView([h.url],{context:a});break;case he.EVENT_USER_LEFT:c=i.get("currentUserId");var f=r;h=f.channel,f.user.userId===c?this._removeChannelsFromView([h.url],{context:a}):this._filter.match(h)?this._addChannelsToView([h],{context:a}):this._removeChannelsFromView([h.url],{context:a});break;case he.EVENT_USER_BANNED:case he.EVENT_USER_UNBANNED:break;case he.EVENT_USER_MUTED:case he.EVENT_USER_UNMUTED:case he.EVENT_TYPING_STATUS_UPDATED:case he.EVENT_OPERATOR_UPDATED:case he.EVENT_CHANNEL_METADATA_UPDATED:case he.EVENT_CHANNEL_METADATA_DELETED:case he.EVENT_CHANNEL_METACOUNTER_UPDATED:case he.EVENT_CHANNEL_METACOUNTER_DELETED:case he.EVENT_READ_RECEIPT_UPDATED:case he.EVENT_USER_RECEIVED_INVITATION:case he.EVENT_USER_JOINED:case he.EVENT_CHANNEL_FROZEN:case he.EVENT_CHANNEL_UNFROZEN:case he.EVENT_CHANNEL_HIDDEN:case he.EVENT_CHANNEL_UNHIDDEN:case he.EVENT_CHANNEL_CHANGED:h=r.channel,this._filter.match(h)?this._addChannelsToView([h],{context:a}):this._removeChannelsFromView([h.url],{context:a});break;case he.EVENT_CHANNEL_DELETED:var p=r.channelUrl;this._removeChannelsFromView([p],{context:a})}},e.prototype._getRemoteChannels=function(){return L(this,void 0,void 0,(function(){var e,t,n;return P(this,(function(r){switch(r.label){case 0:return e=j.get(this._iid).GroupChannel,[4,O.get(this._iid).get("apiClient").loadGroupChannelList(M(M({},this._filter),{order:this._order,token:this._token,limit:this._limit,userIdsFilter:this._filter.userIdsFilter,searchFilter:(i=this._filter.searchFilter,i.searchQuery&&i.searchFields?{search_query:i.searchQuery,search_fields:i.searchFields.join(",").toLocaleLowerCase()}:{})}))];case 1:return t=r.sent(),n=t.channels.map((function(n){return"number"==typeof t.ts&&(n.ts=t.ts),e.upsert(n)})),[4,et.of(this._iid).upsert(n)];case 2:return r.sent(),[2,[n,t.next]]}var i}))}))},e.prototype._addChannelsToView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=[],s=0,o=e;s<o.length;s++){var l=o[s],u=ze(this._channels,l);if(u<0)i.push(l),(c=Be(this._channels,l,this._order))===this._channels.length?this._channels.push(l):this._channels.splice(c,0,l);else{a.push(l),this._channels.splice(u,1);var c=Be(this._channels,l,this._order);this._channels.splice(c,0,l)}}r&&(i.length>0&&this._eventHandler.onChannelsAdded(r,i),a.length>0&&this._eventHandler.onChannelsUpdated(r,a))},e.prototype._removeChannelsFromView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=0,s=e;a<s.length;a++){var o=s[a],l=this._channels.map((function(e){return e.url})).indexOf(o);l>=0&&(i.push(this._channels[l].url),this._channels.splice(l,1))}return r&&i.length>0&&this._eventHandler.onChannelsDeleted(r,i),i},Object.defineProperty(e.prototype,"channelList",{get:function(){return this._channels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasMore",{get:function(){return this._hasMore},enumerable:!1,configurable:!0}),e.prototype.loadMore=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i;return P(this,(function(a){switch(a.label){case 0:return this._hasMore?[4,We.ready()]:[3,5];case 1:return a.sent()?[3,3]:($.debug("Group channel collection loadMore() from the cache."),e=et.of(this._iid),t=e.getNextContainerToken(this._order,this._channels),[4,e.getNextChannels(this._filter,this._order,t,this._limit)]);case 2:return r=a.sent(),this._addChannelsToView(r),[2,r];case 3:return $.debug("Group channel collection loadMore() from the server."),[4,this._getRemoteChannels()];case 4:return n=a.sent(),r=n[0],i=n[1],this._token=i,this._token||(this._hasMore=!1),this._addChannelsToView(r),[2,r];case 5:return[2,[]]}}))}))},e.prototype.dispose=function(){pe.of(this._iid).removeObserver(this._connectionStateObserver),this._localCacheEnabled&&this._backgroundSync.pause(),this._changelogSync.pause(),me.of(this._iid).removeObserver(this._eventObserver)},e.prototype.setGroupChannelCollectionHandler=function(e){this._eventHandler=e},e.GroupChannelOrder=Le,e}(),Ze={},et=function(){function e(e){var t=e.iid,n=e.collection,r=void 0===n?null:n;this._collection=null,this._pkIndex=Date.now(),this._lastFetchedPrimaryKey=Date.now(),this._iid=t,this._collection=r,Ze[t]=this}return e.of=function(e){return Ze[e]},e.prototype._serialize=function(e){var t=this._createPk();return e.cachedPrimaryKey=t,M(M({},e.serialize()),{lastMessageCreatedAt:e.lastMessage?e.lastMessage.createdAt:-1,pk:t})},e.prototype._deserialize=function(e){return e?j.get(this._iid).GroupChannel.buildFromSerializedData(e):null},Object.defineProperty(e.prototype,"_localCacheEnabled",{get:function(){return O.get(this._iid).get("localCacheEnabled")},enumerable:!1,configurable:!0}),e.prototype._createPk=function(){return this._pkIndex++},e.prototype._fetch=function(e,t,n){return L(this,void 0,void 0,(function(){var r,i,a,s,o,l,u,c=this;return P(this,(function(d){switch(d.label){case 0:if(!this._localCacheEnabled)return[3,2];switch(r=Qe.LATEST_LAST_MESSAGE,t){case Le.CHANNEL_NAME_ALPHABETICAL:r=Qe.NAME_ALPHABETICAL;break;case Le.CHRONOLOGICAL:r=Qe.CHRONOLOGICAL;break;case Le.LATEST_LAST_MESSAGE:r=Qe.LATEST_LAST_MESSAGE}return i=n.containerToken,a=i.lastMessageCreatedAt,s=i.createdAt,o=i.name,l=i.lastFetchedPrimaryKey,u={where:function(n){switch(t){case Le.LATEST_LAST_MESSAGE:if(n.lastMessageCreatedAt>a)return!1;if(n.lastMessageCreatedAt===a&&Ve(l,n.pk)>=0)return!1;if(n.lastMessageCreatedAt<0){if(n.createdAt>s)return!1;if(n.createdAt===s&&Ve(l,n.pk)>=0)return!1}break;case Le.CHANNEL_NAME_ALPHABETICAL:var r=n.name.localeCompare(o);if(r<0)return!1;if(0===r&&Ve(l,n.pk)>=0)return!1;break;case Le.CHRONOLOGICAL:if(n.createdAt>s)return!1;if(n.createdAt===s&&Ve(l,n.pk)>=0)return!1}return e.match(c._deserialize(n))},index:r},[4,this._collection.query(u).fetch({limit:n.limit})];case 1:return[2,d.sent().map((function(e){return c._deserialize(e)}))];case 2:return[2,[]]}}))}))},e.prototype.getNextContainerToken=function(e,t){switch(e){case Le.LATEST_LAST_MESSAGE:return t.length>0?{lastMessageCreatedAt:(n=t[t.length-1]).lastMessage?n.lastMessage.createdAt:-1,createdAt:n.createdAt,lastFetchedPrimaryKey:n.cachedPrimaryKey}:{lastMessageCreatedAt:Number.MAX_SAFE_INTEGER,createdAt:Number.MAX_SAFE_INTEGER,lastFetchedPrimaryKey:this._lastFetchedPrimaryKey};case Le.CHRONOLOGICAL:return t.length>0?{createdAt:(n=t[t.length-1]).createdAt,lastFetchedPrimaryKey:n.cachedPrimaryKey}:{createdAt:Number.MAX_SAFE_INTEGER,lastFetchedPrimaryKey:this._lastFetchedPrimaryKey};case Le.CHANNEL_NAME_ALPHABETICAL:var n;return t.length>0?{name:(n=t[t.length-1]).name,lastFetchedPrimaryKey:n.cachedPrimaryKey}:{name:"",lastFetchedPrimaryKey:this._lastFetchedPrimaryKey}}},e.prototype.get=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return this._localCacheEnabled?(t=this._deserialize,[4,this._collection.getByKey(e)]):[3,2];case 1:return[2,t.apply(this,[n.sent()])];case 2:return[2,null]}}))}))},e.prototype.getNextChannels=function(e,t,n,r){return void 0===r&&(r=100),L(this,void 0,void 0,(function(){return P(this,(function(i){switch(i.label){case 0:return[4,this._fetch(e,t,{containerToken:n,limit:r})];case 1:return[2,i.sent()]}}))}))},e.prototype.upsert=function(e){return L(this,void 0,void 0,(function(){var t,n=this;return P(this,(function(r){switch(r.label){case 0:return this._localCacheEnabled?(t=e.map((function(e){return n._serialize(e)})),[4,this._collection.upsertMany(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return this._localCacheEnabled?[4,this._collection.removeIf({where:{url:{"/in":e}}})]:[3,3];case 1:return t.sent(),[4,Pi.getInstance(this._iid).clearCachedMessages(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return this._localCacheEnabled?[4,this._collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e}(),tt=function(){function e(){this.messageType="",this.customTypes=["*"],this.senderUserIds=[],this.sendingStatus=null}return e.prototype.clone=function(){var t=new e,n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){if(this.messageType&&this.messageType!==e.messageType)return!1;if(!this.customTypes.includes("*")&&!this.customTypes.includes(e.customType))return!1;if(this.senderUserIds.length>0){if(!e.isUserMessage()&&!e.isFileMessage())return!1;if(!this.senderUserIds.includes(e.sender.userId))return!1}return!this.sendingStatus||this.sendingStatus===e.sendingStatus},e}(),nt=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,i=Math.floor((n+r)/2);n<r;){var a=e[i].createdAt-t.createdAt;if(a>0)r=i,i=Math.floor((n+r)/2);else{if(!(a<0))return i;n=i+1,i=Math.floor((n+r)/2)}}return e[i].createdAt>t.createdAt?i:i+1}return e.length},rt=function(e){var t=e.channel,n=e.ts,r=e.prevLimit,i=void 0===r?0:r,a=e.nextLimit,s=void 0===a?0:a,o=e.filter,l={channel:t,token:n,tokenType:"timestamp",isInclusive:!0,prevResultSize:i,nextResultSize:s,shouldReverse:!1,includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeReplies:!0,includeParentMessageText:!0,showSubchannelMessagesOnly:!0};if(o){var u=o.messageType,c=o.customTypes,d=o.senderUserIds;u&&(l.messageType=u),c.length>0&&(l.customTypes=c),d.length>0&&(l.senderUserIds=d)}return l},it=function(e,t,n){if(n.length>0){var r=n.map((function(e){return e.createdAt}));t.includes("prev")&&(e.top=Math.min.apply(Math,D([e.top],r,!1))),t.includes("next")&&(e.bottom=Math.max.apply(Math,D([e.bottom],r,!1)))}},at=function(e){return new Promise((function(t,n){setTimeout((function(){return t()}),e)}))},st={};!function(e){e.SUCCEEDED="succeeded",e.UNSENT="unsent"}($e||($e={}));var ot,lt=function(){function e(e){var t=e.iid,n=e.collections;this._iid=t,this._collections=n,st[t]=this}return e.of=function(e){return st[e]},e.prototype._serialize=function(e){return e.serialize()},e.prototype._deserialize=function(e){if(e){var t=M(M({},e),{messageId:parseInt(e.messageId)}),n=j.get(this._iid),r=n.UserMessage,i=n.FileMessage,a=n.AdminMessage;if("user"===t.messageType)return r.buildFromSerializedData(t);if("file"===t.messageType)return i.buildFromSerializedData(t);if("admin"===t.messageType)return a.buildFromSerializedData(t)}return null},e.deserialize=function(e,t){if(t){var n=M(M({},t),{messageId:parseInt(t.messageId)}),r=j.get(e),i=r.UserMessage,a=r.FileMessage,s=r.AdminMessage;if("user"===n.messageType)return i.buildFromSerializedData(n);if("file"===n.messageType)return a.buildFromSerializedData(n);if("admin"===n.messageType)return s.buildFromSerializedData(n)}return null},Object.defineProperty(e.prototype,"_localCacheEnabled",{get:function(){return O.get(this._iid).get("localCacheEnabled")},enumerable:!1,configurable:!0}),e.prototype._getMessageCollectionByType=function(e){return e?this._collections[e]:this._collections.succeeded},e.prototype._getIndexByCollection=function(e){return"UnsentMessage"===e.name?Ye.LATEST_UNSENT:Ye.LATEST},e.prototype._fetch=function(e,t,n){return L(this,void 0,void 0,(function(){var r,i,a=this;return P(this,(function(s){switch(s.label){case 0:return this._localCacheEnabled?(r={where:function(r){if(!r)return!1;if(e&&r.channelUrl!==e)return!1;if(n.parentMessageId&&r.parentMessageId!==n.parentMessageId)return!1;if(n.backward){if(r.createdAt<=n.token)return!1}else if(r.createdAt>=n.token)return!1;return!!t.match(a._deserialize(r))},index:n.index,backward:n.backward},[4,n.collection.query(r)]):[3,3];case 1:return[4,s.sent().fetch({limit:n.limit})];case 2:return i=s.sent(),[2,Promise.all(i.map((function(e){return L(a,void 0,void 0,(function(){var t,r,i;return P(this,(function(a){switch(a.label){case 0:return t=this._deserialize(e),(r=e.messageParams)&&r.file&&ne.isFileTypeBlob(r.fileType)&&"string"==typeof t._messageParams.file?(i=t._messageParams,[4,n.collection.getBlob(r.file)]):[3,2];case 1:i._file=a.sent(),a.label=2;case 2:return[2,t]}}))}))})))];case 3:return[2,[]]}}))}))},e.fetch=function(t,n,r){return L(this,void 0,void 0,(function(){var i,a,s=this;return P(this,(function(o){switch(o.label){case 0:return i={where:function(i){if(!i)return!1;if(r.backward){if(i.createdAt<=r.token)return!1}else if(i.createdAt>=r.token)return!1;return!!n.match(e.deserialize(t,i))},index:r.index,backward:r.backward},[4,r.collection.query(i)];case 1:return[4,o.sent().fetch({limit:r.limit})];case 2:return a=o.sent(),[2,Promise.all(a.map((function(n){return L(s,void 0,void 0,(function(){var i,a,s;return P(this,(function(o){switch(o.label){case 0:return i=e.deserialize(t,n),(a=n.messageParams)&&a.file&&ne.isFileTypeBlob(a.fileType)&&"string"==typeof i._messageParams.file?(s=i._messageParams,[4,r.collection.getBlob(a.file)]):[3,2];case 1:s.file=o.sent(),o.label=2;case 2:return[2,i]}}))}))})))]}}))}))},e.prototype.get=function(e,t){return L(this,void 0,void 0,(function(){var n,r;return P(this,(function(i){switch(i.label){case 0:return this._localCacheEnabled?(n=this._getMessageCollectionByType(t),r=this._deserialize,[4,n.getByKey(e)]):[3,2];case 1:return[2,r.apply(this,[i.sent()])];case 2:return[2,null]}}))}))},e.prototype.getPreviousAndNextMessages=function(e,t,n,r,i){return void 0===r&&(r=30),L(this,void 0,void 0,(function(){var a,s;return P(this,(function(o){switch(o.label){case 0:return[4,this.getPreviousMessages(e,t,n,r,i)];case 1:return a=o.sent(),[4,this.getNextMessages(e,t,n,r,i)];case 2:return s=o.sent(),[2,function(e){for(var t=[],n={},r=0,i=e;r<i.length;r++){var a=i[r];a.messageId?n[a.messageId]||(n[a.messageId]=!0,t.push(a)):t.push(a)}return t}(D(D([],a,!0),s,!0))]}}))}))},e.prototype.getPreviousMessages=function(e,t,n,r,i){return void 0===r&&(r=30),L(this,void 0,void 0,(function(){var a;return P(this,(function(s){switch(s.label){case 0:return a=this._getMessageCollectionByType(i),[4,this._fetch(e,t,{token:n,limit:r,backward:!1,collection:a,index:this._getIndexByCollection(a)})];case 1:return[2,s.sent().reverse()]}}))}))},e.prototype.getNextMessages=function(e,t,n,r,i){return void 0===r&&(r=30),L(this,void 0,void 0,(function(){var a;return P(this,(function(s){switch(s.label){case 0:return a=this._getMessageCollectionByType(i),[4,this._fetch(e,t,{token:n,limit:r,backward:!0,collection:a,index:this._getIndexByCollection(a)})];case 1:return[2,s.sent()]}}))}))},e.prototype.getAllChildMessages=function(e,t,n){return L(this,void 0,void 0,(function(){return P(this,(function(r){switch(r.label){case 0:return[4,this._fetch(e.channelUrl,t,{token:Date.now(),limit:null,collection:n,backward:!1,index:Ye.CHILD_MESSAGE_FIRST,parentMessageId:e.messageId})];case 1:return[2,r.sent()]}}))}))},e.prototype.getUnsentMessages=function(e,t){return L(this,void 0,void 0,(function(){var n;return P(this,(function(r){switch(r.label){case 0:return n=this._getMessageCollectionByType($e.UNSENT),[4,this._fetch(e,t,{token:0,limit:null,collection:n,backward:!0,index:Ye.LATEST_UNSENT})];case 1:return[2,r.sent()]}}))}))},e.prototype.getAllUnsentMessages=function(t){return L(this,void 0,void 0,(function(){var n;return P(this,(function(r){switch(r.label){case 0:return n=this._getMessageCollectionByType($e.UNSENT),[4,e.fetch(this._iid,t,{token:Date.now(),limit:null,collection:n,backward:!1,index:Ye.LATEST_UNSENT})];case 1:return[2,r.sent()]}}))}))},e.prototype.countBetween=function(e,t,n,r,i){return L(this,void 0,void 0,(function(){var a,s=this;return P(this,(function(o){switch(o.label){case 0:return this._localCacheEnabled?(a={where:function(i){return i.channelUrl===e&&!(n>i.createdAt||i.createdAt>r)&&t.match(s._deserialize(i))},index:Ye.LATEST},[4,this._getMessageCollectionByType(i).query(a)]):[3,3];case 1:return[4,o.sent().count()];case 2:return[2,o.sent()];case 3:return[2,0]}}))}))},e.prototype._serializeMessages=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i=this;return P(this,(function(a){switch(a.label){case 0:return n=this._getMessageCollectionByType(t),r=[],[4,Promise.all(e.map((function(e){return L(i,void 0,void 0,(function(){var t,i;return P(this,(function(a){switch(a.label){case 0:return(t=e.serialize())?((t=M({},t)).messageParams&&(t.messageParams=M({},t.messageParams)),e.sendingStatus&&"succeeded"!==e.sendingStatus?t.messageId="unsent-".concat(e.reqId):t.messageId="".concat(e.messageId),e.isFileMessage()&&e._messageParams&&e._messageParams.file&&ne.isBlob(e._messageParams.file)&&ne.isFileTypeBlob(e._messageParams.fileType)?[4,n.saveBlob(e._messageParams.file,e.reqId)]:[3,2]):[3,3];case 1:i=a.sent(),t.messageParams.file=i,a.label=2;case 2:r.push(t),a.label=3;case 3:return[2]}}))}))})))];case 1:return a.sent(),[2,r]}}))}))},e.prototype.upsert=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f,p,g,y;return P(this,(function(m){switch(m.label){case 0:return this._localCacheEnabled?(n=Pi.getInstance(this._iid),r=this._getMessageCollectionByType(t),[4,this._serializeMessages(e,t)]):[3,13];case 1:return i=m.sent(),[4,r.upsertMany(i)];case 2:if(m.sent(),t&&t!==$e.SUCCEEDED)return[3,13];a=[],s=[],o=0,m.label=3;case 3:return o<e.length?(l=e[o]).sendingStatus&&l.sendingStatus===n.MessageSendingStatus.SUCCEEDED&&l.updatedAt>0?(c=(u=a).concat,[4,this._locallyUpdateChildMessages(l,$e.SUCCEEDED)]):[3,6]:[3,7];case 4:return a=c.apply(u,[m.sent()]),h=(d=s).concat,[4,this._locallyUpdateChildMessages(l,$e.UNSENT)];case 5:s=h.apply(d,[m.sent()]),m.label=6;case 6:return o++,[3,3];case 7:return a.length>0?(f=this._getMessageCollectionByType($e.SUCCEEDED),[4,this._serializeMessages(a,$e.SUCCEEDED)]):[3,10];case 8:return p=m.sent(),[4,f.upsertMany(p)];case 9:m.sent(),m.label=10;case 10:return s.length>0?(g=this._getMessageCollectionByType($e.UNSENT),[4,this._serializeMessages(s,$e.UNSENT)]):[3,13];case 11:return y=m.sent(),[4,g.upsertMany(y)];case 12:m.sent(),m.label=13;case 13:return[2]}}))}))},e.prototype._locallyUpdateChildMessages=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i;return P(this,(function(a){switch(a.label){case 0:return n=new tt,r=[],i=this._getMessageCollectionByType(t),[4,this.getAllChildMessages(e,n,i)];case 1:return a.sent().forEach((function(t){t.applyParentMessage(e)&&r.push(t)})),[2,r]}}))}))},e.prototype.remove=function(e,t){return L(this,void 0,void 0,(function(){var n,r;return P(this,(function(i){switch(i.label){case 0:return this._localCacheEnabled?[4,at(500)]:[3,3];case 1:return i.sent(),n=this._getMessageCollectionByType(t),r={messageId:{"/in":e.map((function(e){return"".concat(e)}))}},[4,n.removeIf({where:r})];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},e.prototype.removeUnsentMessages=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s;return P(this,(function(o){switch(o.label){case 0:return t=e.channelUrl,n=e.sendingStatus,r=e.reqIds,i=[],this._localCacheEnabled?[4,at(500)]:[3,3];case 1:return o.sent(),a=this._getMessageCollectionByType($e.UNSENT),s={channelUrl:{"=":t}},n&&(s.sendingStatus={"=":n}),r&&r.length>0&&(s.reqId={"/in":r}),[4,a.removeIf({where:s})];case 2:i=o.sent(),o.label=3;case 3:return[2,i]}}))}))},e.prototype.removeFailedMessages=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i,a;return P(this,(function(s){switch(s.label){case 0:return n=[],this._localCacheEnabled?[4,at(500)]:[3,3];case 1:return s.sent(),r=this._getMessageCollectionByType($e.UNSENT),i=Pi.getInstance(this._iid),a={channelUrl:{"=":e},sendingStatus:{"=":i.MessageSendingStatus.FAILED}},t&&t.length>0&&(a.reqId={"/in":t}),[4,r.removeIf({where:a})];case 2:n=s.sent(),s.label=3;case 3:return[2,n]}}))}))},e.prototype.clearByChannelUrl=function(e){return L(this,void 0,void 0,(function(){var t=this;return P(this,(function(n){switch(n.label){case 0:return[4,Promise.all(Object.keys($e).map((function(n){var r=t._getMessageCollectionByType($e[n]),i={channelUrl:{"=":e}};return r.removeIf({where:i})})))];case 1:return n.sent(),[2]}}))}))},e.prototype.clear=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return this._localCacheEnabled?[4,this._getMessageCollectionByType(e).clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.clearAll=function(){return L(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){switch(t.label){case 0:return this._localCacheEnabled?[4,Promise.all(Object.keys($e).map((function(t){return e.clear($e[t])})))]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.clearAbove=function(e,t){return L(this,void 0,void 0,(function(){var n,r;return P(this,(function(i){switch(i.label){case 0:return this._localCacheEnabled?(n=this._getMessageCollectionByType(t),r={createdAt:{"<":e}},[4,n.removeIf({where:r})]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e}(),ut=function(){function e(){this.messageId=null,this.userId=null,this.key=null,this.operation="",this.updatedAt=null}return e.createFromJson=function(e){var t=parseInt(e.msg_id),n=e.user_id,r=e.operation,i=e.reaction,a=e.updated_at;if(t&&"string"==typeof n&&"string"==typeof r&&["add","delete"].indexOf(r.toLowerCase())>=0&&"string"==typeof i&&i&&"number"==typeof a){var s=new this;return s.messageId=t,s.userId=n,s.key=i,s.operation=r.toLowerCase(),s.updatedAt=a,s}return null},e}(),ct=function(e){return Object.keys(e).forEach((function(t){e[t]&&"object"==typeof e[t]&&ct(e[t])})),Object.freeze(e)},dt=function(){function e(){}return e.serialize=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),ct(n)},e.serializeWithoutFreeze=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},e.deserialize=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},e}(),ht={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},ft=new WeakMap,pt=function(){function e(t){d(this,e),this.messageId=0,this.messageType=e.MESSAGE_TYPE_BASE,this.channelUrl="",this.data=null,this.customType=null,this.silent=!1,this.createdAt=0,this.updatedAt=0,this.channelType=null,this.metaArrays=[],this.reactions=[],this.mentionType=null,this.mentionedUsers=[],this.mentionedUserIds=[],this.mentionedMessageTemplate=null,this.sendingStatus=null,ft.set(this,0),this.parentMessageId=0,this.parentMessageText=null,this.threadInfo=null,this.isReplyToChannel=!1,this.parentMessage=null,this.ogMetaData=null,this.isOperatorMessage=!1,this.appleCriticalAlertOptions=null,this.reqId="",this._isAutoResendRegistered=!1,t&&this.__update(t)}return f(e,[{key:"serialize",value:function(e){var t=this;return dt.serialize(this,(function(n){n.hasOwnProperty("_sender")&&(n.sender=n._sender,delete n._sender),n.hasOwnProperty("_isAutoResendRegistered")&&(n.isAutoResendRegistered=n._isAutoResendRegistered,delete n._isAutoResendRegistered),t.appleCriticalAlertOptions&&(n.appleCriticalAlertOptions=t.appleCriticalAlertOptions.serialize()),e&&e(n)}))}},{key:"isIdentical",value:function(e){return!("object"!==c(e)||!e.hasOwnProperty("messageId"))&&(0!==this.messageId&&0!==e.messageId?this.messageId===e.messageId:this.reqId===e.reqId)}},{key:"isEqual",value:function(e){return se.deepEqual(this,e)}},{key:"isOpenChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isUserMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_USER}},{key:"isAdminMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_ADMIN}},{key:"isFileMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_FILE}},{key:"__update",value:function(e){var t=this,n=Pi.getInstance(this._iid),r=j.get(this._iid),i=r.User,a=r.BaseChannel,s=r.BaseMessageParams,o=r.BaseMessage,l=r.Reaction,c=r.MessageMetaArray,d=r.ThreadInfo,h=r.OGMetaData,f=r.AppleCriticalAlertOptions;if(e.hasOwnProperty("msg_id")&&e.msg_id&&(this.messageId=parseInt(e.msg_id)),e.hasOwnProperty("type"))switch(e.type){case"MESG":this.messageType=o.MESSAGE_TYPE_USER;break;case"FILE":this.messageType=o.MESSAGE_TYPE_FILE;break;case"BRDM":case"ADMM":this.messageType=o.MESSAGE_TYPE_ADMIN}e.hasOwnProperty("message_id")&&e.message_id&&(this.messageId=parseInt(e.message_id)),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",e.hasOwnProperty("silent")&&(this.silent=e.silent),this.createdAt=e.hasOwnProperty("ts")?parseInt(e.ts):0,e.hasOwnProperty("created_at")&&(this.createdAt=parseInt(e.created_at)),this.updatedAt=e.hasOwnProperty("updated_at")?parseInt(e.updated_at):0,this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):a.CHANNEL_TYPE_GROUP;var p=e.hasOwnProperty("metaarray")?e.metaarray:{},g=e.hasOwnProperty("metaarray_key_order")?e.metaarray_key_order:Object.keys(p).sort((function(e,t){return e.localeCompare(t)}));this.metaArrays=[];for(var y=0;y<g.length;y++){var m=g[y];this.metaArrays.push(new c(m,p[m]||[]))}if(e.hasOwnProperty("sorted_metaarray")){var _=e.sorted_metaarray;Array.isArray(_)&&(this.metaArrays=_.map((function(e){return new c(e.key,e.value)})))}if(this.reactions=[],e.hasOwnProperty("reactions")&&Array.isArray(e.reactions))for(var v=0;v<e.reactions.length;v++){var E=l.createFromJson(e.reactions[v]);E&&this.reactions.push(E)}if(this.mentionType=e.hasOwnProperty("mention_type")?e.mention_type:s.MentionType.USERS,this.mentionedUsers=[],e.hasOwnProperty("mentioned_users")&&e.mentioned_users.forEach((function(e){var n=new i(e);t.mentionedUsers.push(n)})),this.mentionedUserIds=[],e.hasOwnProperty("mentioned_user_ids")&&(this.mentionedUserIds=e.mentioned_user_ids),e.hasOwnProperty("mentioned_message_template")&&e.mentioned_message_template&&(this.mentionedMessageTemplate=e.mentioned_message_template),this.sendingStatus=this.messageId>0?n.MessageSendingStatus.SUCCEEDED:n.MessageSendingStatus.FAILED,e.hasOwnProperty("sending_status")&&(this.sendingStatus=e.sending_status),e.hasOwnProperty("root_message_id")&&e.root_message_id&&ft.set(this,parseInt(e.root_message_id)),e.hasOwnProperty("parent_message_id")&&e.parent_message_id&&(this.parentMessageId=parseInt(e.parent_message_id)),this.threadInfo=new d(e.thread_info),this.isReplyToChannel=!!e.hasOwnProperty("is_reply_to_channel")&&e.is_reply_to_channel,e.hasOwnProperty("parent_message_info")){var b=u({},e.parent_message_info);e.parent_message_info.hasOwnProperty("file")&&(b.require_auth=!!e.parent_message_info.file.require_auth);var C={channelType:this.channelType,channelUrl:this.channelUrl};switch(this.parentMessage=a.buildMessage(b,C),this.parentMessage.messageType){case o.MESSAGE_TYPE_USER:this.parentMessageText=this.parentMessage.message;break;case o.MESSAGE_TYPE_FILE:this.parentMessageText=this.parentMessage.name}}e.hasOwnProperty("og_tag")&&(this.ogMetaData=new h(e.og_tag)),e.hasOwnProperty("is_op_msg")&&(this.isOperatorMessage=e.is_op_msg),e.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new f(e.apple_critical_alert_options)),e.hasOwnProperty("is_auto_resend_registered")&&(this._isAutoResendRegistered=e.is_auto_resend_registered),this.reqId=e.hasOwnProperty("req_id")?e.req_id:""}},{key:"getMetaArraysByKeys",value:function(e){return Array.isArray(e)?this.metaArrays.filter((function(t){return e.indexOf(t.key)>-1})):[]}},{key:"metaArray",get:function(){var e={};return this.metaArrays.forEach((function(t){e[t.key]=t.value})),e},set:function(e){if("object"===c(e)&&e){var t=j.get(this._iid).MessageMetaArray,n=[];Object.keys(e).forEach((function(r){n.push(new t(r,e[r]))})),this.metaArrays=n}}},{key:"getMetaArrayByKeys",value:function(e){var t={};return this.getMetaArraysByKeys(e).forEach((function(e){t[e.key]=e.value})),t}},{key:"applyReactionEvent",value:function(e){var t=this,n=j.get(this._iid).Reaction,r=null,i=ve.parse(arguments,[new ve({type:ut,constraint:function(e){return parseInt(e.messageId)===parseInt(t.messageId)}})]),a=S(i,2);if(r=a[0],e=a[1],!r){for(var s=!1,o=0;o<this.reactions.length;o++)if(this.reactions[o].key===e.key){this.reactions[o]._applyEvent(e),this.reactions[o].isEmpty&&this.reactions.splice(o,1),s=!0;break}s||"add"!==e.operation||this.reactions.push(new n(e.key,[e.userId],e.updatedAt))}}},{key:"_getThreadedMessageList",value:function(t,n,r,i){var a=this,s=j.get(this._iid).ThreadedMessageListParams,o=null,l=ve.parse(arguments,[new ve({type:"number"}),new ve({type:"string",constraint:function(e){return Object.values(ht).includes(e)}}),new ve({type:s,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),c=S(l,5);return o=c[0],t=c[1],n=c[2],r=c[3],i=c[4],le(this._iid,(function(i){if(o)i(o,null);else{var s=j.get(a._iid),l=s.GroupChannel,c=s.OpenChannel;a.isGroupChannel()?l.getChannel(a.channelUrl,I.INTERNAL_CALL,(function(s,o){if(Pi.getInstance(a._iid).getErrorFirstCallback()){var l=[s,o];o=l[0],s=l[1]}o?i(o,null):O.get(a._iid).container.apiClient.getMessageList(u(u({channel:s,token:t,tokenType:n},r),{},{shouldReverse:r.reverse,parentMessageId:a.messageId,includeThreadInfo:!0,replyType:e.ReplyType.ALL})).then((function(e){var t=j.get(a._iid).BaseChannel,n=e.messages.map((function(e){return t.buildMessage(e,s)})).filter((function(e){return null!==e})),r=n.filter((function(e){return e.messageId===a.messageId}))[0],o=n.filter((function(e){return e.parentMessageId===a.messageId}));i(null,{parentMessage:r,threadedReplies:o})})).catch((function(e){i(e,null)}))})):a.isOpenChannel()&&c.getChannel(a.channelUrl,I.INTERNAL_CALL,(function(s,o){if(Pi.getInstance(a._iid).getErrorFirstCallback()){var l=[s,o];o=l[0],s=l[1]}o?i(o,null):O.get(a._iid).container.apiClient.getMessageList(u(u({channel:s,token:t,tokenType:n},r),{},{shouldReverse:r.reverse,parentMessageId:a.messageId,includeThreadInfo:!0,replyType:e.ReplyType.ALL})).then((function(e){var t=j.get(a._iid).BaseChannel,n=e.messages.map((function(e){return t.buildMessage(e,s)})).filter((function(e){return null!==e})),r=n.filter((function(e){return e.messageId===a.messageId}))[0],o=n.filter((function(e){return e.parentMessageId===a.messageId}));i(null,{parentMessage:r,threadedReplies:o})})).catch((function(e){i(e,null)}))}))}}),i)}},{key:"getThreadedMessagesByTimestamp",value:function(e,t,n){return this._getThreadedMessageList(e,ht.TIMESTAMP,t,n)}},{key:"applyThreadInfoUpdateEvent",value:function(e){var t=this,n=j.get(this._iid).ThreadInfoUpdateEvent,r=null,i=ve.parse(arguments,[new ve({type:n,constraint:function(e){return parseInt(e.targetMessageId)===parseInt(t.messageId)}})]),a=S(i,2);return r=a[0],e=a[1],!r&&(this.threadInfo=e.threadInfo,!0)}},{key:"applyParentMessage",value:function(e){if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1}},{key:"_setRootMessageId",value:function(e){ft.set(this,e)}}],[{key:"MESSAGE_TYPE_BASE",get:function(){return"base"}},{key:"MESSAGE_TYPE_ADMIN",get:function(){return"admin"}},{key:"MESSAGE_TYPE_USER",get:function(){return"user"}},{key:"MESSAGE_TYPE_FILE",get:function(){return"file"}},{key:"SendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"ReplyType",get:function(){return{ALL:"all",NONE:"none",ONLY_REPLY_TO_CHANNEL:"only_reply_to_channel"}}},{key:"getMessage",value:function(e,t){var n=this,r=j.get(this._iid),i=r.BaseChannel,a=r.MessageRetrievalParams,s=null,o=ve.parse(arguments,[new ve({type:a,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)t(s,null);else{var r=j.get(n._iid),a=r.GroupChannel,o=r.OpenChannel;switch(e.channelType){case i.CHANNEL_TYPE_GROUP:a.getChannel(e.channelUrl,I.INTERNAL_CALL,(function(r,a){if(Pi.getInstance(n._iid).getErrorFirstCallback()){var s=[r,a];a=s[0],r=s[1]}a?t(a,null):O.get(n._iid).container.apiClient.getMessage(u({channel:r},e),(function(e,n){if(e)t(e,null);else{var a=i.buildMessage(n,r);t(null,a)}}))}));break;case i.CHANNEL_TYPE_OPEN:o.getChannel(e.channelUrl,I.INTERNAL_CALL,(function(r,a){if(Pi.getInstance(n._iid).getErrorFirstCallback()){var s=[r,a];a=s[0],r=s[1]}a?t(a,null):O.get(n._iid).container.apiClient.getMessage(u({channel:r},e),(function(e,n){if(e)t(e,null);else{var a=i.buildMessage(n,r);t(null,a)}}))}))}}}),t)}}]),e}(),gt=function(){function e(e){this.nickname="",this.plainProfileUrl="",this.userId="",this.connectionStatus="",this.lastSeenAt=null,this.metaData={},this.isActive=!0,this.friendDiscoveryKey=null,this.friendName=null,this._preferredLanguages=null,this.requireAuth=null,e&&this.__update(e)}return e.objectify=function(e){var t=e.userId,n=void 0===t?null:t,r=e.nickname,i=void 0===r?"":r,a=e.plainProfileUrl,s=void 0===a?"":a,o=e.connectionStatus,l=void 0===o?"":o,u=e.lastSeenAt,c=void 0===u?0:u,d=e.metaData,h=void 0===d?{}:d,f=e.isActive,p=void 0===f||f,g=e.friendDiscoveryKey,y=void 0===g?null:g,m=e.friendName,_=void 0===m?null:m,v=e.preferredLanguages,E=void 0===v?null:v,b=e.requireAuth;return{user_id:n,nickname:i,profile_url:s,is_online:l,last_seen_at:c,metadata:h,is_active:p,friend_discovery_key:y,friend_name:_,preferred_languages:E,require_auth_for_profile_image:void 0!==b&&b}},e.buildFromSerializedData=function(e){var t=j.get(this._iid).User,n=dt.deserialize(e);return new t(t.objectify(n))},Object.defineProperty(e.prototype,"preferredLanguages",{get:function(){return this._preferredLanguages},enumerable:!1,configurable:!0}),e.prototype.__update=function(t){var n=O.get(this._iid).container.auth;t.hasOwnProperty("guest_id")&&(this.userId=t.guest_id),t.hasOwnProperty("user_id")&&(this.userId=t.user_id),t.hasOwnProperty("name")&&(this.nickname=t.name),t.hasOwnProperty("nickname")&&(this.nickname=t.nickname),t.hasOwnProperty("require_auth_for_profile_image")?this.requireAuth=t.require_auth_for_profile_image:this.requireAuth=null,(t.hasOwnProperty("image")||t.hasOwnProperty("profile_url"))&&(this.plainProfileUrl=t.image||t.profile_url||"",Object.defineProperty(this,"profileUrl",{value:this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(n.eKey):this.plainProfileUrl,configurable:!0,writable:!1})),t.hasOwnProperty("is_online")?t.is_online===e.NON_AVAILABLE?this.connectionStatus=e.NON_AVAILABLE:this.connectionStatus=t.is_online?e.ONLINE:e.OFFLINE:this.connectionStatus=e.NON_AVAILABLE,t.hasOwnProperty("last_seen_at")?this.lastSeenAt=parseInt(t.last_seen_at):this.lastSeenAt=0,t.hasOwnProperty("metadata")?this.metaData=t.metadata:this.metaData={},t.hasOwnProperty("is_active")?this.isActive=void 0===t.is_active||t.is_active:this.isActive=!0,t.hasOwnProperty("friend_discovery_key")?this.friendDiscoveryKey=t.friend_discovery_key:this.friendDiscoveryKey=null,t.hasOwnProperty("friend_name")?this.friendName=t.friend_name:this.friendName=null,t.hasOwnProperty("preferred_languages")?this._preferredLanguages=t.preferred_languages||null:this._preferredLanguages=null},e.prototype._updateMetaData=function(e,t){var n=this;void 0===t&&(t=!1);var r=j.get(this._iid).GroupChannel;Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]})),Object.keys(r.cachedChannels).forEach((function(e){if(r.cachedChannels.hasOwnProperty(e)){var t=r.cachedChannels[e];t.memberMap.hasOwnProperty(n.userId)&&(t.memberMap[n.userId].metaData=n.metaData)}}))},e.prototype.serialize=function(){return dt.serialize(this,(function(e){e.hasOwnProperty("_preferredLanguages")&&(e.preferredLanguages=e._preferredLanguages,delete e._preferredLanguages)}))},e.prototype.getOriginalProfileUrl=function(){var e="";if(((e=(e=this.plainProfileUrl.indexOf("://")>-1?this.plainProfileUrl.split("/")[2]:this.plainProfileUrl.split("/")[0]).split("?")[0]).indexOf("sendbird.com")>-1||e.indexOf("sendbirdtest.com")>-1||e.indexOf("intoz.com")>-1||e.indexOf("file-local")>-1)&&this.plainProfileUrl.indexOf(e+"/profile_images/")>-1){var t=this.plainProfileUrl.replace("profile_images/","");return t===this.plainProfileUrl?"":t}return""},e.prototype.createMetaData=function(e,t){var n,r=this,i=null;return n=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return Object.keys(e).length>0&&!Array.isArray(e)}}),new ve({type:"callback"})]),i=n[0],e=n[1],t=n[2],le(this._iid,(function(t){i?t(i,null):O.get(r._iid).container.apiClient.createUserMetaData({metaData:e},(function(e,n){e||r._updateMetaData(n),t(e,n)}))}),t)},e.prototype.updateMetaData=function(e,t,n){var r,i=this,a=null;return r=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),a=r[0],e=r[1],t=r[2],n=r[3],le(this._iid,(function(n){a?n(a,null):O.get(i._iid).container.apiClient.updateUserMetaData({metaData:e,upsert:t},(function(e,t){e||i._updateMetaData(t),n(e,t)}))}),n)},e.prototype.deleteMetaData=function(e,t){var n,r=this,i=null;return n=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),i=n[0],e=n[1],t=n[2],le(this._iid,(function(t){if(i)t(i,null);else{var n={};n[e]="",O.get(r._iid).container.apiClient.deleteUserMetaData({metaDataKey:e},(function(e,i){e||r._updateMetaData(n,!0),t(e,i)}))}}),t)},e.prototype.deleteAllMetaData=function(e){var t=this;return le(this._iid,(function(e){var n=t.metaData;O.get(t._iid).container.apiClient.deleteAllUserMetaData({},(function(r,i){r||t._updateMetaData(n,!0),e(r,i)}))}),e)},Object.defineProperty(e,"NON_AVAILABLE",{get:function(){return"nonavailable"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ONLINE",{get:function(){return"online"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"OFFLINE",{get:function(){return"offline"},enumerable:!1,configurable:!0}),e}(),yt=function(){function e(e,t){this._source=e,this._sendingStatus=t}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFromEvent",{get:function(){return this._source>=2e3},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sendingStatus",{get:function(){return this._sendingStatus},enumerable:!1,configurable:!0}),e}(),mt={},_t=function(e,t){return"sendbird:".concat(e,"@channel/").concat(t,"/message/sync")},vt=function(){function e(e){var t=e.iid,n=e.channel,r=e.limit,i=void 0===r?At:r,a=this;this._prevSync=null,this._nextSync=null,this._syncRange=new xe({top:Number.MAX_SAFE_INTEGER,bottom:-1}),this._isPrevSyncComplete=!1,this._isNextSyncComplete=!1,this._iid=t,this._channel=n,this._limit=i;var s=j.get(this._iid).BaseChannel,o=O.get(this._iid),l=o.get("currentUserId"),u=o.get("store"),c=o.get("apiClient"),d=lt.of(this._iid),h=me.of(this._iid),f=_t(l,this._channel.url),p=o.container.concurrentCallLimit,g=o.container.backOffDelay;this._prevSync=new De(f,(function(e){return L(a,void 0,void 0,(function(){var e,t,r,i,a,o,l,p,g,y=this;return P(this,(function(m){switch(m.label){case 0:return e={hasNext:!0,nextParams:null},[4,u.get(f)];case 1:return(t=m.sent())&&t.isPrevSyncComplete?[3,7]:(t&&(this._syncRange=t.range,this._isPrevSyncComplete=t.isPrevSyncComplete),r=rt({channel:this._channel,ts:this._syncRange.top,prevLimit:this._limit}),[4,c.getMessageList(r)]);case 2:return i=m.sent(),a=[],o=i.messages.map((function(e){var t=s.buildMessage(e,y._channel);return(t.isUserMessage()||t.isFileMessage())&&t._isSentByMe()&&a.push(t.reqId),t})),l=this.getMinCreatedAt(o),this._syncRange.top=Math.min(this._syncRange.top,l),this._syncRange.bottom<0&&(this._syncRange.bottom=this.getMaxCreatedAt(o)),this._isPrevSyncComplete=o.length<this._limit,$.debug("Message collection background sync fetched messages count: ",o.length),[4,d.upsert(o)];case 3:return m.sent(),a.length>0?[4,d.removeUnsentMessages({channelUrl:this._channel.url,reqIds:a})]:[3,5];case 4:m.sent(),m.label=5;case 5:return p={range:this._syncRange,isPrevSyncComplete:this._isPrevSyncComplete,isNextSyncComplete:t?t.isNextSyncComplete:this._isNextSyncComplete},[4,u.set({key:f,value:p,generation:1})];case 6:return m.sent(),g={source:he.MESSAGE_BACKGROUND,payload:{channel:n,messages:o}},h.send(g),e.hasNext=!this._isPrevSyncComplete,[3,8];case 7:$.debug("Message collection background sync has finished."),e.hasNext=!1,m.label=8;case 8:return[2,e]}}))}))}),p,g),this._nextSync=new De(f,(function(e){return L(a,void 0,void 0,(function(){var e,t,r,i,a,o,l,p,g,y=this;return P(this,(function(m){switch(m.label){case 0:return e={hasNext:!0,nextParams:null},[4,u.get(f)];case 1:return(t=m.sent())?(this._syncRange=t.range,r=rt({channel:this._channel,ts:this._syncRange.bottom,nextLimit:this._limit}),[4,c.getMessageList(r)]):[3,7];case 2:return i=m.sent(),a=[],o=i.messages.map((function(e){var t=s.buildMessage(e,y._channel);return(t.isUserMessage()||t.isFileMessage())&&t._isSentByMe()&&a.push(t.reqId),t})),l=this.getMaxCreatedAt(o),this._syncRange.bottom=Math.max(this._syncRange.bottom,l),this._isNextSyncComplete=o.length<this._limit,[4,d.upsert(o)];case 3:return m.sent(),a.length>0?[4,d.removeUnsentMessages({channelUrl:this._channel.url,reqIds:a})]:[3,5];case 4:m.sent(),m.label=5;case 5:return p={range:this._syncRange,isPrevSyncComplete:t?t.isPrevSyncComplete:this._isPrevSyncComplete,isNextSyncComplete:this._isNextSyncComplete},[4,u.set({key:f,value:p,generation:1})];case 6:m.sent(),g={source:he.MESSAGE_BACKGROUND,payload:{channel:n,messages:o}},h.send(g),e.hasNext=!this._isNextSyncComplete,m.label=7;case 7:return[2,e]}}))}))}),p,g)}return e.of=function(t,n,r){return void 0===r&&(r=At),mt[t]||(mt[t]={}),mt[t][n.url]||(mt[t][n.url]=new e({iid:t,channel:n,limit:r})),mt[t][n.url]},Object.defineProperty(e.prototype,"range",{get:function(){return this._syncRange},enumerable:!1,configurable:!0}),e.prototype.resume=function(){$.debug("Message collection background sync has resumed."),this._isPrevSyncComplete||this._prevSync.resume(null),this._isNextSyncComplete||this._nextSync.resume(null)},e.prototype.pause=function(){$.debug("Message collection background sync has paused."),this._prevSync.stop(),this._nextSync.stop()},e.prototype.getMinCreatedAt=function(e){var t=Number.MAX_SAFE_INTEGER;return e.forEach((function(e){var n=e.createdAt;n<t&&(t=n)})),t},e.prototype.getMaxCreatedAt=function(e){var t=0;return e.forEach((function(e){var n=e.createdAt;n>t&&(t=n)})),t},e}(),Et={},bt=function(e,t){return"sendbird:".concat(e,"@channel/").concat(t,"/message/changelogs")},Ct=function(){function e(e){var t=e.iid,n=e.channel,r=this;this._token=0,this._sync=null,this._iid=t,this._channel=n;var i=j.get(this._iid).BaseChannel,a=O.get(this._iid),s=a.get("currentUserId"),o=a.get("store"),l=a.get("apiClient"),u=a.container.localCacheEnabled,c=lt.of(this._iid),d=me.of(this._iid),h=bt(s,this._channel.url);this._sync=new De(h,(function(e){return L(r,void 0,void 0,(function(){var e,t,r,s,f,p,g,y,m,_,v=this;return P(this,(function(E){switch(E.label){case 0:return e={hasNext:!0,nextParams:""},u?[4,o.get(h)]:[3,2];case 1:return r=E.sent(),[3,3];case 2:r=null,E.label=3;case 3:t=r,this._token=t?t.token:a.get("firstConnectedAt")/1e3,s={channelUrl:this._channel.url,isOpenChannel:this._channel.isOpenChannel(),includeMetaArray:!0,includeReactions:!0,includeReplies:!0,includeParentMessageText:!0,includeThreadInfo:!0},"number"==typeof this._token?s.timestamp=this._token:s.token=this._token,E.label=4;case 4:return E.trys.push([4,12,,15]),[4,l.getMessageChangeLogs(s)];case 5:return f=E.sent(),p=f.updated.map((function(e){return i.buildMessage(e,v._channel)})),g={updatedMessages:p,deletedMessageIds:f.deleted.map((function(e){return parseInt(e.message_id)}))},e.hasNext=f.has_more,(g.updatedMessages.length>0||g.deletedMessageIds.length>0)&&(e.nextParams=this._token=f.next),u?(y=[],p.forEach((function(e){(e.isUserMessage()||e.isFileMessage())&&e._isSentByMe()&&y.push(e.reqId)})),y.length>0?[4,c.removeUnsentMessages({channelUrl:this._channel.url,reqIds:y})]:[3,7]):[3,11];case 6:E.sent(),E.label=7;case 7:return[4,c.upsert(p)];case 8:return E.sent(),[4,c.remove(g.deletedMessageIds)];case 9:return E.sent(),[4,o.set({key:h,value:{token:this._token},generation:1})];case 10:E.sent(),E.label=11;case 11:return $.debug("Message collection changelog sync update messages count: ",g.updatedMessages.length),$.debug("Message collection changelog sync deleted message ids count: ",g.deletedMessageIds.length),m={source:he.MESSAGE_CHANGELOG,payload:M({channel:n},g)},d.send(m),[2,e];case 12:return(_=E.sent()).isInvalidTokenError?[4,o.remove(h)]:[3,14];case 13:E.sent(),E.label=14;case 14:throw _;case 15:return[2]}}))}))}))}return e.of=function(t,n){return Et[t]||(Et[t]={}),Et[t][n.url]||(Et[t][n.url]=new e({iid:t,channel:n})),Et[t][n.url]},e.prototype.resume=function(){$.debug("Message collection changelog sync has resumed."),this._sync.resume(null,!0)},e.prototype.pause=function(){$.debug("Message collection changelog sync has paused."),this._sync.stop()},e}();!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api",e.CACHE_ONLY="cache_only"}(ot||(ot={}));var St,Nt=function(){function e(){this._onCacheResult=null,this._onApiResult=null}return e.prototype.invokeCacheResult=function(e,t){this._onCacheResult(e,t)},e.prototype.invokeApiResult=function(e,t){this._onApiResult(e,t)},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}();!function(e){e[e.BACKGROUND_SYNC_CLOSE=0]="BACKGROUND_SYNC_CLOSE",e[e.BACKGROUND_SYNC_OPEN=1]="BACKGROUND_SYNC_OPEN",e[e.FILL=2]="FILL",e[e.USER_CALL=3]="USER_CALL"}(St||(St={}));var At=100,kt=new xe({top:Number.MAX_SAFE_INTEGER,bottom:0}),Tt=new Map,It=function(e){return"sendbird@message/fill/".concat(e,"/").concat(Oe())},wt=function(){function e(e){var t=e.iid,n=e.channel,r=e.startingPoint,i=e.filter,a=e.limit,s=void 0===a?100:a,o=this;this._hugeGapCheckTimer=null,this._messages=[],this._syncRange=new xe(M({},kt)),this._hasPrevious=!0,this._hasNext=!0,this._unsentMessages=[],this._iid=t,this._channel=n,this._startingPoint=r,this._filter=i,this._limit=s,this._syncLimit=Math.max(s,At),this._eventObserver={onevent:function(e){return L(o,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,this._handleEvent(e)];case 1:return t.sent(),[2]}}))}))}},this._eventHandler={onMessagesAdded:Ke,onMessagesUpdated:Ke,onMessagesDeleted:Ke,onChannelUpdated:Ke,onChannelDeleted:Ke,onHugeGapDetected:Ke};var l=O.get(this._iid);this._localCacheEnabled=l.container.localCacheEnabled,this._localCacheEnabled&&(this._backgroundSync=vt.of(this._iid,this._channel,this._syncLimit),this._backgroundSync.resume()),this._changelogSync=Ct.of(this._iid,this._channel),this._changelogSync.resume(),this._connectionObserver={onConnect:function(){o._checkHugeGap(),o._localCacheEnabled&&o._backgroundSync.resume(),o._changelogSync.resume()},onDisconnect:function(){return L(o,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return[4,We.ready()];case 1:return e.sent()||(this._previousFillSync.stop(),this._nextFillSync.stop(),this._localCacheEnabled&&this._backgroundSync.pause(),this._changelogSync.pause()),[2]}}))}))}},this._previousFillSync=new De(It("prev"),(function(e){return L(o,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return[4,this._getRemoteMessages({ts:e,prevLimit:this._syncLimit})];case 1:return(t=i.sent()).length>0?(n=Math.min.apply(Math,t.map((function(e){return e.createdAt}))),this._syncRange.top=Math.min(this._syncRange.top,n),r=new yt(he.MESSAGE_FILL,t[0].sendingStatus),this._addOnlyMessageToView(t,{context:r}),[2,{hasNext:t.length<this._syncLimit||this._syncRange.top>=n,nextParams:this._syncRange.top}]):[2,{hasNext:!1,nextParams:0}]}}))}))})),this._nextFillSync=new De(It("next"),(function(e){return L(o,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return[4,this._getRemoteMessages({ts:e,nextLimit:this._syncLimit})];case 1:return(t=i.sent()).length>0?(n=Math.max.apply(Math,t.map((function(e){return e.createdAt}))),this._syncRange.bottom=Math.max(this._syncRange.bottom,n),r=new yt(he.MESSAGE_FILL,t[0].sendingStatus),this._addOnlyMessageToView(t,{context:r}),[2,{hasNext:t.length<this._syncLimit||this._syncRange.bottom<=n,nextParams:this._syncRange.bottom}]):[2,{hasNext:!1,nextParams:0}]}}))}))})),pe.of(this._iid).addObserver(this._connectionObserver)}return e.prototype._handleEvent=function(e){var t=e.source,n=e.payload,r=void 0===n?{}:n,i=Pi.getInstance(this._iid);switch(e.source){case he.MESSAGE_BACKGROUND:break;case he.MESSAGE_CHANGELOG:var a=r,s=a.channel,o=a.updatedMessages,l=a.deletedMessageIds;if(s&&s.url===this._channel.url){if(o&&o.length>0){this._removeMatchingUnsentMessagesFromView(o);var u=new yt(t,o[0].sendingStatus);this._addMessagesToView(o,{context:u})}l&&l.length>0&&(f=this._removeMessagesFromView(l,{})).length>0&&(u=new yt(t,f[0].sendingStatus),this._eventHandler.onMessagesDeleted(u,this._channel,f))}break;case he.LOCAL_MESSAGE_PENDING_CREATED:case he.LOCAL_MESSAGE_RESEND_STARTED:case he.LOCAL_MESSAGE_CANCELED:var c=r,d=(s=c.channel,c.message);u=new yt(t,d.sendingStatus),s.url===this._channel.url&&this._upsertUnsentMessagesToView([d],{context:u});break;case he.EVENT_MESSAGE_SENT:var h=r;if(s=h.channel,d=h.message,s.url===this._channel.url){var f=this._removeMatchingUnsentMessagesFromView([d]);this._hasNext?f.length>0&&(u=new yt(t,f[0].sendingStatus),this._eventHandler.onMessagesDeleted(u,s,f)):(this._addMessagesToView([d],{}),u=new yt(t,d.sendingStatus),f.length>0?this._eventHandler.onMessagesUpdated(u,s,[d]):this._eventHandler.onMessagesAdded(u,s,[d]))}break;case he.EVENT_MESSAGE_RECEIVED:var p=r;s=p.channel,d=p.message,s.url!==this._channel.url||this._hasNext||(u=new yt(t,d.sendingStatus),this._addMessagesToView([d],{context:u}));break;case he.LOCAL_MESSAGE_FAILED:var g=r;s=g.channel,d=g.message,s.url===this._channel.url&&d.sendingStatus===i.MessageSendingStatus.FAILED&&(u=new yt(t,d.sendingStatus),this._upsertUnsentMessagesToView([d],{context:u}));break;case he.EVENT_MESSAGE_UPDATED:var y=r;s=y.channel,d=y.message,s.url===this._channel.url&&(u=new yt(t,d.sendingStatus),this._addMessagesToView([d],{context:u,isUpdateOnly:!0}));break;case he.EVENT_MESSAGE_DELETED:var m=r,_=(s=m.channel,m.messageId);s.url===this._channel.url&&(Tt.delete(_),(f=this._removeMessagesFromView([_],{})).length>0&&(u=new yt(t,f[0].sendingStatus),this._eventHandler.onMessagesDeleted(u,this._channel,f)));break;case he.EVENT_DELIVERY_RECEIPT_UPDATED:case he.EVENT_READ_RECEIPT_UPDATED:if((s=r.channel).isGroupChannel()){o=[];for(var v=0,E=this._messages;v<E.length;v++)d=E[v],(Tt.get(d.messageId)||0)!==(T=this.channel.getUnreadMemberCount(d))&&(o.push(d),T>0?Tt.set(d.messageId,T):Tt.delete(d.messageId));o.length>0&&(u=new yt(t,o[0].sendingStatus),this._eventHandler.onMessagesUpdated(u,s,o))}break;case he.EVENT_USER_LEFT:var b=O.get(this._iid),C=r,S=(s=C.channel,C.user),N=b.get("currentUserId");if(S.userId!==N){o=[];for(var A=0,k=this._messages;A<k.length;A++){var T;d=k[A],(Tt.get(d.messageId)||0)!==(T=this.channel.getUnreadMemberCount(d))&&(o.push(d),T>0?Tt.set(d.messageId,T):Tt.delete(d.messageId))}o.length>0&&(u=new yt(t,o[0].sendingStatus),this._eventHandler.onMessagesUpdated(u,s,o))}else u=new Ie(t),this._eventHandler.onChannelDeleted(u,s.url);break;case he.EVENT_CHANNEL_CHANGED:case he.EVENT_USER_RECEIVED_INVITATION:case he.EVENT_USER_JOINED:case he.EVENT_CHANNEL_FROZEN:case he.EVENT_CHANNEL_UNFROZEN:case he.EVENT_CHANNEL_HIDDEN:case he.EVENT_CHANNEL_UNHIDDEN:case he.EVENT_USER_MUTED:case he.EVENT_USER_UNMUTED:case he.EVENT_TYPING_STATUS_UPDATED:case he.EVENT_OPERATOR_UPDATED:case he.EVENT_CHANNEL_METADATA_UPDATED:case he.EVENT_CHANNEL_METADATA_DELETED:case he.EVENT_CHANNEL_METACOUNTER_UPDATED:case he.EVENT_CHANNEL_METACOUNTER_DELETED:s=r.channel,u=new Ie(t),this._eventHandler.onChannelUpdated(u,s);break;case he.EVENT_CHANNEL_DELETED:s=r.channel,u=new Ie(t),this._eventHandler.onChannelDeleted(u,s.url)}},e.prototype._createRemoteMessageParams=function(e){var t=e.prevLimit,n=void 0===t?0:t,r=e.nextLimit,i=void 0===r?0:r,a=new(0,j.get(this._iid).MessageListParams);return a.isInclusive=!0,a.prevResultSize=n,a.nextResultSize=i,a.includeMetaArray=!0,a.includeReactions=!0,a.includeThreadInfo=!0,a.includeReplies=!0,a.includeParentMessageText=!0,this._filter.messageType&&(a.messageType=this._filter.messageType),this._filter.customTypes.length>0&&(a.customTypes=this._filter.customTypes),this._filter.senderUserIds.length>0&&(a.senderUserIds=this._filter.senderUserIds),a},e.prototype._getRemoteMessages=function(e){var t=e.ts,n=e.prevLimit,r=void 0===n?0:n,i=e.nextLimit,a=void 0===i?0:i;return L(this,void 0,void 0,(function(){var e,n,i,s;return P(this,(function(o){switch(o.label){case 0:return e=[],r>0?(i=this._createRemoteMessageParams({prevLimit:r,nextLimit:0}),[4,this._channel.getMessagesByTimestamp(t,i)]):[3,2];case 1:n=o.sent(),e=e.concat(n),this._hasPrevious=n.length>=r,o.label=2;case 2:return a>0?(i=this._createRemoteMessageParams({prevLimit:0,nextLimit:a}),[4,this._channel.getMessagesByTimestamp(t,i)]):[3,4];case 3:s=o.sent(),e=e.concat(s),this._hasNext=s.length>=a,o.label=4;case 4:return e.length>0?[4,this._upsertRemotelyFetchedMessages(e)]:[3,6];case 5:o.sent(),o.label=6;case 6:return[2,e]}}))}))},e.prototype._upsertRemotelyFetchedMessages=function(e,t){return void 0===t&&(t={}),L(this,void 0,void 0,(function(){var n,r,i,a;return P(this,(function(s){switch(s.label){case 0:return n=t.context,r=void 0===n?null:n,i=lt.of(this._iid),a=e.map((function(e){return e.reqId})),[4,i.removeUnsentMessages({channelUrl:this.channel.url,reqIds:a})];case 1:return s.sent(),this._removeMatchingUnsentMessagesFromView(e,{context:r}),[4,i.upsert(e,$e.SUCCEEDED)];case 2:return s.sent(),[2]}}))}))},e.prototype._checkHugeGap=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,g=this;return P(this,(function(y){switch(y.label){case 0:return y.trys.push([0,12,,13]),e=j.get(this._iid).BaseChannel,t=O.get(this._iid),n=t.get("apiClient"),this._messages.length>0?(r=lt.of(this._iid),i={from:this._messages[0].createdAt,to:Math.min(this._syncRange.top,this._messages[this._messages.length-1].createdAt),cachedCount:0},a=i,[4,r.countBetween(this._channel.url,this._filter,i.from,i.to)]):[3,8];case 1:return a.cachedCount=y.sent(),s={from:Math.max(this._syncRange.bottom,this._messages[0].createdAt),to:this.hasNext?this._messages[this._messages.length-1].createdAt:Number.MAX_SAFE_INTEGER,cachedCount:0},o=s,[4,r.countBetween(this._channel.url,this._filter,s.from,s.to)];case 2:return o.cachedCount=y.sent(),l={iid:this._iid,channelUrl:this._channel.url,channelType:this._channel.channelType,filter:this._filter,previous:i,next:s},[4,n.checkMessageHugeGap(M(M({},l),l.filter))];case 3:return u=y.sent(),(c={isHugeGap:!!u.is_huge_gap,previousMessages:u.prev_messages.map((function(t){return e.buildMessage(t,g._channel)}))||[],previousHasMore:!!u.prev_hasmore,nextMessages:u.next_messages.map((function(t){return e.buildMessage(t,g._channel)}))||[],nextHasMore:!!u.next_hasmore}).isHugeGap?[3,6]:(h=D(D([],c.previousMessages,!0),c.nextMessages,!0),$.debug("Message collection non-huge gap message fill count: ",h.length),h.length>0?(f=new yt(he.MESSAGE_FILL,h[0].sendingStatus),[4,this._upsertRemotelyFetchedMessages(h,{context:f})]):[3,5]);case 4:y.sent(),this._addOnlyMessageToView(h,{context:f}),this._extendSyncRange(["prev"],c.previousMessages),this._extendSyncRange(["next"],c.nextMessages),c.previousHasMore&&this._previousFillSync.run(this._syncRange.top),c.nextHasMore&&this._nextFillSync.run(this._syncRange.bottom),y.label=5;case 5:return[3,7];case 6:setTimeout((function(){return g._eventHandler.onHugeGapDetected()}),10),y.label=7;case 7:return[3,11];case 8:return d=Math.floor(this._syncLimit/2),[4,this._getRemoteMessages({ts:this._startingPoint,prevLimit:d,nextLimit:d})];case 9:return(h=y.sent()).length>0?(f=new yt(he.MESSAGE_FILL,h[0].sendingStatus),[4,this._upsertRemotelyFetchedMessages(h,{context:f})]):[3,11];case 10:y.sent(),this._addOnlyMessageToView(h,{context:f}),this._extendSyncRange(["prev","next"],this._messages),y.label=11;case 11:return[3,13];case 12:return p=y.sent(),$.warn("Message collection huge gap checker error: ",p),this._hugeGapCheckTimer=setTimeout((function(){g._hugeGapCheckTimer=null,g._checkHugeGap()}),3e3),[3,13];case 13:return[2]}}))}))},e.prototype._extendSyncRange=function(e,t){if(t.length>0){var n=t.map((function(e){return e.createdAt}));e.includes("prev")&&(this._syncRange.top=Math.min.apply(Math,D([this._syncRange.top],n,!1))),e.includes("next")&&(this._syncRange.bottom=Math.max.apply(Math,D([this._syncRange.bottom],n,!1)))}},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n.applyParentMessage(e)&&t.push(n)})),t},e.prototype._addOnlyMessageToView=function(e,t){void 0===t&&(t={});var n=t.context,r=void 0===n?null:n;t.isUpdateOnly;for(var i=Pi.getInstance(this._iid),a=[],s=0,o=e;s<o.length;s++){var l=o[s];if(l.sendingStatus===i.MessageSendingStatus.SUCCEEDED){var u=this._messages.map((function(e){return e.messageId})).indexOf(l.messageId);if(this._filter.match(l)){var c=this._channel.getUnreadMemberCount(l);if(Tt.set(l.messageId,c),-1===u){var d=nt(this._messages,l);a.push(l),this._messages.splice(d,0,l)}}}}r&&a.length>0&&this._eventHandler.onMessagesAdded(r,this._channel,a)},e.prototype._addMessagesToView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=t.isUpdateOnly,a=void 0!==i&&i,s=Pi.getInstance(this._iid),o=[],l=[],u=[],c=0,d=e;c<d.length;c++){var h=d[c];if(h.sendingStatus===s.MessageSendingStatus.SUCCEEDED){var f=this._messages.map((function(e){return e.messageId})).indexOf(h.messageId);if(this._filter.match(h)){var p=this._channel.getUnreadMemberCount(h);if(Tt.set(h.messageId,p),f>=0){if(l.push(h),this._messages[f]=h,h.updatedAt>0){var g=this._updateChildMessagesInView(h);l=l.concat(g)}}else if(!a){var y=nt(this._messages,h);o.push(h),this._messages.splice(y,0,h)}}else f>=0&&(u.push(h),this._messages.splice(f,1))}}r&&(o.length>0&&this._eventHandler.onMessagesAdded(r,this._channel,o),l.length>0&&this._eventHandler.onMessagesUpdated(r,this._channel,l),u.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,u))},e.prototype._removeMessagesFromView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=0,s=e;a<s.length;a++){var o=s[a],l=this._messages.map((function(e){return e.messageId})).indexOf(o);if(l>=0){var u=this._messages[l];i.push(u),this._messages.splice(l,1)}}return r&&i.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,i),i},e.prototype._upsertUnsentMessagesToView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=[],s=[],o=0,l=e;o<l.length;o++){var u=l[o],c=this._unsentMessages.map((function(e){return e.reqId})).indexOf(u.reqId);if(this._filter.match(u))if(c>=0)a.push(u),this._unsentMessages[c]=u;else{var d=nt(this._unsentMessages,u);i.push(u),this._unsentMessages.splice(d,0,u)}else c>=0&&(this._unsentMessages.splice(c,1),s.push(u))}r&&(i.length>0&&this._eventHandler.onMessagesAdded(r,this._channel,i),a.length>0&&this._eventHandler.onMessagesUpdated(r,this._channel,a),s.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,s))},e.prototype._removeMatchingUnsentMessagesFromView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=0,s=e;a<s.length;a++){var o=s[a];if((o.isUserMessage()||o.isFileMessage())&&o._isSentByMe()){var l=this._unsentMessages.map((function(e){return e.reqId})).indexOf(o.reqId);if(l>=0){var u=this._unsentMessages[l];i.push(u),this._unsentMessages.splice(l,1)}}}return r&&i.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,i),i},e.prototype._removeFailedMessagesFromView=function(e){var t=Pi.getInstance(this._iid),n=[],r=[],i=this._unsentMessages.map((function(e){return e.reqId}));if(e)for(var a=0,s=e;a<s.length;a++){var o=s[a],l=i.indexOf(o.reqId);l>=0&&this._unsentMessages[l].sendingStatus===t.MessageSendingStatus.FAILED?n.push(this._unsentMessages[l]):r.push(this._unsentMessages[l])}else for(var u=0,c=this._unsentMessages;u<c.length;u++)(o=c[u]).sendingStatus===t.MessageSendingStatus.FAILED?n.push(o):r.push(o);return this._unsentMessages=r,n},e._processNextAutoResend=function(e){if(e.isCacheEnabled&&!e.isInBackground&&e.getConnectionState()===e.ConnectionState.OPEN)try{var t=e.getAutoResendQueue();if(t.length>0){e.getIsProcessingAutoResend()||($.debug("Auto-resend queue started."),e.setIsProcessingAutoResend(!0));var n=t[0];$.debug("Processing auto-resend for message request id: ",n.reqId),j.get(e._iid).GroupChannel.getChannel(n.channelUrl,I.INTERNAL_CALL,(function(t,r){var i;if(e.getErrorFirstCallback()&&(r=(i=[t,r])[0],t=i[1]),r)throw r;n.isUserMessage()?t._autoResendUserMessage(n):n.isFileMessage()&&t._autoResendFileMessage(n)}))}else $.debug("Auto-resend queue finished."),e.setIsProcessingAutoResend(!1)}catch(t){$.warn("Process auto-resend error: ",t),e.setIsProcessingAutoResend(!1)}},e._completeCurrentAndProcessNextAutoResend=function(e,t){if(e.isCacheEnabled&&t._isAutoResendRegistered){var n=e.getAutoResendQueue();if(t.sendingStatus===e.MessageSendingStatus.SUCCEEDED||t.sendingStatus===e.MessageSendingStatus.FAILED&&!se.isAutoResendableError(t.errorCode))n.length>0&&t.reqId===n[0].reqId&&(n.shift(),this._processNextAutoResend(e));else if(t.sendingStatus===e.MessageSendingStatus.PENDING){if(n.length>0&&n.map((function(e){return e.reqId})).indexOf(t.reqId)>-1)return;n.push(t),!e.getIsProcessingAutoResend()&&n.length>0&&this._processNextAutoResend(e)}}},e._processAutoResendRegisteredPendingMessages=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h;return P(this,(function(f){switch(f.label){case 0:return t=lt.of(e._iid),n=me.of(e._iid),(r=new tt).sendingStatus=e.MessageSendingStatus.PENDING,[4,t.getAllUnsentMessages(r)];case 1:i=f.sent(),a=0,s=i,f.label=2;case 2:return a<s.length?(o=s[a],[4,e.GroupChannel.getChannel(o.channelUrl)]):[3,7];case 3:return l=f.sent(),o._isAutoResendRegistered?(u=(new Date).getTime(),c=o.createdAt+2592e5,u<=c?(-1===(d=e.getAutoResendQueue()).map((function(e){return e.reqId})).indexOf(o.reqId)&&d.push(o),[3,6]):[3,4]):[3,6];case 4:return $.debug("Auto-resend registered pending messaged expired. Expiration date: ",new Date(c).toLocaleString()),(h=o._clone()).sendingStatus=e.MessageSendingStatus.FAILED,h.requestState=e.MessageRequestState.FAILED,h._isAutoResendRegistered=!1,[4,t.upsert([h],$e.UNSENT)];case 5:f.sent(),n.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:l,message:h}}),f.label=6;case 6:return a++,[3,2];case 7:return[2]}}))}))},e._processNonAutoResendRegisteredPendingMessages=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l,u;return P(this,(function(c){switch(c.label){case 0:return t=lt.of(e._iid),n=me.of(e._iid),(r=new tt).sendingStatus=e.MessageSendingStatus.PENDING,[4,t.getAllUnsentMessages(r)];case 1:i=c.sent(),a=0,s=i,c.label=2;case 2:return a<s.length?(o=s[a],[4,e.GroupChannel.getChannel(o.channelUrl)]):[3,6];case 3:return l=c.sent(),o._isAutoResendRegistered?[3,5]:($.debug("Cached pending message is not auto-resend registered. Changing its sending status to failed: ",o.reqId),(u=o._clone()).sendingStatus=e.MessageSendingStatus.FAILED,u.requestState=e.MessageRequestState.FAILED,u.errorCode=F.ACK_TIMEOUT,[4,t.upsert([u],$e.UNSENT)]);case 4:c.sent(),n.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:l,message:u}}),c.label=5;case 5:return a++,[3,2];case 6:return[2]}}))}))},Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return this._messages},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){var e=Pi.getInstance(this._iid);return this._unsentMessages.filter((function(t){return t.sendingStatus===e.MessageSendingStatus.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){var e=Pi.getInstance(this._iid);return this._unsentMessages.filter((function(t){return t.sendingStatus===e.MessageSendingStatus.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startingPoint",{get:function(){return this._startingPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){var t=this,n=new Nt;this._messages=[],this._syncRange=new xe(M({},kt)),this._hasNext=!0,this._hasPrevious=!0;var r=Math.floor(this._limit/2),i=lt.of(this._iid),a=me.of(this._iid);switch(e){case ot.CACHE_ONLY:i.getPreviousAndNextMessages(this._channel.url,this._filter,this._startingPoint,r).then((function(e){return L(t,void 0,void 0,(function(){var t;return P(this,(function(r){switch(r.label){case 0:return[4,i.getUnsentMessages(this._channel.url,this._filter)];case 1:return t=r.sent(),this._upsertUnsentMessagesToView(t),this._addMessagesToView(e),n.invokeCacheResult(null,e),[2]}}))}))})).catch((function(e){n.invokeCacheResult(e,null)})).finally((function(){a.addObserver(t._eventObserver)}));break;case ot.CACHE_AND_REPLACE_BY_API:i.getPreviousAndNextMessages(this._channel.url,this._filter,this._startingPoint,r).then((function(e){return L(t,void 0,void 0,(function(){var t;return P(this,(function(r){switch(r.label){case 0:return[4,i.getUnsentMessages(this._channel.url,this._filter)];case 1:return t=r.sent(),this._upsertUnsentMessagesToView(t),this._addMessagesToView(e),n.invokeCacheResult(null,e),[2]}}))}))})).catch((function(e){n.invokeCacheResult(e,null)})).finally((function(){t._getRemoteMessages({ts:t._startingPoint,prevLimit:r,nextLimit:r}).then((function(e){t._messages=[],t._addMessagesToView(e),t._extendSyncRange(["prev","next"],t._messages),n.invokeApiResult(null,e)})).catch((function(e){n.invokeApiResult(e,null)})).finally((function(){a.addObserver(t._eventObserver)}))}))}return n},e.prototype.loadPrevious=function(){return L(this,void 0,void 0,(function(){var e,t;return P(this,(function(n){switch(n.label){case 0:return this._hasPrevious?(e=this._messages.length>0?Math.min.apply(Math,this._messages.map((function(e){return e.createdAt}))):Number.MAX_SAFE_INTEGER,[4,We.ready()]):[3,5];case 1:return n.sent()?[3,3]:($.debug("Message collection loadPrevious() from the cache."),[4,lt.of(this._iid).getPreviousMessages(this._channel.url,this._filter,e,this._limit)]);case 2:return t=n.sent(),this._addMessagesToView(t),[2,t];case 3:return $.debug("Message collection loadPrevious() from the server."),[4,this._getRemoteMessages({ts:e,prevLimit:this._limit})];case 4:return t=n.sent(),this._addMessagesToView(t),it(this._syncRange,["prev"],this._messages),[2,t];case 5:return[2,[]]}}))}))},e.prototype.loadNext=function(){return L(this,void 0,void 0,(function(){var e,t;return P(this,(function(n){switch(n.label){case 0:return this._hasNext?(e=this._messages.length>0?Math.max.apply(Math,this._messages.map((function(e){return e.createdAt}))):0,[4,We.ready()]):[3,5];case 1:return n.sent()?[3,3]:($.debug("Message collection loadNext() from the cache."),[4,lt.of(this._iid).getNextMessages(this._channel.url,this._filter,e,this._limit)]);case 2:return t=n.sent(),this._addMessagesToView(t),[2,t];case 3:return $.debug("Message collection loadNext() from the server."),[4,this._getRemoteMessages({ts:e,nextLimit:this._limit})];case 4:return t=n.sent(),this._addMessagesToView(t),it(this._syncRange,["next"],this._messages),[2,t];case 5:return[2,[]]}}))}))},e.prototype.removeFailedMessages=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i;return P(this,(function(a){switch(a.label){case 0:return t=Pi.getInstance(this._iid),n=lt.of(this._iid),r=e.map((function(e){return e.reqId})),[4,n.removeUnsentMessages({channelUrl:this.channel.url,sendingStatus:t.MessageSendingStatus.FAILED,reqIds:r})];case 1:return i=a.sent(),this._removeFailedMessagesFromView(e),[2,i]}}))}))},e.prototype.removeAllFailedMessages=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return e=Pi.getInstance(this._iid),[4,lt.of(this._iid).removeUnsentMessages({channelUrl:this.channel.url,sendingStatus:e.MessageSendingStatus.FAILED})];case 1:return t.sent(),this._removeFailedMessagesFromView(),[2]}}))}))},e.prototype.dispose=function(){this._localCacheEnabled&&(this._previousFillSync.stop(),this._nextFillSync.stop(),this._backgroundSync.pause()),this._changelogSync.pause(),pe.of(this._iid).removeObserver(this._connectionObserver),this._hugeGapCheckTimer&&(clearTimeout(this._hugeGapCheckTimer),this._hugeGapCheckTimer=null),me.of(this._iid).removeObserver(this._eventObserver)},e.prototype.setMessageCollectionHandler=function(e){this._eventHandler=e},e}(),Ot={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},Ut=new WeakMap,Rt=new WeakMap,Mt=function(){function e(t){d(this,e),this.url="",this.channelType=e.CHANNEL_TYPE_BASE,this.name="",this.coverUrl="",this.creator=null,this.createdAt=0,this.data=null,this.customType=null,this.isFrozen=!1,this.isEphemeral=!1,Ut.set(this,{}),Rt.set(this,""),t&&this.__update(t)}return f(e,[{key:"__update",value:function(e){this.url=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.name=e.hasOwnProperty("name")?String(e.name):"",this.coverUrl=e.hasOwnProperty("cover_url")?String(e.cover_url):"",this.createdAt=e.hasOwnProperty("created_at")?1e3*e.created_at:0,this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?e.custom_type:"",this.isFrozen=!!e.hasOwnProperty("freeze")&&e.freeze,this.isEphemeral=!!e.hasOwnProperty("is_ephemeral")&&e.is_ephemeral,e.hasOwnProperty("created_by")&&null!==e.created_by&&"object"===c(e.created_by)&&Object.keys(e.created_by).length>0?this.creator=new gt(e.created_by):this.creator=null,e.hasOwnProperty("metadata")&&null!==e.metadata&&(e.hasOwnProperty("ts")&&"number"==typeof e.ts?this._refreshMetaData(e.metadata,e.ts):this._refreshMetaData(e.metadata,-1)),e.hasOwnProperty("cached_primary_key")&&(this.cachedPrimaryKey=e.cached_primary_key)}},{key:"_addOrUpdateCachedMetaData",value:function(e,t){var n=this,r=Ut.get(this);Object.keys(e).forEach((function(i){var a=r[i],s=e[i];a?t>a.updatedAt&&(a.value=s,a.updatedAt=t,a.isRemoved=!1):r[i]={value:s,updatedAt:t,isRemoved:!1},et.of(n._iid).upsert([n]).then((function(){})).catch((function(e){$.error(e)}))}))}},{key:"_markAsDeletedCachedMetaData",value:function(e,t){var n=this,r=Ut.get(this);e.forEach((function(e){var i=r[e];i?t>i.updatedAt&&(i.isRemoved=!0,i.updatedAt=t):r[e]={value:null,updatedAt:t,isRemoved:!0},et.of(n._iid).upsert([n]).then((function(){})).catch((function(e){$.error(e)}))}))}},{key:"_refreshMetaData",value:function(e,t){var n={};Object.keys(e).forEach((function(r){n[r]={value:e[r],updatedAt:t,isRemoved:!1}})),Ut.set(this,n)}},{key:"_clearCachedMetaData",value:function(){Ut.set(this,{})}},{key:"cachedPrimaryKey",get:function(){return Rt.get(this)},set:function(e){Rt.set(this,e)}},{key:"isGroupChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"createOperatorListQuery",value:function(){return new(0,j.get(this._iid).OperatorListQuery)(this)}},{key:"createMessageListQuery",value:function(){return new(0,j.get(this._iid).MessageListQuery)(this)}},{key:"createPreviousMessageListQuery",value:function(){return new(0,j.get(this._iid).PreviousMessageListQuery)(this)}},{key:"serialize",value:function(){var e=this;return dt.serialize(this,(function(t){if(null!==t.lastMessage&&"object"===c(t.lastMessage)){var n=t.lastMessage;n.hasOwnProperty("_sender")&&(n.sender=n._sender,delete n._sender,t.lastMessage=n)}t.hasOwnProperty("_messageOffsetTimestamp")&&(t.messageOffsetTimestamp=t._messageOffsetTimestamp,delete t._messageOffsetTimestamp),t.metadata=e.getCachedMetaData(),e.cachedPrimaryKey&&(t.cachedPrimaryKey=e.cachedPrimaryKey)}))}},{key:"getMessageChangeLogsByTimestamp",value:function(e,t,n,r){var i=this,a=null,s=ve.parse(arguments,[new ve({type:"number",constraint:function(e){return e>=0}}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):O.get(i._iid).container.apiClient.getMessageChangeLogs({channelUrl:i.url,ts:e,token:null,isOpenChannel:i.isOpenChannel(),includeMetaArray:t,includeReactions:n}).then((function(e){var t=j.get(i._iid).BaseChannel,n={updatedMessages:e.updated.map((function(e){return t.buildMessage(e,i)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};r(null,n)})).catch((function(e){r(e,null)}))}),r)}},{key:"getMessageChangeLogsByToken",value:function(e,t,n,r){var i=this,a=null,s=S(ve.parse(arguments,[new ve({type:"string",nullable:!0}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),5);return a=s[0],e=s[1],t=s[2],n=s[3],r=s[4],le(this._iid,(function(r){a?r(a,null):O.get(i._iid).container.apiClient.getMessageChangeLogs({channelUrl:i.url,ts:null,token:e,isOpenChannel:i.isOpenChannel(),includeMetaArray:t,includeReactions:n}).then((function(e){var t=j.get(i._iid).BaseChannel,n={updatedMessages:e.updated.map((function(e){return t.buildMessage(e,i)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};r(null,n)})).catch((function(e){r(e,null)}))}),r)}},{key:"getMessageChangeLogsSinceToken",value:function(e,t,n){var r=this,i=j.get(this._iid),a=i.BaseChannel,s=i.MessageChangeLogsParams,o=null,l=ve.parse(arguments,[new ve({type:"string",nullable:!0}),new ve({type:s,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),c=S(l,4);return o=c[0],e=c[1],t=c[2],n=c[3],le(this._iid,(function(n){o?n(o,null):O.get(r._iid).container.apiClient.getMessageChangeLogs(u({channelUrl:r.url,ts:null,token:e,isOpenChannel:r.isOpenChannel()},t)).then((function(e){var t={updatedMessages:e.updated.map((function(e){return a.buildMessage(e,r)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};n(null,t)})).catch((function(e){n(e,null)}))}),n)}},{key:"getMessageChangeLogsSinceTimestamp",value:function(e,t,n){var r=this,i=j.get(this._iid),a=i.BaseChannel,s=i.MessageChangeLogsParams,o=null,l=ve.parse(arguments,[new ve({type:"number",constraint:function(e){return e>=0}}),new ve({type:s,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),c=S(l,4);return o=c[0],e=c[1],t=c[2],n=c[3],le(this._iid,(function(n){o?n(o,null):O.get(r._iid).container.apiClient.getMessageChangeLogs(u({channelUrl:r.url,timestamp:e,token:null,isOpenChannel:r.isOpenChannel()},t)).then((function(e){var t={updatedMessages:e.updated.map((function(e){return a.buildMessage(e,r)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};n(null,t)})).catch((function(e){n(e,null)}))}),n)}},{key:"getMyMutedInfo",value:function(e){var t=this;return le(this._iid,(function(e){var n=Pi.getInstance(t._iid);O.get(t._iid).container.apiClient.getMyMutedInfo({channelUrl:t.url,userId:n.currentUser?n.currentUser.userId:null,isGroupChannel:t.isGroupChannel()},(function(t,n){var r=null;t||(r={isMuted:n.is_muted,startAt:n.start_at,endAt:n.end_at,remainingDuration:n.remaining_duration,description:n.description}),e(t,r)}))}),e)}},{key:"_parseMessageListParams",value:function(e){for(var t=new(0,j.get(this._iid).MessageListParams),n=null,r=!1,i=0,a=0,s=!1,o="",l="",u=null,c=!1,d=!1,h=null,f=arguments.length,p=new Array(f>1?f-1:0),g=1;g<f;g++)p[g-1]=arguments[g];switch(e){case"prev":var y=S(ve.parse(p,[new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"string"}),new ve({type:"string"}),new ve({type:"array",optional:!0}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),11);n=y[0],r=y[2],i=y[3],s=y[4],o=y[5],l=y[6],u=y[7],c=y[8],d=y[9],h=y[10];break;case"next":var m=S(ve.parse(p,[new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"string"}),new ve({type:"string"}),new ve({type:"array",optional:!0}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),11);n=m[0],r=m[2],a=m[3],s=m[4],o=m[5],l=m[6],u=m[7],c=m[8],d=m[9],h=m[10];break;case"prevnext":var _=S(ve.parse(p,[new ve({type:"number"}),new ve({type:"number"}),new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"string"}),new ve({type:"string"}),new ve({type:"array",optional:!0}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),11);n=_[0],i=_[2],a=_[3],s=_[4],o=_[5],l=_[6],u=_[7],c=_[8],d=_[9],h=_[10],r=!0}return n?[null,h]:(t.isInclusive=r,t.prevResultSize=i,t.nextResultSize=a,t.reverse=s,t.messageType=o,t.customType=l,""===t.customType&&(t.customType="*"),t.senderUserIds=u,t.includeMetaArray=c,t.includeReactions=d,[t,h])}},{key:"_getMessageList",value:function(e,t,n,r){var i=this,a=j.get(this._iid).MessageListParams,s=null,o=ve.parse(arguments,[new ve({type:"number"}),new ve({type:"string",constraint:function(e){return Object.values(Ot).includes(e)}}),new ve({type:a,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),l=S(o,5);return s=l[0],e=l[1],t=l[2],n=l[3],r=l[4],le(this._iid,(function(r){s?r(s,null):O.get(i._iid).container.apiClient.getMessageList(u(u({channel:i,token:e,tokenType:t},n),{},{shouldReverse:n.reverse})).then((function(e){var t=j.get(i._iid).BaseChannel,n=e.messages.map((function(e){return t.buildMessage(e,i)})).filter((function(e){return null!==e}));r(null,n)})).catch((function(e){r(e,null)}))}),r)}},{key:"getPreviousMessagesByTimestamp",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prev"].concat(N(ve.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,Ot.TIMESTAMP,n,r)}},{key:"getNextMessagesByTimestamp",value:function(e){var t=S(this._parseMessageListParams.apply(this,["next"].concat(N(ve.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,Ot.TIMESTAMP,n,r)}},{key:"getPreviousAndNextMessagesByTimestamp",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prevnext"].concat(N(ve.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,Ot.TIMESTAMP,n,r)}},{key:"getPreviousMessagesByID",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prev"].concat(N(ve.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,Ot.MESSAGE_ID,n,r)}},{key:"getNextMessagesByID",value:function(e){var t=S(this._parseMessageListParams.apply(this,["next"].concat(N(ve.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,Ot.MESSAGE_ID,n,r)}},{key:"getPreviousAndNextMessagesByID",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prevnext"].concat(N(ve.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,Ot.MESSAGE_ID,n,r)}},{key:"getMessagesByTimestamp",value:function(e,t,n){return this._getMessageList(e,Ot.TIMESTAMP,t,n)}},{key:"getMessagesByMessageId",value:function(e,t,n){return this._getMessageList(e,Ot.MESSAGE_ID,t,n)}},{key:"_sendUserMessage",value:function(e){var t=this,n=e.reqId,r=e.message,i=e.data,a=e.customType,s=e.metaArrays,o=e.mentionType,l=e.mentionedUserIds,c=e.mentionedUsers,d=e.mentionedMessageTemplate,h=e.pushNotificationDeliveryOption,f=e.rootMessageId,p=e.parentMessageId,g=e.translationTargetLanguages,y=e.appleCriticalAlertOptions,m=e.silent,_=void 0!==m&&m,v=e.isReplyToChannel,E=e.messageParams,b=e.oldMessage,C=void 0===b?null:b,S=e.isManualResend,N=void 0!==S&&S,A=e.callback,k=j.get(this._iid),T=k.Command,I=k.UserMessage,w=Pi.getInstance(this._iid),U=lt.of(this._iid),R=et.of(this._iid),M=me.of(this._iid),L=O.get(this._iid).container.localCacheEnabled;n||(n=T.generateRequestId());var P={};Array.isArray(g)&&g.forEach((function(e){return P[e]=""}));var D=I.objectify({messageId:0,reqId:n,user:w.currentUser||{},channel:this,message:r,data:i,customType:a,metaArrays:s,mentionType:o,mentionedUserIds:l,mentionedUsers:c,mentionedMessageTemplate:d,rootMessageId:f,parentMessageId:p,translations:P,silent:_,appleCriticalAlertOptions:y,isReplyToChannel:v,messageParams:E,createdAt:(new Date).getTime()}),x=new I(D);if(x.requestState=w.MessageRequestState.PENDING,x.sendingStatus=w.MessageSendingStatus.PENDING,x.requestedMentionUserIds=l,x._messageParams=E,!w.currentUser){var H=new F("Connection should be made first.",F.CONNECTION_REQUIRED),G=new I(D);return G.requestState=w.MessageRequestState.FAILED,G.sendingStatus=w.MessageSendingStatus.FAILED,G.requestedMentionUserIds=l,G.errorCode=H.code,A(H,G),x}return(!t.isGroupChannel()||C&&C._isAutoResendRegistered?Promise.resolve():U.upsert([x],$e.UNSENT).then((function(){M.send({source:N?he.LOCAL_MESSAGE_RESEND_STARTED:he.LOCAL_MESSAGE_PENDING_CREATED,payload:{channel:t,message:x}})}))).then((function(){var e=T.bMessage({channelUrl:t.url,message:r,data:i,customType:a,metaArrays:s,mentionType:o,mentionedUserIds:l,mentionedMessageTemplate:d,requestId:n,rootMessageId:f,parentMessageId:p,silent:_,translationTargetLanguages:g,pushNotificationDeliveryOption:h,appleCriticalAlertOptions:y,isReplyToChannel:v});x.reqId=e.requestId,t.isGroupChannel()&&w.getConnectionState()!==w.ConnectionState.OPEN&&w.currentUser&&!w.connecting&&!w.reconnecting&&"string"==typeof a&&0===a.indexOf("SB_VIDEOCHAT")?O.get(w._iid).container.apiClient.sendUserMessage({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),message:r,data:i,customType:a,translationTargetLanguages:g,metaArrays:s,mentionType:o,mentionedUserIds:l,mentionedMessageTemplate:d,pushNotificationDeliveryOption:h,rootMessageId:f,parentMessageId:p,appleCriticalAlertOptions:y,isReplyToChannel:v},(function(e,r){var i=null;if(e){if(x._isAutoResendRegistered&&se.isAutoResendableError(e.code))return;(i=new I(D)).requestState=w.MessageRequestState.FAILED,i.requestedMentionUserIds=l,C&&(i._isAutoResendRegistered=C._isAutoResendRegistered),e.code===F.REQUEST_CANCELED?(i.sendingStatus=w.MessageSendingStatus.CANCELED,U.removeUnsentMessages({channelUrl:t.url,sendingStatus:w.MessageSendingStatus.PENDING,reqIds:[n]}).then((function(){M.send({source:he.LOCAL_MESSAGE_CANCELED,payload:{channel:t,message:i}})})).catch((function(e){return $.error(e)})).finally((function(){A&&A(new F(e.message,e.code),i)}))):(i.errorCode=e.code,i.sendingStatus=w.MessageSendingStatus.FAILED,L&&se.isAutoResendableError(e.code)&&(i.sendingStatus=w.MessageSendingStatus.PENDING,i.errorCode=0,i._isAutoResendRegistered=!0),U.upsert([i],$e.UNSENT).then((function(){wt._completeCurrentAndProcessNextAutoResend(w,i),M.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:t,message:i}})})).catch((function(e){return $.error(e)})).finally((function(){var t=i._clone();t.sendingStatus=w.MessageSendingStatus.FAILED,t.errorCode=e.code,t._isAutoResendRegistered=!1,A&&A(new F(e.message,e.code),t)})))}else{for(var a in(i=new I(r)).reqId=n,i.requestState=w.MessageRequestState.SUCCEEDED,i.sendingStatus=w.MessageSendingStatus.SUCCEEDED,C&&(i._isAutoResendRegistered=C._isAutoResendRegistered),t.lastMessage=i,w.channelHandlers)w.channelHandlers[a].onChannelChanged(t);R.upsert([t]).then((function(){M.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}})})).then((function(){return U.removeUnsentMessages({channelUrl:t.url,sendingStatus:w.MessageSendingStatus.PENDING,reqIds:[n]})})).then((function(){return U.upsert([i],$e.SUCCEEDED)})).then((function(){wt._completeCurrentAndProcessNextAutoResend(w,i),M.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:t,message:i}})})).catch((function(e){return $.error(e)})).finally((function(){A&&A(null,i)}))}})):w.sendCommand(e,(function(r,i){if(w.getErrorFirstCallback()){var a=[r,i];i=a[0],r=a[1]}if(i){if(x._isAutoResendRegistered&&se.isAutoResendableError(i.code))return;var s=new I(D);s.reqId=e.requestId,s.requestState=w.MessageRequestState.FAILED,i.code===F.REQUEST_CANCELED?(s.sendingStatus=w.MessageSendingStatus.CANCELED,t.isGroupChannel()&&U.removeUnsentMessages({channelUrl:t.url,sendingStatus:w.MessageSendingStatus.PENDING,reqIds:[n]}).then((function(){M.send({source:he.LOCAL_MESSAGE_CANCELED,payload:{channel:t,message:s}})})).catch((function(e){return $.error(e)})).finally((function(){A&&A(new F(i.message,i.code),s)}))):(s.sendingStatus=w.MessageSendingStatus.FAILED,s.errorCode=i.code,s.requestedMentionUserIds=l,t.isGroupChannel()?(L&&se.isAutoResendableError(i.code)&&(s.sendingStatus=w.MessageSendingStatus.PENDING,s.errorCode=0,s._isAutoResendRegistered=!0),U.upsert([s],$e.UNSENT).then((function(){return wt._completeCurrentAndProcessNextAutoResend(w,s),M.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:t,message:s}})})).catch((function(e){return $.error(e)})).finally((function(){var e=s._clone();e.sendingStatus=w.MessageSendingStatus.FAILED,e.errorCode=i.code,e._isAutoResendRegistered=!1,A&&A(new F(i.message,i.code),e)}))):A&&A(new F(i.message,i.code),s))}else{var o=new I(u(u({},r.getJsonElement()),{},{messageParams:E}));o.reqId=n,o.requestState=w.MessageRequestState.SUCCEEDED,o.sendingStatus=w.MessageSendingStatus.SUCCEEDED,C&&(o._isAutoResendRegistered=C._isAutoResendRegistered);var c=w.currentUser;if(c&&o._sender&&c.userId===o._sender.userId&&(c.nickname!==o._sender.nickname&&(c.nickname=o._sender.nickname),c.plainProfileUrl!==o._sender.plainProfileUrl&&(c.plainProfileUrl=o._sender.plainProfileUrl),se.deepEqual(c.metaData,o._sender.metaData)||(c.metaData=o._sender.metaData)),t.isGroupChannel()){t.lastMessage=o,Object.keys(w.channelHandlers).forEach((function(e){w.channelHandlers[e].onChannelChanged(t)}));var d=me.of(t._iid);et.of(t._iid).upsert([t]).then((function(){d.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}})})).then((function(){return U.removeUnsentMessages({channelUrl:t.url,sendingStatus:w.MessageSendingStatus.PENDING,reqIds:[n]})})).then((function(){return U.upsert([o],$e.SUCCEEDED)})).then((function(){wt._completeCurrentAndProcessNextAutoResend(w,o),d.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:t,message:o}})})).catch((function(e){return $.error(e)})).finally((function(){A&&A(null,o)}))}else A&&A(null,o)}}))})),x}},{key:"sendUserMessage",value:function(){var e=ve.toArray(arguments),t=e.pop(),n=null,r=null,i=j.get(this._iid).UserMessageParams;if("function"==typeof t)if(e[0]instanceof i)null===(r=e[0]).data&&(r.data=""),null===r.customType&&(r.customType="");else if("string"==typeof e[0])switch((r=new i).data="",r.customType="",r.message=e[0],e.length){case 1:break;case 2:r.data=e[1]||"";break;case 3:r.data=e[1]||"",r.customType=e[2]||"";break;case 4:r.data=e[1]||"",r.customType=e[2]||"",r.translationTargetLanguages=Array.isArray(e[3])?e[3]:[e[3]];break;default:n=ve.error}else n=ve.error;else n=ve.error;var a=O.get(this._iid).container.isErrorFirstInCallback;return!n&&r._validate()&&r.message?this._sendUserMessage(u(u({},r),{},{metaArrays:r.metaArrays,mentionType:r.mentionType,mentionedUserIds:r._mentionedUserIds,mentionedUsers:r.mentionedUsers,mentionedMessageTemplate:r.mentionedMessageTemplate,rootMessageId:r.rootMessageId,parentMessageId:r.parentMessageId,translationTargetLanguages:r._translationTargetLanguages,messageParams:r,callback:function(e,n){a?t(e,n):t(n,e)}})):(a?t(ve.error,null):t(null,ve.error),null)}},{key:"_autoResendUserMessage",value:function(e){var t=this,n=Pi.getInstance(this._iid);if(n&&n.currentUser){var r=e._messageParams;return new Promise((function(n,i){return t._sendUserMessage(u(u({},r),{},{reqId:e.reqId,metaArrays:r.metaArrays,mentionType:r.mentionType,mentionedUserIds:r._mentionedUserIds,rootMessageId:r.rootMessageId,parentMessageId:r.parentMessageId,translationTargetLanguages:r._translationTargetLanguages,pushNotificationDeliveryOption:r.pushNotificationDeliveryOption,messageParams:r,oldMessage:e,callback:function(e,t){e?i(e):n(t)}}))}))}}},{key:"_autoResendFileMessage",value:function(e){var t=Pi.getInstance(this._iid);if(t&&t.currentUser){var n=this._parsePendingFileMessage(e),r=j.get(this._iid).FileMessageQueue;r.create(this).addJob(new r.Job({fileInfo:n,pendingMessage:e._clone(),requestId:e.reqId,error:n.error,response:null}))}}},{key:"resendUserMessage",value:function(e,t){var n=this,r=j.get(this._iid),i=r.UserMessage,a=r.UserMessageParams,s=null,o=ve.parse(arguments,[new ve({type:i,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===n.url&&"string"==typeof e.message&&"string"==typeof e.data&&"string"==typeof e.customType&&"object"===c(e.translations)&&!Array.isArray(e.translations)}}),new ve({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)s.message+=" Please check if the failed message is resend-able with `message.isResendable().`",t(s,null);else{var r=Object.keys(e.translations),i=a.PushNotificationDeliveryOption.DEFAULT;n._sendUserMessage(u(u({},e),{},{mentionedUserIds:e.requestedMentionUserIds,translationTargetLanguages:r,pushNotificationDeliveryOption:i,reqId:e.reqId,messageParams:e._messageParams,isManualResend:!0,callback:t}))}}),t)}},{key:"updateUserMessage",value:function(e,t,n,r,i){var a=this,s=j.get(this._iid),o=s.Command,l=s.UserMessage,c=s.UserMessageParams,d=arguments,h=null,f=null;if("number"==typeof e)switch(d.length){case 3:var p=S(ve.parse(d,[new ve({type:"number"}),new ve({type:c}),new ve({type:"callback"})]),4);h=p[0],e=p[1],f=p[2],i=p[3];break;case 5:f=new c;var g=S(ve.parse(d,[new ve({type:"number"}),new ve({type:"string",nullable:!0}),new ve({type:"string",nullable:!0}),new ve({type:"string",nullable:!0}),new ve({type:"callback"})]),6);h=g[0],e=g[1],t=g[2],n=g[3],r=g[4],i=g[5],f.message=t,f.data=n,f.customType=r}return le(this._iid,(function(t){if(!h&&f&&f._validate()){var n=o.bUpdateUserMessage(u(u({channelUrl:a.url,messageId:e},f),{},{mentionType:f._mentionType,mentionedUserIds:f._mentionedUserIds,mentionedMessageTemplate:f.mentionedMessageTemplate})),r=Pi.getInstance(a._iid);r.sendCommand(n,(function(e,n){if(r.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}var s=null;if(!n&&(s=new l(u(u({},e.getJsonElement()),{},{messageParams:f})),a.isGroupChannel())){var o=!1;a.lastMessage?(a.lastMessage.createdAt<s.createdAt||a.lastMessage.createdAt===s.createdAt&&a.lastMessage.messageId===s.messageId&&a.lastMessage.updatedAt<s.updatedAt)&&(a.lastMessage=s,o=!0):(a.lastMessage=s,o=!0);var c=me.of(a._iid);!s.silent&&o&&(Object.keys(r.channelHandlers).forEach((function(e){r.channelHandlers[e].onChannelChanged(a)})),et.of(a._iid).upsert([a]).then((function(){c.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:a}})})).catch((function(e){return $.error(e)}))),lt.of(a._iid).upsert([s],$e.SUCCEEDED).then((function(){c.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:a,message:s}})})).catch((function(e){return $.error(e)}))}t(n,s)}))}else t(ve.error,null)}),i)}},{key:"translateUserMessage",value:function(e,t,n){var r=this,i=Pi.getInstance(this._iid),a=j.get(this._iid).UserMessage,s=null,o=ve.parse(arguments,[new ve({type:a,constraint:function(e){return e.channelUrl===r.url&&e.sendingStatus===i.MessageSendingStatus.SUCCEEDED}}),new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),l=S(o,4);return s=l[0],e=l[1],t=l[2],n=l[3],le(this._iid,(function(n){s?n(s,null):O.get(r._iid).container.apiClient.translateUserMessage({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),messageId:e.messageId,translationTargetLanguages:t},(function(e,t){var r=null;e||(r=new a(t)),n(e,r)}))}),n)}},{key:"_parsePendingFileMessage",value:function(e){var t=e._messageParams.serialize(),n=t.data,r=t.customType,i=t.fileUrl,a=t.thumbnailSizes,s=t.mentionType,o=t.mentionedUserIds,l=t.metaArrays,u=t.parentMessageId,c=t.pushNotificationDeliveryOption,d=e._messageParams;return{file:d.file?d.file:i,name:e.name,type:e.type,size:e.size,data:n,customType:r,thumbnailSizes:a,metaArrays:l,mentionType:s,mentionedUserIds:o,pushNotificationDeliveryOption:c,rootMessageId:u,parentMessageId:u,appleCriticalAlertOptions:d.appleCriticalAlertOptions,messageParams:e._messageParams,silent:e.silent,error:null,progressHandler:null,callback:null}}},{key:"_parseFileMessageArguments",value:function(e){var t=j.get(this._iid),n=t.BaseMessageParams,r=t.FileMessageParams,i={reqId:null,error:null,file:null,name:null,type:null,size:null,data:"",customType:"",thumbnailSizes:[],metaArrays:[],mentionType:n.MentionType.USERS,mentionedUserIds:[],pushNotificationDeliveryOption:r.PushNotificationDeliveryOption.DEFAULT,rootMessageId:null,parentMessageId:null,progressHandler:null,silent:!1,appleCriticalAlertOptions:null,isReplyToChannel:!1,messageParams:null,callback:null};if("function"==typeof e[e.length-1]&&(i.callback=e.pop()),"function"==typeof e[e.length-1]&&(i.progressHandler=e.pop()),e[0]instanceof r)i.reqId=e[0]._reqId,i.file=e[0].file||e[0].fileUrl,i.name=e[0].fileName,i.type=e[0].mimeType,i.size=e[0].fileSize,i.data=e[0].data,i.customType=e[0].customType,i.thumbnailSizes=e[0].thumbnailSizes,i.metaArrays=e[0].metaArrays,i.mentionType=e[0]._mentionType,i.mentionedUserIds=e[0]._mentionedUserIds,i.pushNotificationDeliveryOption=e[0].pushNotificationDeliveryOption?e[0].pushNotificationDeliveryOption:r.PushNotificationDeliveryOption.DEFAULT,i.rootMessageId=e[0].rootMessageId,i.parentMessageId=e[0].parentMessageId,i.silent=e[0].silent,e[0]._validate()||(i.error=ve.error),i.appleCriticalAlertOptions=e[0].appleCriticalAlertOptions,i.isReplyToChannel=e[0].isReplyToChannel,i.messageParams=e[0];else if(se.isFile(e[0])||"string"==typeof e[0]){switch(i.file=e[0],e.length){case 1:break;case 2:i.data=e[1];break;case 3:i.data=e[1],i.customType=e[2];break;case 4:i.data=e[1],i.customType=e[2],i.thumbnailSizes=e[3];break;case 5:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4];break;case 6:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4],i.customType=e[5];break;case 7:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4],i.customType=e[5],i.thumbnailSizes=e[6]}var a=S(ve.parse([i.file,i.name,i.type,i.size,i.data,i.customType,i.thumbnailSizes],[new ve({type:["file","string"]}),new ve({type:"string",nullable:!0}),new ve({type:"string",nullable:!0}),new ve({type:"number",nullable:!0,constraint:function(e){return e>=0}}),new ve({type:"string",nullable:!0}),new ve({type:"string",nullable:!0}),new ve({type:"array"})]),8);i.error=a[0],i.file=a[1],i.name=a[2],i.type=a[3],i.size=a[4],i.data=a[5],i.customType=a[6],i.thumbnailSizes=a[7];var s=se.isFile(i.file);s&&(i.name=i.name||i.file.name,i.type=i.type||i.file.type,i.size=i.size||i.file.size),i.messageParams={mentionType:n.MentionType.USERS,mentionedUserIds:i.mentionedUserIds,cachedMentionedUsers:[],cachedMentionedUserIds:[],metaArrays:i.metaArrays,parentMessageId:i.parentMessageId,pushNotificationDeliveryOption:i.pushNotificationDeliveryOption,appleCriticalAlertOptions:i.appleCriticalAlertOptions,fileName:i.name,mimeType:i.type,fileSize:i.size,data:i.data,customType:i.customType,isUpdate:!1,file:s?i.file:null,fileUrl:s?null:i.file,thumbnailSizes:i.thumbnailSizes}}else i.error=ve.error;return se.isFile(i.file)&&(i.name=i.name||i.file.name,i.type=i.type||i.file.type,i.size=i.size||i.file.size),i}},{key:"_createTempFileMessage",value:function(e){try{var t,n=Pi.getInstance(this._iid),r=j.get(this._iid),i=r.Command,a=r.FileMessage,s=u(u({},e),{},{messageId:0,reqId:null!==(t=e.reqId)&&void 0!==t?t:i.generateRequestId(),user:n.currentUser||{},channel:this,plainUrl:"string"==typeof e.file?e.file:"",thumbnails:e.thumbnailSizes.map((function(e){return{url:"",plainUrl:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}})),sendingStatus:n.MessageSendingStatus.PENDING,createdAt:(new Date).getTime()}),o=a.objectify(s);return new a(o)}catch(e){return null}}},{key:"sendFileMessage",value:function(){var e=this,t=ve.toArray(arguments),n=this._parseFileMessageArguments(t),r=j.get(this._iid).Command,i=null,a=r.generateRequestId();n.error||((i=this._createTempFileMessage(n)).requestedMentionUserIds=n.mentionedUserIds,a=i.reqId);var s=Pi.getInstance(this._iid);if(s&&s.currentUser||(n.error=new F("Connection should be made first.",F.CONNECTION_REQUIRED)),this.isGroupChannel()){var o=lt.of(this._iid),l=me.of(this._iid);o.upsert([i],$e.UNSENT).then((function(){l.send({source:he.LOCAL_MESSAGE_PENDING_CREATED,payload:{channel:e,message:i}})}))}var u=j.get(this._iid).FileMessageQueue;return u.create(this).addJob(new u.Job({fileInfo:n,pendingMessage:i,requestId:a,error:n.error,response:null})),i}},{key:"sendFileMessages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.progress?n.progress:function(){},i=n.sent?n.sent:function(){},a=n.complete?n.complete:function(){};if(Array.isArray(e)&&e.length>0&&e.length<=20){var s=[];return e.forEach((function(n,o){s.push(t.sendFileMessage(n,r,(function(t,n){i(t,n),o===e.length-1&&a(null)})))})),s}return a(ve.error),null}},{key:"resendFileMessage",value:function(e,t,n){var r=this,i=j.get(this._iid),a=i.FileMessage,s=i.FileMessageParams,o=null,l=ve.parse(arguments,[new ve({type:a,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===r.url&&Array.isArray(e.thumbnails)}}),new ve({type:"file",optionalIf:function(e){var t,n,r=!!e[0].plainUrl,i=se.isFile(null===(t=e[0])||void 0===t||null===(n=t.messageParams)||void 0===n?void 0:n.file);return r||i},defaultValue:null}),new ve({type:"callback"})]),u=S(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],le(this._iid,(function(n){if(o)o.message+=" Please check if the failed message is resend-able with `message.isResendable().`",n(o,null);else{var i,a=new s;a._reqId=e.reqId,e.plainUrl?a.fileUrl=e.plainUrl:t?a.file=t:se.isFile(null===(i=e.messageParams)||void 0===i?void 0:i.file)&&(a.file=e.messageParams.file),a.fileName=e.name,a.fileSize=e.size,a.mimeType=e.type,a.data=e.data,a.customType=e.customType,a.mentionType=e.mentionType,a.mentionedUserIds=e.requestedMentionUserIds,a.metaArrays=e.metaArrays,a.thumbnailSizes=e.thumbnails.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),a.appleCriticalAlertOptions=e.appleCriticalAlertOptions,r.sendFileMessage(a,n)}}),n)}},{key:"updateFileMessage",value:function(e,t,n,r){var i=this,a=j.get(this._iid),s=a.Command,o=a.FileMessage,l=a.FileMessageParams,c=arguments,d=null,h=null;if("number"==typeof e)switch(c.length){case 3:var f=S(ve.parse(c,[new ve({type:"number"}),new ve({type:l}),new ve({type:"callback"})]),4);d=f[0],e=f[1],h=f[2],r=f[3],h&&(h._isUpdate=!0);break;case 4:h=new l;var p=S(ve.parse(c,[new ve({type:"number"}),new ve({type:"string",nullable:!0}),new ve({type:"string",nullable:!0}),new ve({type:"callback"})]),5);d=p[0],e=p[1],t=p[2],n=p[3],r=p[4],h.data=t,h.customType=n,h._isUpdate=!0}return le(this._iid,(function(t){if(!d&&h&&h._validate()){var n=s.bUpdateFileMessage(u(u({channelUrl:i.url,messageId:e},h),{},{mentionType:h._mentionType,mentionedUserIds:h._mentionedUserIds})),r=Pi.getInstance(i._iid);r.sendCommand(n,(function(e,n){if(r.getErrorFirstCallback()){var a=[e,n];n=a[0],e=a[1]}var s=null;if(!n&&(s=new o(u(u({},e.getJsonElement()),{},{messageParams:h})),i.isGroupChannel())){var l=!1;i.lastMessage?(i.lastMessage.createdAt<s.createdAt||i.lastMessage.createdAt===s.createdAt&&i.lastMessage.messageId===s.messageId&&i.lastMessage.updatedAt<s.updatedAt)&&(i.lastMessage=s,l=!0):(i.lastMessage=s,l=!0);var c=me.of(i._iid);!s.silent&&l&&(Object.keys(r.channelHandlers).forEach((function(e){r.channelHandlers[e].onChannelChanged(i)})),et.of(i._iid).upsert([i]).then((function(){c.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:i}})})).catch((function(e){return $.error(e)}))),lt.of(i._iid).upsert([s],$e.SUCCEEDED).then((function(){c.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:i,message:s}})})).catch((function(e){return $.error(e)}))}t(n,s)}))}else t(ve.error,null)}),r)}},{key:"cancelUploadingFileMessage",value:function(e,t){var n=null,r=S(ve.parse(arguments,[new ve({type:["number","string"]}),new ve({type:"callback"})]),3);n=r[0],e=r[1],t=r[2];var i=O.get(this._iid).container.isErrorFirstInCallback;return n?(i?t(n,null):t(null,n),!1):j.get(this._iid).FileMessageQueue.create(this).cancelUploadItemByRequestId(e,(function(e,n){return i?t(e,n):t(n,e)}))}},{key:"addReaction",value:function(e,t,n){var r=this,i=Pi.getInstance(this._iid),a=j.get(this._iid).ReactionEvent,s=null,o=ve.parse(arguments,[new ve({type:pt}),new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),l=S(o,4);return s=l[0],e=l[1],t=l[2],n=l[3],le(this._iid,(function(n){s?n(s,null):e.sendingStatus===i.MessageSendingStatus.SUCCEEDED?O.get(r._iid).container.apiClient.addReaction({isGroupChannel:e.isGroupChannel(),channelUrl:e.channelUrl,messageId:e.messageId,key:t},(function(t,r){var i=null;t||(i=a.createFromJson(u(u({},r),{},{msg_id:e.messageId}))),n(t,i)})):n(new F("Cannot add reaction to a non-succeeded message.",F.REQUEST_FAILED),null)}),n)}},{key:"deleteReaction",value:function(e,t,n){var r=this,i=Pi.getInstance(this._iid),a=j.get(this._iid).ReactionEvent,s=null,o=ve.parse(arguments,[new ve({type:pt}),new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),l=S(o,4);return s=l[0],e=l[1],t=l[2],n=l[3],le(this._iid,(function(n){s?n(s,null):e.sendingStatus===i.MessageSendingStatus.SUCCEEDED?O.get(r._iid).container.apiClient.deleteReaction({isGroupChannel:e.isGroupChannel(),channelUrl:e.channelUrl,messageId:e.messageId,key:t},(function(t,r){var i=null;t||(i=a.createFromJson(u(u({},r),{},{msg_id:e.messageId}))),n(t,i)})):n(new F("Cannot remove reaction to a non-succeeded message.",F.REQUEST_FAILED),null)}),n)}},{key:"deleteMessage",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return!Array.isArray(e)&&null!==e&&e.hasOwnProperty("messageId")}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.deleteMessage({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),messageId:e.messageId},(function(r,i){if(!r&&n.isGroupChannel()){var a=lt.of(n._iid),s=me.of(n._iid);a.remove([e.messageId],$e.SUCCEEDED).then((function(){s.send({source:he.EVENT_MESSAGE_DELETED,payload:{channel:n,message:e}})})).catch((function(e){return $.error(e)}))}t(r,null)}))}),t)}},{key:"copyUserMessage",value:function(t,n,r){var i=j.get(this._iid);i.Command;var a=i.UserMessage,s=i.BaseMessageParams,o=null,l=S(ve.parse(arguments,[new ve({type:e}),new ve({type:a}),new ve({type:"callback"})]),4);o=l[0],t=l[1],n=l[2],r=l[3];var c=O.get(this._iid).container.isErrorFirstInCallback;if(o)return c?r(ve.error,null):r(null,ve.error),null;if(this.url!==n.channelUrl){var d=new F("The message does not belong to this channel",F.INVALID_PARAMETER);return c?r(d,null):r(null,d),null}var h=Object.keys(n.translations);h.forEach((function(e){return""}));var f=s.PushNotificationDeliveryOption.DEFAULT;return t._sendUserMessage(u(u({},n),{},{reqId:null,pushNotificationDeliveryOption:f,translationTargetLanguages:h,rootMessageId:null,parentMessageId:null,parentMessageText:null,messageParams:n._messageParams,callback:r}))}},{key:"copyFileMessage",value:function(t,n,r){var i=this,a=j.get(this._iid),s=a.Command;a.GroupChannel;var o=a.FileMessage,l=a.BaseMessageParams;a.FileMessageParams;var u=a.User,c=null,d=S(ve.parse(arguments,[new ve({type:e}),new ve({type:o}),new ve({type:"callback"})]),4);c=d[0],t=d[1],n=d[2],r=d[3];var h=O.get(this._iid),f=h.container.isErrorFirstInCallback;if(c)return f?r(ve.error,null):r(null,ve.error),null;if(this.url!==n.channelUrl){var p=new F("The message does not belong to this channel");return f?r(p,null):r(null,p),null}var g=Pi.getInstance(this._iid),y=n,m=y.url,_=y.name,v=y.type,E=y.size,b=y.data,C=y.customType,N=y.mentionType,A=y.mentionedUserIds,k=y.mentionedUsers,T=y.metaArrays,I=y.thumbnails,w=y.requireAuth,U=y.messageSurvivalSeconds,R=y.silent,M=y.appleCriticalAlertOptions,L=s.generateRequestId(),P=g.currentUser||{},D=t.url,x=t.isOpenChannel(),H=k.filter((function(e){return new u(u.objectify(e))})),G=l.PushNotificationDeliveryOption.DEFAULT,z=o.objectify({messageId:0,reqId:L,user:P,channel:t,plainUrl:m,name:_,type:v,size:E,data:b,customType:C,mentionType:N,mentionedUserIds:A,mentionedUsers:H,requestedMentionUserIds:A,metaArrays:T,thumbnails:I,requireAuth:w,messageSurvivalSeconds:U,silent:R,createdAt:(new Date).getTime(),appleCriticalAlertOptions:M}),B=new o(z);if(B.requestState=g.MessageRequestState.PENDING,B.sendingStatus=g.MessageSendingStatus.PENDING,!g.currentUser){var V=new F("Connection should be made first.",F.CONNECTION_REQUIRED),q=new o(z);return q.requestState=g.MessageRequestState.FAILED,q.sendingStatus=g.MessageSendingStatus.FAILED,q.errorCode=V.code,f?r(V,q):r(q,V),B}var K=s.bFile({requestId:L,channelUrl:D,url:m,name:_,type:v,size:E,data:b,customType:C,metaArrays:T,mentionType:N,mentionedUserIds:A,thumbnailSizes:I,requireAuth:w,pushNotificationDeliveryOption:G,silent:R,appleCriticalAlertOptions:M});return g.getConnectionState()===g.ConnectionState.OPEN||g.connecting||g.reconnecting?g.sendCommand(K,(function(e,n){if(g.getErrorFirstCallback()){var a=[e,n];n=a[0],e=a[1]}if(n)if(n.code!==F.INVALID_PARAMETER){var s=new o(z);s.requestState=g.MessageRequestState.FAILED,s.sendingStatus=g.MessageSendingStatus.FAILED,n.code!==F.FILE_UPLOAD_CANCEL_FAILED&&n.code!==F.REQUEST_CANCELED||(s.sendingStatus=g.MessageSendingStatus.CANCELED),s.errorCode=n.code,f?r(n,s):r(s,n)}else f?r(n,null):r(null,n);else{var l=new o(e.getJsonElement()),u=l._sender;if(P&&u&&P.userId===u.userId&&(P.nickname!==u.nickname&&(P.nickname=u.nickname),P.plainProfileUrl!==u.plainProfileUrl&&(P.plainProfileUrl=u.plainProfileUrl)),t.isGroupChannel()){t.lastMessage=l,Object.keys(g.channelHandlers).forEach((function(e){g.channelHandlers[e].onChannelChanged(t)}));var c=me.of(i._iid);et.of(i._iid).upsert([t]).then((function(){c.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}})})).catch((function(e){return $.error(e)})),lt.of(i._iid).upsert([l]).then((function(){c.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:i,message:l}})})).catch((function(e){return $.error(e)}))}f?r(null,l):r(l,null)}})):h.container.apiClient.sendFileMessage({channelUrl:D,isOpenChannel:x,fileUrl:m,fileName:_,fileType:v,fileSize:E,data:b,customType:C,metaArrays:T,mentionType:N,mentionedUserIds:A,thumbnailSizes:I,requireAuth:w,pushNotificationDeliveryOption:G,appleCriticalAlertOptions:M},(function(e,n){if(e)if(e.code!==F.INVALID_PARAMETER){var i=new o(commnad.getJsonElement());i.requestState=g.MessageRequestState.FAILED,i.sendingStatus=g.MessageSendingStatus.FAILED,e.code!==F.FILE_UPLOAD_CANCEL_FAILED&&e.code!==F.REQUEST_CANCELED||(i.sendingStatus=g.MessageSendingStatus.CANCELED),i.errorCode=e.code,f?r(e,i):r(i,e)}else f?r(e,null):r(null,e);else{var a=new o(n),s=a._sender;P&&s&&P.userId===s.userId&&(P.nickname!==s.nickname&&(P.nickname=s.nickname),P.plainProfileUrl!==s.plainProfileUrl&&(P.plainProfileUrl=s.plainProfileUrl)),t.isGroupChannel()&&(t.lastMessage=a,Object.keys(g.channelHandlers).forEach((function(e){g.channelHandlers[e].onChannelChanged(t)}))),f?r(null,a):r(a,null)}})),B}},{key:"addOperators",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.addOperators({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),operatorUserIds:e},(function(e,n){return t(e,n)}))}),t)}},{key:"removeOperators",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.removeOperators({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),operatorUserIds:e},(function(e,n){return t(e,n)}))}),t)}},{key:"getMetaCounters",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:e},(function(e,n){return t(e,n)}))}),t)}},{key:"getAllMetaCounters",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getMetaCounters({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),keys:[]},(function(t,n){return e(t,n)}))}),e)}},{key:"createMetaCounters",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.createMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e},(function(e,n){return t(e,n)}))}),t)}},{key:"updateMetaCounters",value:function(e,t,n){var r=this,i=null,a=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):O.get(r._iid).container.apiClient.updateMetaCounters({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),metaCounter:e,upsert:t,mode:"set"},(function(e,t){return n(e,t)}))}),n)}},{key:"increaseMetaCounters",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.updateMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e,upsert:!1,mode:"increase"},(function(e,n){return t(e,n)}))}),t)}},{key:"decreaseMetaCounters",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.updateMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e,upsert:!1,mode:"decrease"},(function(e,n){var r=null;e||(r={},Object.keys(n).forEach((function(e){r[e]=n[e]}))),t(e,r)}))}),t)}},{key:"deleteMetaCounter",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.deleteMetaCounter({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),key:e},(function(e,n){return t(e,n)}))}),t)}},{key:"deleteAllMetaCounters",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.deleteAllMetaCounters({channelUrl:t.url,isOpenChannel:t.isOpenChannel()},(function(t,n){return e(t,n)}))}),e)}},{key:"getCachedMetaData",value:function(){var e=Ut.get(this),t={};return Object.keys(e).forEach((function(n){var r=e[n];r.isRemoved||(t[n]=r.value)})),t}},{key:"getMetaData",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:e},(function(e,r){if(r&&r.ts){var i=r.metadata;n._addOrUpdateCachedMetaData(i,r.ts),t(e,i)}else t(e,r)}))}),t)}},{key:"getAllMetaData",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getMetaData({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),keys:[]},(function(n,r){if(r&&r.ts){var i=r.metadata;t._refreshMetaData(i,r.ts),e(n,i)}else e(n,r)}))}),e)}},{key:"createMetaData",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.createMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaData:e},(function(e,n){t(e,n&&n.ts?n.metadata:n)}))}),t)}},{key:"updateMetaData",value:function(e,t,n){var r=this,i=null,a=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0}}),new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):O.get(r._iid).container.apiClient.updateMetaData({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),metaData:e,upsert:t},(function(e,t){n(e,t&&t.ts?t.metadata:t)}))}),n)}},{key:"deleteMetaData",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.deleteMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),key:e},(function(e,n){t(e,n&&n.ts?{}:n)}))}),t)}},{key:"deleteAllMetaData",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.deleteAllMetaData({channelUrl:t.url,isOpenChannel:t.isOpenChannel()},(function(t,n){return e(t,n&&n.ts?{}:n)}))}),e)}},{key:"_updateMessageMetaArray",value:function(e,t,n,r){var i=this;return le(this._iid,(function(r){var a=j.get(i._iid),s=a.Command,o=a.UserMessage,l=a.FileMessage,u=a.AdminMessage,c=null;if(t.isUserMessage()?c=s.bUpdateUserMessage({channelUrl:e,messageId:t.messageId,metaArrayParams:n}):t.isFileMessage()&&(c=s.bUpdateFileMessage({channelUrl:e,messageId:t.messageId,metaArrayParams:n})),c){var d=Pi.getInstance(i._iid);d.sendCommand(c,(function(e,n){if(d.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}var a=null;n||(t.isUserMessage()?a=new o(e.getJsonElement()):t.isFileMessage()?a=new l(e.getJsonElement()):t.isAdminMessage()&&(a=new u(e.getJsonElement()))),r(n,a)}))}else r(ve.error,null)}),r)}},{key:"createMessageMetaArrayKeys",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ve.parse(arguments,[new ve({type:pt}),new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e&&""!==e}))}}),new ve({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=[];if(Array.isArray(t))for(var l=0;l<t.length;l++){var u=t[l];o.push(new r(u,[]))}return this._updateMessageMetaArray(this.url,e,{array:o.map((function(e){return e.encode()})),mode:"add",upsert:!0},n)}},{key:"deleteMessageMetaArrayKeys",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ve.parse(arguments,[new ve({type:pt}),new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e&&""!==e}))}}),new ve({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=[];if(Array.isArray(t))for(var l=0;l<t.length;l++){var u=t[l];o.push(new r(u,[]))}return this._updateMessageMetaArray(this.url,e,{array:o.map((function(e){return e.encode()})),mode:"remove",upsert:!0},n)}},{key:"addMessageMetaArrayValues",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ve.parse(arguments,[new ve({type:pt}),new ve({type:"object",constraint:function(e){return e&&(Array.isArray(e)&&e.length>0&&e.every((function(e){return e instanceof r}))||Object.keys(e).length>0&&Object.keys(e).every((function(t){return Array.isArray(e[t])&&e[t].length>0&&e[t].every((function(e){return"string"==typeof e&&e.length>0}))})))}}),new ve({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=Array.isArray(t)?t.map((function(e){return e.encode()})):Object.keys(t).map((function(e){return{key:e,value:t[e]}}));return this._updateMessageMetaArray(this.url,e,{array:o,mode:"add",upsert:!0},n)}},{key:"removeMessageMetaArrayValues",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ve.parse(arguments,[new ve({type:pt}),new ve({type:"object",constraint:function(e){return e&&(Array.isArray(e)&&e.length>0&&e.every((function(e){return e instanceof r}))||Object.keys(e).length>0&&Object.keys(e).every((function(t){return Array.isArray(e[t])&&e[t].length>0&&e[t].every((function(e){return"string"==typeof e&&e.length>0}))})))}}),new ve({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=Array.isArray(t)?t.map((function(e){return e.encode()})):Object.keys(t).map((function(e){return{key:e,value:t[e]}}));return this._updateMessageMetaArray(this.url,e,{array:o,mode:"remove",upsert:!0},n)}},{key:"report",value:function(e,t,n){var r=this,i=j.get(this._iid).BaseChannel,a=null,s=S(ve.parse(arguments,[new ve({type:i.ReportCategory}),new ve({type:"string"}),new ve({type:"callback"})]),4);return a=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){if(a)n(a,null);else{var i=Pi.getInstance(r._iid);O.get(r._iid).container.apiClient.report({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),reportCategory:e,reportingUserId:i.currentUser?i.currentUser.userId:null,reportDescription:t},(function(e,t){n(e,null)}))}}),n)}},{key:"reportUser",value:function(e,t,n,r){var i=this,a=j.get(this._iid).BaseChannel,s=null,o=S(ve.parse(arguments,[new ve({type:gt}),new ve({type:a.ReportCategory}),new ve({type:"string"}),new ve({type:"callback"})]),5);return s=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){if(s)r(s,null);else{var a=Pi.getInstance(i._iid);O.get(i._iid).container.apiClient.reportUser({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),reportCategory:t,offendingUserId:e.userId,reportingUserId:a.currentUser?a.currentUser.userId:null,reportDescription:n},(function(e,t){r(e,null)}))}}),r)}},{key:"reportMessage",value:function(e,t,n,r){var i=this,a=j.get(this._iid).BaseChannel,s=null,o=S(ve.parse(arguments,[new ve({type:pt}),new ve({type:a.ReportCategory}),new ve({type:"string"}),new ve({type:"callback"})]),5);return s=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){if(s)r(s,null);else{var a=Pi.getInstance(i._iid);O.get(i._iid).container.apiClient.reportMessage({messageId:e.messageId,channelUrl:i.url,isOpenChannel:i.isOpenChannel(),reportCategory:t,offendingUserId:e.sender.userId,reportingUserId:a.currentUser?a.currentUser.userId:null,reportDescription:n},(function(e,t){r(e,null)}))}}),r)}}],[{key:"CHANNEL_TYPE_OPEN",get:function(){return"open"}},{key:"CHANNEL_TYPE_GROUP",get:function(){return"group"}},{key:"CHANNEL_TYPE_BASE",get:function(){return"base"}},{key:"MessageTypeFilter",get:function(){return{ALL:"",USER:"MESG",FILE:"FILE",ADMIN:"ADMM"}}},{key:"ReportCategory",get:function(){return{SPAM:"spam",HARASSING:"harassing",SUSPICIOUS:"suspicious",INAPPROPRIATE:"inappropriate"}}},{key:"buildMessage",value:function(e,t){var n=j.get(this._iid),r=n.UserMessage,i=n.FileMessage,a=n.AdminMessage;if(e)switch(e.hasOwnProperty("channel_type")||(e.channel_type=t.channelType),e.type){case"MESG":return new r(e);case"FILE":var s=e.file;return new i(u(u({},e),{},{url:String(s.url),name:String(s.name),type:String(s.type),size:parseInt(s.size),data:String(s.data)}));case"BRDM":case"ADMM":return new a(e)}return null}}]),e}(),Lt=function(){function e(t){d(this,e),t&&(this.category=t.hasOwnProperty("cat")?parseInt(t.cat):0,this.data=t.hasOwnProperty("data")?t.data:null,this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this.channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):Mt.CHANNEL_TYPE_GROUP,this.channel=t.hasOwnProperty("channel")?t.channel:null)}return f(e,[{key:"isGroupChannel",value:function(){return this.channelType===Mt.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){return this.channelType===Mt.CHANNEL_TYPE_OPEN}}]),e}();Lt.CATEGORY_NONE=0,Lt.CATEGORY_CHANNEL_ENTER=10102,Lt.CATEGORY_CHANNEL_EXIT=10103,Lt.CATEGORY_USER_CHANNEL_MUTE=10201,Lt.CATEGORY_USER_CHANNEL_UNMUTE=10200,Lt.CATEGORY_USER_CHANNEL_BAN=10601,Lt.CATEGORY_USER_CHANNEL_UNBAN=10600,Lt.CATEGORY_CHANNEL_FREEZE=10701,Lt.CATEGORY_CHANNEL_UNFREEZE=10700,Lt.CATEGORY_TYPING_START=10900,Lt.CATEGORY_TYPING_END=10901,Lt.CATEGORY_CHANNEL_JOIN=1e4,Lt.CATEGORY_CHANNEL_LEAVE=10001,Lt.CATEGORY_CHANNEL_OPERATOR_UPDATE=10002,Lt.CATEGORY_CHANNEL_INVITE=10020,Lt.CATEGORY_CHANNEL_DECLINE_INVITE=10022,Lt.CATEGORY_CHANNEL_PROP_CHANGED=11e3,Lt.CATEGORY_CHANNEL_DELETED=12e3,Lt.CATEGORY_CHANNEL_META_DATA_CHANGED=11100,Lt.CATEGORY_CHANNEL_META_COUNTERS_CHANGED=11200,Lt.CATEGORY_CHANNEL_HIDE=13e3,Lt.CATEGORY_CHANNEL_UNHIDE=13001;var Pt=f((function e(t){d(this,e),t&&(this.category=t.hasOwnProperty("cat")?parseInt(t.cat):0)}));Pt.CATEGORY_USER_BLOCK=20001,Pt.CATEGORY_USER_UNBLOCK=2e4,Pt.CATEGORY_FRIEND_DISCOVERED=20900;var Dt=function(){function e(t){d(this,e),this.sb=t,this.cls=j.get(this.sb._iid)}return f(e,[{key:"onRawCommandReceived",value:function(e){var t=this,n=this.cls,r=n.Command,i=n.User,a=n.Member,s=n.RestrictedUser,o=n.BaseChannel,l=n.GroupChannel,d=n.OpenChannel,h=n.UserMessage,f=n.FileMessage,p=n.AdminMessage,g=n.BaseMessageParams,y=n.ReactionEvent,m=n.ReadStatus,_=n.ThreadInfoUpdateEvent,v=n.RestrictionInfo,E=O.get(this.sb._iid),b=E.container,C=b.pinger,S=b.auth,N=b.subscribedUnreadMessageCount,A=b.sessionManager,k=b.ackStateMap,w=new r(e),U=w.getJsonElement();if(U.hasOwnProperty("unread_cnt")&&"object"===c(U.unread_cnt)){var R=!1,M=U.unread_cnt.ts;"number"==typeof M&&M>N.ts&&(N.all!==U.unread_cnt.all&&(R=!0),N.all=U.unread_cnt.all>=0?U.unread_cnt.all:0,U.unread_cnt.custom_types&&Object.keys(U.unread_cnt.custom_types).forEach((function(e){N.custom_types[e]!==U.unread_cnt.custom_types[e]&&(R=!0),N.custom_types[e]=U.unread_cnt.custom_types[e]})),R=R&&N.ts>0,N.ts=M),R&&Object.keys(this.sb.userEventHandlers).forEach((function(e){t.sb.userEventHandlers[e].onTotalUnreadMessageCountUpdated(N.all,N.custom_types)}))}var L=w.requestId;if(L){var P=k[L];if(P){clearTimeout(P.timer);var D=P.handler;k.hasOwnProperty(L)&&delete k[L],D&&("EROR"===w.command?D(new F(U.message,U.code),null):D(null,w))}}else{C&&"LOGI"!==w.command&&C.refreshTimer();var x,H=et.of(this.sb._iid),G=lt.of(this.sb._iid),j=me.of(this.sb._iid);switch(w.command){case"LOGI":if(this.sb.loginTimer)if(clearTimeout(this.sb.loginTimer),this.sb.loginTimer=null,this.sb.onLoginTimerCancel=null,U.hasOwnProperty("error"))this.sb.isSessionOpened=!1,this.sb.loginHandler(new F(U.message,U.code),null);else{if(this.sb.isSessionOpened=!0,U.hasOwnProperty("key")&&(S.sessionKey=U.key),U.hasOwnProperty("ekey")&&(S.eKey=U.ekey),U.hasOwnProperty("user_id")&&(this.sb.currentUser=new i(U)),"number"==typeof U.ping_interval&&U.ping_interval>0&&E.set("pingInterval",1e3*U.ping_interval),"number"==typeof U.pong_timeout&&U.pong_timeout>0&&E.set("pongTimeout",1e3*U.pong_timeout),"number"==typeof U.login_ts){var z=1e3*U.login_ts;E.set("connectedAt",z);var B=E.container,V=B.firstConnectedAt,q=B.localCacheEnabled,K=B.store;if(!V){var Q=z;if(q){var Y=(x=this.sb.currentUser.userId,"sendbird:".concat(x,"@firstConnectedAt"));K.get(Y).then((function(e){e&&(Q=e.ts)})).catch((function(e){t.handleCacheError(e)})).finally((function(){E.set("firstConnectedAt",Q)}))}else E.set("firstConnectedAt",Q)}}if(U.hasOwnProperty("reconnect")&&"object"===c(U.reconnect)){var W=U.reconnect,J=E.container.wsAdapter;W.hasOwnProperty("interval")&&"number"==typeof W.interval&&(J.reconnectParams.interval=W.interval),W.hasOwnProperty("max_interval")&&"number"==typeof W.max_interval&&(J.reconnectParams.maxInterval=W.max_interval),W.hasOwnProperty("mul")&&"number"==typeof W.mul&&(J.reconnectParams.multiplier=W.mul),W.hasOwnProperty("retry_cnt")&&"number"==typeof W.retry_cnt&&(J.reconnectParams.retryCount=W.retry_cnt)}"number"==typeof U.max_unread_cnt_on_super_group?E.set("maxUnreadCountOfSuperGroupChannel",U.max_unread_cnt_on_super_group):E.set("maxUnreadCountOfSuperGroupChannel",I.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL),U.profile_image_encryption&&E.set("profileImageEncryption",!0),C&&C.start(),U.hasOwnProperty("file_upload_size_limit")&&U.hasOwnProperty("premium_feature_list")&&U.hasOwnProperty("emoji_hash")&&E.set("appInfo",new Te(U)),U.hasOwnProperty("concurrent_call_limit")&&U.hasOwnProperty("back_off_delay")&&(E.set("concurrentCallLimit",U.concurrent_call_limit),E.set("backOffDelay",U.back_off_delay)),this.sb.loginHandler(null,this.sb.currentUser)}break;case"EXPR":var X=new F("The session would be expired.",U.reason||F.SESSION_KEY_EXPIRED);A.refreshSessionIfExpiredError(X).then((function(){})).catch((function(){}));break;case"MESG":case"FILE":case"BRDM":case"ADMM":var Z=null;if("MESG"===w.command?Z=new h(U):"FILE"===w.command?Z=new f(U):"BRDM"!==w.command&&"ADMM"!==w.command||(Z=new p(U)),Z){var ee=this.sb.currentUser?this.sb.currentUser.userId:null,te=Z.silent,ne=!!U.force_update_last_message,re=Z._sender&&Z._sender.userId===ee;if(Z.isGroupChannel()){var ie=l.cachedChannels.hasOwnProperty(Z.channelUrl);l.getChannel(Z.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(!n){if(!E.container.appInfo.isSupergroupMackDisabled||!e.isSuper||e.isBroadcast){var a=r.bMessageAck({channelUrl:Z.channelUrl,messageId:Z.messageId});t.sb.sendCommand(a)}if(e.isHidden=!1,e.hiddenState=l.HiddenState.UNHIDDEN,l.cachedChannels[e.url]=e,Z._sender&&e.memberMap.hasOwnProperty(Z._sender.userId)){var s=e.memberMap[Z._sender.userId];s.nickname!==Z._sender.nickname&&(s.nickname=Z._sender.nickname),s.plainProfileUrl!==Z._sender.plainProfileUrl&&(s.plainProfileUrl=Z._sender.plainProfileUrl),se.deepEqual(s.metaData,Z._sender.metaData)||(s.metaData=Z._sender.metaData),s.isBlockedByMe!==Z._sender.isBlockedByMe&&(s.isBlockedByMe=Z._sender.isBlockedByMe)}var o=t.sb.currentUser;o&&re&&(o.nickname!==Z._sender.nickname&&(o.nickname=Z._sender.nickname),o.plainProfileUrl!==Z._sender.plainProfileUrl&&(o.plainProfileUrl=Z._sender.plainProfileUrl),se.deepEqual(o.metaData,Z._sender.metaData)||(o.metaData=Z._sender.metaData));var u=!1;if(Z.mentionType===g.MentionType.CHANNEL)re||(u=!0);else if(Z.mentionType===g.MentionType.USERS)for(var c=0;c<Z.mentionedUsers.length;c++)if(!re&&Z.mentionedUsers[c].userId===ee){u=!0;break}te&&!re||(e.isEphemeral||ie)&&((!e.lastMessage||e.lastMessage.createdAt<Z.createdAt)&&(e.lastMessage=Z),re||e._setGroupChannelUnreadCount(e.unreadMessageCount+1,e.unreadMentionCount+(u?1:0))),ne&&(!e.lastMessage||e.lastMessage.createdAt<Z.createdAt)&&(e.lastMessage=Z),te&&!re||(H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)}))),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onMessageReceived(e,Z),u&&r.onMentionReceived(e,Z)})),G.upsert([Z]).then((function(){j.send({source:he.EVENT_MESSAGE_RECEIVED,payload:{channel:e,message:Z}})})).catch((function(e){t.handleCacheError(e)}))}}))}else Z.isOpenChannel()&&d.getChannel(Z.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){var i=!1;if(Z.mentionType===g.MentionType.CHANNEL)i=!0;else if(Z.mentionType===g.MentionType.USERS)for(var a=0;a<Z.mentionedUsers.length;a++)if(Z.mentionedUsers[a].userId===ee){i=!0;break}Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];d.enteredChannels[e.url]&&r.onMessageReceived(e,Z),i&&r.onMentionReceived(e,Z)})),d.enteredChannels[e.url]&&j.send({source:he.EVENT_MESSAGE_RECEIVED,payload:{channel:e,message:Z}})}}))}break;case"MEDI":case"FEDI":case"AEDI":var ae=null;if("MEDI"===w.command?ae=new h(U):"FEDI"===w.command?ae=new f(U):"AEDI"===w.command&&(ae=new p(U)),ae){var oe=this.sb.currentUser?this.sb.currentUser.userId:null,le=ae.silent,ue=ae.sender&&ae.sender.userId===oe;if(ae.isGroupChannel()){var ce=l.cachedChannels.hasOwnProperty(ae.channelUrl);l.getChannel(ae.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){var i=e.cachedReadReceiptStatus[oe],a=i&&i>=ae.createAt,s=t.sb.currentUser;s&&ue&&(s.nickname!==ae._sender.nickname&&(s.nickname=ae._sender.nickname),s.plainProfileUrl!==ae._sender.plainProfileUrl&&(s.plainProfileUrl=ae._sender.plainProfileUrl),se.deepEqual(s.metaData,ae._sender.metaData)||(s.metaData=ae._sender.metaData));var o=!1,l=!1;if(!ue&&!a&&U&&U.hasOwnProperty("old_values")){var u=U.old_values.mention_type||ae.mentionType,c=U.old_values.mentioned_user_ids||ae.mentionedUsers.map((function(e){return e.userId}));if(u===g.MentionType.USERS&&ae.mentionType===g.MentionType.USERS){for(var d=!1,h=!1,f=0;f<c.length;f++)if(c[f]===oe){d=!0;break}for(var p=0;p<ae.mentionedUsers.length;p++)if(ae.mentionedUsers[p].userId===oe){h=!0;break}!d&&h&&(l=!0,!le&&ce&&(e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1),o=!0))}else if(u===g.MentionType.USERS&&ae.mentionType===g.MentionType.CHANNEL){for(var y=!1,m=0;m<c.length;m++)if(c[m]===oe){y=!0;break}y||(l=!0,!le&&ce&&(e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1),o=!0))}}e.lastMessage?e.lastMessage.createdAt<ae.createdAt?(e.lastMessage=ae,o=!0):e.lastMessage.createdAt===ae.createdAt&&e.lastMessage.messageId===ae.messageId&&(ce?e.lastMessage.updatedAt<ae.updatedAt&&(e.lastMessage=ae,o=!0):o=!0):(e.lastMessage=ae,o=!0),le&&!ue||!o||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onMessageUpdated(e,ae),l&&r.onMentionReceived(e,ae)})),G.upsert([ae]).then((function(){j.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:e,message:ae}})})).catch((function(e){t.handleCacheError(e)}))}}))}else ae.isOpenChannel()&&d.getChannel(ae.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageUpdated(e,ae)})),j.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:e,message:ae}}))}))}break;case"DELM":var de=String(U.channel_type),fe=String(U.channel_url),pe=parseInt(U.msg_id);switch(de){case o.CHANNEL_TYPE_GROUP:l.getChannel(fe,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageDeleted(e,pe)})),G.remove(["".concat(pe)]).then((function(){j.send({source:he.EVENT_MESSAGE_DELETED,payload:{channel:e,messageId:pe}})})).catch((function(e){t.handleCacheError(e)})))}));break;case o.CHANNEL_TYPE_OPEN:d.getChannel(fe,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageDeleted(e,pe)})),j.send({source:he.EVENT_MESSAGE_DELETED,payload:{channel:e,messageId:pe}}))}))}break;case"READ":var ge=new m(U),ye=l.cachedChannels.hasOwnProperty(ge.channelUrl);l.getChannel(ge.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(ye&&e.updateReadReceipt(ge.reader.userId,ge.timestamp),t.sb.currentUser&&(ge.reader.userId===t.sb.currentUser.userId?ye?(e.unreadMessageCount>0||e.unreadMentionCount>0)&&(e._setGroupChannelUnreadCount(0,0),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):0!==e.unreadMessageCount&&0!==e.unreadMentionCount||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReadReceiptUpdated(e)})),j.send({source:he.EVENT_READ_RECEIPT_UPDATED,payload:{channel:e,user:ge.reader}})))}));break;case"MRCT":var _e=String(U.channel_type),ve=String(U.channel_url),Ee=y.createFromJson(U);switch(_e){case o.CHANNEL_TYPE_GROUP:l.getChannel(ve,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReactionUpdated(e,Ee)})),G.get("".concat(Ee.messageId)).then((function(n){n&&(n.applyReactionEvent(Ee),G.upsert([n]).then((function(){j.send({source:he.EVENT_REACTION_UPDATED,payload:{channel:e,reactionEvent:Ee}})})).catch((function(e){t.handleCacheError(e)})))})).catch((function(e){t.handleCacheError(e)})))}));break;case o.CHANNEL_TYPE_OPEN:d.getChannel(ve,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReactionUpdated(e,Ee)})),j.send({source:he.EVENT_REACTION_UPDATED,payload:{channel:e,reactionEvent:Ee}}))}))}break;case"DLVR":var be=String(U.channel_url),Ce=U.hasOwnProperty("updated")?U.updated:null,Se=l.cachedChannels.hasOwnProperty(be);l.getChannel(be,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){var i=!1;Object.keys(Ce).forEach((function(n){t.sb.currentUser&&n===t.sb.currentUser.userId&&(i=!0),Se&&e.updateDeliveryReceipt(n,parseInt(Ce[n]))})),l.cachedChannels[e.url]=e,i&&1===Object.keys(Ce).length||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onDeliveryReceiptUpdated(e)})),j.send({source:he.EVENT_DELIVERY_RECEIPT_UPDATED,payload:{channel:e}}))}}));break;case"MTHD":var Ne=String(U.channel_url),Ae=String(U.channel_type),ke=_.createFromJson(U);switch(Ae){case o.CHANNEL_TYPE_GROUP:l.getChannel(Ne,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onThreadInfoUpdated(e,ke)})),G.get("".concat(ke.targetMessageId)).then((function(n){n&&(n.applyThreadInfoUpdateEvent(ke),G.upsert([n]).then((function(){j.send({source:he.EVENT_THREAD_INFO_UPDATED,payload:{channel:e,threadInfoUpdateEvent:ke}})})).catch((function(e){t.handleCacheError(e)})))})).catch((function(e){t.handleCacheError(e)})))}));break;case o.CHANNEL_TYPE_OPEN:d.getChannel(Ne,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onThreadInfoUpdated(e,ke)})),j.send({source:he.EVENT_THREAD_INFO_UPDATED,payload:{channel:e,threadInfoUpdateEvent:ke}}))}))}break;case"MCNT":if(U.hasOwnProperty("group_channels")&&Array.isArray(U.group_channels)){var Ie,we=[],Oe=T(U.group_channels);try{for(Oe.s();!(Ie=Oe.n()).done;){var Ue=Ie.value;if(Ue){var Re=l.cachedChannels[Ue.channel_url];Re&&Re.isBroadcast&&Re.setLatestMemberCount(Ue.member_count,Ue.joined_member_count,Ue.ts)&&we.push(Re)}}}catch(e){Oe.e(e)}finally{Oe.f()}we.length>0&&(Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelMemberCountChanged(we)})),H.upsert(we).then((function(){var e,t=T(we);try{for(t.s();!(e=t.n()).done;){var n=e.value;j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:n}})}}catch(e){t.e(e)}finally{t.f()}})).catch((function(e){t.handleCacheError(e)})))}if(U.hasOwnProperty("open_channels")&&Array.isArray(U.open_channels)){var Me,Le=[],Pe=T(U.open_channels);try{for(Pe.s();!(Me=Pe.n()).done;){var De=Me.value;if(De){var xe=d.cachedChannels[De.channel_url];xe&&xe.setLatestParticipantCount(De.participant_count,De.ts)&&Le.push(xe)}}}catch(e){Pe.e(e)}finally{Pe.f()}if(Le.length>0){Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelParticipantCountChanged(Le)}));var Fe,He=T(Le);try{for(He.s();!(Fe=He.n()).done;){var Ge=Fe.value;j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:Ge}})}}catch(e){He.e(e)}finally{He.f()}}}break;case"SYEV":var je=new Lt(U),ze=U.ts;switch(je.category){case Lt.CATEGORY_CHANNEL_JOIN:case Lt.CATEGORY_CHANNEL_LEAVE:l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{var s=je.data.hasOwnProperty("member_count")?je.data.member_count:null,o=je.data.hasOwnProperty("joined_member_count")?je.data.joined_member_count:null,u=!1;if(je.category===Lt.CATEGORY_CHANNEL_JOIN)(je.data.hasOwnProperty("users")?je.data.users:[je.data]).forEach((function(n){e.isSuper||e.isBroadcast?u=e.setLatestMemberCount(s,o,U.ts):(n.state=a.JOINED,e.addMember(new a(n),ze),e.updateJoinedMemberCount());var r=new i(n);t.sb.currentUser&&r.userId===t.sb.currentUser.userId&&(e.myMemberState="joined",l.cachedChannels[e.url]=e),Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onUserJoined(e,r),e.isBroadcast&&u&&i.onChannelMemberCountChanged([e])})),H.upsert([e]).then((function(){j.send({source:he.EVENT_USER_JOINED,payload:{channel:e,user:r}})})).catch((function(e){t.handleCacheError(e)}))}));else{var c=new i(je.data);t.sb.currentUser&&c.userId===t.sb.currentUser.userId?(e.isPublic||l.removeCachedChannel(je.channelUrl),e.myMemberState="none",e.invitedAt=0,e.joinedAt=0,e._setGroupChannelUnreadCount(0,0)):l.cachedChannels[e.url]=e,e.isSuper||e.isBroadcast?u=e.setLatestMemberCount(s,o,U.ts):(E.container.appInfo.enabledChannelMemberShipHistory?(e.memberMap[c.userId].state=l.MemberStateFilter.LEFT,e.memberCount=je.data.member_count):e.removeMember(c),e.updateJoinedMemberCount()),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserLeft(e,c),e.isBroadcast&&u&&r.onChannelMemberCountChanged([e])})),H.upsert([e]).then((function(){j.send({source:he.EVENT_USER_LEFT,payload:{channel:e,user:c}})})).catch((function(e){t.handleCacheError(e)}))}}}));break;case Lt.CATEGORY_CHANNEL_OPERATOR_UPDATE:je.isGroupChannel()?l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{for(var a=je.data.operators.map((function(e){return new i(e)})),s=a.map((function(e){return e.userId})),o=0;o<e.members.length;o++)e.members[o].role=s.indexOf(e.members[o].userId)>=0?l.Role.OPERATOR:l.Role.NONE;e.myRole=t.sb.currentUser&&s.indexOf(t.sb.currentUser.userId)>=0?l.Role.OPERATOR:l.Role.NONE,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onOperatorUpdated(e,a)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_OPERATOR_UPDATED,payload:{channel:e,operators:a}})})).catch((function(e){t.handleCacheError(e)}))}})):je.isOpenChannel()&&d.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):(e.operators=je.data.operators.map((function(e){return new i(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onOperatorUpdated(e,e.operators)})))}));break;case Lt.CATEGORY_CHANNEL_INVITE:l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{var s=null;je.data&&je.data.inviter&&Object.keys(je.data.inviter).length>0&&(s=new i(je.data.inviter));for(var o=[],u=0;u<je.data.invitees.length;u++){var c=new i(je.data.invitees[u]);o.push(c),je.data.invitees[u].state=a.INVITED;var d=new a(je.data.invitees[u]);if(e.isSuper||e.isBroadcast){var h=je.data.hasOwnProperty("member_count")?je.data.member_count:null,f=je.data.hasOwnProperty("joined_member_count")?je.data.joined_member_count:null;e.setLatestMemberCount(h,f,U.ts)}else e.addMember(d,ze);t.sb.currentUser&&d.userId===t.sb.currentUser.userId&&(e.isHidden=!1,"joined"!==e.myMemberState&&(e.myMemberState="invited"),e.invitedAt=U.ts,l.cachedChannels[e.url]=e)}Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserReceivedInvitation(e,s,o)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_USER_RECEIVED_INVITATION,payload:{channel:e,inviter:s,invitees:o}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Lt.CATEGORY_CHANNEL_DECLINE_INVITE:l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{var a=null;je.data&&je.data.inviter&&Object.keys(je.data.inviter).length>0&&(a=new i(je.data.inviter));var s=new i(je.data.invitee);if(t.sb.currentUser&&s.userId===t.sb.currentUser.userId&&(e.invitedAt=0,e.myMemberState="none",e.isPublic||l.removeCachedChannel(je.channelUrl)),e.isSuper||e.isBroadcast){var o=je.data.hasOwnProperty("member_count")?je.data.member_count:null,u=je.data.hasOwnProperty("joined_member_count")?je.data.joined_member_count:null;e.setLatestMemberCount(o,u,U.ts)}else e.removeMember(s);t.sb.currentUser&&s.userId!==t.sb.currentUser.userId&&(l.cachedChannels[e.url]=e),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserDeclinedInvitation(e,a,s)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_USER_DECLINED_INVITATION,payload:{channel:e,inviter:a,invitee:s}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Lt.CATEGORY_TYPING_START:case Lt.CATEGORY_TYPING_END:l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{var a=new i(je.data);je.category===Lt.CATEGORY_TYPING_START?e.updateTypingStatus(a,!0):e.updateTypingStatus(a,!1),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onTypingStatusUpdated(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_TYPING_STATUS_UPDATED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Lt.CATEGORY_CHANNEL_ENTER:case Lt.CATEGORY_CHANNEL_EXIT:d.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{var a=je.data.hasOwnProperty("participant_count")?je.data.participant_count:null,s=e.setLatestParticipantCount(a,U.ts),o=new i(je.data);je.category===Lt.CATEGORY_CHANNEL_ENTER?(Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserEntered(e,o),s&&r.onChannelParticipantCountChanged([e])})),j.send({source:he.EVENT_CHANNEL_ENTER,payload:{channel:e,user:o}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserExited(e,o),s&&r.onChannelParticipantCountChanged([e])})),j.send({source:he.EVENT_CHANNEL_EXIT,payload:{channel:e,user:o}}))}}));break;case Lt.CATEGORY_USER_CHANNEL_MUTE:case Lt.CATEGORY_USER_CHANNEL_UNMUTE:var Be=je.category===Lt.CATEGORY_USER_CHANNEL_MUTE,Ve=u({},je.data);Be&&(Ve.restriction_type=s.RestrictionType.MUTED);var qe=Be?new s(Ve):new i(je.data),Ke=Be?"muted":"unmuted";je.isOpenChannel()?d.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):Be?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserMuted(e,qe)})),j.send({source:he.EVENT_USER_MUTED,payload:{channel:e,user:qe}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnmuted(e,qe)})),j.send({source:he.EVENT_USER_UNMUTED,payload:{channel:e,user:qe}}))})):l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):(t.sb.currentUser&&qe.userId===t.sb.currentUser.userId&&(e.myMutedState=Ke),Array.isArray(e.members)&&e.members.filter((function(e){return e&&e.userId===qe.userId})).forEach((function(e){e.isMuted=Be,e.restrictionInfo=new v(Ve)})),Be?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserMuted(e,qe)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_USER_MUTED,payload:{channel:e,user:qe}})})).catch((function(e){t.handleCacheError(e)}))):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnmuted(e,qe)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_USER_UNMUTED,payload:{channel:e,user:qe}})})).catch((function(e){t.handleCacheError(e)}))))}));break;case Lt.CATEGORY_USER_CHANNEL_BAN:case Lt.CATEGORY_USER_CHANNEL_UNBAN:var Qe=je.category===Lt.CATEGORY_USER_CHANNEL_BAN,Ye=u({},je.data);Qe&&(Ye.restriction_type=s.RestrictionType.BANNED);var We=Qe?new s(Ye):new i(je.data);je.isOpenChannel()?d.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):Qe?(t.sb.currentUser&&We.userId===t.sb.currentUser.userId&&(delete d.enteredChannels[je.channelUrl],t.cls.FileMessageQueue.delete(je.channelUrl)),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserBanned(e,We)})),j.send({source:he.EVENT_USER_BANNED,payload:{channel:e,user:We}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnbanned(e,We)})),j.send({source:he.EVENT_USER_UNBANNED,payload:{channel:e,user:We}}))})):l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else if(Qe){if(t.sb.currentUser&&We.userId===t.sb.currentUser.userId&&(e.isPublic||l.removeCachedChannel(je.channelUrl),e.myMemberState="none",e.invitedAt=0,e.joinedAt=0,e._setGroupChannelUnreadCount(0,0)),e.isSuper||e.isBroadcast){var i=je.data.hasOwnProperty("member_count")?je.data.member_count:null,a=je.data.hasOwnProperty("joined_member_count")?je.data.joined_member_count:null;e.setLatestMemberCount(i,a,U.ts)}else e.removeMember(We),e.updateJoinedMemberCount();Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserBanned(e,We)})),j.send({source:he.EVENT_USER_BANNED,payload:{channel:e,user:We}})}else Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnbanned(e,We)})),j.send({source:he.EVENT_USER_UNBANNED,payload:{channel:e,user:We}})}));break;case Lt.CATEGORY_CHANNEL_FREEZE:case Lt.CATEGORY_CHANNEL_UNFREEZE:je.isOpenChannel()?d.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):(e.isFrozen=je.data.freeze,d.cachedChannels[e.url]=e,je.category===Lt.CATEGORY_CHANNEL_FREEZE?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelFrozen(e)})),j.send({source:he.EVENT_CHANNEL_FROZEN,payload:{channel:e}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelUnfrozen(e)})),j.send({source:he.EVENT_CHANNEL_UNFROZEN,payload:{channel:e}})))})):l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):(e.isFrozen=je.data.freeze,l.cachedChannels[e.url]=e,je.category===Lt.CATEGORY_CHANNEL_FREEZE?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelFrozen(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_FROZEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelUnfrozen(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_UNFROZEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))))}));break;case Lt.CATEGORY_CHANNEL_DELETED:je.isGroupChannel()?l.removeCachedChannel(je.channelUrl):d.removeCachedChannel(je.channelUrl);var Je=je.channelUrl,$e=je.isGroupChannel()?"group":"open";Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelDeleted(Je,$e)})),H.remove([Je]).then((function(){j.send({source:he.EVENT_CHANNEL_DELETED,payload:{channelUrl:Je,channelType:$e}})})).catch((function(e){t.handleCacheError(e)}));break;case Lt.CATEGORY_CHANNEL_PROP_CHANGED:je.isOpenChannel()?d.getChannelWithoutCache(je.channelUrl,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}}))})):l.getChannelWithoutCache(je.channelUrl,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)$.debug("Discard command:","`".concat(w.command,"`"),je.category);else{var i=e.unreadMessageCount,a=e.unreadMentionCount;e.myCountPreference!==l.CountPreference.ALL&&(e.myCountPreference===l.CountPreference.UNREAD_MESSAGE_COUNT_ONLY?a=0:e.myCountPreference===l.CountPreference.UNREAD_MENTION_COUNT_ONLY?i=0:(i=0,a=0)),e._setGroupChannelUnreadCount(i,a),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Lt.CATEGORY_CHANNEL_META_DATA_CHANGED:case Lt.CATEGORY_CHANNEL_META_COUNTERS_CHANGED:var Xe=je.data.hasOwnProperty("created"),Ze=je.data.hasOwnProperty("updated"),tt=je.data.hasOwnProperty("deleted");(je.isOpenChannel()?d.getChannel(je.channelUrl,I.INTERNAL_CALL):l.getChannel(je.channelUrl,I.INTERNAL_CALL)).then((function(e){var n=je.data.created,r=je.data.updated,i=je.data.deleted;Object.keys(t.sb.channelHandlers).forEach((function(a){var s=t.sb.channelHandlers[a];if(je.category===Lt.CATEGORY_CHANNEL_META_DATA_CHANGED){var o=U.ts;Xe&&e._addOrUpdateCachedMetaData(n,o),Ze&&e._addOrUpdateCachedMetaData(r,o),tt&&e._markAsDeletedCachedMetaData(i,o),Xe&&s.onMetaDataCreated(e,n),Ze&&s.onMetaDataUpdated(e,r),tt&&s.onMetaDataDeleted(e,i),(Xe||Ze)&&j.send({source:he.EVENT_CHANNEL_METADATA_UPDATED,payload:{channel:e,metaData:u(u({},n),r)}}),tt&&j.send({source:he.EVENT_CHANNEL_METADATA_DELETED,payload:{channel:e,metaData:u({},i)}})}else Xe&&s.onMetaCountersCreated(e,n),Ze&&s.onMetaCountersUpdated(e,r),tt&&s.onMetaCountersDeleted(e,i),(Xe||Ze)&&j.send({source:he.EVENT_CHANNEL_METACOUNTER_UPDATED,payload:{channel:e,metaData:u(u({},n),r)}}),tt&&j.send({source:he.EVENT_CHANNEL_METACOUNTER_DELETED,payload:{channel:e,metaData:u({},i)}})}))})).catch((function(e){return $.debug("Discard command:","`".concat(w.command,"`"),je.category)}));break;case Lt.CATEGORY_CHANNEL_HIDE:case Lt.CATEGORY_CHANNEL_UNHIDE:l.getChannel(je.channelUrl,I.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?$.debug("Discard command:","`".concat(w.command,"`"),je.category):je.category===Lt.CATEGORY_CHANNEL_HIDE?(e.isHidden=!0,je.data&&(je.data.hasOwnProperty("allow_auto_unhide")&&(e.hiddenState=je.data.allow_auto_unhide?l.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:l.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE),je.data.hasOwnProperty("hide_previous_messages")&&je.data.hide_previous_messages&&e._setGroupChannelUnreadCount(0,0)),U.hasOwnProperty("ts_message_offset")&&(e._messageOffsetTimestamp=U.ts_message_offset),l.cachedChannels[e.url]=e,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelHidden(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_HIDDEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):(e.isHidden=!1,e.hiddenState=l.HiddenState.UNHIDDEN,l.cachedChannels[e.url]=e,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),H.upsert([e]).then((function(){j.send({source:he.EVENT_CHANNEL_UNHIDDEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)})))}))}break;case"USEV":var nt=new Lt(U);switch(nt.category){case Pt.CATEGORY_USER_BLOCK:case Pt.CATEGORY_USER_UNBLOCK:var rt=nt.data.blocker.user_id,it=nt.data.blockee.user_id;Object.keys(l.cachedChannels).forEach((function(e){var n=l.cachedChannels[e];try{t.sb.currentUser&&(t.sb.currentUser.userId===rt?n.memberMap[it].isBlockedByMe=nt.category===Pt.CATEGORY_USER_BLOCK:t.sb.currentUser.userId===it&&(n.memberMap[rt].isBlockingMe=nt.category===Pt.CATEGORY_USER_BLOCK))}catch(e){}}));break;case Pt.CATEGORY_FRIEND_DISCOVERED:var at=nt.data.friend_discoveries.map((function(e){return new i(e)}));Object.keys(this.sb.userEventHandlers).forEach((function(e){t.sb.userEventHandlers[e].onFriendsDiscovered(at)}))}break;case"LEAV":case"JOIN":case"PONG":case"MTIO":case"TPST":case"TPEN":break;default:$.debug("Discard command:","`".concat(w.command,"`"))}}}},{key:"handleCacheError",value:function(e){$.error(e)}}]),e}(),xt=200,Ft={},Ht={},Gt=function(){function e(t){d(this,e),this.channel=t,this.uploadQueue=[],this.messageQueue=[],this.latestTimestampToSendMessage=0,j.get(this._iid).FileMessageQueue.queueMap[t.url]=this}return f(e,[{key:"_handleMessageQueueUpdated",value:function(e){var t=this;switch($.debug("`fileMessageQueue` message queue updated:",this.messageQueue),e){case"add":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue();break;case"update":case"remove":if(this.messageQueue.length>0){var n=j.get(this._iid).FileMessageQueue,r=this.messageQueue[0];if(r)if(r.state===n.State.UPLOADED)if(r.state=n.State.SENDING,navigator&&"boolean"==typeof navigator.onLine)if(navigator.onLine){for(0===this.latestTimestampToSendMessage&&(this.latestTimestampToSendMessage=(new Date).getTime()-xt);(new Date).getTime()-this.latestTimestampToSendMessage<xt;);this.latestTimestampToSendMessage=(new Date).getTime(),this._sendUploadedMessage(r,(function(e,i){r.state=n.State.SENT,r.error=e||null,r.response=i||null,t._handleMessageQueueUpdated("update")}))}else r.state=n.State.SENT,r.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),r.response=null,this._finalizeMessage();else We.ready().then((function(e){if(e){for(0===t.latestTimestampToSendMessage&&(t.latestTimestampToSendMessage=(new Date).getTime()-xt);(new Date).getTime()-t.latestTimestampToSendMessage<xt;);t.latestTimestampToSendMessage=(new Date).getTime(),t._sendUploadedMessage(r,(function(e,i){r.state=n.State.SENT,r.error=e||null,r.response=i||null,t._handleMessageQueueUpdated("update")}))}else r.state=n.State.SENT,r.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),r.response=null,t._finalizeMessage()}));else r.state===n.State.SENT&&this._finalizeMessage()}}}},{key:"_handleUploadQueueUpdated",value:function(e,t){var n=this;switch($.debug("`fileMessageQueue` upload queue updated:",this.uploadQueue),e){case"add":var r=j.get(this._iid).FileMessageQueue;if(t.state=r.State.UPLOADING,t.error){var i=this.messageQueue.map((function(e){return e.requestId})).indexOf(t.requestId);i>-1&&(t.state=r.State.SENT,this._handleMessageQueueUpdated("update")),this._finalizeUpload(t.requestId)}else navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?this._uploadFile(t,(function(e){t.error&&t.error.code===F.REQUEST_FAILED&&(t.error=new F("Failed to upload a file.",F.NETWORK_ERROR)),t.error&&t.state===r.State.SENT||(t.state=r.State.UPLOADED),t.fileInfo=e,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId)})):(t.state=r.State.SENT,t.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),t.response=null,this._handleMessageQueueUpdated("update"),this._finalizeUpload(t.requestId)):We.ready().then((function(e){e?n._uploadFile(t,(function(e){t.error&&t.error.code===F.REQUEST_FAILED&&(t.error=new F("Failed to upload a file.",F.NETWORK_ERROR)),t.error&&t.state===r.State.SENT||(t.state=r.State.UPLOADED),t.fileInfo=e,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId)})):(t.state=r.State.SENT,t.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),t.response=null,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId))}));break;case"update":break;case"remove":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue()}}},{key:"_moveFirstPendingMessageToUploadQueue",value:function(){var e=j.get(this._iid).FileMessageQueue,t=this.messageQueue.filter((function(t){return t.state===e.State.PENDING}));if(t.length>0){var n=t[0];this.uploadQueue.push(n),this._handleUploadQueueUpdated("add",n)}}},{key:"_sendUploadedMessage",value:function(e,t){var n=j.get(this._iid),r=n.Command,i=n.FileMessage,a=e.fileInfo,s=r.bFile(u(u({},a),{},{requestId:e.requestId,channelUrl:this.channel.url,url:a.file,metaArrays:a.metaArrays})),o=Pi.getInstance(this._iid),l=O.get(this._iid);o.getConnectionState()===o.ConnectionState.OPEN||!o.currentUser||o.connecting||o.reconnecting?o.sendCommand(s,(function(e,n){if(o.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n){var l=new i(s.getJsonElement());l.requestedMentionUserIds=a.mentionedUserIds,t(n,l)}else{var u=new i(e.getJsonElement());t(null,u)}})):l.container.apiClient.sendFileMessage(u(u({reqId:e.requestId,channelUrl:this.channel.url,isOpenChannel:this.channel.isOpenChannel()},a),{},{fileUrl:a.file,fileName:a.name,fileSize:a.size,fileType:a.type,metaArrays:a.metaArrays}),(function(e,n){var r=new i(e?s.getJsonElement():n);e&&(r.requestedMentionUserIds=a.mentionedUserIds),t(e,r)}))}},{key:"_uploadFile",value:function(e,t){var n=e.fileInfo,r=e.pendingMessage;if("string"!=typeof n.file&&n.file){var i=j.get(this._iid).FileMessageQueue;O.get(this._iid).container.apiClient.uploadFile(u(u({},n),{},{fileType:n.type,channelUrl:this.channel.url,reqId:r?r.reqId:null}),(function(r,a){if(r)e.state=i.State.SENT,e.error=r,e.response=null,t(n);else{var s="object"===c(a)?a:JSON.parse(a);n.file=s.url,n.thumbnailSizes=s.hasOwnProperty("thumbnails")?s.thumbnails:[],n.requireAuth=!!s.hasOwnProperty("require_auth")&&s.require_auth,n.size=s.hasOwnProperty("file_size")?s.file_size:n.size,t(n)}}))}else n.thumbnailSizes=[],n.requireAuth=!1,t(n)}},{key:"_finalizeUpload",value:function(e){var t=this.uploadQueue.map((function(e){return e.requestId})).indexOf(e);if(t>-1){var n=this.uploadQueue.splice(t,1);n.length>0&&this._handleUploadQueueUpdated("remove",n[0])}}},{key:"_finalizeMessage",value:function(){var e=this,t=O.get(this._iid),n=t.container.localCacheEnabled,r=t.container.isErrorFirstInCallback,i=Pi.getInstance(this._iid),a=et.of(this._iid),s=lt.of(this._iid),o=me.of(this._iid),l=j.get(this._iid).FileMessageQueue,u=this.messageQueue[0],c=u.pendingMessage;if(u&&u.state===l.State.SENT){u.state=l.State.DONE;var d=u.response;d&&c&&(d._isAutoResendRegistered=c._isAutoResendRegistered);var h=u.error,f=h?new F(h.message,h.code):null,p=u.fileInfo.callback;if(d&&!h){d.reqId=c.reqId,d.requestState=i.MessageRequestState.SUCCEEDED,d.sendingStatus=i.MessageSendingStatus.SUCCEEDED;var g=i.currentUser;if(g&&d._sender&&g.userId===d._sender.userId&&(g.nickname!==d._sender.nickname&&(g.nickname=d._sender.nickname),g.plainProfileUrl!==d._sender.plainProfileUrl&&(g.plainProfileUrl=d._sender.plainProfileUrl)),this.channel.isGroupChannel())return this.channel.lastMessage=d,Object.keys(i.channelHandlers).forEach((function(t){i.channelHandlers[t].onChannelChanged(e.channel)})),void a.upsert([this.channel]).then((function(){o.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e.channel}})})).then((function(){return s.removeUnsentMessages({channelUrl:e.channel.url,sendingStatus:i.MessageSendingStatus.PENDING,reqIds:[d.reqId]})})).then((function(){return s.upsert([d],$e.SUCCEEDED)})).then((function(){wt._completeCurrentAndProcessNextAutoResend(i,d),o.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:e.channel,message:d}})})).catch((function(e){return $.error(e)})).finally((function(){p&&(p.isPromisifyCallback||r?p(null,d):p(d,null)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")}))}if(h){if(d&&d._isAutoResendRegistered&&se.isAutoResendableError(h.code))return this.messageQueue.shift(),void this._handleMessageQueueUpdated("remove");if(u.pendingMessage&&(d=u.pendingMessage._clone()),d&&h.code!==F.INVALID_PARAMETER)if(d.requestState=i.MessageRequestState.FAILED,h.code===F.FILE_UPLOAD_CANCEL_FAILED||h.code===F.REQUEST_CANCELED){if(d.sendingStatus=i.MessageSendingStatus.CANCELED,this.channel.isGroupChannel())return void s.removeUnsentMessages({channelUrl:this.channel.url,sendingStatus:i.MessageSendingStatus.PENDING,reqIds:[d.reqId]}).then((function(){o.send({source:he.LOCAL_MESSAGE_CANCELED,payload:{channel:e.channel,message:d}})})).catch((function(e){return $.error(e)})).finally((function(){p&&(p.isPromisifyCallback||r?p(f,d):p(d,f)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")}))}else if(d.sendingStatus=i.MessageSendingStatus.FAILED,d.errorCode=h.code,d.requestedMentionUserIds=u.fileInfo.mentionedUserIds,h.code===F.FILE_SIZE_LIMIT_EXCEEDED&&d._messageParams&&d._messageParams.file&&(d._messageParams.file=null),this.channel.isGroupChannel())return void(h.code===F.USER_NOT_MEMBER||h.code===F.CHANNEL_NOT_FOUND?a.remove([this.channel.url]).then((function(){return s.removeUnsentMessages({channelUrl:e.channel.url,sendingStatus:i.MessageSendingStatus.PENDING,reqIds:[d.reqId]})})).then((function(){o.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:e.channel,message:d}})})).catch((function(e){return $.error(e)})).finally((function(){p&&(p.isPromisifyCallback||r?p(f,d):p(d,f)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")})):(n&&se.isAutoResendableError(h.code)&&(d.sendingStatus=i.MessageSendingStatus.PENDING,d.errorCode=0,d._isAutoResendRegistered=!0),s.upsert([d],$e.UNSENT).then((function(){wt._completeCurrentAndProcessNextAutoResend(i,d),o.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:e.channel,message:d}})})).catch((function(e){return $.error(e)})).finally((function(){var t=d._clone();t.sendingStatus=i.MessageSendingStatus.FAILED,t.errorCode=h.code,t._isAutoResendRegistered=!1,p&&(p.isPromisifyCallback||r?p(f,t):p(t,f)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")}))))}p&&(p.isPromisifyCallback||r?p(f,d):p(d,f)),this.messageQueue.shift(),this._handleMessageQueueUpdated("remove")}}},{key:"addJob",value:function(e){this.messageQueue.push(e),this._handleMessageQueueUpdated("add")}},{key:"cancelUploadItemByRequestId",value:function(e,t){this._finalizeUpload(e);var n=this.messageQueue.map((function(e){return e.requestId})).indexOf(e);if(n>-1){var r=j.get(this._iid).FileMessageQueue,i=this.messageQueue[n];!i||i.state!==r.State.UPLOADING&&i.state!==r.State.PENDING||(i.state=r.State.SENT,i.response=null,i.error=new F("Uploading has been completed or canceled.",F.FILE_UPLOAD_CANCEL_FAILED),this._handleMessageQueueUpdated("update"));var a=r.uploadRequest[e];if(a)return"function"==typeof a.abort?a.abort():"function"==typeof a.cancel&&a.cancel("Upload has been canceled."),t(null,!0),!0;t(new F("Uploading has been completed or canceled.",F.FILE_UPLOAD_CANCEL_FAILED),!1)}else t(new F("Uploading has been completed or canceled.",F.FILE_UPLOAD_CANCEL_FAILED),!1);return!1}}],[{key:"State",get:function(){return{PENDING:"pending",UPLOADING:"uploading",UPLOADED:"uploaded",SENDING:"sending",SENT:"sent",DONE:"done"}}},{key:"getByChannelUrl",value:function(e){return j.get(this._iid).FileMessageQueue.queueMap[e]}},{key:"create",value:function(e){var t=j.get(this._iid).FileMessageQueue;return t.queueMap.hasOwnProperty(e.url)||(t.queueMap[e.url]=new t(e)),t.queueMap[e.url]}},{key:"delete",value:function(e){var t=j.get(this._iid).FileMessageQueue;t.queueMap.hasOwnProperty(e)&&delete t.queueMap[e]}},{key:"clear",value:function(){Ht[this._iid]={}}},{key:"queueMap",get:function(){return Ht[this._iid]||(Ht[this._iid]={}),Ht[this._iid]}},{key:"uploadRequest",get:function(){return Ft[this._iid]||(Ft[this._iid]={}),Ft[this._iid]}}]),e}();Gt.Job=f((function e(t){var n=t.fileInfo,r=t.requestId,i=t.pendingMessage,a=t.state,s=t.error,o=void 0===s?null:s,l=t.response,u=void 0===l?null:l;d(this,e),this.fileInfo=n,this.requestId=r,this.pendingMessage=i,this.state=a||Gt.State.PENDING,this.error=o,this.response=u}));var jt,zt={},Bt=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=void 0===n?1048576:n,i=e.cacheLimit,a=void 0===i?256:i,s=e.blockHashBase,o=void 0===s?2:s,l=e.blockHashMultiplier,u=void 0===l?10:l,c=e.blockHashConstant,d=void 0===c?11:c,h=e.transactionApplyDelay,f=void 0===h?200:h,p=e.disableLogger,g=void 0!==p&&p;return zt[t]||(this.itemSizeLimit=r,this.cacheLimit=a,this.blockHashBase=o,this.blockHashMultiplier=u,this.blockHashConstant=d,this.transactionApplyDelay=f,this.disableLogger=g,zt[t]=this),zt[t]}return e.get=function(e){return zt[e]},e}();!function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"}(jt||(jt={}));var Vt,qt=function(e){function t(n){var r=n.code,i=void 0===r?jt.UNKNOWN_ERROR:r,a=n.message,s=void 0===a?"Unknown error occurred.":a,o=e.call(this,s)||this;return o.code=i,Object.setPrototypeOf(o,t.prototype),o}return R(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:jt.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:jt.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:jt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:jt.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:jt.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:jt.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:jt.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:jt.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:jt.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:jt.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:jt.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:jt.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:jt.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:jt.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:jt.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:jt.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:jt.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:jt.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:jt.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:jt.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:jt.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:jt.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:jt.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:jt.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed"}(Vt||(Vt={}));var Kt,Qt=function(e,t){if(void 0===t&&(t=new WeakMap),"object"==typeof e&&null!==e){if(t.has(e))throw qt.circularReferenceFound;t.set(e,!0);var n=null;if(Array.isArray(e))n=e.map((function(e){return Qt(e,t)}));else if(e instanceof RegExp)n=e;else if(e instanceof Date)n=e;else for(var r in n={},e)n[r]=Qt(e[r],t);return t.delete(e),n}return e},Yt=function(e,t){if(null==t)return 1;if(null==e)return-1;if(typeof e!=typeof t)throw qt.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t)}return n},Wt=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return(n>>>0)%t},Jt=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},$t=function(e,t){if(!t)return!1;if("function"!=typeof e){for(var n in e)if(["/and","&&"].includes(n)){if(e[n].some((function(e){return!$t(e,t)})))return!1}else if(["/or","||"].includes(n)){if(e[n].every((function(e){return!$t(e,t)})))return!1}else if("/where"===n){if(!(0,e[n])(t))return!1}else{var r=n;if("object"==typeof e[r]){var i=e[r];for(var a in i)switch(a){case"/eq":case"=":if((s=t[r])!==(o=i[a]))return!1;break;case"/neq":case"!=":if((s=t[r])===(o=i[a]))return!1;break;case"/gt":case">":var s=t[r],o=i[a];if(!(Yt(s,o)>0))return!1;break;case"/gte":case">=":if(s=t[r],o=i[a],!(Yt(s,o)>=0))return!1;break;case"/lt":case"<":if(s=t[r],o=i[a],!(Yt(s,o)<0))return!1;break;case"/lte":case"<=":if(s=t[r],o=i[a],!(Yt(s,o)<=0))return!1;break;case"/in":if(s=t[r],!(o=i[a]).includes(s))return!1;break;case"/nin":if(s=t[r],(o=i[a]).includes(s))return!1;break;case"/contain":if(s=t[r],o=i[a],!s.includes(o))return!1;break;case"/regex":if(s=t[r],!(o=i[a]).test(s))return!1;break;case"/where":if(s=t[r],!(0,i[a])(s))return!1}}else if("function"==typeof e[r]){if(!e[r](t[r]))return!1}else if(e[r]!==t[r])return!1}return!0}return e(t)},Xt=function(){},Zt=function(){return Promise.resolve()},en=function(e){return e},tn=function(e,t){t(null)};!function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD"}(Kt||(Kt={}));var nn,rn,an,sn=function(){function e(e){var t=e.initialPrevValue,n=void 0===t?null:t,r=e.initialNextValue,i=void 0===r?null:r,a=e.iterator,s=e.map,o=void 0===s?en:s,l=e.backward,u=void 0===l?Zt:l,c=e.forward,d=void 0===c?Zt:c,h=e.complete,f=void 0===h?Xt:h;this._prevValue=n,this._nextValue=i,this._error=null,this._map=o,this._backward=u,this._forward=d,this._iterator=a,this._complete=f}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return L(this,void 0,void 0,(function(){var e,t,n;return P(this,(function(r){switch(r.label){case 0:if(!this.hasPrevious)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.next=function(){return L(this,void 0,void 0,(function(){var e,t,n;return P(this,(function(r){switch(r.label){case 0:if(!this.hasNext)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},e}(),on=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.blockManager,s=e.indexer;this.condition=n,this.backward=i,this._blockManager=a,this._indexer=s}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(var i in this._indexer.fields){var a=this._indexer.fields[i],s=1;if("-"===a[0]&&(a=a.slice(1),s=-1),this.condition[a])if("object"==typeof this.condition[a]){var o=s>0?n:t;for(var l in this.condition[a])if(o.includes(l))for(var u=r;u>=0;u--)if(s*Yt(this._indexer.origin[u].columnValues[i],this.condition[a][l])<=0){r=u;break}}else for(u=r;u>=0;u--)if(s*Yt(this._indexer.origin[u].columnValues[i],this.condition[a])<=0){r=u;break}}return Math.min(r+1,this._indexer.origin.length-1)}var c=0;if("function"!=typeof this.condition){var d=function(r){var i=h._indexer.fields[r],a=1;if("-"===i[0]&&(i=i.slice(1),a=-1),h.condition[i])if("object"==typeof h.condition[i])Object.keys(h.condition[i]).forEach((function(s){if((a>0?t:n).includes(s))for(var o=c;o<e._indexer.origin.length;o++)if(a*Yt(e._indexer.origin[o].columnValues[r],e.condition[i][s])>=0){c=o;break}}));else for(var s=c;s<h._indexer.origin.length;s++)if(a*Yt(h._indexer.origin[s].columnValues[r],h.condition[i])>=0){c=s;break}},h=this;for(i=0;i<this._indexer.fields.length;i++)d(i)}return Math.max(c-1,0)},e.prototype.each=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l=this;return P(this,(function(u){switch(u.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(l._indexer.origin[t]){if(!l._indexer.origin[t].keys[++n]){if(!l._indexer.origin[++t])return!1;n=0}return!0}return!1},i=function(){if(l._indexer.origin[t]){if(!l._indexer.origin[t].keys[--n]){if(!l._indexer.origin[--t])return!1;n=l._indexer.origin[t].keys.length-1}return!0}return!1},a=null,!this._indexer.origin[t])return[3,4];s=this.backward?i:r,u.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if(o=u.sent(),$t(this.condition,o))return a=o,[3,4];u.label=3;case 3:if(s())return[3,1];u.label=4;case 4:return[4,new Promise((function(s){var o=new sn({initialNextValue:Qt(a),iterator:e,forward:function(){return L(l,void 0,void 0,(function(){var e,a;return P(this,(function(s){switch(s.label){case 0:e=this.backward?i:r,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return a=s.sent(),$t(this.condition,a)?[2,Qt(a)]:[3,1];case 3:return[2,null]}}))}))},backward:function(){return L(l,void 0,void 0,(function(){var e,a;return P(this,(function(s){switch(s.label){case 0:e=this.backward?r:i,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return a=s.sent(),$t(this.condition,a)?[2,Qt(a)]:[3,1];case 3:return[2,null]}}))}))},complete:s});e(o)}))];case 5:return[2,u.sent()]}}))}))},e}(),ln=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.mutex,s=e.blockManager,o=e.indexer;this._mutex=a,this._iterator=new on({condition:n,backward:i,blockManager:s,indexer:o})}return e.prototype.fetch=function(e){return void 0===e&&(e={}),L(this,void 0,void 0,(function(){var t,n,r,i,a=this;return P(this,(function(s){switch(s.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return[2,[]];if(n<0)throw qt.collectionQueryNotValid;s.label=1;case 1:return s.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return s.sent(),[4,this._iterator.each((function(e){return L(a,void 0,void 0,(function(){return P(this,(function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2]}))}))}))];case 3:return s.sent(),this._mutex.unlock(),[2,r];case 4:throw i=s.sent(),this._mutex.unlock(),i;case 5:return[2]}}))}))},e.prototype.count=function(){return L(this,void 0,void 0,(function(){var e,t,n=this;return P(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each((function(t){return L(n,void 0,void 0,(function(){return P(this,(function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2]}))}))}))];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return[2]}}))}))},e}(),un=function(e){return"".concat("nest","@").concat(e)},cn=function(e,t){return"".concat(un(e),"/").concat(t)},dn=function(e,t){return"".concat(cn(e,t),".metadata")},hn=function(e,t){return"".concat(cn(e,t),"/block.")},fn=function(e,t){return"".concat(cn(e,t),"/blob.")},pn=function(e,t,n,r){return void 0===r&&(r=0),"".concat(fn(e,t)).concat(n,".").concat(r)},gn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this.dbname=t,this.collectionName=n,this._store=r}return e.prototype._makeShards=function(e,t){var n=Math.max(this._store.itemSizeLimit-1024,0);if(n>0){for(var r=Math.ceil(e.data.length/n),i="".concat(r,".").concat(e.type,".").concat(t),a=[],s=0;s<e.data.length;s+=n){var o=e.data.slice(s,s+n);a.push(o)}return{blobId:i,shards:a}}return{blobId:null,shards:null}},e.prototype._encode=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){var n=new FileReader;n.onload=function(){t({data:n.result,type:e.type})},n.readAsDataURL(e)}))];case 1:return[2,t.sent()]}}))}))},e.prototype._decode=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s;return P(this,(function(o){switch(o.label){case 0:return"undefined"==typeof fetch?[3,3]:[4,fetch(e.data)];case 1:return[4,o.sent().blob()];case 2:return[2,o.sent()];case 3:for(t=[],n=atob(e.data.split(",")[1]),r=0;r<n.length;r+=512){for(i=n.slice(r,r+512),a=new Array(i.length),s=0;s<i.length;s++)a[s]=i.charCodeAt(s);t.push(new Uint8Array(a))}return[2,new Blob(t,{type:e.type})]}}))}))},e.prototype.get=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l;return P(this,(function(u){switch(u.label){case 0:if(t=[],n=e.split("."),r=n[0],i=n[1],!((a=parseInt(r))>0))return[3,6];s=0,u.label=1;case 1:return s<a?(o=pn(this.dbname,this.collectionName,e,s),[4,this._store.get(o)]):[3,4];case 2:if(!(l=u.sent())||!l.d)throw qt.storeBrokenBlob;t.push(l.d),u.label=3;case 3:return s++,[3,1];case 4:return[4,this._decode({data:t.join(""),type:i})];case 5:return[2,u.sent()];case 6:return[2,null]}}))}))},e.prototype.save=function(e,t){return void 0===t&&(t="".concat(Date.now())),L(this,void 0,void 0,(function(){var n,r,i,a,s,o,l;return P(this,(function(u){switch(u.label){case 0:return n=[],[4,this._encode(e)];case 1:if(r=u.sent(),i=this._makeShards(r,t),a=i.blobId,s=i.shards,!a)return[3,3];for(o=0;o<s.length;o++)l=pn(this.dbname,this.collectionName,a,o),n.push({key:l,value:{d:s[o]},generation:1});return[4,this._store.setMany(n)];case 2:if(u.sent().some((function(e){return e instanceof Error})))throw qt.storeWriteFailed;return[2,a];case 3:return[2,null]}}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i;return P(this,(function(a){switch(a.label){case 0:if(t=[],n=e.split(".")[0],!((r=parseInt(n))>0))return[3,2];for(i=0;i<r;i++)t.push(pn(this.dbname,this.collectionName,e,i));return[4,this._store.removeMany(t)];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i,a;return P(this,(function(s){switch(s.label){case 0:return e=fn(this.dbname,this.collectionName),t=[],[4,this._store.getAllKeys()];case 1:for(n=s.sent(),r=0,i=n;r<i.length;r++)(a=i[r]).startsWith(e)&&t.push(a);return[4,this._store.removeMany(n)];case 2:return s.sent(),[2]}}))}))},e}();!function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR"}(nn||(nn={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile"}(rn||(rn={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT"}(an||(an={}));var yn=[rn.PENDING,rn.VOLATILE],mn={},_n=function(){function e(e){var t=e.dbname,n=e.limit,r=void 0===n?256:n;return mn[t]||(this.dbname=t,this._items=[],this._limit=r,mn[t]=this),mn[t]}return e.get=function(e){return mn[e]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=an.DEFAULT),L(this,void 0,void 0,(function(){var r,i;return P(this,(function(a){switch(a.label){case 0:return(r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return(i=a.sent())&&(r={key:t,value:i,generation:1,state:n===an.PERSISTENT?rn.PERSISTENT:rn.VOLATILE},this.put(r)),[3,3];case 2:n===an.PERSISTENT&&(r.state=rn.PERSISTENT),a.label=3;case 3:return[2,r]}}))}))},e.prototype.get=function(e,t){void 0===t&&(t=an.DEFAULT);var n=this._items.map((function(e){return e.key})).indexOf(e);if(n>-1){var r=this._items[n];return t===an.PERSISTENT&&(r.state=rn.PERSISTENT),t!==an.NO_CACHE&&this.put(r),r}return null},e.prototype.put=function(e){if(this._limit>0){var t=this._items.map((function(e){return e.key})).indexOf(e.key);if(t>-1)yn.includes(this._items[t].state)&&yn.includes(e.state)?(this._items.splice(t,1),this._items.push(e)):(this._items[t].state=e.state,this._items[t].generation=e.generation,this._items[t].value=e.value);else{this._items.push(e);var n=this._items.filter((function(e){return e.state===rn.VOLATILE})),r=n.length-this._limit;if(r>0){for(var i=[],a=0,s=this._items;a<s.length;a++){var o=s[a];o.state===rn.VOLATILE&&r>0?r--:i.push(o)}this._items=i}}}},e.prototype.remove=function(e){var t=this._items.map((function(e){return e.key})).indexOf(e);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(e){this._items=this._items.filter((function(t){return!e(t)}))},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter((function(e){return e.state!==rn.VOLATILE}))},e}(),vn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._metadata=null,this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=n,this.metadataKey=function(e,t){return"".concat(cn(e,t),"/trans.metadata")}(t,n),this.recordsetKey=function(e,t){return"".concat(cn(e,t),"/trans.recordset")}(t,n),this._store=r}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=n.sent()||[]).push.apply(t,e),[2,this._reduceRecordSet(t)]}}))}))},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],a=[],s=i.requests.length-1;s>=0;s--){var o=i.requests[s],l=o.data;n[l.key]||(a.unshift(o),n[l.key]=!0)}a.length>0&&(i.requests=a,t.unshift(i))}return t},e.prototype._applyRecord=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i,a,s,o,l,u,c;return P(this,(function(d){switch(d.label){case 0:n=_n.get(this.dbname),r=t.generation,i=t.requests,a=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._store.setMany(i.map((function(e){return M(M({},e.data),{generation:r})})))];case 2:for(s=d.sent(),o=0;o<i.length;o++)s[o]instanceof Error&&(a||(a=s[o]),l=i[o].data,n.put(M(M({},l),{generation:r,state:rn.PERSISTENT})));return[3,4];case 3:return u=d.sent(),a=u,[3,4];case 4:return a?[3,6]:(c=e.filter((function(e){return e.generation!==r})),[4,this._store.set({key:this.recordsetKey,value:c,generation:r})]);case 5:return d.sent(),this._onWrite.forEach((function(e){e(i.map((function(e){return e.data})))})),[3,7];case 6:this._onError.forEach((function(e){return e(a)})),d.label=7;case 7:return[2]}}))}))},e.prototype.init=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i;return P(this,(function(a){switch(a.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=a.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=a.sent(),n=0,r=t,a.label=3;case 3:return n<r.length?(i=r[n],[4,this._applyRecord(t,i)]):[3,6];case 4:a.sent(),a.label=5;case 5:return n++,[3,3];case 6:return[2]}}))}))},e.prototype.on=function(e,t,n){switch(e){case nn.COMMIT:this._onCommit.set(t,n);break;case nn.WRITE:this._onWrite.set(t,n);break;case nn.ERROR:this._onError.set(t,n)}},e.prototype.requestWrite=function(e,t){void 0===t&&(t=null),this._requests.push({data:e,options:t}),_n.get(this.dbname).put(M({state:rn.PENDING,generation:this.generation},e))},e.prototype.requestMultipleWrite=function(e,t){void 0===t&&(t=null);for(var n=_n.get(this.dbname),r=0,i=e;r<i.length;r++){var a=i[r];this._requests.push({data:a,options:t}),n.put(M({state:rn.PENDING,generation:this.generation},a))}},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){return _n.get(this.dbname).clearByCondition((function(e){return e.state===rn.PENDING})),this._requests=[],[2]}))}))},e.prototype.commit=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h=this;return P(this,(function(f){switch(f.label){case 0:if(!((e=this._requests).length>0))return[3,4];for(t=[],n={},o=e.length-1;o>=0;o--)r=e[o],u=r.data,n[u.key]||(n[u.key]=!0,t.unshift(r));return i={generation:this.generation,requests:t},[4,this._getReducedRecordset([i])];case 1:return a=f.sent(),[4,this._store.set({key:this.recordsetKey,value:a,generation:this.generation})];case 2:return f.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata,generation:1})];case 3:for(f.sent(),s=_n.get(this.dbname),o=0;o<t.length;o++)l=t[o],u=l.data,c=l.options,s.put(M(M({},u),{generation:i.generation,state:c&&c.persistent?rn.PERSISTENT:rn.VOLATILE}));this._requests=[],this._onCommit.forEach((function(t){t(e.map((function(e){return e.data})))})),d=Bt.get(this.dbname),setTimeout((function(){try{h._applyRecord(a,i)}catch(e){h._onError.forEach((function(n){return n(e)}))}}),d.transactionApplyDelay),f.label=4;case 4:return[2]}}))}))},e}(),En=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,i=void 0===r?[]:r,a=e.limit;this.blockId=t,this.keyName=n,this.limit=a,this._items=D([],i,!0)}return e.createFromCacheItem=function(t){return t?new e(t.value):null},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},e.prototype.getItemByKey=function(e){var t=this;return this._items.find((function(n){var r=n[t.keyName];return e===r}))},e.prototype.has=function(e){var t=this;return this._items.map((function(e){return e[t.keyName]})).includes(e)},e.prototype.add=function(e){var t=this,n=this._items.map((function(e){return e[t.keyName]})).indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0)},e.prototype.remove=function(e){for(var t in this._items)if(this._items[t][this.keyName]===e)return this._items.splice(parseInt(t),1),!0;return!1},e.prototype.clear=function(){this._items=[]},e}(),bn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,a=void 0===i?Wt:i,s=e.transaction,o=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=a,this.metadata=r,this._transaction=s,this._store=o}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){return void 0===t&&(t=this.metadata.blockLevel),n=this.dbname,r=this.collectionName,i=t,a="".concat(function(e,t,n){var r=n.base*Math.pow(n.multiplier,t)+n.constant;return(n.hashFunction||Wt)(e,r)}(e,t,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(hn(n,r)).concat(i,".").concat(a);var n,r,i,a},e.prototype._findBlock=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a;return P(this,(function(s){switch(s.label){case 0:t=_n.get(this.dbname),n=this.metadata.blockLevel,s.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((i=s.sent())&&(a=En.createFromCacheItem(i)).getItemByKey(e))return[2,a];s.label=3;case 3:return n--,[3,1];case 4:return[2,null]}}))}))},e.prototype.getFromBlock=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return[2,(t=n.sent())?t.getItemByKey(e):null]}}))}))},e.prototype.putToBlock=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i,a,s;return P(this,(function(o){switch(o.label){case 0:return n=Bt.get(this.dbname),r=this.createBlockId(e),i=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,_n.get(this.dbname).find(this._store,r)];case 1:return a=o.sent(),(s=a?En.createFromCacheItem(a):new En({blockId:r,keyName:this.keyName,items:[],limit:i})).add(t)?(this._transaction.requestWrite({key:s.blockId,value:s.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.removeFromBlock=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return(t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.clearAllBlocks=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i,a,s;return P(this,(function(o){switch(o.label){case 0:return e=hn(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=o.sent(),n=t.filter((function(t){return t.startsWith(e)})),[4,this._store.removeMany(n)];case 2:for(o.sent(),r=_n.get(this.dbname),i=0,a=n;i<a.length;i++)s=a[i],r.remove(s);return[2]}}))}))},e}(),Cn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.fields,a=e.transaction,s=e.store,o=this;this._origin=[],this._table=[],this.dbname=t,this.collectionName=n,this.keyName=r,this.fields=i,this.indexerKey=function(e,t,n){return"".concat(cn(e,t),"/index.").concat(n)}(this.dbname,this.collectionName,this.fields.join(">")),this._transaction=a,this._store=s,this._transaction.on(nn.COMMIT,this.indexerKey,(function(){return o.commit()})),this._transaction.on(nn.ERROR,this.indexerKey,(function(){return o.abort()}))}return e.createKey=function(e){return e.join(">")},e.parseKey=function(e){return e.split(">")},e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=this.indexOf(n),i=r[0];return r[1]?!this._table[i].keys.includes(t)&&(this._table[i].keys.push(t),!0):(this._table.splice(i,0,{columnValues:n,keys:[t]}),!0)},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=this.indexOf(n),i=r[0];if(r[1]){var a=this._table[i].keys.indexOf(t);if(a>-1)return this._table[i].keys.splice(a,1),0===this._table[i].keys.length&&this._table.splice(i,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){for(var t,n,r=[],i=0,a=this.fields;i<a.length;i++){var s=a[i];if("-"===s[0]&&(s=s.slice(1)),n=void 0,n=typeof(t=e[s]),null!==t&&"undefined"!==n&&"boolean"!==n&&"number"!==n&&"string"!==n)throw qt.indexTypesNotMatch;r.push(e[s])}return r},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=Yt(e[n],t[n]);if(0!==i)return r*i}return 0},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else{if(!(i<0))return[r,!0];n=r-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return L(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d;return P(this,(function(h){switch(h.label){case 0:return[4,(e=_n.get(this.dbname)).find(this._store,this.indexerKey,an.PERSISTENT)];case 1:return(t=h.sent())?[3,7]:(n=hn(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=h.sent(),i=0,a=r,h.label=3;case 3:return i<a.length?(s=a[i]).startsWith(n)?[4,e.find(this._store,s,an.NO_CACHE)]:[3,5]:[3,6];case 4:for(o=h.sent(),l=En.createFromCacheItem(o),u=0,c=l.items;u<c.length;u++)d=c[u],this._addItem(d);h.label=5;case 5:return i++,[3,3];case 6:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,8];case 7:this._origin=t.value,this._table=Qt(this._origin),h.label=8;case 8:return[2]}}))}))},e.prototype.drop=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return _n.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),[2]}}))}))},e.prototype.addItem=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.removeItem=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.commit=function(){this._origin=this._table,this._table=Qt(this._origin)},e.prototype.abort=function(){this._table=Qt(this._origin)},e}(),Sn="undefined"!=typeof document&&"undefined"!=typeof navigator;Sn&&navigator.userAgent&&navigator.userAgent.includes("Chrome/")&&navigator.userAgent.includes("Chromium/");var Nn=Sn&&navigator.userAgent&&navigator.userAgent.includes("Firefox/")&&!navigator.userAgent.includes("Seamonkey/");Sn&&navigator.userAgent&&navigator.userAgent.includes("Safari/")&&!navigator.userAgent.includes("Chrome/")&&navigator.userAgent.includes("Chromium/"),Sn&&navigator.userAgent&&(navigator.userAgent.includes("OPR/")||navigator.userAgent.includes("Opera/")),Sn&&navigator.userAgent&&navigator.userAgent.includes("Trident/7.0");var An,kn,Tn=Sn&&navigator.userAgent&&navigator.userAgent.includes("Edge/"),In=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))};!function(e){e[e.PROCESSING=0]="PROCESSING",e[e.DONE=1]="DONE"}(An||(An={})),function(e){e.NEWNODE="newnode",e.REMOVENODE="removenode",e.CLAIM_HOST="claimhost",e.SYNC_HOST="synchost",e.REQUEST_LOCK="requestlock",e.ACQUIRE_LOCK="acquirelock",e.RELEASE_LOCK="releaselock"}(kn||(kn={}));var wn,On={},Un=function(){function e(e,t){void 0===t&&(t={});var n=this;return this._state=An.PROCESSING,this._hostId=null,this._queue=[],this._currentItem=null,this._activationTimeout=null,this._activationQueue=[],On[e]&&!t.forceCreate||(this.nodeId=In(),this.key=e,Sn&&(t.startAsInvisible?this.registerNode():"visible"===document.visibilityState?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&n.claimHost()})),window.addEventListener("message",(function(e){var t=e.data,r=t.nodeId,i=t.requestId,a=t.key,s=t.op,o=t.data;if(r!==n.nodeId&&a===n.key)switch(s){case kn.NEWNODE:n._sendSync();break;case kn.CLAIM_HOST:n._sendSync(),n._hostId=r;break;case kn.SYNC_HOST:if(!n.isInSync){n._activationTimeout&&clearTimeout(n._activationTimeout);for(var l=o,u=l.currentItemRequestId,c=function(e){n._queue.findIndex((function(t){return t.requestId===e.requestId}))<0&&n._requestLock({nodeId:e.nodeId,requestId:e.requestId,key:n.key,op:kn.REQUEST_LOCK,ts:e.ts})},d=0,h=l.queue;d<h.length;d++)c(h[d]);n._currentItem=n._queue.find((function(e){return e.requestId===u})),n._completeSync()}break;case kn.REMOVENODE:n._queue=n._queue.filter((function(e){return e.nodeId!==t.nodeId})),n._currentItem&&n._currentItem.nodeId===t.nodeId&&(n._currentItem=null,n._acquire(n._queue[0]));break;case kn.REQUEST_LOCK:n._requestLock(t);break;case kn.ACQUIRE_LOCK:var f=n._queue.find((function(e){return e.requestId===i}));n._acquire(f);break;case kn.RELEASE_LOCK:n._release(i)}})),window.addEventListener("beforeunload",(function(){n._send(kn.REMOVENODE)}))),On[e]=this),On[e]}return Object.defineProperty(e.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:function(){return this._state==An.DONE},enumerable:!1,configurable:!0}),e.prototype._send=function(e,t){var n,r;void 0===t&&(t={});var i={nodeId:this.nodeId,requestId:null!==(n=null==t?void 0:t.requestId)&&void 0!==n?n:In(),key:this.key,op:e,data:null!==(r=t.data)&&void 0!==r?r:null,ts:Date.now()};return Sn&&window.postMessage(i,"*"),i},e.prototype._acquire=function(e){void 0===e&&(e=null),e?(this._currentItem=e,this._currentItem.onAcquired(e.requestId)):this._currentItem=null},e.prototype._release=function(e){if(this._currentItem&&this._currentItem.requestId===e){var t=this._currentItem;this._currentItem=null,t.nodeId===this.nodeId&&this._send(kn.RELEASE_LOCK,{requestId:t.requestId});var n=this._queue.findIndex((function(t){return t.requestId===e}));n>-1&&this._queue.splice(n,1),t.onReleased(e)}},e.prototype._requestLock=function(e){var t=this;return new Promise((function(n){var r={nodeId:e.nodeId,requestId:e.requestId,ts:e.ts,onAcquired:function(e){t.isHost&&t._send(kn.ACQUIRE_LOCK,{requestId:e}),n()},onReleased:function(){t._acquire(t._queue[0])}},i=!1;for(var a in t._queue)if(t._queue[a].ts>r.ts){t._queue.splice(parseInt(a),0,r),i=!0;break}i||t._queue.push(r),t._currentItem||t._acquire(t._queue[0])}))},e.prototype._sendSync=function(){var e;this.isHost&&this._send(kn.SYNC_HOST,{data:{currentItemRequestId:null===(e=this._currentItem)||void 0===e?void 0:e.requestId,queue:this._queue.map((function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}}))}})},e.prototype._waitUntilSyncCompleted=function(){return L(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){return this.isHost&&!this.isInSync?[2,new Promise((function(t){e._activationQueue.push(t)}))]:[2]}))}))},e.prototype._waitSync=function(){var e=this;this.isInSync||(this._activationTimeout=setTimeout((function(){e._completeSync()}),8))},e.prototype._completeSync=function(){this.isInSync||(this._state=An.DONE,this._activationQueue.forEach((function(e){return e()})),this._activationQueue=[])},e.prototype.registerNode=function(){this._send(kn.NEWNODE),this._waitSync()},e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(kn.CLAIM_HOST),this._waitSync()},e.prototype.lock=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return t.sent(),e=this._send(kn.REQUEST_LOCK),[4,this._requestLock(e)];case 2:return t.sent(),[2]}}))}))},e.prototype.unlock=function(){var e;this._release(null===(e=this._currentItem)||void 0===e?void 0:e.requestId)},e}(),Rn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.keyHash,a=e.indexes,s=e.store,o=this;this._state=Vt.INIT,this._metadata=null,this._indexers=[],this.dbname=t,this.name=n,this.keyName=r,this.indexes=D([[r]],a.filter((function(e){return Cn.createKey(e)!==o.keyName})),!0),this._keyHash=i,this._store=s,this._mutex=new Un(function(e,t){return"".concat(cn(e,t),".lock")}(t,n)),this._blobContainer=new gn({dbname:t,collectionName:n,store:s}),this._transaction=new vn({dbname:t,collectionName:n,store:s})}return e.metadataOf=function(e,t,n){return L(this,void 0,void 0,(function(){var r;return P(this,(function(i){switch(i.label){case 0:return r=dn(e,t),[4,n.get(r)];case 1:return[2,i.sent()]}}))}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.init=function(){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f=this;return P(this,(function(p){switch(p.label){case 0:return[4,this._mutex.lock()];case 1:p.sent(),p.label=2;case 2:return p.trys.push([2,9,,10]),t=Bt.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=p.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:for(p.sent(),this._blockManager=new bn({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=D([],this.indexes,!0),i=[],a=r.map((function(e){return Cn.createKey(e)})),s=n?n.indexes.map((function(e){return Cn.createKey(e)})):[],o=0,l=s;o<l.length;o++)u=l[o],a.includes(u)||i.push(Cn.parseKey(u));return(c=[]).push.apply(c,r.map((function(e){var t=new Cn({dbname:f.dbname,collectionName:f.name,keyName:f.keyName,fields:e,transaction:f._transaction,store:f._store});return f._indexers.push(t),t.ensure()}))),c.push.apply(c,i.map((function(e){return new Cn({dbname:f.dbname,collectionName:f.name,keyName:f.keyName,fields:e,transaction:f._transaction,store:f._store}).drop()}))),[4,Promise.all(c)];case 5:return p.sent(),[4,this._transaction.commit()];case 6:return p.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(d=dn(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata,generation:1})]);case 7:p.sent(),p.label=8;case 8:return this._state=Vt.READY,this._mutex.unlock(),[3,10];case 9:throw h=p.sent(),this._mutex.unlock(),h;case 10:return[2]}}))}))},e.prototype.close=function(){this._state=Vt.CLOSED},e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return"string"==typeof t&&!!t},e.prototype._getIndexerBy=function(e){void 0===e&&(e=null),e||(e=[this.keyName]);for(var t=Cn.createKey(e),n=0,r=this._indexers;n<r.length;n++){var i=r[n];if(t===Cn.createKey(i.fields))return i}return null},e.prototype._upgradeBlockLevel=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return e=dn(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata,generation:1})];case 1:return t.sent(),[2]}}))}))},e.prototype._requestInsert=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return i.sent()?[3,10]:[4,this._blockManager.putToBlock(t,e)];case 2:return i.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return i.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:i.sent(),i.label=5;case 5:n=0,r=this._indexers,i.label=6;case 6:return n<r.length?[4,r[n].addItem(e)]:[3,9];case 7:i.sent(),i.label=8;case 8:return n++,[3,6];case 9:return[3,11];case 10:throw qt.collectionInsertDuplicate;case 11:return[2]}}))}))},e.prototype._requestUpsert=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return P(this,(function(l){switch(l.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=l.sent())?[3,10]:[4,this._blockManager.putToBlock(t,e)];case 2:return l.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return l.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:l.sent(),l.label=5;case 5:r=0,i=this._indexers,l.label=6;case 6:return r<i.length?[4,(o=i[r]).addItem(e)]:[3,9];case 7:l.sent(),l.label=8;case 8:return r++,[3,6];case 9:return[3,16];case 10:return[4,this._blockManager.putToBlock(t,e)];case 11:l.sent(),a=0,s=this._indexers,l.label=12;case 12:return a<s.length?0===(o=s[a]).diff(o.getColumnValues(n),o.getColumnValues(e))?[3,15]:[4,o.removeItem(n)]:[3,16];case 13:return l.sent(),[4,o.addItem(e)];case 14:l.sent(),l.label=15;case 15:return a++,[3,12];case 16:return[2]}}))}))},e.prototype._requestUpdate=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a;return P(this,(function(s){switch(s.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=s.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,7];case 2:s.sent(),r=0,i=this._indexers,s.label=3;case 3:return r<i.length?0===(a=i[r]).diff(a.getColumnValues(n),a.getColumnValues(e))?[3,6]:[4,a.removeItem(n)]:[3,7];case 4:return s.sent(),[4,a.addItem(e)];case 5:s.sent(),s.label=6;case 6:return r++,[3,3];case 7:return[2]}}))}))},e.prototype._requestRemove=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return[4,this._blockManager.getFromBlock(e)];case 1:return(t=i.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,6];case 2:i.sent(),n=0,r=this._indexers,i.label=3;case 3:return n<r.length?[4,r[n].removeItem(t)]:[3,6];case 4:i.sent(),i.label=5;case 5:return n++,[3,3];case 6:return[2]}}))}))},e.prototype._requestClear=function(){return L(this,void 0,void 0,(function(){var e,t;return P(this,(function(n){switch(n.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:n.sent(),e=0,t=this._indexers,n.label=2;case 2:return e<t.length?[4,t[e].clear()]:[3,5];case 3:n.sent(),n.label=4;case 4:return e++,[3,2];case 5:return[2]}}))}))},e.prototype.getByKey=function(e){return L(this,void 0,void 0,(function(){var t,n;return P(this,(function(r){switch(r.label){case 0:return this._state!==Vt.READY?[3,6]:[4,this._mutex.lock()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,Qt(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return[3,7];case 6:throw qt.collectionNotReady;case 7:return[2]}}))}))},e.prototype.query=function(e){return void 0===e&&(e={}),this._state===Vt.READY?new ln({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward}):null},e.prototype.insertOne=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return this._state!==Vt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw qt.collectionKeyNotGiven;return[4,this._requestInsert(Qt(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw qt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.insertMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a=this;return P(this,(function(s){switch(s.label){case 0:return this._state!==Vt.READY?[3,11]:[4,this._mutex.lock()];case 1:s.sent(),s.label=2;case 2:if(s.trys.push([2,8,,10]),e.some((function(e){return!a._hasPropertyOfKeyName(e)})))throw qt.collectionKeyNotGiven;t=0,n=e,s.label=3;case 3:return t<n.length?(r=n[t],[4,this._requestInsert(Qt(r))]):[3,6];case 4:s.sent(),s.label=5;case 5:return t++,[3,3];case 6:return[4,this._transaction.commit()];case 7:return s.sent(),this._mutex.unlock(),[2,e];case 8:return i=s.sent(),[4,this._transaction.clear()];case 9:throw s.sent(),this._mutex.unlock(),i;case 10:return[3,12];case 11:throw qt.collectionNotReady;case 12:return[2]}}))}))},e.prototype.upsertOne=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return this._state!==Vt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw qt.collectionKeyNotGiven;return[4,this._requestUpsert(Qt(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw qt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.upsertMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a=this;return P(this,(function(s){switch(s.label){case 0:return this._state!==Vt.READY?[3,11]:[4,this._mutex.lock()];case 1:s.sent(),s.label=2;case 2:if(s.trys.push([2,8,,10]),e.some((function(e){return!a._hasPropertyOfKeyName(e)})))throw qt.collectionKeyNotGiven;t=0,n=e,s.label=3;case 3:return t<n.length?(r=n[t],[4,this._requestUpsert(Qt(r))]):[3,6];case 4:s.sent(),s.label=5;case 5:return t++,[3,3];case 6:return[4,this._transaction.commit()];case 7:return s.sent(),this._mutex.unlock(),[2,e];case 8:return i=s.sent(),[4,this._transaction.clear()];case 9:throw s.sent(),this._mutex.unlock(),i;case 10:return[3,12];case 11:throw qt.collectionNotReady;case 12:return[2]}}))}))},e.prototype.update=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return this._state!==Vt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw qt.collectionKeyNotGiven;return[4,this._requestUpdate(Qt(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw qt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.updateIf=function(e,t){return L(this,void 0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f=this;return P(this,(function(p){switch(p.label){case 0:return this._state!==Vt.READY?[3,12]:[4,this._mutex.lock()];case 1:p.sent(),p.label=2;case 2:return p.trys.push([2,9,,11]),n=e.where,r=void 0===n?{}:n,i=e.index,a=void 0===i?null:i,s=e.backward,o=void 0!==s&&s,l=[],[4,new on({condition:r,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(a)}).each((function(e){return L(f,void 0,void 0,(function(){var n,i;return P(this,(function(a){if(e.error)throw e.stop(),e.error;if(e.hasNext){if(n=e.nextValue,$t(r,n)&&t.set){if("function"!=typeof t.set)for(i in t.set)n[i]=t.set[i];else t.set(n);l.push(n)}e.next()}else e.stop();return[2]}))}))}))];case 3:p.sent(),u=0,c=l,p.label=4;case 4:return u<c.length?(d=c[u],[4,this._requestUpdate(Qt(d))]):[3,7];case 5:p.sent(),p.label=6;case 6:return u++,[3,4];case 7:return[4,this._transaction.commit()];case 8:return p.sent(),this._mutex.unlock(),[2,l];case 9:return h=p.sent(),[4,this._transaction.clear()];case 10:throw p.sent(),this._mutex.unlock(),h;case 11:return[3,13];case 12:throw this._transaction.clear(),qt.collectionNotReady;case 13:return[2]}}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return this._state!==Vt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw qt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.removeIf=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h=this;return P(this,(function(f){switch(f.label){case 0:return this._state!==Vt.READY?[3,11]:[4,this._mutex.lock()];case 1:f.sent(),f.label=2;case 2:return f.trys.push([2,9,,10]),t=e.where,n=void 0===t?{}:t,r=e.index,i=void 0===r?null:r,a=e.backward,s=void 0!==a&&a,o=[],[4,new on({condition:n,blockManager:this._blockManager,backward:s,indexer:this._getIndexerBy(i)}).each((function(e){return L(h,void 0,void 0,(function(){var t,r;return P(this,(function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(t=e.nextValue,$t(n,t)&&(r=t[this.keyName],o.push(r)),e.next()):e.stop(),[2]}))}))}))];case 3:f.sent(),l=0,u=o,f.label=4;case 4:return l<u.length?(c=u[l],[4,this._requestRemove(c)]):[3,7];case 5:f.sent(),f.label=6;case 6:return l++,[3,4];case 7:return[4,this._transaction.commit()];case 8:return f.sent(),this._mutex.unlock(),[2,o];case 9:throw d=f.sent(),this._mutex.unlock(),d;case 10:return[3,12];case 11:throw this._transaction.clear(),qt.collectionNotReady;case 12:return[2]}}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return this._state!==Vt.READY?[3,8]:[4,this._mutex.lock()];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw qt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.getBlob=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.saveBlob=function(e,t){return void 0===t&&(t=null),L(this,void 0,void 0,(function(){return P(this,(function(n){switch(n.label){case 0:return[4,this._blobContainer.save(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.removeBlob=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.removeAllBlobs=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return[4,this._blobContainer.clear()];case 1:return e.sent(),[2]}}))}))},e}(),Mn={key:"__ev",value:{k:"__ev",v:"scs"},generation:1},Ln={encrypt:function(e){return e},decrypt:function(e){return e}},Pn={},Dn=function(){function e(e){void 0===e&&(e={});var t=e.itemSizeLimit,n=void 0===t?4194304:t,r=e.delay,i=void 0===r?1:r,a=e.encryption,s=void 0===a?Ln:a;this._encryption=s,this.itemSizeLimit=n,this.delay=i,this.observer={}}return Object.defineProperty(e.prototype,"rawData",{get:function(){return Pn[this.dbname]},set:function(e){Pn[this.dbname]=e},enumerable:!1,configurable:!0}),e.prototype.observe=function(e,t,n){var r=this;this.observer[e]={},t.forEach((function(t){return r.observer[e][t]=n}))},e.prototype.init=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:this.dbname=e,Pn[this.dbname]={},n.label=1;case 1:return n.trys.push([1,,3,5]),[4,this.get(Mn.key)];case 2:if((t=n.sent())&&JSON.stringify(t)!==JSON.stringify(Mn.value))throw qt.storeEncryptionInvalid;return[3,5];case 3:return[4,this.set(Mn)];case 4:return n.sent(),[7];case 5:return[2]}}))}))},e.prototype.getAllKeys=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){return[2,Object.keys(Pn[this.dbname]).filter((function(e){return e!==Mn.key}))]}))}))},e.prototype.get=function(e){return L(this,void 0,void 0,(function(){var t,n;return P(this,(function(r){switch(r.label){case 0:return[4,Jt(this.delay)];case 1:if(r.sent(),t=this.observer[e],n=t&&t.get?t.get(e):null)throw n;return[2,Pn[this.dbname][e]?this._encryption.decrypt(Pn[this.dbname][e]):null]}}))}))},e.prototype.set=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s;return P(this,(function(o){switch(o.label){case 0:return[4,Jt(this.delay)];case 1:if(o.sent(),t=e.key,n=e.value,r=this.observer[t],i=r&&r.set?r.set(t):null)throw i;if(a=this._encryption.encrypt(n),s=JSON.stringify(a),t===Mn.key||s.length<this.itemSizeLimit)return Pn[this.dbname][t]=a,[2,Pn[this.dbname][t]];throw qt.storeItemSizeExceeded}}))}))},e.prototype.setMany=function(e){return L(this,void 0,void 0,(function(){var t,n=this;return P(this,(function(r){switch(r.label){case 0:return[4,Jt(this.delay)];case 1:return r.sent(),t=[],e.forEach((function(e){var r=e.key,i=e.value,a=n.observer[r];if(a&&a.set&&a.set(r))t.push(qt.collectionWriteFailed);else{var s=n._encryption.encrypt(i),o=JSON.stringify(s);r===Mn.key||o.length<n.itemSizeLimit?(Pn[n.dbname][r]=s,t.push(i)):t.push(qt.storeItemSizeExceeded)}})),[2,t]}}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){var t,n;return P(this,(function(r){switch(r.label){case 0:return[4,Jt(this.delay)];case 1:if(r.sent(),t=this.observer[e],n=t&&t.remove?t.remove(e):null)throw n;return Pn[this.dbname][e]&&delete Pn[this.dbname][e],[2,e]}}))}))},e.prototype.removeMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a;return P(this,(function(s){switch(s.label){case 0:return[4,Jt(this.delay)];case 1:for(s.sent(),t=0,n=e;t<n.length;t++){if(r=n[t],i=this.observer[r],a=i&&i.remove?i.remove(r):null)throw a;Pn[this.dbname][r]&&delete Pn[this.dbname][r]}return[2,e]}}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return[4,Jt(this.delay)];case 1:return e.sent(),Pn[this.dbname]={},[2]}}))}))},e}(),xn="NestDBStore",Fn=function(){function e(e){void 0===e&&(e={}),this.itemSizeLimit=104857600;var t=e.encryption,n=void 0===t?Ln:t;this._window="undefined"!=typeof window?window:null,this._indexedDB=this._window?this._window.indexedDB||this._window.mozIndexedDB||this._window.webkitIndexedDB||this._window.msIndexedDB:null,this._encryption=n}return e.prototype.init=function(e){return L(this,void 0,void 0,(function(){var t,n,r=this;return P(this,(function(i){switch(i.label){case 0:return this.dbname=e,[4,new Promise((function(e,t){if(r._window&&Sn)if(Nn){var n=r._indexedDB.open("_testMozilla");n.onerror=function(){return t(qt.storeNotAvailableInPrivateBrowsing)},n.onsuccess=function(){return e()}}else Tn?r._window.indexedDB||!r._window.PointerEvent&&!r._window.MSPointerEvent||t(qt.storeNotAvailableInPrivateBrowsing):e();else t(qt.storeNotAvailable)}))];case 1:return i.sent(),t=this,[4,new Promise((function(t,n){var i=r._indexedDB.open(e);i.addEventListener("upgradeneeded",(function(e){e.target.result.createObjectStore(xn,{keyPath:"key"})})),i.addEventListener("success",(function(e){return t(e.target.result)})),i.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 2:t._database=i.sent(),i.label=3;case 3:return i.trys.push([3,,5,7]),[4,this.get(Mn.key)];case 4:if((n=i.sent())&&JSON.stringify(n)!==JSON.stringify(Mn.value))throw qt.storeEncryptionInvalid;return[3,7];case 5:return[4,this.set(Mn)];case 6:return i.sent(),[7];case 7:return[2]}}))}))},e.prototype.getAllKeys=function(){return L(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,n){var r=e._database.transaction(xn,"readonly").objectStore(xn).getAllKeys();r.addEventListener("success",(function(e){t(e.target.result.filter((function(e){return e!==Mn.key})))})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 1:return[2,t.sent()]}}))}))},e.prototype.get=function(e){return L(this,void 0,void 0,(function(){var t=this;return P(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n,r){var i=t._database.transaction(xn,"readonly").objectStore(xn).get(e);i.addEventListener("success",(function(e){return n(e.target.result?t._encryption.decrypt(e.target.result.value):null)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 1:return[2,n.sent()]}}))}))},e.prototype.set=function(e){return L(this,void 0,void 0,(function(){var t,n,r=this;return P(this,(function(i){switch(i.label){case 0:return t=e.key,n=e.value,[4,new Promise((function(e,i){var a=r._database.transaction(xn,"readwrite").objectStore(xn).put({key:t,value:r._encryption.encrypt(n)});a.addEventListener("success",(function(t){e(t.target.result)})),a.addEventListener("error",(function(e){return i(e.target.error)}))}))];case 1:return i.sent(),[2,n]}}))}))},e.prototype.setMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r=this;return P(this,(function(i){switch(i.label){case 0:return t=[],n=this._database.transaction(xn,"readwrite").objectStore(xn),e.forEach((function(e){var i=e.key,a=e.value;t.push(new Promise((function(e){var t=n.put({key:i,value:r._encryption.encrypt(a)});t.addEventListener("success",(function(t){e(t.target.result)})),t.addEventListener("error",(function(){e(qt.collectionWriteFailed)}))})))})),[4,Promise.all(t)];case 1:return i.sent(),[2,e.map((function(e){return e.value}))]}}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){var t=this;return P(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n,r){var i=t._database.transaction(xn,"readwrite").objectStore(xn).delete(e);i.addEventListener("success",(function(){return n(e)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 1:return[2,n.sent()]}}))}))},e.prototype.removeMany=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return t=this._database.transaction(xn,"readwrite").objectStore(xn),[4,Promise.all(e.map((function(e){return new Promise((function(n,r){var i=t.delete(e);i.addEventListener("success",(function(){return n(e)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){var e=this;return P(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,n){var r=e._database.transaction(xn,"readwrite").objectStore(xn).clear();r.addEventListener("success",(function(){return t()})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 1:return[2,t.sent()]}}))}))},e}(),Hn=function(){function e(e){var t=e.AsyncStorage,n=e.encryption,r=void 0===n?Ln:n;this.itemSizeLimit=6291456,this._asyncStorage=t,this._encryption=r}return e.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},e.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},e.prototype.init=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:this.dbname=e,n.label=1;case 1:return n.trys.push([1,,3,5]),[4,this.get(Mn.key)];case 2:if((t=n.sent())&&JSON.stringify(t)!==JSON.stringify(Mn.value))throw qt.storeEncryptionInvalid;return[3,5];case 3:return[4,this.set(Mn)];case 4:return n.sent(),[7];case 5:return[2]}}))}))},e.prototype.getAllKeys=function(){return L(this,void 0,void 0,(function(){var e,t=this;return P(this,(function(n){switch(n.label){case 0:return e=this._getActualKey(Mn.key),[4,this._asyncStorage.getAllKeys()];case 1:return[2,n.sent().filter((function(n){return t._isBelonging(n)&&n!==e})).map((function(e){return e.substring("".concat(t.dbname,"/").length)}))]}}))}))},e.prototype.get=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(t=n.sent())?this._encryption.decrypt(JSON.parse(t)):null]}}))}))},e.prototype.set=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:return t=e.key,n=e.value,r=JSON.stringify(this._encryption.encrypt(n)),t===Mn.key||r.length<this.itemSizeLimit?[4,this._asyncStorage.setItem(this._getActualKey(t),r)]:[3,2];case 1:return i.sent(),[2,JSON.parse(r)];case 2:throw qt.storeItemSizeExceeded}}))}))},e.prototype.setMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return P(this,(function(l){switch(l.label){case 0:t=[],n=0,r=e,l.label=1;case 1:if(!(n<r.length))return[3,8];i=r[n],l.label=2;case 2:return l.trys.push([2,6,,7]),a=i.key,s=i.value,o=JSON.stringify(this._encryption.encrypt(s)),a===Mn.key||o.length<this.itemSizeLimit?[4,this._asyncStorage.setItem(this._getActualKey(a),o)]:[3,4];case 3:return l.sent(),t.push(s),[3,5];case 4:t.push(qt.storeItemSizeExceeded),l.label=5;case 5:return[3,7];case 6:return l.sent(),t.push(qt.collectionWriteFailed),[3,7];case 7:return n++,[3,1];case 8:return[2,t]}}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,this._asyncStorage.removeItem(this._getActualKey(e))];case 1:return t.sent(),[2,e]}}))}))},e.prototype.removeMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){switch(i.label){case 0:t=0,n=e,i.label=1;case 1:return t<n.length?(r=n[t],[4,this._asyncStorage.removeItem(this._getActualKey(r))]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[4,this.remove(Mn.key)];case 3:return t.sent(),[2]}}))}))},e}(),Gn=function(){function e(e){var t=e.MMKV,n=e.encryption,r=void 0===n?Ln:n;this.itemSizeLimit=6291456,this._mmkv=t,this._encryption=r}return e.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},e.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},e.prototype.init=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:this.dbname=e,n.label=1;case 1:return n.trys.push([1,,3,5]),[4,this.get(Mn.key)];case 2:if((t=n.sent())&&JSON.stringify(t)!==JSON.stringify(Mn.value))throw qt.storeEncryptionInvalid;return[3,5];case 3:return[4,this.set(Mn)];case 4:return n.sent(),[7];case 5:return[2]}}))}))},e.prototype.getAllKeys=function(){return L(this,void 0,void 0,(function(){var e,t=this;return P(this,(function(n){return e=this._getActualKey(Mn.key),[2,this._mmkv.getAllKeys().filter((function(n){return t._isBelonging(n)&&n!==e})).map((function(e){return e.substr("".concat(t.dbname,"/").length)}))]}))}))},e.prototype.get=function(e){return L(this,void 0,void 0,(function(){var t;return P(this,(function(n){switch(n.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(t=n.sent())?this._encryption.decrypt(JSON.parse(t)):null]}}))}))},e.prototype.set=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){if(t=e.key,n=e.value,r=JSON.stringify(this._encryption.encrypt(n)),t===Mn.key||r.length<this.itemSizeLimit)return this._mmkv.set(this._getActualKey(t),r),[2,JSON.parse(r)];throw qt.storeItemSizeExceeded}))}))},e.prototype.setMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return P(this,(function(l){for(t=[],n=0,r=e;n<r.length;n++){i=r[n];try{a=i.key,s=i.value,o=JSON.stringify(this._encryption.encrypt(s)),a===Mn.key||o.length<this.itemSizeLimit?(this._mmkv.set(this._getActualKey(a),o),t.push(s)):t.push(qt.storeItemSizeExceeded)}catch(e){t.push(qt.collectionWriteFailed)}}return[2,t]}))}))},e.prototype.remove=function(e){return L(this,void 0,void 0,(function(){return P(this,(function(t){return this._mmkv.delete(this._getActualKey(e)),[2,e]}))}))},e.prototype.removeMany=function(e){return L(this,void 0,void 0,(function(){var t,n,r;return P(this,(function(i){for(t=0,n=e;t<n.length;t++)r=n[t],this._mmkv.delete(this._getActualKey(r));return[2,e]}))}))},e.prototype.clear=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[4,this.remove(Mn.key)];case 3:return t.sent(),[2]}}))}))},e}(),jn="[NESTDB]",zn=!0,Bn=function(){function e(){}return e.off=function(){zn=!1},e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];zn&&console.log.apply(console,D(["".concat(jn,"[LOG]")],e,!1))},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];zn&&console.warn.apply(console,D(["".concat(jn,"[WARNING]")],e,!1))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];zn&&console.error.apply(console,D(["".concat(jn,"[ERROR]")],e,!1))},e}();!function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED"}(wn||(wn={}));var Vn,qn,Kn,Qn,Yn,Wn,Jn,$n=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=wn.INIT,this._config=i||new Bt({dbname:t}),this._store=r,this._event={success:Xt,error:Xt,upgrade:tn},this._collections=new Map,this._globalMutex=new Un("".concat(this.name,".lock")),this._config.disableLogger&&Bn.off(),new _n({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.commitSchema=function(e){return L(this,void 0,void 0,(function(){var t=this;return P(this,(function(n){switch(n.label){case 0:return this._state!==wn.OPENING?[3,2]:[4,Promise.all(e.map((function(e){return L(t,void 0,void 0,(function(){var t,n,r,i;return P(this,(function(a){switch(a.label){case 0:return t=e.collectionName,n=e.keyName,r=e.index,i=void 0===r?[]:r,this._collections.has(t)||this._collections.set(t,new Rn({dbname:this.name,collectionName:t,keyName:n,keyHash:e.keyHash||null,indexes:i,store:this._store})),[4,this._collections.get(t).init()];case 1:return a.sent(),[2]}}))}))})))];case 1:return n.sent(),[3,3];case 2:throw qt.databaseSchemaNotOnUpgrade;case 3:return[2]}}))}))},e.prototype.open=function(){var e;return L(this,void 0,void 0,(function(){var t,n,r,i,a=this;return P(this,(function(s){switch(s.label){case 0:return[4,this._globalMutex.lock()];case 1:if(s.sent(),this._state===wn.OPENED)return[3,15];this._state=wn.OPENING,s.label=2;case 2:return s.trys.push([2,5,,15]),[4,this._store.init(this.name)];case 3:return s.sent(),o=this.name,t="".concat(un(o),".metadata"),n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:return r=null!==(e=s.sent())&&void 0!==e?e:n,[2,new Promise((function(e,n){var i=function(e){r.version<a._version?a._event.upgrade(r.version,(function(n){return L(a,void 0,void 0,(function(){var i;return P(this,(function(a){switch(a.label){case 0:if(n)return[3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r,generation:this._version})];case 2:return a.sent(),e({continued:!0}),[3,4];case 3:return i=a.sent(),e({continued:!1,err:i}),[3,4];case 4:return[3,6];case 5:e({continued:!1,err:n}),a.label=6;case 6:return[2]}}))}))})):e({continued:!1})},s=function(t){var o=t.continued,l=void 0!==o&&o,u=t.err,c=void 0===u?null:u;if(l)setTimeout((function(){return i(s)}),10);else if(c)Bn.error(c.message),a._globalMutex.unlock(),a._event.error(c),n(c);else{var d=[];r.collectionNames.forEach((function(e){a._collections.has(e)||d.push(L(a,void 0,void 0,(function(){var t,n;return P(this,(function(r){switch(r.label){case 0:return[4,Rn.metadataOf(this.name,e,this._store)];case 1:return(t=r.sent())?(n=new Rn({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:t.indexes,store:this._store}),this._collections.set(e,n),[4,n.init()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))})))})),Promise.all(d).then((function(){a._state=wn.OPENED,a._globalMutex.unlock(),a._event.success(),e()})).catch((function(e){Bn.error(e.message),a._globalMutex.unlock(),a._event.error(e),n(e)}))}};i(s)}))];case 5:switch((i=s.sent()).code){case jt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,6];case jt.STORE_NOT_AVAILABLE:return[3,8];case jt.STORE_ENCRYPTION_INVALID:return[3,10]}return[3,13];case 6:return Bn.warning("Access to the local storage is not allowed in private browsing. Switched to MemoryStore automatically."),this._store=new Dn({}),this._globalMutex.unlock(),this._event.error(i),[4,this.open()];case 7:return s.sent(),[3,14];case 8:return Bn.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new Dn({}),this._globalMutex.unlock(),this._event.error(i),[4,this.open()];case 9:return s.sent(),[3,14];case 10:return Bn.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this._store.clear()];case 11:return s.sent(),this._globalMutex.unlock(),this._event.error(i),[4,this.open()];case 12:return s.sent(),[3,14];case 13:throw Bn.error(i.message),this._globalMutex.unlock(),this._event.error(i),i;case 14:return[3,15];case 15:return[2]}var o}))}))},e.prototype.close=function(){this._state=wn.CLOSED,this._collections.forEach((function(e){return e.close()}))},e.prototype.reset=function(){return L(this,void 0,void 0,(function(){var e,t=this;return P(this,(function(n){switch(n.label){case 0:return(e=_n.get(this.name))&&e.clearByCondition((function(e){return e.key.startsWith(un(t.name))})),[4,this._store.clear()];case 1:return n.sent(),[2]}}))}))},e.prototype.on=function(e,t){this._event[e]=t},e.prototype.off=function(e){"function"==typeof this._event[e]&&(this._event[e]="upgrade"===e?tn:Xt)},e.prototype.collection=function(e){return this._collections.get(e)||null},e}(),Xn=function(){function e(){}return e.create=function(){return"".concat(Math.floor(1e5*Math.random()),"-").concat((new Date).getTime())},e}();!function(e){e.AND="AND",e.OR="OR"}(Vn||(Vn={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(qn||(qn={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Kn||(Kn={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper"}(Qn||(Qn={})),function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"}(Yn||(Yn={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(Wn||(Wn={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Jn||(Jn={}));var Zn=function(){function e(){this._iid=null,this._searchFilter={},this._userIdsFilter={userIds:[],includeMode:!0,queryType:Vn.AND},this.includeEmpty=!1,this.nicknameContainsFilter="",this.nicknameStartsWithFilter="",this.nicknameExactMatchFilter="",this.channelNameContainsFilter="",this.memberStateFilter=Kn.ALL,this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=Qn.ALL,this.publicChannelFilter=Yn.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Wn.ALL,this.hiddenChannelFilter=Jn.UNHIDDEN,this.includeFrozen=!0}return Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype._isFriend=function(e){return!!e.friendDiscoveryKey||!!e.friendName},Object.defineProperty(e.prototype,"iid",{set:function(e){this._iid=e},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={searchQuery:t,searchFields:e})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=Vn.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n}},e.prototype.clone=function(){var t=new e;t.setSearchFilter(this.searchFilter.searchFields,this.searchFilter.searchQuery),t.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){var t=this._searchFilter,n=t.searchQuery,r=t.searchFields;if(n&&r&&r.length>0&&!r.some((function(t){switch(t){case qn.CHANNEL_NAME:return e.name.toLowerCase().includes(n.toLowerCase());case qn.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(n.toLowerCase())}));default:return!0}})))return!1;var i=this._userIdsFilter,a=i.includeMode,s=i.queryType,o=i.userIds,l=O.get(this._iid).get("currentUserId"),u=e.members.map((function(e){return e.userId}));if(a){if(o.length>0)switch(s){case Vn.AND:if(o.some((function(e){return!u.includes(e)})))return!1;break;case Vn.OR:if(o.every((function(e){return!u.includes(e)})))return!1}}else{if(o.includes(l)||o.push(l),e.members.length>o.length)return!1;if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=D([],e,!0).sort(),r=D([],t,!0).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(o,u))return!1}if(!this.includeEmpty&&!e.lastMessage)return!1;if(!this.includeFrozen&&e.isFrozen)return!1;if(this.customTypesFilter.length>0&&!this.customTypesFilter.includes(e.customType))return!1;if(this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType))return!1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var c=this.nicknameContainsFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==l&&e.nickname.toLowerCase().includes(c)})))return!1}if(this.nicknameStartsWithFilter){var d=this.nicknameStartsWithFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==l&&e.nickname.toLowerCase().startsWith(d)})))return!1}if(this.nicknameExactMatchFilter){var h=this.nicknameExactMatchFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==l&&e.nickname.toLowerCase()!==h})))return!1}if(this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return!1;if(this.memberStateFilter)switch(this.memberStateFilter){case Kn.JOINED:if("joined"!==e.myMemberState)return!1;break;case Kn.INVITED:if("invited"!==e.myMemberState)return!1;break;case Kn.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return!1;break;case Kn.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case Jn.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return!1;break;case Jn.HIDDEN:if(!e.isHidden)return!1;break;case Jn.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return!1;break;case Jn.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Wn.UNREAD_MESSAGE&&0===e.unreadMessageCount)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case Yn.PUBLIC:if(!e.isPublic||"none"===e.myMemberState)return!1;break;case Yn.PRIVATE:if(e.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case Qn.SUPER:if(!e.isSuper)return!1;break;case Qn.NON_SUPER:if(e.isSuper)return!1}return!0},e.QueryType=Vn,e.SearchField=qn,e.MemberStateFilter=Kn,e.SuperChannelFilter=Qn,e.PublicChannelFilter=Yn,e.UnreadChannelFilter=Wn,e.HiddenChannelFilter=Jn,e}(),er=function(){function e(e){var t=e.iid;this._iid=t,this._filter=new Zn,this._filter.iid=this._iid,this._order=Le.LATEST_LAST_MESSAGE,this._limit=20}return e.prototype.setFilter=function(e){return this._filter=e.clone(),this._filter.iid=this._iid,this},e.prototype.setOrder=function(e){return this._order=e,this},e.prototype.setLimit=function(e){return this._limit=e,this},e.prototype.build=function(){return new Xe({iid:this._iid,filter:this._filter,order:this._order,limit:this._limit})},e}(),tr=function(){function e(e){var t=e.iid,n=e.channel;this._iid=t,this._channel=n,this._startingPoint=Date.now(),this._filter=new tt,this._limit=100}return e.prototype.setFilter=function(e){return this._filter=e.clone(),this},e.prototype.setStartingPoint=function(e){return this._startingPoint=e,this},e.prototype.setLimit=function(e){return this._limit=e,this},e.prototype.build=function(){return new wt({iid:this._iid,channel:this._channel,startingPoint:this._startingPoint,filter:this._filter,limit:this._limit})},e}(),nr={},rr={},ir=new WeakMap,ar=new WeakMap,sr=new WeakMap,or=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).channelType=Mt.CHANNEL_TYPE_GROUP,r.isDistinct=!1,r.isSuper=!1,r.isBroadcast=!1,r.isPublic=!1,r.unreadMessageCount=0,r.inviter=null,r.members=[],r.memberMap={},r.lastMessage=null,r.memberCount=0,r.joinedMemberCount=0,r.cachedReadReceiptStatus={},r.cachedDeliveryReceiptStatus=null,r.myPushTriggerOption=n.PushTriggerOption.DEFAULT,r.isPushEnabled,r.isHidden=!1,r.hiddenState=n.HiddenState.UNHIDDEN,r.isDiscoverable=!0,r.myLastRead=0,r.messageSurvivalSeconds=-1,r.invitedAt=0,r.joinedAt=0,r._messageOffsetTimestamp=0,r._cachedLastDeliveredReceipt={sentAt:0,timeout:null},ir.set(_(r),{}),ar.set(_(r),{start:0,end:0}),sr.set(_(r),0),e&&r._update(e),r}return f(n,[{key:"messageOffsetTimestamp",get:function(){return this._messageOffsetTimestamp}},{key:"createMessageCollection",value:function(){return new tr({iid:this._iid,channel:this})}},{key:"_setGroupChannelUnreadCount",value:function(e,t){try{if("number"==typeof e&&e>=0)if("all"===this.myCountPreference||"unread_message_count_only"===this.myCountPreference)if(this.isSuper||this.isBroadcast){var n=O.get(this._iid).container.maxUnreadCountOfSuperGroupChannel;this.unreadMessageCount=e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&("all"===this.myCountPreference||"unread_mention_count_only"===this.myCountPreference?this.unreadMentionCount=t:this.unreadMentionCount=0)}catch(e){}}},{key:"_update",value:function(e){var t=this,n=j.get(this._iid),r=n.BaseChannel,i=n.GroupChannel,a=n.User,s=n.Member;if(this.isAccessCodeRequired=!!e.is_access_code_required&&e.is_access_code_required,this.isDistinct=!!e.is_distinct&&e.is_distinct,this.isPushEnabled=!!e.is_push_enabled&&e.is_push_enabled,this.isHidden=!!e.hasOwnProperty("is_hidden")&&e.is_hidden,this.myPushTriggerOption=e.push_trigger_option?e.push_trigger_option:i.PushTriggerOption.DEFAULT,this.myCountPreference=e.hasOwnProperty("count_preference")?e.count_preference:i.CountPreference.ALL,this.unreadMessageCount=0,this.unreadMentionCount=0,this._setGroupChannelUnreadCount(parseInt(e.unread_message_count),parseInt(e.unread_mention_count)),e.hasOwnProperty("read_receipt")&&(this.cachedReadReceiptStatus={},Object.keys(e.read_receipt).forEach((function(n){var r=e.read_receipt[n];t.updateReadReceipt(n,parseInt(r))}))),e.hasOwnProperty("delivery_receipt")&&"object"===c(e.delivery_receipt)&&null!==e.delivery_receipt&&(this.cachedDeliveryReceiptStatus||(this.cachedDeliveryReceiptStatus={}),Object.keys(e.delivery_receipt).forEach((function(n){var r=e.delivery_receipt[n];t.updateDeliveryReceipt(n,parseInt(r))}))),e.hasOwnProperty("user_last_read")&&"number"==typeof e.user_last_read?this.myLastRead=e.user_last_read:this.myLastRead=0,e.hasOwnProperty("members")){this.members=[],this.memberMap={};for(var o=0;o<e.members.length;o++){var l=new s(e.members[o]);this.members.push(l),this.memberMap[l.userId]=l}}this.myMemberState=e.member_state||"none",this.myRole=e.my_role||i.Role.NONE,e.hasOwnProperty("is_muted")?"string"==typeof e.is_muted?this.myMutedState=e.is_muted:"boolean"==typeof e.is_muted?this.myMutedState=e.is_muted?"muted":"unmuted":this.myMutedState="unmuted":this.myMutedState="unmuted",e.hasOwnProperty("member_count")&&(this.memberCount=parseInt(e.member_count)),e.hasOwnProperty("joined_member_count")&&(this.joinedMemberCount=parseInt(e.joined_member_count)),e.hasOwnProperty("last_message")&&"object"===c(e.last_message)&&e.last_message?e.last_message instanceof pt?this.lastMessage=e.last_message:this.lastMessage=r.buildMessage(e.last_message,this):this.lastMessage=null,e.hasOwnProperty("inviter")&&null!==e.inviter&&"object"===c(e.inviter)&&Object.keys(e.inviter).length>0?this.inviter=new a(e.inviter):this.inviter=null,this.invitedAt=e.invited_at||0,this.joinedAt=e.joined_ts||0,e.hasOwnProperty("is_super")&&"boolean"==typeof e.is_super?this.isSuper=e.is_super:this.isSuper=!1,e.hasOwnProperty("is_broadcast")&&"boolean"==typeof e.is_broadcast?this.isBroadcast=e.is_broadcast:this.isBroadcast=!1,e.hasOwnProperty("is_public")&&"boolean"==typeof e.is_public?this.isPublic=e.is_public:this.isPublic=!1,e.hasOwnProperty("hidden_state")?this.hiddenState=e.hidden_state:this.hiddenState=i.HiddenState.UNHIDDEN,e.hasOwnProperty("is_discoverable")&&"boolean"==typeof e.is_discoverable?this.isDiscoverable=e.is_discoverable:this.isDiscoverable=this.isPublic,e.hasOwnProperty("ts_message_offset")&&(this._messageOffsetTimestamp=e.ts_message_offset),e.hasOwnProperty("message_survival_seconds")&&"number"==typeof e.message_survival_seconds&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"addMember",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.isSuper&&!this.isBroadcast){var n=j.get(this._iid).Member,r=this.removeMember(e);r&&r.state===n.JOINED&&(e.state=n.JOINED),this.memberMap[e.userId]=e,this.members.push(e),this.memberCount++,this.updateReadReceipt(e.userId,t),this.updateDeliveryReceipt(e.userId,t)}}},{key:"removeMember",value:function(e){var t=null;if(!this.isSuper&&!this.isBroadcast&&this.memberMap.hasOwnProperty(e.userId)){delete this.memberMap[e.userId];for(var n=0;n<this.members.length;n++){var r=this.members[n];if(r.userId===e.userId){t=r,this.members.splice(n,1);break}}this.memberCount--}return t}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"isIdentical",value:function(e){return e&&this.url===e.url}},{key:"isEqual",value:function(e){return se.deepEqual(this,e)}},{key:"createMemberListQuery",value:function(){return new(0,j.get(this._iid).MemberListQuery)(this.url)}},{key:"createBannedUserListQuery",value:function(){return new(0,j.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:this.isOpenChannel()})}},{key:"refresh",value:function(e){return j.get(this._iid).GroupChannel.getChannelWithoutCache(this.url,e)}},{key:"updateChannel",value:function(){var e=this,t=ve.toArray(arguments),n=void 0;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r.channelUrl=e.url,r._validate()?O.get(e._iid).container.apiClient.updateGroupChannel(u(u({},r),{},{operatorUserIds:r.operatorUserIds}),(function(e,t){var r=null;e||(r=i.upsert(t)),n(e,r)})):n(ve.error,null)}),n);if(3===t.length){var s=new a;return s.channelUrl=this.url,s.name=t[0],"string"==typeof t[1]?s.coverUrl=t[1]:s.coverImage=t[1],s.data=t[2],n?this.updateChannel(s,n):this.updateChannel(s)}if(4===t.length){var o=new a;return o.channelUrl=this.url,o.isDistinct=t[0],o.name=t[1],"string"==typeof t[1]?o.coverUrl=t[2]:o.coverImage=t[2],o.data=t[3],n?this.updateChannel(o,n):this.updateChannel(o)}if(5===t.length){var l=new a;return l.channelUrl=this.url,l.isDistinct=t[0],l.name=t[1],"string"==typeof t[2]?l.coverUrl=t[2]:l.coverImage=t[2],l.data=t[3],l.customType=t[4],n?this.updateChannel(l,n):this.updateChannel(l)}return le(this._iid,(function(e){return e(ve.error,null)}),n)}},{key:"invite",value:function(e,t){var n=null,r=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.length>0&&e.every((function(e){return!!e.userId&&"string"==typeof e.userId}))}}),new ve({type:"callback"})]),i=S(r,3);return n=i[0],e=i[1],t=i[2],n?le(this._iid,(function(e){return e(ve.error,null)}),t):this.inviteWithUserIds(e.map((function(e){return e.userId})),t)}},{key:"inviteWithUserIds",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.inviteToGroupChannel({channelUrl:n.url,userIds:e},(function(e,r){var i=null;e||(i=j.get(n._iid).GroupChannel.upsert(r)),t(e,i)}))}),t)}},{key:"acceptInvitation",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string",optional:!0,defaultValue:null}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.acceptInvitation({channelUrl:n.url,accessCode:e},(function(e,r){var i=null;e||((i=j.get(n._iid).GroupChannel.upsert(r)).myMemberState="joined"),t(e,i)}))}),t)}},{key:"declineInvitation",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.declineInvitation({channelUrl:t.url},(function(n,r){var i=null;if(!n){var a=j.get(t._iid).GroupChannel;(i=a.upsert(r)).myMemberState="none",t.isPublic||a.removeCachedChannel(t.url)}e(n,i)}))}),e)}},{key:"join",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string",optional:!0,defaultValue:null}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.joinGroupChannel({channelUrl:n.url,accessCode:e},(function(e,r){var i=null;e||((i=j.get(n._iid).GroupChannel.upsert(r)).myMemberState="joined"),t(e,i)}))}),t)}},{key:"leave",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.leaveGroupChannel({channelUrl:t.url},(function(t,n){return e(t,null)}))}),e)}},{key:"muteUser",value:function(e,t,n,r){return this.muteUserWithUserId(e?e.userId:null,t,n,r)}},{key:"muteUserWithUserId",value:function(e,t,n,r){var i=this,a=null,s=ve.parse(arguments,[new ve({type:"string"}),new ve({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ve({type:"string",optional:!0,defaultValue:""}),new ve({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):O.get(i._iid).container.apiClient.muteUser({channelUrl:i.url,userId:e,description:n,seconds:t,isGroupChannel:!0},(function(e,t){r(e,null)}))}),r)}},{key:"unmuteUser",value:function(e,t){return this.unmuteUserWithUserId(e?e.userId:null,t)}},{key:"unmuteUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.unmuteUser({channelUrl:n.url,userId:e,isGroupChannel:!0},(function(e,n){t(e,null)}))}),t)}},{key:"banUser",value:function(e,t,n,r){return this.banUserWithUserId(e?e.userId:null,t,n,r)}},{key:"banUserWithUserId",value:function(e,t,n,r){var i=this,a=null,s=ve.parse(arguments,[new ve({type:"string"}),new ve({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ve({type:"string"}),new ve({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):O.get(i._iid).container.apiClient.banUser({channelUrl:i.url,userId:e,description:n,seconds:t,isGroupChannel:!0},(function(e,t){r(e,null)}))}),r)}},{key:"unbanUser",value:function(e,t){return this.unbanUserWithUserId(e?e.userId:null,t)}},{key:"unbanUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.unbanUser({channelUrl:n.url,userId:e,isGroupChannel:!0},(function(e,n){t(e,null)}))}),t)}},{key:"updateJoinedMemberCount",value:function(){if(!this.isSuper&&!this.isBroadcast){var e=j.get(this._iid).Member;this.joinedMemberCount=this.members.filter((function(t){return t.state===e.JOINED})).length}}},{key:"setLatestMemberCount",value:function(e,t,n){var r=!1;return"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&n>=sr.get(this)&&(sr.set(this,n),r=t!==this.joinedMemberCount||e!==this.memberCount,this.memberCount=e,this.joinedMemberCount=t),r}},{key:"hide",value:function(e,t,n){var r=this,i=null,a=S(ve.parse(arguments,[new ve({type:"boolean",optional:!0,defaultValue:!1}),new ve({type:"boolean",optional:!0,defaultValue:!0}),new ve({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){i?n(i,null):O.get(r._iid).container.apiClient.hideGroupChannel({channelUrl:r.url,hidePreviousMessages:e,allowAutoUnhide:t},(function(i,a){if(!i){var s=j.get(r._iid).GroupChannel;r.isHidden=!0,r.hiddenState=t?s.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:s.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE,e&&r._setGroupChannelUnreadCount(0,0),a.hasOwnProperty("ts_message_offset")&&(r._messageOffsetTimestamp=a.ts_message_offset),s.cachedChannels[r.url]=r}n(i,a)}))}),n)}},{key:"unhide",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.unhideGroupChannel({channelUrl:t.url},(function(n,r){if(!n){var i=j.get(t._iid).GroupChannel;t.isHidden=!1,t.hiddenState=i.HiddenState.UNHIDDEN,i.cachedChannels[t.url]=t}e(n,r)}))}),e)}},{key:"freeze",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.freeze({channelUrl:t.url,isGroupChannel:!0,freezing:!0},(function(n,r){if(!n){var i=j.get(t._iid).GroupChannel;t.isFrozen=!0,i.cachedChannels[t.url]=t}e(n,null)}))}),e)}},{key:"unfreeze",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.freeze({channelUrl:t.url,isGroupChannel:!0,freezing:!1},(function(n,r){if(!n){var i=j.get(t._iid).GroupChannel;t.isFrozen=!1,i.cachedChannels[t.url]=t}e(n,null)}))}),e)}},{key:"delete",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.deleteGroupChannel({channelUrl:t.url},(function(n,r){n||j.get(t._iid).GroupChannel.removeCachedChannel(t.url),e(n,r)}))}),e)}},{key:"markAsRead",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid).Command,r=Pi.getInstance(t._iid),i=n.bRead({channelUrl:t.url});r.sendCommand(i,(function(n,i){if(r.getErrorFirstCallback()){var a=[n,i];i=a[0],n=a[1]}if(i)e(i,null);else if(r.currentUser){var s=et.of(t._iid),o=me.of(t._iid);t.updateReadReceipt(r.currentUser.userId,n.getJsonElement().ts);var l=!1;(t.unreadMessageCount>0||t.unreadMentionCount>0)&&(t._setGroupChannelUnreadCount(0,0),Object.keys(r.channelHandlers).forEach((function(e){r.channelHandlers[e].onChannelChanged(t)})),l=!0),e(null,null),s.upsert([t]).then((function(){l&&o.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}}),o.send({source:he.EVENT_READ_RECEIPT_UPDATED,payload:{channel:t}})})).catch((function(e){return $.error(e)}))}else{var u=new SendBirdException("Connection should be made first.",SendBirdException.CONNECTION_REQUIRED);e(u,null)}}))}),e)}},{key:"getUnreadMemberCount",value:function(e){var t=O.get(this._iid),n=j.get(this._iid).Member,r=t.container.currentUserId;if(e instanceof pt&&!e.isAdminMessage()&&r&&!this.isSuper&&!this.isBroadcast){for(var i=0,a=e.createdAt,s=this.members,o=0;o<s.length;o++){var l=s[o];r===l.userId||l.state!==n.JOINED||e.sender&&e.sender.userId===l.userId||(this.cachedReadReceiptStatus[l.userId]||0)<a&&i++}return i}return 0}},{key:"getReadReceipt",value:function(e){return this.getUnreadMemberCount(e)}},{key:"markAsDelivered",value:function(){var e=this,t=Pi.getInstance(this._iid),n=t.currentUser?t.currentUser.userId:null;O.get(this._iid).container.apiClient.markAsDelivered({channelUrl:this.url,userId:n},(function(t,r){if(t)$.debug(t);else{var i=r.hasOwnProperty("ts")?r.ts:0;e.updateDeliveryReceipt(n,i)}}))}},{key:"getUndeliveredMemberCount",value:function(e){var t=O.get(this._iid),n=j.get(this._iid).Member,r=t.container.currentUserId;if(this.cachedDeliveryReceiptStatus&&e instanceof pt&&!e.isAdminMessage()&&r&&!this.isSuper&&!this.isBroadcast){var i,a=e.createdAt,s=0,o=T(this.members);try{for(o.s();!(i=o.n()).done;){var l=i.value;r===l.userId||l.state!==n.JOINED||e.sender&&e.sender.userId===l.userId||this.cachedDeliveryReceiptStatus[l.userId]<a&&s++}}catch(e){o.e(e)}finally{o.f()}return s}return 0}},{key:"getDeliveryReceipt",value:function(e){return this.getUndeliveredMemberCount(e)}},{key:"getReadMembers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Pi.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof pt&&!e.isAdminMessage()){for(var r=[],i=0;i<this.members.length;i++){var a=this.members[i];(t||a.userId!==n.currentUser.userId&&a.userId!==e.sender.userId)&&(this.cachedReadReceiptStatus[a.userId]||0)>=e.createdAt&&r.push(a)}return r}return[]}},{key:"getUnreadMembers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Pi.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof pt&&!e.isAdminMessage()){for(var r=[],i=0;i<this.members.length;i++){var a=this.members[i];(t||a.userId!==n.currentUser.userId&&a.userId!==e.sender.userId)&&(this.cachedReadReceiptStatus[a.userId]||0)<e.createdAt&&r.push(a)}return r}return[]}},{key:"getReadStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Pi.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast){for(var r={},i=Object.keys(this.cachedReadReceiptStatus),a=function(a){var s=i[a];if(!t&&s===n.currentUser.userId)return"continue";var o=e.cachedReadReceiptStatus[s],l=e.members.filter((function(e){return e.userId===s}));r[s]={user:l.length>0?l[0]:null,last_seen_at:parseInt(o)}},s=0;s<i.length;s++)a(s);return r}return{}}},{key:"updateReadReceipt",value:function(e,t){var n=this.cachedReadReceiptStatus[e];if(!n||n<t){this.cachedReadReceiptStatus[e]=t;var r=Pi.getInstance(this._iid);r.currentUser&&e===r.currentUser.userId&&(this.myLastRead=t)}}},{key:"updateDeliveryReceipt",value:function(e,t){if(this.cachedDeliveryReceiptStatus)if(this.cachedDeliveryReceiptStatus.hasOwnProperty(e)){var n=this.cachedDeliveryReceiptStatus[e];(!n||n<t)&&(this.cachedDeliveryReceiptStatus[e]=t)}else this.cachedDeliveryReceiptStatus[e]=t}},{key:"startTyping",value:function(){var e=Pi.getInstance(this._iid),t=(new Date).getTime(),n=e.Options.typingIndicatorThrottle;("number"!=typeof n||n<1e3||n>9e3)&&(n=1e3);var r=ar.get(this);if(t-r.start>=n){r.end=0,r.start=t;var i=j.get(this._iid).Command.bTypeStart({channelUrl:this.url,time:r.start});e.sendCommand(i,null)}}},{key:"endTyping",value:function(){var e=Pi.getInstance(this._iid),t=(new Date).getTime(),n=e.Options.typingIndicatorThrottle;("number"!=typeof n||n<1e3||n>9e3)&&(n=1e3);var r=ar.get(this);if(t-r.end>=n){r.start=0,r.end=t;var i=j.get(this._iid).Command.bTypeEnd({channelUrl:this.url,time:r.end});e.sendCommand(i,null)}}},{key:"invalidateTypingStatus",value:function(){var e=ir.get(this),t=(new Date).getTime(),n=!1;return Object.keys(e).forEach((function(r){var i=e[r].ts;t-i>=1e4&&(delete e[r],n=!0)})),n}},{key:"getTypingMembers",value:function(){var e=this,t=ir.get(this),n=[];return Object.keys(t).forEach((function(t){var r=e.memberMap[t];r&&n.push(r)})),n}},{key:"getTypingUsers",value:function(){var e=ir.get(this),t=[];return Object.keys(e).forEach((function(n){var r=e[n].user;t.push(r)})),t}},{key:"updateTypingStatus",value:function(e,t){var n=ir.get(this);t?n[e.userId]={user:e,ts:(new Date).getTime()}:delete n[e.userId]}},{key:"isTyping",value:function(){var e=ir.get(this);return 0!==Object.keys(e).length}},{key:"registerScheduledUserMessage",value:function(e,t){var n=this,r=j.get(this._iid),i=r.ScheduledUserMessage,a=r.ScheduledUserMessageParams,s=null,o=ve.parse(arguments,[new ve({type:a,constraint:function(e){return"string"==typeof e.message&&"string"==typeof e._getScheduleString()}}),new ve({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){s?t(s,null):O.get(n._iid).container.apiClient.registerScheduledUserMessage({groupChannelParams:e,channelUrl:n.url,isOpenChannel:!1},(function(e,r){var a=null;if(!e){a=new i(r);var s=Pi.getInstance(n._iid).currentUser;s&&a._sender&&s.userId===a._sender.userId&&(s.nickname=a._sender.nickname,s.plainProfileUrl=a._sender.plainProfileUrl,s.metaData=a._sender.metaData)}t(e,a)}))}),t)}},{key:"getPushPreference",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getMyPushTriggerOption({channelUrl:t.url},(function(n,r){var i=null;if(!n){try{i=r.enable}catch(e){i=!1}t.isPushEnabled=i}e&&e(n,i)}))}),e)}},{key:"setPushPreference",value:function(e,t){var n=this;return le(this._iid,(function(t){var r=j.get(n._iid).GroupChannel;O.get(n._iid).container.apiClient.setMyPushTriggerOption({channelUrl:n.url,enable:e},(function(e,i){e||(n.isPushEnabled=i.enable,n.isPushEnabled||(n.myPushTriggerOption=r.PushTriggerOption.OFF)),t(e,i)}))}),t)}},{key:"getMyPushTriggerOption",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getMyPushTriggerOption({channelUrl:t.url},(function(r,i){var a=null;if(!r){try{a=i.push_trigger_option||n.PushTriggerOption.DEFAULT}catch(e){$.debug(e)}t.myPushTriggerOption=a}e(r,a)}))}),e)}},{key:"setMyPushTriggerOption",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannel,i=null,a=S(ve.parse(arguments,[new ve({type:r.PushTriggerOption}),new ve({type:"callback"})]),3);return i=a[0],e=a[1],t=a[2],le(this._iid,(function(t){i?t(i,null):O.get(n._iid).container.apiClient.setMyPushTriggerOption({channelUrl:n.url,pushTriggerOption:e},(function(e,r){var i=null;if(!e){try{i=r.push_trigger_option}catch(e){$.debug(e)}n.myPushTriggerOption=i}t(e,i)}))}),t)}},{key:"setMyCountPreference",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannel,i=null,a=S(ve.parse(arguments,[new ve({type:r.CountPreference}),new ve({type:"callback"})]),3);return i=a[0],e=a[1],t=a[2],le(this._iid,(function(t){i?t(i,null):O.get(n._iid).container.apiClient.setMyCountPreference({channelUrl:n.url,countPreference:e},(function(e,i){var a=null;e||(a=n.myCountPreference=i.count_preference,n._setGroupChannelUnreadCount(n.unreadMessageCount,n.unreadMentionCount),r.cachedChannels[n.url]=n),t(e,a)}))}),t)}},{key:"resetMyHistory",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.resetMyHistory({channelUrl:t.url},(function(n,r){if(!n&&r.hasOwnProperty("ts_message_offset")){var i=j.get(t._iid).GroupChannel;t._messageOffsetTimestamp=r.ts_message_offset,i.cachedChannels[t.url]=t}e(n,r)}))}),e)}}],[{key:"MemberStateFilter",get:function(){return{ALL:"all",JOINED:"joined_only",INVITED:"invited_only",INVITED_BY_FRIEND:"invited_by_friend",INVITED_BY_NON_FRIEND:"invited_by_non_friend",LEFT:"left"}}},{key:"PushTriggerOption",get:function(){return{DEFAULT:"default",ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"CountPreference",get:function(){return{ALL:"all",UNREAD_MESSAGE_COUNT_ONLY:"unread_message_count_only",UNREAD_MENTION_COUNT_ONLY:"unread_mention_count_only",OFF:"off"}}},{key:"HiddenState",get:function(){return{UNHIDDEN:"unhidden",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"PublicChannelFilter",get:function(){return{ALL:"all",PUBLIC:"public",PRIVATE:"private"}}},{key:"SuperChannelFilter",get:function(){return{ALL:"all",SUPER:"super",NON_SUPER:"nonsuper",BROADCAST_ONLY:"broadcast_only"}}},{key:"UnreadChannelFilter",get:function(){return{ALL:"all",UNREAD_MESSAGE:"unread_message"}}},{key:"HiddenChannelFilter",get:function(){return{ALL:"all",UNHIDDEN:"unhidden_only",HIDDEN:"hidden_only",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"Role",get:function(){return{OPERATOR:"operator",NONE:"none"}}},{key:"UnreadItemKey",get:function(){return{GROUP_CHANNEL_UNREAD_MENTION_COUNT:"group_channel_unread_mention_count",NONSUPER_UNREAD_MENTION_COUNT:"non_super_group_channel_unread_mention_count",SUPER_UNREAD_MENTION_COUNT:"super_group_channel_unread_mention_count",GROUP_CHANNEL_UNREAD_MESSAGE_COUNT:"group_channel_unread_message_count",NONSUPER_UNREAD_MESSAGE_COUNT:"non_super_group_channel_unread_message_count",SUPER_UNREAD_MESSAGE_COUNT:"super_group_channel_unread_message_count",GROUP_CHANNEL_INVITATION_COUNT:"group_channel_invitation_count",NONSUPER_INVITATION_COUNT:"non_super_group_channel_invitation_count",SUPER_INVITATION_COUNT:"super_group_channel_invitation_count"}}},{key:"cachedChannels",get:function(){return nr[this._iid]||(nr[this._iid]={}),nr[this._iid]}},{key:"createGroupChannelCollection",value:function(){return new er({iid:this._iid})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid),n=t.User,r=t.Member,i=t.GroupChannel,a=t.BaseMessage,s=t.UserMessage,o=t.FileMessage,l=t.AdminMessage,d=dt.deserialize(e),h=function(e){return null!=e&&"object"===c(e)?e.messageType===a.MESSAGE_TYPE_USER?new s(s.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,mentionedUsers:e.mentionedUsers}))):e.messageType===a.MESSAGE_TYPE_FILE?new o(o.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,mentionedUsers:e.mentionedUsers}))):new l(l.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},mentionedUsers:e.mentionedUsers}))):null}(d.lastMessage);return new i({channel_url:d.url,name:d.name,cover_url:d.coverUrl,data:d.data,custom_type:d.customType,invited_at:d.invitedAt,created_at:d.createdAt/1e3,joined_ts:d.joinedAt,is_access_code_required:d.isAccessCodeRequired,is_distinct:d.isDistinct,is_super:d.isSuper,is_broadcast:d.isBroadcast,is_public:d.isPublic,is_discoverable:d.isDiscoverable,is_hidden:d.isHidden,is_ephemeral:d.isEphemeral,is_muted:d.myMutedState,is_push_enabled:d.isPushEnabled,freeze:d.isFrozen,unread_message_count:d.unreadMessageCount,unread_mention_count:d.unreadMentionCount,push_trigger_option:d.myPushTriggerOption,count_preference:d.myCountPreference,hidden_state:d.hiddenState,member_count:d.memberCount,joined_member_count:d.joinedMemberCount,member_state:d.myMemberState,my_role:d.myRole,user_last_read:d.myLastRead,ts_message_offset:d.messageOffsetTimestamp,message_survival_seconds:d.messageSurvivalSeconds,read_receipt:d.cachedReadReceiptStatus,delivery_receipt:d.cachedDeliveryReceiptStatus,members:d.members.map((function(e){return r.objectify(u({},e))})),last_message:h,created_by:null!==d.creator&&void 0!==d.creator&&"object"===c(d.creator)?n.objectify(d.creator):null,inviter:null!==d.inviter&&void 0!==d.inviter&&"object"===c(d.inviter)?n.objectify(d.inviter):null,metadata:d.metadata,cached_primary_key:d.cachedPrimaryKey})}},{key:"upsert",value:function(e){var t=j.get(this._iid).GroupChannel,n=new t(e);if(t.cachedChannels.hasOwnProperty(n.url)){if(n.isEphemeral){var r=t.cachedChannels[n.url];e.last_message=r.lastMessage,e.unread_message_count=r.unreadMessageCount}t.cachedChannels[n.url].update(e)}else t.cachedChannels[n.url]=n;return t.cachedChannels[n.url]}},{key:"removeCachedChannel",value:function(e){var t=j.get(this._iid),n=t.GroupChannel,r=t.FileMessageQueue;n.cachedChannels[e]&&delete n.cachedChannels[e],r.delete(e)}},{key:"clearCache",value:function(){nr[this._iid]={},j.get(this._iid).FileMessageQueue.clear()}},{key:"getChannel",value:function(e,t){var n=null,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ve({type:"callback"})]),a=S(i,4);if(n=a[0],e=a[1],r=a[2],t=a[3],n)return le(this._iid,(function(e){e(n,null)}),t);var s=j.get(this._iid).GroupChannel;return s.cachedChannels[e]?le(this._iid,(function(t){t(null,s.cachedChannels[e])}),t):s.getChannelWithoutCache(e,r,t)}},{key:"getChannelWithoutCache",value:function(e,t){var n=this,r=null,i=null,a=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ve({type:"callback"})]),s=S(a,4);return r=s[0],e=s[1],i=s[2],t=s[3],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getGroupChannel({channelUrl:e,internalCall:i,showMember:!0},(function(e,r){var i=null;e||(i=n.upsert(r)),t(e,i)}))}),t)}},{key:"createDistinctChannelIfNotExist",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannelParams,i=null,a=ve.parse(arguments,[new ve({type:r,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),s=S(a,3);return i=s[0],e=s[1],t=s[2],le(this._iid,(function(t){i?t(i,null):(e.isPublic||(e.accessCode=null),O.get(n._iid).container.apiClient.createGroupChannel(u(u({},e),{},{isDistinct:!0}),(function(e,r){var i=null;if(!e){var a=j.get(n._iid).GroupChannel;i={channel:new a(r),isCreated:r.is_created},a.cachedChannels[i.channel.url]=i.channel}t(e,i)})))}),t)}},{key:"createChannel",value:function(){var e=this,t=ve.toArray(arguments),n=void 0;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r.isPublic||(r.accessCode=null),r._validate()?O.get(e._iid).container.apiClient.createGroupChannel(r,(function(e,t){var r=null;e||(r=new i(t),i.cachedChannels[r.url]=r),n(e,r)})):n(ve.error,null)}),n);if(Array.isArray(t[0])){var s=new a;switch(t.length){case 1:s.addUsers(t[0]);break;case 2:s.addUsers(t[0]),s.isDistinct=t[1];break;case 3:s.addUsers(t[0]),s.isDistinct=t[1],s.customType=t[2];break;case 5:s.addUsers(t[0]),s.isDistinct=t[1],s.name=t[2],"string"==typeof t[3]?s.coverUrl=t[3]:s.coverImage=t[3],s.data=t[4];break;case 6:s.addUsers(t[0]),s.isDistinct=t[1],s.name=t[2],"string"==typeof t[3]?s.coverUrl=t[3]:s.coverImage=t[3],s.data=t[4],s.customType=t[5];break;default:return le(this._iid,(function(e){return e(ve.error,null)}),n)}return n?i.createChannel(s,n):i.createChannel(s)}return le(this._iid,(function(e){return e(ve.error,null)}),n)}},{key:"createChannelWithUserIds",value:function(){var e=ve.toArray(arguments),t=void 0;"function"==typeof e[e.length-1]&&(t=e.pop());var n=j.get(this._iid),r=n.GroupChannel,i=new(0,n.GroupChannelParams);switch(e.length){case 1:i.addUserIds(e[0]);break;case 2:i.addUserIds(e[0]),i.isDistinct=e[1];break;case 3:i.addUserIds(e[0]),i.isDistinct=e[1],i.customType=e[2];break;case 5:i.addUserIds(e[0]),i.isDistinct=e[1],i.name=e[2],"string"==typeof e[3]?i.coverUrl=e[3]:i.coverImage=e[3],i.data=e[4];break;case 6:i.addUserIds(e[0]),i.isDistinct=e[1],i.name=e[2],"string"==typeof e[3]?i.coverUrl=e[3]:i.coverImage=e[3],i.data=e[4],i.customType=e[5];break;default:return le(this._iid,(function(e){return e(ve.error,null)}),t)}return t?r.createChannel(i,t):r.createChannel(i)}},{key:"createMyGroupChannelListQuery",value:function(){return new(0,j.get(this._iid).GroupChannelListQuery)}},{key:"createPublicGroupChannelListQuery",value:function(){return new(0,j.get(this._iid).PublicGroupChannelListQuery)}},{key:"markAsReadAllLastSentAt",get:function(){return rr[this._iid]||0},set:function(e){rr[this._iid]=e}},{key:"getChannelCount",value:function(e,t){return Pi.getInstance(this._iid).getGroupChannelCount(e,t)}},{key:"getUnreadItemCount",value:function(e,t){return Pi.getInstance(this._iid).getUnreadItemCount(e,t)}},{key:"getTotalUnreadMessageCount",value:function(){var e=ve.toArray(arguments),t="function"==typeof e[e.length-1]?e.pop():null,n=Pi.getInstance(this._iid);return n.getTotalUnreadMessageCount.apply(n,N(e).concat([t]))}},{key:"getTotalUnreadChannelCount",value:function(e){return Pi.getInstance(this._iid).getTotalUnreadChannelCount(e)}}]),n}(Mt),lr=function(e){function t(t){var n=e.call(this,t)||this;return n.state="",n.role="",n.isMuted=!1,n.isBlockedByMe=!1,n.isBlockingMe=!1,n.restrictionInfo=null,t&&n._update(t),n}return R(t,e),t.objectify=function(e){var t=j.get(this._iid),n=t.User,r=t.RestrictedUser,i=t.RestrictionInfo,a=e.state,s=e.role,o=void 0===s?"":s,l=e.isMuted,u=void 0!==l&&l,c=e.isBlockedByMe,d=void 0!==c&&c,h=e.isBlockingMe,f=void 0!==h&&h,p=e.restrictionInfo,g=void 0===p?null:p,y=u?r.objectify(e):n.objectify(e);if(y.state=a,y.role=o,y.is_muted=u,y.is_blocked_by_me=d,y.is_blocking_me=f,g){var m=i.objectify(g);y.restriction_type=m.restriction_type,y.muted_description=m.description,y.muted_end_at=m.end_at}return y},t.buildFromSerializedData=function(e){var t=j.get(this._iid).Member,n=dt.deserialize(e);return new t(t.objectify(M({},n)))},t.prototype._update=function(e){var t=j.get(this._iid),n=t.RestrictedUser,r=t.RestrictionInfo;this.state=e.state,this.role=e.role||or.Role.NONE,e.hasOwnProperty("is_muted")&&(this.isMuted=e.is_muted),e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me),e.hasOwnProperty("is_blocking_me")&&(this.isBlockingMe=e.is_blocking_me),this.isMuted&&(this.restrictionInfo=new r(e),this.restrictionInfo.restrictionType=n.RestrictionType.MUTED)},t.prototype.parse=function(e){this._update(e)},Object.defineProperty(t,"JOINED",{get:function(){return"joined"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVITED",{get:function(){return"invited"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"LEFT",{get:function(){return"left"},enumerable:!1,configurable:!0}),t}(gt),ur=function(e){function t(t){var n=e.call(this,t)||this;return n.role="",n.isBlockedByMe=!1,t&&n._update(t),n}return R(t,e),t.objectify=function(e){var t=j.get(this._iid).User,n=e.role,r=void 0===n?"":n,i=e.isBlockedByMe,a=void 0!==i&&i,s=t.objectify(e);return s.role=r,s.is_blocked_by_me=a,s},t.buildFromSerializedData=function(e){var t=j.get(this._iid).Sender,n=dt.deserialize(e);return new t(t.objectify(M({},n)))},t.prototype.parse=function(e){this._update(e)},t.prototype._update=function(e){this.role=e.role||or.Role.NONE,e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me)},t}(gt),cr=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).restrictionInfo=null,e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=j.get(this._iid).RestrictionInfo;this.restrictionInfo=new t(e)}}],[{key:"RestrictionType",get:function(){return{MUTED:"muted",BANNED:"banned"}}},{key:"objectify",value:function(e){var t=j.get(this._iid),n=t.User,r=t.RestrictionInfo,i=e.restrictionInfo,a=void 0===i?{}:i;return u(u({},n.objectify(e)),r.objectify(a))}}]),n}(gt),dr=function(){function e(e){this.emojiHash=null,this.emojiCategories=null,e&&this._update(e)}return e.prototype._update=function(e){var t=j.get(this._iid).EmojiCategory;this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((function(e){return new t(e)})):[]},e}(),hr=function(){function e(e){this.id=null,this.name=null,this.url=null,this.emojis=null,e&&this._update(e)}return e.prototype._update=function(e){var t=j.get(this._iid).Emoji;this.id=e.id||0,this.name=e.name||"",this.url=e.url||"",this.emojis=e.emojis?e.emojis.map((function(e){return new t(e)})):[]},e}(),fr=function(){function e(e){this.key=null,this.url=null,e&&this._update(e)}return e.prototype._update=function(e){this.key=e.key,this.url=e.url},e}(),pr={},gr={},yr=new WeakMap,mr=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).channelType=Mt.CHANNEL_TYPE_OPEN,r.participantCount=0,yr.set(_(r),0),r.operators=[],e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=j.get(this._iid).User;e.hasOwnProperty("participant_count")&&(this.participantCount=parseInt(e.participant_count)),e.hasOwnProperty("operators")&&Array.isArray(e.operators)&&(this.operators=e.operators.map((function(e){return new t(e)})))}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"createParticipantListQuery",value:function(){return new(0,j.get(this._iid).ParticipantListQuery)({channelUrl:this.url})}},{key:"createMutedUserListQuery",value:function(){return new(0,j.get(this._iid).MutedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"createBannedUserListQuery",value:function(){return new(0,j.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"isOperator",value:function(e){return!!e&&this.isOperatorWithUserId(e.userId)}},{key:"isOperatorWithUserId",value:function(e){return this.operators.map((function(e){return e.userId})).indexOf(e)>-1}},{key:"refresh",value:function(e){return j.get(this._iid).OpenChannel.getChannelWithoutCache(this.url,e)}},{key:"enter",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid).Command.bEnter({channelUrl:t.url}),r=Pi.getInstance(t._iid);r.sendCommand(n,(function(n,i){if(r.getErrorFirstCallback()){var a=[n,i];i=a[0],n=a[1]}i?(i=i?new F(i.message,i.code):null,e(i,null)):(j.get(t._iid).OpenChannel.enteredChannels[t.url]=t,me.of(t._iid).send({source:he.EVENT_CHANNEL_ENTER,payload:{channel:t}}),t.refresh((function(){return e(null,null)})))}))}),e)}},{key:"exit",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid),r=n.Command,i=n.FileMessageQueue,a=r.bExit({channelUrl:t.url}),s=Pi.getInstance(t._iid);s.sendCommand(a,(function(n,r){if(s.getErrorFirstCallback()){var a=[n,r];r=a[0],n=a[1]}r?(r=r?new F(r.message,r.code):null,e(r,null)):(delete j.get(t._iid).OpenChannel.enteredChannels[t.url],i.delete(t.url),me.of(t._iid).send({source:he.EVENT_CHANNEL_EXIT,payload:{channel:t}}),e(null,null))}))}),e)}},{key:"updateChannel",value:function(){var e=this,t=ve.toArray(arguments),n=null;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.OpenChannel,a=r.OpenChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r.channelUrl=e.url,r._validate()?O.get(e._iid).container.apiClient.updateOpenChannel(r,(function(e,t){var r=null;e||(r=i.upsert(t)),n(e,r)})):n(ve.error,null)}),n);if(3===t.length){var s=new a;return s.channelUrl=this.url,s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2],s.operatorUserIds=this.operators.map((function(e){return e.userId})),n?this.updateChannel(s,n):this.updateChannel(s)}if(4===t.length){var o=new a;return o.channelUrl=this.url,o.name=t[0],o.coverUrlOrImage=t[1],o.data=t[2],Array.isArray(t[3])&&(o.operatorUserIds=t[3]),n?this.updateChannel(o,n):this.updateChannel(o)}if(5===t.length){var l=new a;return l.channelUrl=this.url,l.name=t[0],l.coverUrlOrImage=t[1],l.data=t[2],Array.isArray(t[3])&&(l.operatorUserIds=t[3]),l.customType=t[4],n?this.updateChannel(l,n):this.updateChannel(l)}return le(this._iid,(function(e){return e(ve.error,null)}),n)}},{key:"updateChannelWithOperatorUserIds",value:function(){var e=ve.toArray(arguments),t=void 0;switch("function"==typeof e[e.length-1]&&(t=e.pop()),e.length){case 4:case 5:return t?this.updateChannel(params,t):this.updateChannel(params);default:return le(this._iid,(function(e){return e(ve.error,null)}),t)}}},{key:"muteUser",value:function(e,t,n,r){return this.muteUserWithUserId(e?e.userId:null,t,n,r)}},{key:"muteUserWithUserId",value:function(e,t,n,r){var i=this,a=null,s=ve.parse(arguments,[new ve({type:"string"}),new ve({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ve({type:"string",optional:!0,defaultValue:""}),new ve({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):O.get(i._iid).container.apiClient.muteUser({channelUrl:i.url,userId:e,description:n,seconds:t,isGroupChannel:!1},(function(e,t){r(e,null)}))}),r)}},{key:"unmuteUser",value:function(e,t){return this.unmuteUserWithUserId(e?e.userId:null,t)}},{key:"unmuteUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.unmuteUser({channelUrl:n.url,userId:e,isGroupChannel:!1},(function(e,n){t(e,null)}))}),t)}},{key:"banUser",value:function(e,t,n){return this.banUserWithUserId(e?e.userId:null,t,n)}},{key:"banUserWithUserId",value:function(e,t,n){var r=this,i=null,a=ve.parse(arguments,[new ve({type:"string"}),new ve({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ve({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):O.get(r._iid).container.apiClient.banUser({channelUrl:r.url,userId:e,description:null,seconds:t,isGroupChannel:!1},(function(e,t){n(e,null)}))}),n)}},{key:"unbanUser",value:function(e,t){return this.unbanUserWithUserId(e?e.userId:null,t)}},{key:"unbanUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.unbanUser({channelUrl:n.url,userId:e,isGroupChannel:!1},(function(e,n){t(e,null)}))}),t)}},{key:"setLatestParticipantCount",value:function(e,t){var n=!1;return"number"==typeof e&&"number"==typeof t&&t>=yr.get(this)&&(yr.set(this,t),n=e!==this.participantCount,this.participantCount=e),n}},{key:"delete",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.deleteOpenChannel({channelUrl:t.url},(function(n,r){n||(delete j.get(t._iid).OpenChannel.cachedChannels[t.url],j.get(t._iid).FileMessageQueue.delete(t.url)),e(n,r)}))}),e)}}],[{key:"cachedChannels",get:function(){return pr[this._iid]||(pr[this._iid]={}),pr[this._iid]}},{key:"enteredChannels",get:function(){return gr[this._iid]||(gr[this._iid]={}),gr[this._iid]}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid),n=t.User,r=t.OpenChannel,i=dt.deserialize(e);return new r({channel_url:i.url,name:i.name,cover_url:i.coverUrl,data:i.data,custom_type:i.customType,created_at:i.createdAt/1e3,freeze:i.isFrozen,is_ephemeral:i.isEphemeral,participant_count:i.participantCount,operators:i.operators.map((function(e){return n.objectify(e)}))})}},{key:"getChannel",value:function(e,t){var n=null,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ve({type:"callback"})]),a=S(i,4);if(n=a[0],e=a[1],r=a[2],t=a[3],n)return le(this._iid,(function(e){e(n,null)}),t);var s=j.get(this._iid).OpenChannel;return s.cachedChannels[e]?le(this._iid,(function(t){t(null,s.cachedChannels[e])}),t):s.getChannelWithoutCache(e,r,t)}},{key:"getChannelWithoutCache",value:function(e,t){var n=this,r=null,i=null,a=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ve({type:"callback"})]),s=S(a,4);return r=s[0],e=s[1],i=s[2],t=s[3],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getOpenChannel({channelUrl:e,internalCall:i},(function(e,r){var i=null;e||(i=j.get(n._iid).OpenChannel.upsert(r)),t(e,i)}))}),t)}},{key:"createChannel",value:function(){var e=this,t=ve.toArray(arguments),n=null;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.OpenChannel,a=r.OpenChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r._validate()?O.get(e._iid).container.apiClient.createOpenChannel(r,(function(t,r){var i=null;t||(i=j.get(e._iid).OpenChannel.upsert(r)),n(t,i)})):n(ve.error,null)}),n);var s=new a;switch(t.length){case 0:break;case 1:s.name=t[0];break;case 2:s.name=t[0],s.coverUrlOrImage=t[1];break;case 3:s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2];break;case 4:s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2],s.operatorUserIds=t[3];break;case 5:s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2],s.operatorUserIds=t[3],s.customType=t[4];break;default:return le(this._iid,(function(e){return e(ve.error,null)}),n)}return n?i.createChannel(s,n):i.createChannel(s)}},{key:"createChannelWithOperatorUserIds",value:function(){var e=ve.toArray(arguments),t=void 0;switch("function"==typeof e[e.length-1]&&(t=e.pop()),e.length){case 4:case 5:return t?this.createChannel.apply(this,N(e).concat([t])):this.createChannel.apply(this,N(e));default:return le(this._iid,(function(e){return e(ve.error,null)}),t)}}},{key:"upsert",value:function(e){var t=new(0,j.get(this._iid).OpenChannel)(e);return this.cachedChannels.hasOwnProperty(t.url)?this.cachedChannels[t.url].update(e):this.cachedChannels[t.url]=t,this.cachedChannels[t.url]}},{key:"removeCachedChannel",value:function(e){this.cachedChannels[e]&&delete this.cachedChannels[e],j.get(this._iid).FileMessageQueue.delete(e)}},{key:"clearCache",value:function(){pr[this._iid]={},j.get(this._iid).FileMessageQueue.clear()}},{key:"clearEnteredChannels",value:function(){gr[this._iid]={}}},{key:"createOpenChannelListQuery",value:function(){return new(0,j.get(this._iid).OpenChannelListQuery)}}]),n}(Mt),_r="default",vr=function(){function e(e){this.name=_r,this.volume=1,e&&this._update(e)}return e.prototype._update=function(e){e.hasOwnProperty("name")&&(this.name=e.name),e.hasOwnProperty("volume")&&(this.volume=e.volume)},e.objectify=function(e){var t=e.name,n=void 0===t?_r:t,r=e.volume;return{name:n,volume:void 0===r?1:r}},e.prototype.serialize=function(){return dt.serialize(this)},e}(),Er=function(){function e(e,t){void 0===t&&(t=[]),this.key=e,this.value=Array.isArray(t)&&t.every((function(e){return"string"==typeof e}))?t:[]}return e.prototype.encode=function(){return{key:this.key,value:this.value||[]}},e}(),br=new WeakMap,Cr=function(){function e(t){d(this,e),this._mentionType=e.MentionType.USERS,this._mentionedUserIds=[],this._cachedMentionedUsers=[],this._cachedMentionedUserIds=[],this._metaArrays=[],br.set(this,null),this._parentMessageId=null,this._reqId=null,this.data=null,this.customType=null,this.pushNotificationDeliveryOption=null,this.appleCriticalAlertOptions=null,this.isReplyToChannel=!1,this.mentionedMessageTemplate=null,t&&this._update(t)}return f(e,[{key:"mentionType",get:function(){return this._mentionType},set:function(e){var t=j.get(this._iid).BaseMessageParams;Object.keys(t.MentionType).map((function(e){return t.MentionType[e]})).indexOf(e)>-1&&(this._mentionType=e)}},{key:"mentionedUserIds",get:function(){return this._cachedMentionedUserIds},set:function(e){if(Array.isArray(e)){if(0===e.length)return this._cachedMentionedUserIds=[],void(this._mentionedUserIds=[]);for(var t=Pi.getInstance(this._iid),n=0;n<e.length;n++){var r=e[n];if("string"!=typeof r){this._cachedMentionedUserIds=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(r)<0&&t.currentUser&&t.currentUser.userId!==r&&(this._cachedMentionedUserIds.push(r),this._mentionedUserIds.push(r))}}}},{key:"mentionedUsers",get:function(){return this._cachedMentionedUsers},set:function(e){if(Array.isArray(e)){if(0===e.length)return this._cachedMentionedUserIds=[],void(this._mentionedUserIds=[]);for(var t=Pi.getInstance(this._iid),n=0;n<e.length;n++){var r=e[n];if(!r.hasOwnProperty("userId")){this._cachedMentionedUsers=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(r.userId)<0&&t.currentUser&&t.currentUser.userId!==r.userId&&(this._cachedMentionedUsers.push(r),this._mentionedUserIds.push(r.userId))}}}},{key:"metaArrayKeys",get:function(){return this._metaArrays.map((function(e){return e.key}))},set:function(e){var t=j.get(this._iid).MessageMetaArray,n={};if(Array.isArray(e)){this._metaArrays=[];for(var r=0;r<e.length;r++)"string"!=typeof e[r]||n[e[r]]||(n[e[r]]=!0,this._metaArrays.push(new t(e[r])))}}},{key:"metaArrays",get:function(){return this._metaArrays},set:function(e){var t=j.get(this._iid).MessageMetaArray;if(Array.isArray(e)){this._metaArrays=[];for(var n=0;n<e.length;n++){var r=e[n];if(r instanceof t){var i,a=this._metaArrays.map((function(e){return e.key})).indexOf(r.key);a<0?this._metaArrays.push(r):(i=this._metaArrays[a].value).push.apply(i,N(r.value))}}}}},{key:"rootMessageId",get:function(){return br.get(this)}},{key:"parentMessageId",get:function(){return this._parentMessageId},set:function(e){br.set(this,e),this._parentMessageId=e}},{key:"_serialize",value:function(e){return dt.serialize(this,(function(t){t.hasOwnProperty("_mentionType")&&(t.mentionType=t._mentionType,delete t._mentionType),t.hasOwnProperty("_mentionedUserIds")&&(t.mentionedUserIds=t._mentionedUserIds,delete t._mentionedUserIds),t.hasOwnProperty("_cachedMentionedUsers")&&(t.cachedMentionedUsers=t._cachedMentionedUsers,delete t._cachedMentionedUsers),t.hasOwnProperty("_cachedMentionedUserIds")&&(t.cachedMentionedUserIds=t._cachedMentionedUserIds,delete t._cachedMentionedUserIds),t.hasOwnProperty("_metaArrays")&&(t.metaArrays=t._metaArrays,delete t._metaArrays),t.hasOwnProperty("_parentMessageId")&&(t.parentMessageId=t._parentMessageId,delete t._parentMessageId),e&&e(t)}))}},{key:"_update",value:function(e){e.hasOwnProperty("mention_type")&&(this._mentionType=e.mention_type),e.hasOwnProperty("mentioned_user_ids")&&(this._mentionedUserIds=e.mentioned_user_ids),e.hasOwnProperty("mentioned_message_template")&&(this.mentionedMessageTemplate=e.mentioned_message_template),e.hasOwnProperty("cached_mentioned_users")&&(this._cachedMentionedUsers=e.cached_mentioned_users),e.hasOwnProperty("cached_mentioned_user_ids")&&(this._cachedMentionedUserIds=e.cached_mentioned_user_ids),e.hasOwnProperty("meta_arrays")&&(this._metaArrays=e.meta_arrays.map((function(e){return new Er(e.key,e.value)}))),e.hasOwnProperty("parent_message_id")&&(this.parentMessageId=e.parent_message_id),e.hasOwnProperty("data")&&(this.data=e.data),e.hasOwnProperty("custom_type")&&(this.customType=e.custom_type),e.hasOwnProperty("push_notification_delivery_option")&&(this.pushNotificationDeliveryOption=e.push_notification_delivery_option),e.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new vr(e.apple_critical_alert_options)),e.hasOwnProperty("is_reply_to_channel")&&(this.isReplyToChannel=e.is_reply_to_channel)}},{key:"_validate",value:function(){var e=j.get(this._iid),t=e.BaseMessageParams,n=e.MessageMetaArray,r=br.get(this);return Object.keys(t.MentionType).map((function(e){return t.MentionType[e]})).indexOf(this.mentionType)>-1&&this._mentionedUserIds.every((function(e){return"string"==typeof e}))&&("string"==typeof this.mentionedMessageTemplate||null===this.mentionedMessageTemplate)&&Array.isArray(this._metaArrays)&&this._metaArrays.every((function(e){return e instanceof n}))&&("number"==typeof r||null===r)&&("number"==typeof this._parentMessageId||null===this._parentMessageId)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&(null===this.pushNotificationDeliveryOption||Object.keys(t.PushNotificationDeliveryOption).map((function(e){return t.PushNotificationDeliveryOption[e]})).indexOf(this.pushNotificationDeliveryOption)>-1)&&(null===this.appleCriticalAlertOptions||this.appleCriticalAlertOptions instanceof vr)&&"boolean"==typeof this.isReplyToChannel}}],[{key:"_objectify",value:function(t){var n=t.mentionType,r=void 0===n?e.MentionType.USERS:n,i=t.mentionedUserIds,a=void 0===i?[]:i,s=t.mentionedMessageTemplate,o=void 0===s?null:s,l=t.cachedMentionedUsers,u=void 0===l?[]:l,c=t.cachedMentionedUserIds,d=void 0===c?[]:c,h=t.metaArrays,f=void 0===h?[]:h,p=t.parentMessageId,g=void 0===p?null:p,y=t.pushNotificationDeliveryOption,m=void 0===y?null:y,_=t.appleCriticalAlertOptions,v=void 0===_?null:_,E=t.isReplyToChannel;return{mention_type:r,mentioned_user_ids:a,mentioned_message_template:o,cached_mentioned_users:u,cached_mentioned_user_ids:d,meta_arrays:f,parent_message_id:g,push_notification_delivery_option:m,apple_critical_alert_options:v,is_reply_to_channel:void 0!==E&&E}}},{key:"MentionType",get:function(){return{USERS:"users",CHANNEL:"channel"}}},{key:"PushNotificationDeliveryOption",get:function(){return{DEFAULT:"default",SUPPRESS:"suppress"}}}]),e}(),Sr=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).message=null,r._translationTargetLanguages=[],e&&r._update(e),r}return f(n,[{key:"serialize",value:function(){return C(y(n.prototype),"_serialize",this).call(this,(function(e){e.hasOwnProperty("_translationTargetLanguages")&&(e.translationTargetLanguages=e._translationTargetLanguages,delete e._translationTargetLanguages)}))}},{key:"targetLanguages",get:function(){return this.translationTargetLanguages},set:function(e){this.translationTargetLanguages=e}},{key:"translationTargetLanguages",get:function(){return this._translationTargetLanguages},set:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("string"!=typeof e[t])return void(this._translationTargetLanguages=[]);this._translationTargetLanguages=e}}},{key:"_update",value:function(e){C(y(n.prototype),"_update",this).call(this,e),e.hasOwnProperty("message")&&(this.message=e.message),e.hasOwnProperty("translation_target_languages")&&(this._translationTargetLanguages=e.translation_target_languages)}},{key:"_validate",value:function(){return C(y(n.prototype),"_validate",this).call(this)&&("string"==typeof this.message||null===this.message)&&Array.isArray(this.translationTargetLanguages)&&this.translationTargetLanguages.every((function(e){return"string"==typeof e}))}}],[{key:"objectify",value:function(e){var t=e.message,n=void 0===t?null:t,r=e.data,i=void 0===r?null:r,a=e.customType,s=void 0===a?null:a,o=e.translationTargetLanguages,l=void 0===o?[]:o;return u(u({},Cr._objectify(e)),{},{message:n,data:i,custom_type:s,translation_target_languages:l})}}]),n}(Cr),Nr=function(){function e(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=0),this.key=e,this.userIds=t,this.updatedAt=n;for(var r={},i=0,a=this.userIds;i<a.length;i++)r[a[i]]=this.updatedAt;this._version=r}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.createFromJson=function(e){var t=e.key,n=e.user_ids,r=e.updated_at;return"string"==typeof t&&t&&Array.isArray(n)&&n.length>0&&"number"==typeof r?new this(t,n,r):null},e.objectify=function(e){return{key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}},e.prototype._applyEvent=function(e){if(e.key===this.key&&(!this._version[e.userId]||this._version[e.userId]<e.updatedAt)){var t=this.userIds.indexOf(e.userId);switch(e.operation){case"add":t<0&&this.userIds.push(e.userId);break;case"delete":t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}},e}(),Ar=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).messageType=pt.MESSAGE_TYPE_USER,r.message=null,r._sender=null,r.translations={},r.requestState=null,r.requestedMentionUserIds=[],r.errorCode=0,r.messageSurvivalSeconds=-1,r.plugins=[],r._messageParams=null,e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=Pi.getInstance(this._iid),n=j.get(this._iid),r=n.Sender,i=n.Plugin;this.message=String(e.message),this._sender=new r(e.user),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.translations=e.hasOwnProperty("translations")?e.translations:{},this.requestState=this.messageId>0?t.MessageRequestState.SUCCEEDED:t.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===t.MessageSendingStatus.CANCELED&&(this.requestState=t.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds),this.plugins=[],e.hasOwnProperty("plugins")&&Array.isArray(e.plugins)&&(this.plugins=e.plugins.map((function(e){return new i(e)}))),e.hasOwnProperty("message_params")&&(this._messageParams=new Sr(e.message_params))}},{key:"sender",get:function(){var e=Pi.getInstance(this._iid),t=j.get(this._iid).GroupChannel;if(this._sender&&e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var r=n.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.plainProfileUrl!==r.plainProfileUrl&&(this._sender.plainProfileUrl=r.plainProfileUrl),se.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"isResendable",value:function(){var e=Pi.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&se.isResendableError(this.errorCode)}},{key:"serialize",value:function(){var e=this;return C(y(n.prototype),"serialize",this).call(this,(function(t){e._messageParams&&(t.messageParams=e._messageParams.serialize())}))}},{key:"messageParams",get:function(){return this._messageParams}},{key:"_clone",value:function(){return j.get(this._iid).UserMessage.buildFromSerializedData(this.serialize())}},{key:"_isSentByMe",value:function(){var e=Pi.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.SUCCEEDED&&0===this.updatedAt&&this._sender&&this._sender.userId===e.currentUser.userId}}],[{key:"objectify",value:function(e){var t=Pi.getInstance(this._iid),n=j.get(this._iid),r=n.BaseChannel,i=n.BaseMessageParams,a=n.Sender,s=n.User,o=n.UserMessage,l=n.FileMessage,c=n.AdminMessage,d=n.ThreadInfo,h=n.OGMetaData,f=n.Plugin,p=n.Reaction,g=n.AppleCriticalAlertOptions,y=n.UserMessageParams,m=e.messageId,_=e.messageType,v=void 0===_?pt.MESSAGE_TYPE_BASE:_,E=e.reqId,b=void 0===E?"":E,C=e.user,S=e.channel,N=void 0===S?null:S,A=e.channelUrl,k=void 0===A?"":A,T=e.channelType,I=void 0===T?r.CHANNEL_TYPE_OPEN:T,w=e.message,O=e.data,U=void 0===O?"":O,R=e.customType,M=void 0===R?"":R,L=e.mentionType,P=void 0===L?i.MentionType.USERS:L,D=e.mentionedUsers,x=void 0===D?[]:D,F=e.mentionedUserIds,H=void 0===F?[]:F,G=e.mentionedMessageTemplate,z=void 0===G?null:G,B=e.requestedMentionUserIds,V=void 0===B?[]:B,q=e.reactions,K=void 0===q?[]:q,Q=e.metaArrays,Y=void 0===Q?[]:Q,W=e.rootMessageId,J=void 0===W?0:W,$=e.parentMessageId,X=void 0===$?0:$,Z=e.parentMessageText,ee=void 0===Z?"":Z,te=e.threadInfo,ne=void 0===te?null:te,re=e.isReplyToChannel,ie=void 0!==re&&re,ae=e.parentMessage,se=void 0===ae?null:ae,oe=e.translations,le=void 0===oe?{}:oe,ue=e.sendingStatus,ce=e.errorCode,de=void 0===ce?0:ce,he=e.silent,fe=void 0!==he&&he,pe=e.isGlobalBlocked,ge=void 0!==pe&&pe,ye=e.messageSurvivalSeconds,me=void 0===ye?-1:ye,_e=e.ogMetaData,ve=void 0===_e?null:_e,Ee=e.isOperatorMessage,be=void 0!==Ee&&Ee,Ce=e.plugins,Se=void 0===Ce?[]:Ce,Ne=e.appleCriticalAlertOptions,Ae=e.createdAt,ke=e.updatedAt,Te=void 0===ke?0:ke,Ie=e.messageParams,we=void 0===Ie?null:Ie,Oe=e.isAutoResendRegistered,Ue=void 0!==Oe&&Oe,Re={};switch(Re.req_id=b,Re.msg_id=m,v){case pt.MESSAGE_TYPE_USER:Re.type="MESG";break;case pt.MESSAGE_TYPE_FILE:Re.type="FILE";break;case pt.MESSAGE_TYPE_ADMIN:Re.type="ADMM"}if(Re.user=a.objectify(u({},C)),Re.channel_url=N?N.url:k,Re.channel_type=N?N.channelType:I,Re.message=w,Re.data=U,Re.custom_type=M,Re.translations=le,Re.is_global_block=!!ge,Re.ts=Ae,Re.updated_at=Te,Re.mention_type=P,Re.mentioned_users=x.map((function(e){return s.objectify(e)})),Re.mentioned_user_ids=H,Re.mentioned_message_template=z,Re.requested_mention_user_ids=V,Re.reactions=K.map((function(e){return p.objectify(e)})),Re.metaarray={},Y.forEach((function(e){var t=e.key;Re.metaarray[t]=e.value})),Re.metaarray_key_order=Y.map((function(e){return e.key})),Re.root_message_id=J,Re.parent_message_id=X,Re.parent_message_text=ee,ne&&(Re.thread_info=d.objectify(ne)),Re.is_reply_to_channel=ie,se)switch(se.messageType){case pt.MESSAGE_TYPE_USER:Re.parent_message_info=o._objectifySerializedData(se);break;case pt.MESSAGE_TYPE_FILE:Re.parent_message_info=l._objectifySerializedData(se);break;case pt.MESSAGE_TYPE_ADMIN:Re.parent_message_info=c._objectifySerializedData(se)}return Re.sending_status=m>0?t.MessageSendingStatus.SUCCEEDED:t.MessageSendingStatus.FAILED,ue&&(Re.sending_status=ue),Re.silent=!!fe,Re.error_code=de,Re.message_survival_seconds=me,ve&&(Re.og_tag=h.objectify(ve)),Re.is_op_msg=!!be,Re.plugins=Se.map((function(e){return f.objectify(e)})),Ne&&(Re.apple_critical_alert_options=g.objectify(Ne)),we&&(Re.message_params=y.objectify(we)),Re.is_auto_resend_registered=Ue,Re}},{key:"build",value:function(e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,g,y,m,_,v,E,b,C,S,N,A,k,T,I,w){return this.objectify({messageId:t,reqId:e,user:n,channel:r,message:i,data:a,customType:s,mentionType:f,mentionedUsers:p,mentionedUserIds:v,mentionedMessageTemplate:E,requestedMentionUserIds:C,reactions:h,metaArrays:d,rootMessageId:g,parentMessageId:y,parentMessageText:m,threadInfo:_,translations:o,sendingStatus:b,errorCode:S,isGlobalBlocked:l,messageSurvivalSeconds:N,ogMetaData:A,isOperatorMessage:k,plugins:T,appleCriticalAlertOptions:I,createdAt:u,updatedAt:c,messageParams:w})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).UserMessage,n=dt.deserialize(e);return new t(this._objectifySerializedData(n))}},{key:"_objectifySerializedData",value:function(e){return j.get(this._iid).UserMessage.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,messageParams:e.messageParams?new Sr(Sr.objectify(e.messageParams)):null}))}}]),n}(pt),kr=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).fileName=null,r.mimeType=null,r.fileSize=null,r._isUpdate=!1,r._file=null,r._fileType=null,r._fileUrl=null,r._thumbnailSizes=[],e&&r._update(e),r}return f(n,[{key:"serialize",value:function(){return C(y(n.prototype),"_serialize",this).call(this,(function(e){e.hasOwnProperty("_isUpdate")&&(e.isUpdate=e._isUpdate,delete e._isUpdate),e.hasOwnProperty("_file")&&(e.file=e._file,delete e._file),e.hasOwnProperty("_fileType")&&(e.fileType=e._fileType,delete e._fileType),e.hasOwnProperty("_fileUrl")&&(e.fileUrl=e._fileUrl,delete e._fileUrl),e.hasOwnProperty("_thumbnailSizes")&&(e.thumbnailSizes=e._thumbnailSizes,delete e._thumbnailSizes)}))}},{key:"file",get:function(){return this._file},set:function(e){se.isFile(e)&&(this._fileUrl=null,this._file=e,ne.isFile(e)?this._fileType=x.FILE:ne.isBlob(e)?this._fileType=x.BLOB:ne.isFileLikeObject(e)?this._fileType=x.BLOB_LIKE_OBJECT:"string"==typeof e&&(this._fileType=x.URL))}},{key:"fileType",get:function(){return this._fileType}},{key:"fileUrl",get:function(){return this._fileUrl},set:function(e){"string"==typeof e&&(this._fileUrl=e,this._file=null)}},{key:"thumbnailSizes",get:function(){return this._thumbnailSizes},set:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("object"!==c(e[t])||"number"!=typeof e[t].maxWidth||"number"!=typeof e[t].maxHeight)return void(this._thumbnailSizes=[]);this._thumbnailSizes=e}}},{key:"_update",value:function(e){C(y(n.prototype),"_update",this).call(this,e),e.hasOwnProperty("file_name")&&(this.fileName=e.file_name),e.hasOwnProperty("mime_type")&&(this.mimeType=e.mime_type),e.hasOwnProperty("file_size")&&(this.fileSize=e.file_size),e.hasOwnProperty("is_update")&&(this._isUpdate=e.is_update),e.hasOwnProperty("file")&&(this._file=e.file),e.hasOwnProperty("file_type")&&(this._fileType=e.file_type),e.hasOwnProperty("file_url")&&(this._fileUrl=e.file_url),e.hasOwnProperty("thumbnail_sizes")&&(this._thumbnailSizes=e.thumbnail_sizes)}},{key:"_validate",value:function(){return C(y(n.prototype),"_validate",this).call(this)&&(this._isUpdate||se.isFile(this.file)||"string"==typeof this.fileUrl)&&("string"==typeof this.fileName||null===this.fileName)&&("string"==typeof this.mimeType||null===this.mimeType)&&("number"==typeof this.fileSize||null===this.fileSize)&&(null===this._thumbnailSizes||this._thumbnailSizes.every((function(e){return"object"===c(e)&&e.maxWidth>0&&e.maxHeight>0})))}}],[{key:"objectify",value:function(e){var t=e.fileName,n=void 0===t?null:t,r=e.mimeType,i=void 0===r?null:r,a=e.fileSize,s=void 0===a?null:a,o=e.data,l=void 0===o?null:o,c=e.customType,d=void 0===c?null:c,h=e.isUpdate,f=void 0!==h&&h,p=e.file,g=void 0===p?null:p,y=e.fileType,m=void 0===y?null:y,_=e.fileUrl,v=void 0===_?null:_,E=e.thumbnailSizes,b=void 0===E?[]:E;return u(u({},Cr._objectify(e)),{},{file_name:n,mime_type:i,file_size:s,data:l,custom_type:d,is_update:f,file:g,file_type:m,file_url:v,thumbnail_sizes:b})}}]),n}(Cr),Tr=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).messageType=pt.MESSAGE_TYPE_FILE,r.plainUrl=null,r.name="File",r.size=0,r.type=null,r.thumbnails=[],r._sender=null,r.requireAuth=null,r.requestState=null,r.requestedMentionUserIds=[],r.errorCode=0,r.messageSurvivalSeconds=-1,r._messageParams=null,e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=Pi.getInstance(this._iid),n=O.get(this._iid).container.auth,r=j.get(this._iid).Sender;if(this._sender=new r(e.user),this.requireAuth=!!e.hasOwnProperty("require_auth")&&e.require_auth,e.hasOwnProperty("url")&&(this.plainUrl=e.url.split("?auth=")[0]),this.name=e.hasOwnProperty("name")?e.name:"File",this.size=parseInt(e.size)||0,this.type=e.type,e.hasOwnProperty("custom")&&(this.data=e.custom),e.hasOwnProperty("file")){var i=e.file;i.hasOwnProperty("url")&&(this.plainUrl=i.url),i.hasOwnProperty("name")&&(this.name=i.name),i.hasOwnProperty("size")&&(this.size=i.size),i.hasOwnProperty("type")&&(this.type=i.type),i.hasOwnProperty("custom")&&(this.data=i.custom)}if(Object.defineProperty(this,"url",{value:this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(n.eKey):this.plainUrl,configurable:!0,writable:!1}),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.thumbnails=e.hasOwnProperty("thumbnails")?e.thumbnails:[],this.requireAuth)for(var a=0;a<this.thumbnails.length;a++)this.thumbnails[a].plainUrl=String(this.thumbnails[a].url).split("?auth=")[0],this.thumbnails[a].url=this.requireAuth?"".concat(this.thumbnails[a].plainUrl,"?auth=").concat(n.eKey):this.thumbnails[a].plainUrl;this.requestState=this.messageId>0?t.MessageRequestState.SUCCEEDED:t.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===t.MessageSendingStatus.CANCELED&&(this.requestState=t.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds),e.hasOwnProperty("message_params")&&(this._messageParams=new kr(e.message_params))}},{key:"sender",get:function(){var e=Pi.getInstance(this._iid),t=j.get(this._iid).GroupChannel;if(this._sender&&e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var r=n.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.plainProfileUrl!==r.plainProfileUrl&&(this._sender.plainProfileUrl=r.plainProfileUrl),se.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"isResendable",value:function(){var e=Pi.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&se.isResendableError(this.errorCode)}},{key:"serialize",value:function(){var e=this;return C(y(n.prototype),"serialize",this).call(this,(function(t){e._messageParams&&(t.messageParams=e._messageParams.serialize())}))}},{key:"messageParams",get:function(){return this._messageParams}},{key:"_clone",value:function(){var e=j.get(this._iid).FileMessage.buildFromSerializedData(this.serialize());if(this._messageParams&&e._messageParams){var t=this._messageParams.file;t&&ne.isBlob(t)&&(e._messageParams.file=t.slice())}return e}},{key:"_isSentByMe",value:function(){var e=Pi.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.SUCCEEDED&&0===this.updatedAt&&this._sender&&this._sender.userId===e.currentUser.userId}}],[{key:"objectify",value:function(e){var t=Pi.getInstance(this._iid),n=j.get(this._iid),r=n.BaseChannel,i=n.BaseMessageParams,a=n.Sender,s=n.User,o=n.UserMessage,l=n.FileMessage,c=n.AdminMessage,d=n.ThreadInfo,h=n.OGMetaData,f=n.Reaction,p=n.FileMessageParams,g=n.AppleCriticalAlertOptions,y=e.messageId,m=e.messageType,_=void 0===m?pt.MESSAGE_TYPE_BASE:m,v=e.reqId,E=void 0===v?"":v,b=e.user,C=void 0===b?{}:b,S=e.channel,N=e.plainUrl,A=e.name,k=void 0===A?null:A,T=e.type,I=e.size,w=void 0===I?0:I,O=e.data,U=void 0===O?"":O,R=e.customType,M=void 0===R?"":R,L=e.mentionType,P=void 0===L?i.MentionType.USERS:L,D=e.mentionedUsers,x=void 0===D?[]:D,F=e.mentionedUserIds,H=void 0===F?[]:F,G=e.requestedMentionUserIds,z=void 0===G?[]:G,B=e.reactions,V=void 0===B?[]:B,q=e.metaArrays,K=void 0===q?[]:q,Q=e.rootMessageId,Y=void 0===Q?0:Q,W=e.parentMessageId,J=void 0===W?0:W,$=e.parentMessageText,X=void 0===$?"":$,Z=e.threadInfo,ee=void 0===Z?null:Z,te=e.isReplyToChannel,ne=void 0!==te&&te,re=e.parentMessage,ie=void 0===re?null:re,ae=e.thumbnails,se=void 0===ae?[]:ae,oe=e.requireAuth,le=void 0!==oe&&oe,ue=e.sendingStatus,ce=e.errorCode,de=void 0===ce?0:ce,he=e.silent,fe=void 0!==he&&he,pe=e.isGlobalBlocked,ge=void 0!==pe&&pe,ye=e.messageSurvivalSeconds,me=void 0===ye?-1:ye,_e=e.ogMetaData,ve=void 0===_e?null:_e,Ee=e.isOperatorMessage,be=void 0!==Ee&&Ee,Ce=e.appleCriticalAlertOptions,Se=e.createdAt,Ne=e.updatedAt,Ae=void 0===Ne?0:Ne,ke=e.messageParams,Te=void 0===ke?null:ke,Ie=e.isAutoResendRegistered,we=void 0!==Ie&&Ie,Oe={};switch(Oe.req_id=E,Oe.msg_id=y,_){case pt.MESSAGE_TYPE_USER:Oe.type="MESG";break;case pt.MESSAGE_TYPE_FILE:Oe.type="FILE";break;case pt.MESSAGE_TYPE_ADMIN:Oe.type="ADMM"}Oe.user=a.objectify(u({},C)),Oe.channel_url=S.url,Oe.channel_type=S.channelType===r.CHANNEL_TYPE_OPEN?r.CHANNEL_TYPE_OPEN:r.CHANNEL_TYPE_GROUP,Oe.url=N,Oe.name=k,Oe.type=T,Oe.size=w,Oe.custom=U,Oe.custom_type=M,Oe.thumbnails=se,Oe.require_auth=le,Oe.is_global_block=!!ge,Oe.ts=Se,Oe.updated_at=Ae,Oe.mention_type=P,Oe.mentioned_users=x.map((function(e){return s.objectify(e)})),Oe.mentioned_user_ids=H,Oe.requested_mention_user_ids=z,Oe.reactions=V.map((function(e){return f.objectify(e)})),Oe.metaarray={};for(var Ue=0;Ue<K.length;Ue++){var Re=K[Ue].key;Oe.metaarray[Re]=K[Ue].value}if(Oe.metaarray_key_order=K.map((function(e){return e.key})),Oe.root_message_id=Y,Oe.parent_message_id=J,Oe.parent_message_text=X,ee&&(Oe.thread_info=d.objectify(ee)),Oe.is_reply_to_channel=ne,ie)switch(ie.messageType){case r.MESSAGE_TYPE_USER:Oe.parent_message_info=o._objectifySerializedData(ie);break;case r.MESSAGE_TYPE_FILE:Oe.parent_message_info=l._objectifySerializedData(ie);break;case r.MESSAGE_TYPE_ADMIN:Oe.parent_message_info=c._objectifySerializedData(ie)}return Oe.sending_status=y>0?t.MessageSendingStatus.SUCCEEDED:t.MessageSendingStatus.FAILED,ue&&(Oe.sending_status=ue),Oe.silent=!!fe,Oe.error_code=de,Oe.message_survival_seconds=me,ve&&(Oe.og_tag=h.objectify(ve)),Oe.is_op_msg=!!be,Ce&&(Oe.apple_critical_alert_options=g.objectify(Ce)),Te&&(Oe.message_params=p.objectify(Te)),Oe.is_auto_resend_registered=we,Oe}},{key:"build",value:function(e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,g,y,m,_,v,E,b,C,S,N,A,k,T,I,w,O,U){return this.objectify({messageId:t,reqId:e,user:n,channel:r,plainUrl:i,name:a,type:s,size:o,data:l,customType:u,mentionType:m,mentionedUsers:_,mentionedUserIds:S,requestedMentionUserIds:A,reactions:y,metaArrays:g,rootMessageId:v,parentMessageId:E,parentMessageText:b,threadInfo:C,thumbnails:h,requireAuth:f,sendingStatus:N,errorCode:k,isGlobalBlocked:c,messageSurvivalSeconds:T,ogMetaData:I,isOperatorMessage:w,appleCriticalAlertOptions:O,createdAt:d,updatedAt:p,messageParams:U})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).FileMessage,n=dt.deserialize(e);return new t(this._objectifySerializedData(n))}},{key:"_objectifySerializedData",value:function(e){return j.get(this._iid).FileMessage.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,messageParams:e.messageParams?new kr(kr.objectify(e.messageParams)):null}))}}]),n}(pt),Ir=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).messageType=pt.MESSAGE_TYPE_ADMIN,r.message="",r.translations={},e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){this.message=String(e.message),this.translations=e.hasOwnProperty("translations")?e.translations:{}}}],[{key:"objectify",value:function(e){var t=j.get(this._iid),n=t.BaseChannel,r=t.BaseMessageParams,i=t.UserMessage,a=t.FileMessage,s=t.AdminMessage,o=t.User,l=t.ThreadInfo,u=t.OGMetaData,c=t.Reaction,d=e.messageId,h=e.messageType,f=void 0===h?pt.MESSAGE_TYPE_BASE:h,p=e.channel,g=e.message,y=e.data,m=void 0===y?"":y,_=e.customType,v=void 0===_?"":_,E=e.mentionType,b=void 0===E?r.MentionType.USERS:E,C=e.mentionedUsers,S=void 0===C?[]:C,N=e.mentionedMessageTemplate,A=void 0===N?null:N,k=e.reactions,T=void 0===k?[]:k,I=e.metaArrays,w=void 0===I?[]:I,O=e.rootMessageId,U=void 0===O?0:O,R=e.parentMessageId,M=void 0===R?0:R,L=e.parentMessageText,P=void 0===L?"":L,D=e.threadInfo,x=void 0===D?null:D,F=e.isReplyToChannel,H=void 0!==F&&F,G=e.parentMessage,z=void 0===G?null:G,B=e.translations,V=void 0===B?{}:B,q=e.silent,K=void 0!==q&&q,Q=e.ogMetaData,Y=void 0===Q?null:Q,W=e.createdAt,J=e.updatedAt,$=void 0===J?0:J,X={msg_id:d,channel_url:p.url,channel_type:p.channelType===n.CHANNEL_TYPE_OPEN?n.CHANNEL_TYPE_OPEN:n.CHANNEL_TYPE_GROUP,message:g,data:m,custom_type:v,silent:K,ts:W,updated_at:$};switch(f){case pt.MESSAGE_TYPE_USER:X.type="MESG";break;case pt.MESSAGE_TYPE_FILE:X.type="FILE";break;case pt.MESSAGE_TYPE_ADMIN:X.type="ADMM"}X.translations=V,X.mention_type=b,X.mentioned_users=S.map((function(e){return o.objectify(e)})),X.mentioned_message_template=A,X.reactions=T.map((function(e){return c.objectify(e)})),X.metaarray={};for(var Z=0;Z<w.length;Z++){var ee=w[Z].key;X.metaarray[ee]=w[Z].value}if(X.metaarray_key_order=w.map((function(e){return e.key})),X.root_message_id=U,X.parent_message_id=M,X.parent_message_text=P,x&&(X.thread_info=l.objectify(x)),X.is_reply_to_channel=H,z)switch(z.messageType){case n.MESSAGE_TYPE_USER:X.parent_message_info=i._objectifySerializedData(z);break;case n.MESSAGE_TYPE_FILE:X.parent_message_info=a._objectifySerializedData(z);break;case n.MESSAGE_TYPE_ADMIN:X.parent_message_info=s._objectifySerializedData(z)}return Y&&(X.og_tag=u.objectify(Y)),X}},{key:"build",value:function(e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,g,y,m){return this.objectify({messageId:e,channel:t,message:n,data:r,customType:i,mentionType:c,mentionedUsers:d,mentionedMessageTemplate:h,reactions:u,metaArrays:l,rootMessageId:f,parentMessageId:p,parentMessageText:g,threadInfo:y,translations:a,ogMetaData:m,createdAt:s,updatedAt:o})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).AdminMessage,n=dt.deserialize(e);return new t(this._objectifySerializedData(n))}},{key:"_objectifySerializedData",value:function(e){return j.get(this._iid).AdminMessage.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType}}))}}]),n}(pt),wr=function(){function e(t){d(this,e);var n=j.get(this._iid),r=n.BaseMessage,i=n.BaseMessageParams;this.scheduledId=0,this.scheduledDateTimeString="",this.scheduledTimezone="",this.status=e.Status.SCHEDULED,this.createdAt=0,this.updatedAt=0,this._messageType=r.MESSAGE_TYPE_BASE,this._sender=null,this._channelType="",this.channelUrl="",this.message="",this.customType="",this.data="",this.metaArrays=[],this.mentionType=i.MentionType.USERS,this.mentionedUsers=[],this.pushNotificationDeliveryOption=i.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=[],this.errorMessage="",this.errorCode=0,this.appleCriticalAlertOptions=null,t&&this._update(t)}return f(e,[{key:"sender",get:function(){var e=Pi.getInstance(this._iid),t=j.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var r=n.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.plainProfileUrl!==r.plainProfileUrl&&(this._sender.plainProfileUrl=r.plainProfileUrl),se.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"_update",value:function(t){var n=this,r=j.get(this._iid),i=r.User,a=r.Sender,s=r.BaseMessageParams,o=r.MessageMetaArray,l=r.AppleCriticalAlertOptions;this.scheduledId=t.hasOwnProperty("scheduled_id")?parseInt(t.scheduled_id):0,this.scheduledDateTimeString=t.hasOwnProperty("scheduled_dt")?String(t.scheduled_dt):"",this.scheduledTimezone=t.hasOwnProperty("scheduled_timezone")?String(t.scheduled_timezone):"",this.status=t.hasOwnProperty("status")?String(t.status):"",this.createdAt=t.hasOwnProperty("created_at")?parseInt(t.created_at):0,this.updatedAt=t.hasOwnProperty("updated_at")?parseInt(t.updated_at):0,this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this._channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):"",this._messageType=t.hasOwnProperty("type")?String(t.type):"",this._sender=t.hasOwnProperty("user")?new a(t.user):null,this.message=t.hasOwnProperty("message")?String(t.message):"",this.customType=t.hasOwnProperty("custom_type")?String(t.custom_type):"",this.data=t.hasOwnProperty("data")?String(t.data):"";var u=t.hasOwnProperty("metaarray")?t.metaarray:{},c=t.hasOwnProperty("metaarray_key_order")?t.metaarray_key_order:Object.keys(u).sort((function(e,t){return e.localeCompare(t)}));this.metaArrays=[];for(var d=0;d<c.length;d++){var h=c[d];this.metaArrays.push(new o(h,u[h]||[]))}this.mentionType=t.hasOwnProperty("mention_type")?t.mention_type:s.MentionType.USERS,this.mentionedUsers=[],t.hasOwnProperty("mentioned_users")&&t.mentioned_users.forEach((function(e){var t=new i(e);n.mentionedUsers.push(t)})),this.pushNotificationDeliveryOption=t.hasOwnProperty("push_option")?t.push_option:s.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=t.hasOwnProperty("translation_target_langs")?t.translation_target_langs:[],this.status===e.Status.FAILED&&(t.hasOwnProperty("error")&&t.error.hasOwnProperty("message")&&(this.errorMessage=String(t.error.message)),t.hasOwnProperty("error")&&t.error.hasOwnProperty("code")&&(this.errorCode=parseInt(t.error.code))),t.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new l(t.apple_critical_alert_options))}},{key:"isOpenChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_GROUP}},{key:"metaArray",get:function(){var e={};return this.metaArrays.forEach((function(t){e[t.key]=t.value})),e},set:function(e){if("object"===c(e)&&e){var t=j.get(this._iid).MessageMetaArray,n=[];Object.keys(e).forEach((function(r){n.push(new t(r,e[r]))})),this.metaArrays=n}}}],[{key:"Status",get:function(){return{SCHEDULED:"scheduled",SENT:"sent",CANCELED:"canceled",FAILED:"failed"}}}]),e}(),Or=function(){function e(){this.threadInfo=null,this.targetMessageId=0,this.channelUrl=null,this.channelType=null}return e.createFromJson=function(e){var t=j.get(this._iid),n=t.BaseChannel,r=t.ThreadInfo,i=e.thread_info,a=e.root_message_id,s=e.channel_url,o=e.channel_type;if(i&&"object"==typeof i&&("string"==typeof a||"number"==typeof a)&&"string"==typeof s&&"string"==typeof o&&[n.CHANNEL_TYPE_GROUP,n.CHANNEL_TYPE_OPEN].includes(o)){var l=new this;return l.threadInfo=new r(i),l.targetMessageId=parseInt(a+""),l.channelUrl=s,l.channelType=o,l}return null},e}(),Ur=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this.metaDataKeyFilter="",this.metaDataValuesFilter=[],this.nicknameStartsWithFilter=null,this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIdsFilter)&&"string"==typeof t.metaDataKeyFilter&&Array.isArray(t.metaDataValuesFilter)&&!!t.metaDataKeyFilter==t.metaDataValuesFilter.length>0&&("string"==typeof t.nicknameStartsWithFilter||null===t.nicknameStartsWithFilter)?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadUserList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),Rr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._isOpenChannel=!1,this._channelUrl=null,this._token="",t.channelUrl&&(this._channelUrl=t.channelUrl),t.isOpenChannel&&(this._isOpenChannel=t.isOpenChannel)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadBannedUserList(u(u({},t),{},{channelUrl:t._channelUrl,isOpenChannel:t._isOpenChannel,token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).RestrictedUser,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.banned_list.map((function(e){var t=new a(e);return t.restrictionInfo.restrictionType=a.RestrictionType.BANNED,t}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),Mr=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIdsFilter)?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadBlockedUserList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),Lr=function(){function e(){d(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasMore?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadFriendList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasMore=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),Pr=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=e.ORDER_LATEST_LAST_MESSAGE,this._token="",this._searchFilter={},this._userIdsFilter={userIds:[],includeMode:!0,queryType:e.QueryType.AND},this._userIdsExactFilter=[],this._userIdsIncludeFilter=[],this._userIdsIncludeFilterQueryType=e.QueryType.AND,this.nicknameContainsFilter="",this.nicknameStartsWithFilter="",this.nicknameExactMatchFilter="",this.channelNameContainsFilter="",this.memberStateFilter=or.MemberStateFilter.ALL,this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=or.SuperChannelFilter.ALL,this.publicChannelFilter=or.PublicChannelFilter.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=or.UnreadChannelFilter.ALL,this.metadataOrderKeyFilter=null,this.metadataKey=null,this.metadataValues=[],this.metadataValueStartsWith=null,this.hiddenChannelFilter=or.HiddenChannelFilter.UNHIDDEN,this.includeFrozen=!0,this.includeMetaData=!0}return f(e,[{key:"userIdsExactFilter",get:function(){return this._userIdsExactFilter},set:function(e){Array.isArray(e)&&(this._userIdsExactFilter=e,this._userIdsIncludeFilter=[],this._userIdsFilter.userIds=this._userIdsExactFilter,this._userIdsFilter.includeMode=!1)}},{key:"userIdsIncludeFilter",get:function(){return this._userIdsIncludeFilter},set:function(e){Array.isArray(e)&&(this._userIdsIncludeFilter=e,this._userIdsExactFilter=[],this._userIdsFilter.userIds=this._userIdsIncludeFilter,this._userIdsFilter.includeMode=!0)}},{key:"userIdsIncludeFilterQueryType",get:function(){return this._userIdsIncludeFilterQueryType},set:function(t){Object.keys(e.QueryType).map((function(t){return e.QueryType[t]})).indexOf(t)>-1&&(this._userIdsIncludeFilterQueryType=t.toUpperCase(),this._userIdsFilter.queryType=this._userIdsIncludeFilterQueryType)}},{key:"setSearchFilter",value:function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={search_query:t,search_fields:e.join(",").toLocaleLowerCase()})}},{key:"serialize",value:function(){return dt.serialize(this,(function(e){e.isLoading=!1}))}},{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid),r=n.GroupChannel,i=n.GroupChannelListQuery;!("number"==typeof t.limit&&t.limit>0&&"boolean"==typeof t.includeEmpty&&"string"==typeof t.order&&[i.ORDER_CHRONOLOGICAL,i.ORDER_LATEST_LAST_MESSAGE,i.CHANNEL_NAME_ALPHABETICAL,i.METADATA_VALUE_ALPHABETICAL].indexOf(t.order.toLowerCase())>-1&&Array.isArray(t._userIdsExactFilter)&&Array.isArray(t._userIdsIncludeFilter)&&Array.isArray(t.customTypesFilter)&&Array.isArray(t.channelUrlsFilter)&&Object.keys(i.QueryType).map((function(e){return i.QueryType[e]})).indexOf(t._userIdsIncludeFilterQueryType.toUpperCase())>-1&&Object.keys(r.MemberStateFilter).map((function(e){return r.MemberStateFilter[e]})).indexOf(t.memberStateFilter)>-1&&Object.keys(r.SuperChannelFilter).map((function(e){return r.SuperChannelFilter[e]})).indexOf(t.superChannelFilter)>-1&&Object.keys(r.PublicChannelFilter).map((function(e){return r.PublicChannelFilter[e]})).indexOf(t.publicChannelFilter)>-1&&Object.keys(r.UnreadChannelFilter).map((function(e){return r.UnreadChannelFilter[e]})).indexOf(t.unreadChannelFilter)>-1&&Object.keys(r.HiddenChannelFilter).map((function(e){return r.HiddenChannelFilter[e]})).indexOf(t.hiddenChannelFilter)>-1)||"string"!=typeof t.customTypeStartsWithFilter&&null!==t.customTypeStartsWithFilter||"string"!=typeof t.nicknameContainsFilter||"string"!=typeof t.nicknameStartsWithFilter||"string"!=typeof t.nicknameExactMatchFilter||"string"!=typeof t.channelNameContainsFilter||"string"!=typeof t.metadataOrderKeyFilter&&null!==t.metadataOrderKeyFilter||"string"!=typeof t.metadataKey&&null!==t.metadataKey||!Array.isArray(t.metadataValues)||!t.metadataValues.every((function(e){return"string"==typeof e}))||"string"!=typeof t.metadataValueStartsWith&&null!==t.metadataValueStartsWith||"boolean"!=typeof t.includeFrozen||"boolean"!=typeof t.includeMetaData?e(ve.error,null):t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadGroupChannelList(u(u({},t),{},{token:t._token,userIdsFilter:t._userIdsFilter,searchFilter:t._searchFilter})).then((function(n){var r=j.get(t._iid).GroupChannel,i=String(n.next);t._token=i,t.hasNext=!!i;var a=n.channels;if(!a||!Array.isArray(a))throw new F("Failed at loading group channels.",F.MALFORMED_DATA);var s=a.map((function(e){return"number"==typeof n.ts&&(e.ts=n.ts),r.upsert(e)}));t.isLoading=!1,e(null,s)})).catch((function(n){t.isLoading=!1,e(n,null)}))):e(null,[])}),e)}}],[{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}},{key:"QueryType",get:function(){return{AND:"AND",OR:"OR"}}},{key:"SearchField",get:function(){return{MEMBER_NICKNAME:"member_nickname",CHANNEL_NAME:"channel_name"}}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).GroupChannel,n=dt.deserialize(e),r=t.createMyGroupChannelListQuery();return Object.keys(n).forEach((function(e){r.hasOwnProperty(e)&&(r[e]=n[e])})),r}}]),e}(),Dr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.mutedMemberFilter=e.MutedMemberFilter.ALL,this.memberStateFilter=or.MemberStateFilter.ALL,this.nicknameStartsWithFilter=null,this.order=e.Order.MEMBER_NICKNAME_ALPHABETICAL,this._token="",this._channelUrl=t}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid),r=n.GroupChannel,i=n.Member,a=n.MemberListQuery;if("number"==typeof t.limit&&t.limit>0&&Object.keys(a.MutedMemberFilter).map((function(e){return a.MutedMemberFilter[e]})).indexOf(t.mutedMemberFilter)>-1&&Object.keys(r.MemberStateFilter).map((function(e){return r.MemberStateFilter[e]})).indexOf(t.memberStateFilter)>-1&&Object.keys(a.Order).map((function(e){return a.Order[e]})).indexOf(t.order)>-1&&("string"==typeof t.nicknameStartsWithFilter||null===t.nicknameStartsWithFilter))if(t.isLoading)e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else if(t.hasNext){t.isLoading=!0;var s=O.get(t._iid);t.memberStateFilter===r.MemberStateFilter.LEFT&&(t.memberStateFilter=r.MemberStateFilter.ALL),s.container.apiClient.loadMemberList(u(u({},t),{},{channelUrl:t._channelUrl,token:t._token}),(function(n,r){var a=null;if(!n){var s=String(r.next);t._token=s,t.hasNext=!!s,a=r.members.map((function(e){return new i(e)}))}t.isLoading=!1,e(n,a)}))}else e(null,[]);else e(ve.error,null)}),e)}}],[{key:"MutedMemberFilter",get:function(){return{ALL:"all",MUTED:"muted",UNMUTED:"unmuted"}}},{key:"Order",get:function(){return{MEMBER_NICKNAME_ALPHABETICAL:"member_nickname_alphabetical",OPERATOR_THEN_MEMBER_ALPHABETICAL:"operator_then_member_alphabetical"}}}]),e}(),xr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",t.channelUrl&&(this._channelUrl=t.channelUrl),t.isOpenChannel&&(this._isOpenChannel=t.isOpenChannel)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadMutedUserList(u(u({},t),{},{channelUrl:t._channelUrl,isOpenChannel:t._isOpenChannel,token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).RestrictedUser,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.muted_list.map((function(e){var t=new a(e);return t.restrictionInfo.restrictionType=a.RestrictionType.MUTED,t}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),Fr=function(){function e(){d(this,e),this.limit=20,this.isLoading=!1,this.hasNext=!0,this.nameKeyword=null,this.urlKeyword=null,this.customTypes=[],this.includeFrozen=!0,this.includeMetaData=!0}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){!("number"==typeof t.limit&&t.limit>0&&Array.isArray(t.customTypes))||"string"!=typeof t.nameKeyword&&null!==t.nameKeyword||"string"!=typeof t.urlKeyword&&null!==t.urlKeyword||"boolean"!=typeof t.includeFrozen||"boolean"!=typeof t.includeMetaData?e(ve.error,null):t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadOpenChannelList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).OpenChannel,s=String(r.next);t._token=s,t.hasNext=!!s;var o=r.channels;o&&Array.isArray(o)?i=o.map((function(e){return"number"==typeof r.ts&&(e.ts=r.ts),a.upsert(e)})):n=new F("Failed at loading open channels.",F.MALFORMED_DATA)}t.isLoading=!1,e(n,i)}))):e(null,[])}),e)}}]),e}(),Hr=new WeakMap,Gr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",Hr.set(this,t)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){if("number"==typeof t.limit&&t.limit>0)if(t.isLoading)e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else if(t.hasNext){t.isLoading=!0;var n=Hr.get(t);O.get(t._iid).container.apiClient.loadOperatorList(u(u({},t),{},{token:t._token,channelUrl:n.url,isOpenChannel:n.isOpenChannel()}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.operators.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))}else e(null,[]);else e(ve.error,null)}),e)}}]),e}(),jr=new WeakMap,zr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",t&&jr.set(this,t.channelUrl)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadParticipantList(u(u({},t),{},{channelUrl:jr.get(t),token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.participants.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),Br=new WeakMap,Vr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.limit,i=void 0===r?20:r,a=n.reverse,s=void 0!==a&&a,o=n.exactMatch,l=void 0!==o&&o,u=n.channelUrl,c=void 0===u?"":u,h=n.channelCustomType,f=void 0===h?"":h,p=n.messageTimestampFrom,g=void 0===p?null:p,y=n.messageTimestampTo,m=void 0===y?null:y,_=n.order,v=void 0===_?"score":_,E=n.advancedQuery,b=void 0!==E&&E,C=n.targetFields,S=void 0===C?null:C;d(this,e),this.isLoading=!1,this.hasNext=!0,Br.set(this,{keyword:t,limit:i,reverse:s,exactMatch:l,channelUrl:c,channelCustomType:f,messageTimestampFrom:g,messageTimestampTo:m,order:v,advancedQuery:b,targetFields:S,previousToken:"",nextToken:""})}return f(e,[{key:"key",get:function(){return Br.get(this).keyword}},{key:"limit",get:function(){return Br.get(this).limit}},{key:"reverse",get:function(){return Br.get(this).reverse}},{key:"exactMatch",get:function(){return Br.get(this).exactMatch}},{key:"channelUrl",get:function(){return Br.get(this).channelUrl}},{key:"channelCustomType",get:function(){return Br.get(this).channelCustomType}},{key:"messageTimestampFrom",get:function(){return Br.get(this).messageTimestampFrom}},{key:"messageTimestampTo",get:function(){return Br.get(this).messageTimestampTo}},{key:"order",get:function(){return Br.get(this).order}},{key:"next",value:function(e){var t=this,n=j.get(this._iid),r=n.BaseChannel,i=n.GroupChannel,a=n.OpenChannel;return le(this._iid,(function(e){var n=Br.get(t),s=n.keyword,o=n.limit,l=n.reverse,u=n.exactMatch,c=n.channelUrl,d=n.channelCustomType,h=n.messageTimestampFrom,f=n.messageTimestampTo,p=n.order,g=n.advancedQuery,y=n.targetFields,m=n.nextToken;!("number"==typeof o&&o>0&&o<=1e3&&"boolean"==typeof l&&"boolean"==typeof u)||"string"!=typeof c&&null!==c||"string"!=typeof d&&null!==d||"number"!=typeof h&&null!==h||"number"!=typeof f&&null!==f||!(["score","ts"].indexOf(p)>=0)||"boolean"!=typeof g&&null!==g||!Array.isArray(y)&&null!==y?e(ve.error,null):t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.searchMessages({keyword:s,limit:o,reverse:l,exactMatch:u,channelUrl:c,channelCustomType:d,messageTimestampFrom:h,messageTimestampTo:f,order:p,advancedQuery:g,targetFields:y,nextToken:m},(function(n,s){var o=null;n||(o=[],s.results.forEach((function(e){if(e.channel.hasOwnProperty("members")){var t=new i(e.channel);i.cachedChannels[t.url]=t,o.push(r.buildMessage(e,t))}else{var n=new a(e.channel);a.cachedChannels[n.url]=n,o.push(r.buildMessage(e,n))}})),t.hasNext=s.has_next,Br.get(t).nextToken=s.end_cursor),t.isLoading=!1,e(n,o)}))):e(null,[])}),e)}}]),e}(),qr=new WeakMap,Kr=new WeakMap,Qr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,Kr.set(this,Number.MAX_SAFE_INTEGER),qr.set(this,t),this.reverse=!1,this.messageTypeFilter=null,this.customTypeFilter=null,this.customTypesFilter=[],this.senderUserIdsFilter=[],this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.showSubchannelMessagesOnly=!1}return f(e,[{key:"load",value:function(e,t,n,r){var i=this,a=j.get(this._iid),s=a.BaseChannel,o=a.BaseMessage,l=null,u=ve.parse(arguments,[new ve({type:"number",optional:!0,defaultValue:this.limit}),new ve({type:"boolean",optional:!0,defaultValue:this.reverse}),new ve({type:["string","number"],optional:!0,defaultValue:this.messageTypeFilter,constraint:function(e){return Object.keys(s.MessageTypeFilter).map((function(e){return s.MessageTypeFilter[e]})).indexOf(e)>-1||[0,1,2,3].indexOf(e)>-1}}),new ve({type:"callback"})]),c=S(u,5);return l=c[0],e=c[1],t=c[2],n=c[3],r=c[4],le(this._iid,(function(r){if(("string"!=typeof i.customTypeFilter&&null!==i.customTypeFilter||!Array.isArray(i.customTypesFilter)||!i.customTypesFilter.every((function(e){return"string"==typeof e||null===e}))||!Array.isArray(i.senderUserIdsFilter)||!i.senderUserIdsFilter.every((function(e){return"string"==typeof e}))||"boolean"!=typeof i.includeMetaArray||null!==i.includeReaction&&"boolean"!=typeof i.includeReaction||null!==i.includeReactions&&"boolean"!=typeof i.includeReactions||"boolean"!=typeof i.includeThreadInfo||null!==i.includeReplies&&"boolean"!=typeof i.includeReplies||!(null===i.replyType||"string"==typeof i.replyType&&Object.values(o.ReplyType).includes(i.replyType))||null!==i.includeParentMessageText&&"boolean"!=typeof i.includeParentMessageText||null!==i.includeParentMessageInfo&&"boolean"!=typeof i.includeParentMessageInfo||"boolean"!=typeof i.showSubchannelMessagesOnly)&&(l=ve.error),l)r(l,null);else{if(i.limit=e,i.reverse=t,i.messageTypeFilter=n,"number"==typeof i.messageTypeFilter)switch(i.messageTypeFilter){case 0:i.messageTypeFilter=s.MessageTypeFilter.ALL;break;case 1:i.messageTypeFilter=s.MessageTypeFilter.USER;break;case 2:i.messageTypeFilter=s.MessageTypeFilter.FILE;break;case 3:i.messageTypeFilter=s.MessageTypeFilter.ADMIN}if(i.isLoading)r(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else if(i.hasMore){i.isLoading=!0;var a=qr.get(i);O.get(i._iid).container.apiClient.getMessageList({channel:a,token:Kr.get(i)||(new Date).getTime()+1e4,tokenType:"timestamp",isInclusive:!1,prevResultSize:e,nextResultSize:0,shouldReverse:t,messageType:i.messageTypeFilter,customType:i.customTypeFilter,customTypes:i.customTypesFilter,senderUserIds:i.senderUserIdsFilter,includeMetaArray:i.includeMetaArray,includeReaction:i.includeReaction,includeReactions:i.includeReactions,includeReplies:i.includeReplies,includeParentMessageText:i.includeParentMessageText,includeThreadInfo:i.includeThreadInfo,replyType:i.replyType,includeParentMessageInfo:i.includeParentMessageInfo,showSubchannelMessagesOnly:i.showSubchannelMessagesOnly}).then((function(t){var n=t.messages.map((function(e){return s.buildMessage(e,a)}));(0===n.length||n.length<e)&&(i.hasMore=!1);var o=Kr.get(i);Kr.set(i,Math.min.apply(Math,N(n.map((function(e){return e.createdAt}))).concat([o]))),i.isLoading=!1,r(null,n)})).catch((function(e){i.isLoading=!1,r(e,null)}))}else r(null,[])}}),r)}}]),e}(),Yr=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=Pr.ORDER_LATEST_LAST_MESSAGE,this._token="",this.channelNameContainsFilter="",this.channelUrlsFilter=[],this.customTypesFilter=[],this.customTypeStartsWithFilter=null,this.superChannelFilter=or.SuperChannelFilter.ALL,this.membershipFilter=e.MembershipType.JOINED,this.metadataOrderKeyFilter=null,this.metadataKey=null,this.metadataValues=[],this.metadataValueStartsWith=null,this.includeFrozen=!0,this.includeMetaData=!0}return f(e,[{key:"next",value:function(t){var n=this;return le(this._iid,(function(t){var r=j.get(n._iid).GroupChannel;!("number"==typeof n.limit&&n.limit>0&&"boolean"==typeof n.includeEmpty&&"string"==typeof n.order&&[e.ORDER_CHRONOLOGICAL,e.CHANNEL_NAME_ALPHABETICAL,e.METADATA_VALUE_ALPHABETICAL,e.ORDER_LATEST_LAST_MESSAGE].indexOf(n.order.toLowerCase())>-1&&Array.isArray(n.customTypesFilter)&&Array.isArray(n.channelUrlsFilter)&&Object.keys(e.MembershipType).map((function(t){return e.MembershipType[t]})).indexOf(n.membershipFilter)>-1&&Object.keys(r.SuperChannelFilter).map((function(e){return r.SuperChannelFilter[e]})).indexOf(n.superChannelFilter)>-1)||"string"!=typeof n.customTypeStartsWithFilter&&null!==n.customTypeStartsWithFilter||"string"!=typeof n.channelNameContainsFilter||"string"!=typeof n.metadataOrderKeyFilter&&null!==n.metadataOrderKeyFilter||"string"!=typeof n.metadataKey&&null!==n.metadataKey||!Array.isArray(n.metadataValues)||!n.metadataValues.every((function(e){return"string"==typeof e}))||"string"!=typeof n.metadataValueStartsWith&&null!==n.metadataValueStartsWith||"boolean"!=typeof n.includeFrozen||"boolean"!=typeof n.includeMetaData?t(ve.error,null):n.isLoading?t(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):n.hasNext?(n.isLoading=!0,O.get(n._iid).container.apiClient.loadPublicGroupChannelList(u(u({},n),{},{token:n._token}),(function(e,i){var a=null;if(!e){var s=String(i.next);n._token=s,n.hasNext=!!s;var o=i.channels;o&&Array.isArray(o)?a=o.map((function(e){return"number"==typeof i.ts&&(e.ts=i.ts),r.upsert(e)})):e=new F("Failed at loading group channels.",F.MALFORMED_DATA)}n.isLoading=!1,t(e,a)}))):t(null,[])}),t)}}],[{key:"MembershipType",get:function(){return{ALL:"all",JOINED:"joined"}}},{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}}]),e}(),Wr=function(){function e(){d(this,e),this.isDistinct=null,this.isSuper=null,this.isBroadcast=null,this.isPublic=null,this.channelUrl=null,this.isEphemeral=null,this.isDiscoverable=null,this.isStrict=null,this.name=null,this.data=null,this.customType=null,this.channelCover=null,this.coverUrl=null,this.coverImage=null,this.accessCode=null,this.messageSurvivalSeconds=null,this._invitedUserIds=[];var t=null;Object.defineProperty(this,"operators",{set:function(e){Array.isArray(e)&&e.filter((function(e){return e.hasOwnProperty("userId")})).length===e.length&&(t=e.map((function(e){return e.userId})))}}),Object.defineProperty(this,"operatorUserIds",{get:function(){return t},set:function(e){Array.isArray(e)&&e.filter((function(e){return"string"==typeof e})).length===e.length&&(t=e)}})}return f(e,[{key:"_validate",value:function(){return Array.isArray(this._invitedUserIds)&&this._invitedUserIds.every((function(e){return"string"==typeof e}))&&("string"==typeof this.channelUrl||null===this.channelUrl)&&("string"==typeof this.coverUrl||null===this.coverUrl)&&(se.isFile(this.coverImage)||null===this.coverImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("boolean"==typeof this.isDistinct||null===this.isDistinct)&&("boolean"==typeof this.isSuper||null===this.isSuper)&&("boolean"==typeof this.isBroadcast||null===this.isBroadcast)&&("boolean"==typeof this.isPublic||null===this.isPublic)&&("boolean"==typeof this.isEphemeral||null===this.isEphemeral)&&("boolean"==typeof this.isDiscoverable||null===this.isDiscoverable)&&("boolean"==typeof this.isStrict||null===this.isStrict)&&(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every((function(e){return"string"==typeof e}))||null===this.operatorUserIds)&&("string"==typeof this.accessCode||null===this.accessCode)&&("number"==typeof this.messageSurvivalSeconds||null===this.messageSurvivalSeconds)}},{key:"addUsers",value:function(e){if(Array.isArray(e)){var t,n=e.filter((function(e){return e.hasOwnProperty("userId")&&"string"==typeof e.userId})).map((function(e){return e.userId}));(t=this._invitedUserIds).push.apply(t,N(n))}}},{key:"addUser",value:function(e){e.hasOwnProperty("userId")&&"string"==typeof e.userId&&this._invitedUserIds.push(e.userId)}},{key:"addUserIds",value:function(e){if(Array.isArray(e)){var t,n=e.filter((function(e){return"string"==typeof e}));(t=this._invitedUserIds).push.apply(t,N(n))}}},{key:"addUserId",value:function(e){"string"==typeof e&&this._invitedUserIds.push(e)}}]),e}(),Jr=function(){function e(){d(this,e),this.channelUrl=null,this.name=null,this.coverUrlOrImage=null,this.data=null,this.customType=null,this._operatorUserIds=[]}return f(e,[{key:"operatorUserIds",get:function(){return this._operatorUserIds},set:function(e){Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))&&(this._operatorUserIds=e)}},{key:"operators",set:function(e){Array.isArray(e)&&e.every((function(e){return e.hasOwnProperty("userId")}))&&(this._operatorUserIds=e.map((function(e){return e.userId})))}},{key:"_validate",value:function(){return(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every((function(e){return"string"==typeof e}))||null===this.operatorUserIds)&&("string"==typeof this.coverUrlOrImage||se.isFile(this.coverUrlOrImage)||null===this.coverUrlOrImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("string"==typeof this.channelUrl&&/^\w+$/.test(this.channelUrl)||null===this.channelUrl)}}]),e}(),$r=function(e){g(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this)).year=null,r.month=null,r.day=null,r.hour=null,r.min=null,r.timezone=null,r._scheduledDateTimeString=null,e&&r._update(e),r}return f(n,[{key:"scheduledDateTimeString",get:function(){return this._scheduledDateTimeString?this._scheduledDateTimeString:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&this.month>=1&&this.month<=12&&"number"==typeof this.day&&this.day>=1&&this.day<=31&&"number"==typeof this.hour&&this.hour>=0&&this.hour<=24&&"number"==typeof this.min&&this.min>=0&&this.min<=60&&"string"==typeof this.timezone&&this.timezone.length>0?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2):null},set:function(e){e&&"string"==typeof e&&(this._scheduledDateTimeString=e)}},{key:"_update",value:function(e){e.hasOwnProperty("message")&&(this.message=e.message),e.hasOwnProperty("year")&&(this.year=e.year),e.hasOwnProperty("month")&&(this.month=e.month),e.hasOwnProperty("day")&&(this.day=e.day),e.hasOwnProperty("hour")&&(this.hour=e.hour),e.hasOwnProperty("min")&&(this.min=e.min),e.hasOwnProperty("timezone")&&(this.timezone=e.timezone)}},{key:"_getScheduleString",value:function(){return this.scheduledDateTimeString?this.scheduledDateTimeString+" "+this.timezone:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&this.month>=1&&this.month<=12&&"number"==typeof this.day&&this.day>=1&&this.day<=31&&"number"==typeof this.hour&&this.hour>=0&&this.hour<=24&&"number"==typeof this.min&&this.min>=0&&this.min<=60&&"string"==typeof this.timezone&&this.timezone.length>0?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2)+" "+this.timezone:null}},{key:"setSchedule",value:function(e,t,n,r,i,a){"number"==typeof e&&4===e.toString().length&&"number"==typeof t&&t>=1&&t<=12&&"number"==typeof n&&n>=1&&n<=31&&"number"==typeof r&&r>=0&&r<=24&&"number"==typeof i&&i>=0&&i<=60&&"string"==typeof a&&a.length>0&&(this.scheduledDateTimeString=e.toString()+"-"+("0"+t.toString()).substr(-2)+"-"+("0"+n.toString()).substr(-2)+" "+("0"+r.toString()).substr(-2)+":"+("0"+i.toString()).substr(-2),this.timezone=a)}}]),n}(Sr),Xr=f((function e(){d(this,e),this.channelCustomTypesFilter=[],this.superChannelFilter=or.SuperChannelFilter.ALL})),Zr=function(e){g(n,e);var t=E(n);function n(){return d(this,n),t.call(this)}return f(n)}(Xr),ei=function(e){g(n,e);var t=E(n);function n(){return d(this,n),t.call(this)}return f(n)}(Xr),ti=function(){function e(){d(this,e),this.channelUrl=null,this.channelType=null,this.messageId=0,this.includeMetaArray=!1,this.includeReactions=!1,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.includeParentMessageInfo=null}return f(e,[{key:"_validate",value:function(){var e=j.get(this._iid).BaseChannel;return"string"==typeof this.channelUrl&&"string"==typeof this.channelType&&[e.CHANNEL_TYPE_BASE,e.CHANNEL_TYPE_OPEN,e.CHANNEL_TYPE_GROUP].includes(this.channelType)&&"number"==typeof this.messageId&&"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeReactions&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)}}]),e}(),ni=function(){function e(){d(this,e);var t=j.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=t.MessageTypeFilter.ALL,this.customType=null,this.customTypes=[],this.senderUserIds=null,this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.showSubchannelMessagesOnly=!1}return f(e,[{key:"_validate",value:function(){var e=j.get(this._iid),t=e.BaseChannel,n=e.BaseMessage;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(t.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e||null===e}))&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every((function(e){return"string"==typeof e}))||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeReplies||"boolean"==typeof this.includeReplies)&&(null===this.replyType||"string"==typeof this.replyType&&Object.values(n.ReplyType).includes(this.replyType))&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.showSubchannelMessagesOnly}},{key:"belongsTo",value:function(e){var t=j.get(this._iid),n=t.BaseChannel,r=t.UserMessageParams,i=t.FileMessageParams,a=t.BaseMessage;if(this.messageType!==n.MessageTypeFilter.ALL){if(e instanceof r&&this.messageType!==n.MessageTypeFilter.USER)return!1;if(e instanceof i&&this.messageType!==n.MessageTypeFilter.FILE)return!1}if(Array.isArray(this.customTypes)&&this.customTypes.length>0&&!this.customTypes.includes(e.customType))return!1;if("string"==typeof this.customType&&this.customType!==e.customType)return!1;if(Array.isArray(this.senderUserIds)&&this.senderUserIds.length>0){var s=Pi.getInstance(e._iid);if(!s||!s.currentUser||!this.senderUserIds.includes(s.currentUser.userId))return!1}if("string"==typeof this.replyType&&e.parentMessageId){if(this.replyType===a.ReplyType.NONE)return!1;if(this.replyType===a.ReplyType.ONLY_REPLY_TO_CHANNEL&&!e.isReplyToChannel)return!1}else if(!1===this.includeReplies&&e.parentMessageId)return!1;return!0}}]),e}(),ri=function(){function e(){d(this,e);var t=j.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=t.MessageTypeFilter.ALL,this.customType=null,this.customTypes=[],this.senderUserIds=null,this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeParentMessageText=null,this.includeParentMessageInfo=null}return f(e,[{key:"_validate",value:function(){var e=j.get(this._iid).BaseChannel;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(e.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e||null===e}))&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every((function(e){return"string"==typeof e}))||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)}}]),e}(),ii=function(){function e(){d(this,e),this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null}return f(e,[{key:"_validate",value:function(){return"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeReplies||"boolean"==typeof this.includeReplies)&&(null===this.replyType||"string"==typeof this.replyType&&Object.values(BaseMessage.ReplyType).includes(this.replyType))&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)}}]),e}(),ai=function(){function e(){d(this,e),this.customTypes=[],this.includeEmpty=!1,this.includeFrozen=!0}return f(e,[{key:"_validate",value:function(){return(Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e}))||null===this.customTypes)&&("boolean"==typeof this.includeEmpty||null===this.includeEmpty)&&"boolean"==typeof this.includeFrozen}}]),e}(),si=function(){this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this.onReconnectFailed=function(){}},oi=function(){this.onFriendsDiscovered=function(){},this.onTotalUnreadMessageCountUpdated=function(){}},li=f((function e(){d(this,e),this.onMessageReceived=function(e,t){},this.onMessageUpdated=function(e,t){},this.onMessageDeleted=function(e,t){},this.onReadReceiptUpdated=function(e){},this.onReactionUpdated=function(e,t){},this.onDeliveryReceiptUpdated=function(e){},this.onTypingStatusUpdated=function(e){},this.onUserJoined=function(e,t){},this.onUserLeft=function(e,t){},this.onOperatorUpdated=function(e,t){},this.onUserEntered=function(e,t){},this.onUserExited=function(e,t){},this.onUserMuted=function(e,t){},this.onUserUnmuted=function(e,t){},this.onUserBanned=function(e,t){},this.onUserUnbanned=function(e,t){},this.onChannelFrozen=function(e){},this.onChannelUnfrozen=function(e){},this.onChannelChanged=function(e){},this.onChannelDeleted=function(e,t){},this.onUserReceivedInvitation=function(e,t,n){},this.onUserDeclinedInvitation=function(e,t,n){},this.onMetaDataCreated=function(e,t){},this.onMetaDataUpdated=function(e,t){},this.onMetaDataDeleted=function(e,t){},this.onMetaCountersCreated=function(e,t){},this.onMetaCountersUpdated=function(e,t){},this.onMetaCountersDeleted=function(e,t){},this.onChannelHidden=function(e){},this.onMentionReceived=function(e,t){},this.onThreadInfoUpdated=function(e,t){},this.onChannelMemberCountChanged=function(e){},this.onChannelParticipantCountChanged=function(e){}})),ui=f((function e(t){if(d(this,e),t){var n=j.get(this._iid),r=n.User,i=n.BaseChannel;this.reader=new r(t.user),this.timestamp=parseInt(t.ts),this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this.channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):i.CHANNEL_TYPE_GROUP}})),ci=function(){function e(e){this.replyCount=0,this.mostRepliedUsers=[],this.lastRepliedAt=0,this.updatedAt=0,e&&this._update(e)}return e.objectify=function(e){var t=j.get(this._iid).User,n=e.replyCount,r=void 0===n?0:n,i=e.mostRepliedUsers,a=void 0===i?[]:i,s=e.lastRepliedAt,o=void 0===s?0:s,l=e.updatedAt,u=void 0===l?0:l,c={};return c.reply_count=r,Array.isArray(a)&&a.every((function(e){return e instanceof t}))&&(c.most_replies=a.map((function(e){return t.objectify(e)}))),c.last_replied_at=o,c.updated_at=u,c},e.build=function(e,t,n,r){return this.objectify({replyCount:e,mostRepliedUsers:t,lastRepliedAt:n,updatedAt:r})},e.prototype._update=function(e){var t=j.get(this._iid).User;e.hasOwnProperty("reply_count")&&(this.replyCount=parseInt(e.reply_count)),e.hasOwnProperty("most_replies")&&Array.isArray(e.most_replies)&&e.most_replies.every((function(e){return"object"==typeof e}))&&(this.mostRepliedUsers=e.most_replies.map((function(e){return new t(e)}))),e.hasOwnProperty("last_replied_at")&&(this.lastRepliedAt=parseInt(e.last_replied_at)),e.hasOwnProperty("updated_at")&&(this.updatedAt=parseInt(e.updated_at))},e}(),di=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e&&this._update(e)}return e.objectify=function(e){var t=j.get(this._iid).OGImage,n=e.title,r=void 0===n?null:n,i=e.url,a=void 0===i?null:i,s=e.description,o=void 0===s?null:s,l=e.defaultImage,u=void 0===l?null:l,c={};return c["og:title"]=r,c["og:url"]=a,c["og:description"]=o,u&&(c["og:image"]=t.objectify(u)),c},e.prototype._update=function(e){var t=j.get(this._iid).OGImage;e.hasOwnProperty("og:title")&&(this.title=e["og:title"]),e.hasOwnProperty("og:url")&&(this.url=e["og:url"]),e.hasOwnProperty("og:description")&&(this.description=e["og:description"]),e.hasOwnProperty("og:image")&&(this.defaultImage=new t(e["og:image"]))},e}(),hi=function(){function e(e){this.url=null,this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,e&&this._update(e)}return e.objectify=function(e){var t=e.url,n=void 0===t?null:t,r=e.secureUrl,i=void 0===r?null:r,a=e.type,s=void 0===a?null:a,o=e.width,l=void 0===o?0:o,u=e.height,c=void 0===u?0:u,d=e.alt,h=void 0===d?null:d,f={};return f.url=n,f.secure_url=i,f.type=s,f.width=l,f.height=c,f.alt=h,f},e.prototype._update=function(e){e.hasOwnProperty("url")&&(this.url=e.url),e.hasOwnProperty("secure_url")&&(this.secureUrl=e.secure_url),e.hasOwnProperty("type")&&(this.type=e.type),e.hasOwnProperty("width")&&(this.width=parseInt(e.width)),e.hasOwnProperty("height")&&(this.height=parseInt(e.height)),e.hasOwnProperty("alt")&&(this.alt=e.alt)},e}(),fi=function(){function e(e){this.type=null,this.vendor=null,this.detail={},e&&this._update(e)}return e.objectify=function(e){var t=e.type,n=void 0===t?"":t,r=e.vendor,i=void 0===r?"":r,a=e.detail,s=void 0===a?{}:a,o={};return o.type=n,o.vendor=i,o.detail=s,o},e.prototype._update=function(e){this.type=e.hasOwnProperty("type")?e.type:"",this.vendor=e.hasOwnProperty("vendor")?e.vendor:"",e.hasOwnProperty("detail")&&"object"==typeof e.detail&&!Array.isArray(e.detail)&&(this.detail=e.detail)},e}(),pi=function(){function e(t){d(this,e),this.restrictionType=null,this.description=null,this.endAt=-1,t&&this._update(t)}return f(e,[{key:"_update",value:function(e){e.hasOwnProperty("restriction_type")&&(this.restrictionType=e.restriction_type),e.hasOwnProperty("description")?this.description=e.description:e.hasOwnProperty("muted_description")&&(this.description=e.muted_description),e.hasOwnProperty("end_at")?this.endAt=parseInt(e.end_at):e.hasOwnProperty("muted_end_at")&&(this.endAt=parseInt(e.muted_end_at))}}],[{key:"objectify",value:function(e){var t=e.restrictionType,n=void 0===t?null:t,r=e.description,i=void 0===r?null:r,a=e.endAt,s=void 0===a?-1:a,o={};return o.restriction_type=n,o.description=i,o.end_at=s,o}}]),e}(),gi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIds=t,this.metaDataKey="",this.metaDataValues=[],this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIds)&&"string"==typeof t.metaDataKey&&Array.isArray(t.metaDataValues)&&!!t.metaDataKey==t.metaDataValues.length>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,O.get(t._iid).container.apiClient.loadUserList(u(u({},t),{},{userIdsFilter:t.userIds,metaDataKeyFilter:t.metaDataKey,metaDataValuesFilter:t.metaDataValues,token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ve.error,null)}),e)}}]),e}(),yi=new WeakMap,mi=function(){function e(t){d(this,e),this.isLoading=!1,yi.set(this,t)}return f(e,[{key:"prev",value:function(e,t,n,r){var i=arguments,a=this;return le(this._iid,(function(r){var s,o=j.get(a._iid).BaseChannel,l=S(ve.parse(i,[new ve({type:"number"}),new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"function"})]),5);if(s=l[0],e=l[1],t=l[2],n=l[3],r=l[4],s)r(s,null);else if(a.isLoading)r(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else{a.isLoading=!0;var u=yi.get(a);O.get(a._iid).container.apiClient.getMessageList({channelUrl:u.url,channelType:u.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:t,nextResultSize:0,shouldReverse:n,messageType:"",customType:""}).then((function(e){var t=e.messages.map((function(e){return o.buildMessage(e,u)}));a.isLoading=!1,r(null,t)})).catch((function(e){a.isLoading=!1,r(e,null)}))}}),r)}},{key:"next",value:function(e,t,n,r){var i=arguments,a=this;return le(this._iid,(function(r){var s,o=j.get(a._iid).BaseChannel,l=S(ve.parse(i,[new ve({type:"number"}),new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"function"})]),5);if(s=l[0],e=l[1],t=l[2],n=l[3],r=l[4],s)r(s,null);else if(a.isLoading)r(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else{a.isLoading=!0;var u=yi.get(a);O.get(a._iid).container.apiClient.getMessageList({channelUrl:u.url,channelType:u.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:0,nextResultSize:t,shouldReverse:n,messageType:"",customType:""}).then((function(e){var t=e.messages.map((function(e){return o.buildMessage(e,u)}));a.isLoading=!1,r(null,t)})).catch((function(e){a.isLoading=!1,r(e,null)}))}}),r)}},{key:"load",value:function(e,t,n,r,i){var a=arguments,s=this;return le(this._iid,(function(i){var o,l=j.get(s._iid).BaseChannel,u=S(ve.parse(a,[new ve({type:"number"}),new ve({type:"number"}),new ve({type:"number"}),new ve({type:"boolean"}),new ve({type:"callback"})]),6);if(o=u[0],e=u[1],t=u[2],n=u[3],r=u[4],i=u[5],o)i(o,null);else if(s.isLoading)i(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else{s.isLoading=!0;var c=yi.get(s);O.get(s._iid).container.apiClient.getMessageList({channelUrl:c.url,channelType:c.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:t,nextResultSize:n,shouldReverse:r,messageType:"",customType:""}).then((function(e){var t=e.messages.map((function(e){return l.buildMessage(e,c)}));s.isLoading=!1,i(null,t)})).catch((function(e){s.isLoading=!1,i(e,null)}))}}),i)}}]),e}(),_i=0,vi=1,Ei=2,bi=function(){function e(t){var n=this;d(this,e),this.state=_i,this._value=null,this._reason=null;var r=function(e){n.state===_i&&(n.state=Ei,n._reason=e)};if("function"!=typeof t)throw"Promise resolver ".concat(t," is not a function");try{t((function(e){n.state===_i&&(n.state=vi,n._value=e)}),r)}catch(e){r(e)}}return f(e,[{key:"length",get:function(){return 1}},{key:"then",value:function(t,n){var r=this,i=this;switch(this.state){case _i:setTimeout((function(){return r.then(t,n)}),2);break;case vi:t&&"function"==typeof t&&(i=t(this._value));break;case Ei:n&&"function"==typeof n&&(i=n(this._reason))}return i instanceof e?i:this}},{key:"catch",value:function(t){var n=this,r=this;switch(this.state){case _i:setTimeout((function(){return n.catch(t)}),2);break;case vi:break;case Ei:r=t(this._reason)}return r instanceof e?r:this}},{key:"finally",value:function(t){var n=this,r=this;switch(this.state){case _i:setTimeout((function(){return n.finally(t)}),2);break;case vi:case Ei:r=t()}return r instanceof e?r:this}}],[{key:"all",value:function(t){return new e((function(n,r){if(Array.isArray(t)||"string"==typeof t)if(t.length>0){for(var i=[],a=0;a<t.length;a++)t[a]instanceof e?i.push(t[a]):i.push(e.resolve(t[a]));var s=new Array(i.length).fill(null),o=i.length,l=function(e,t,i){t?r(t):(o--,s[e]=i,o<=0&&n(s))};i.forEach((function(e,t){e.then((function(e){l(t,null,e)})).catch((function(e){l(t,e,null)}))}))}else n([]);else r(new Error("Uncaught (in promise) TypeError: ".concat(c(t)," ").concat(t," is not iterable")))}))}},{key:"resolve",value:function(t){return new e((function(n,r){t instanceof e?t.then((function(t){return e.resolve(t)})).catch((function(e){return r(e)})):n(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}}]),e}(),Ci=function(){"undefined"!=typeof Promise&&Promise.prototype.finally||("undefined"!=typeof window?window.Promise=bi:"undefined"!=typeof n.g?n.g.Promise=bi:"undefined"!=typeof self?self.Promise=bi:"undefined"!=typeof globalThis&&(globalThis.Promise=bi)),Object.values||(Object.values=function(e){return Object.keys(e).map((function(t){return e[t]}))}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{value:Math.pow(2,53)-1})},Si="collection@semaphore_holders_for:",Ni="collection@semaphore_resolvers_for:",Ai="collection@semaphore_chain_process_state_for:",ki=new Map,Ti=new Map,Ii=new Map,wi=function(){function e(t){var n=t.key,r=t.concurrentCallLimit,i=void 0===r?2:r,a=t.backOffDelay,s=void 0===a?0:a,o=this;this._holdersKey=e.createSemaphoreHoldersKey(n),this._resolversKey=e.createSemaphoreResolversKey(n),this._chainProcessStateKey=e.createChainProcessStateKey(n),this._numLocks=i,this._backOffDelay=s,this._localAcquiredKeys=[],this._localResolversData=[],ee()?(ki[this._holdersKey]||(ki[this._holdersKey]=[]),Ti[this._resolversKey]||(Ti[this._resolversKey]=[])):(window.addEventListener("storage",(function(e){return L(o,void 0,void 0,(function(){var t,n;return P(this,(function(r){if(this._localResolversData.length>0&&this.numLocksAvailable>0&&!this._isProcessChainAcquireRunning()&&this._hasHighestPriorityResolver())switch(e.key){case this._holdersKey:if(t=JSON.parse(e.oldValue),n=JSON.parse(e.newValue),!t||!n||n.length>=t.length)return[2];this._processChainResolve();break;case this._chainProcessStateKey:if(JSON.parse(e.newValue))return[2];this._processChainResolve();break;default:return[2]}return[2]}))}))})),window.addEventListener("beforeunload",(function(){var e=o._getLocalResolversData(),t=o._localResolversData.map((function(e){return e.key})),n=e.filter((function(e){return t.indexOf(e.key)<0}));n.length>0?window.localStorage.setItem(o._resolversKey,JSON.stringify(n)):window.localStorage.removeItem(o._resolversKey),o._localAcquiredKeys.forEach((function(e){return o.release(e)}))})))}return e.createSemaphoreHoldersKey=function(e){return Si+e},e.createSemaphoreResolversKey=function(e){return Ni+e},e.createChainProcessStateKey=function(e){return Ai+e},e.removeAllSemaphoreKeys=function(){if("undefined"!=typeof document&&"undefined"!=typeof navigator&&"undefined"!=typeof localStorage){for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n.startsWith(Si)||n.startsWith(Ni)||n.startsWith(Ai))&&e.push(n)}for(t=0;t<e.length;t++)localStorage.removeItem(e[t])}},Object.defineProperty(e.prototype,"numLocks",{get:function(){return this._numLocks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backOffDelay",{get:function(){return this._backOffDelay},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numLocksAvailable",{get:function(){if(ee())return this.numLocks-ki[this._holdersKey].length;var e=this._getLocalHoldersData();return this.numLocks-e.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waitCount",{get:function(){return ee()?Ti[this._resolversKey].length:this._getLocalResolversData().length},enumerable:!1,configurable:!0}),e.prototype._hasHighestPriorityResolver=function(){var e=this._getLocalResolversData();return e.length>0&&this._localResolversData.map((function(e){return e.key})).indexOf(e[0].key)>=0},e.prototype._isProcessChainAcquireRunning=function(){if(ee())return Ii[this._chainProcessStateKey];var e=window.localStorage[this._chainProcessStateKey];return void 0!==e&&JSON.parse(e)},e.prototype._setProcessChainAcquireRunning=function(e){ee()?Ii[this._chainProcessStateKey]=e:e?window.localStorage.setItem(this._chainProcessStateKey,JSON.stringify(e)):window.localStorage.removeItem(this._chainProcessStateKey)},e.prototype._processChainResolve=function(){return L(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return this.waitCount>0&&this.numLocksAvailable>0&&!this._isProcessChainAcquireRunning()?(this._setProcessChainAcquireRunning(!0),this._tryResolve()?[4,we(this._backOffDelay)]:[3,2]):[3,3];case 1:t.sent(),t.label=2;case 2:this._setProcessChainAcquireRunning(!1),ee()?this._processChainResolve():(e=new StorageEvent("storage",{key:this._chainProcessStateKey,oldValue:JSON.stringify(!0),newValue:JSON.stringify(!1)}),dispatchEvent(e)),t.label=3;case 3:return[2]}}))}))},e.prototype.acquire=function(e){return void 0===e&&(e=St.BACKGROUND_SYNC_CLOSE),L(this,void 0,void 0,(function(){var t,n=this;return P(this,(function(r){return ee()?[2,new Promise((function(t){var r={key:Oe(),resolver:function(e){return t(e)},priority:e};switch(e){case St.USER_CALL:case St.FILL:case St.BACKGROUND_SYNC_OPEN:for(var i=Ti[n._resolversKey],a=-1,s=0;s<i.length&&a<0;s++)e>i[s].priority&&(a=s);if(a>=0){Ti[n._resolversKey].splice(a,0,r);break}case St.BACKGROUND_SYNC_CLOSE:Ti[n._resolversKey].push(r)}n._processChainResolve()}))]:(t=this._getLocalResolversData(),[2,new Promise((function(r){var i=Oe(),a={key:i,priority:e},s={key:i,resolver:function(e){return r(e)},priority:e};switch(e){case St.USER_CALL:case St.FILL:case St.BACKGROUND_SYNC_OPEN:for(var o=-1,l=0;l<t.length&&o<0;l++)e>t[l].priority&&(o=l);if(o>=0){t.splice(o,0,a),window.localStorage.setItem(n._resolversKey,JSON.stringify(t)),n._localResolversData.splice(o,0,s);break}case St.BACKGROUND_SYNC_CLOSE:t.push(a),window.localStorage.setItem(n._resolversKey,JSON.stringify(t)),n._localResolversData.push(s)}n._processChainResolve()}))])}))}))},e.prototype.release=function(e){if(ee()){if((t=ki[this._holdersKey].indexOf(e))>=0)return ki[this._holdersKey].splice(t,1),this._processChainResolve(),!0}else{var t,n=JSON.parse(window.localStorage[this._holdersKey]),r=D([],n,!0);if((t=n.indexOf(e))>=0){n.splice(t,1),n.length>0?window.localStorage.setItem(this._holdersKey,JSON.stringify(n)):window.localStorage.removeItem(this._holdersKey),this._localAcquiredKeys.splice(this._localAcquiredKeys.indexOf(e),1);var i=new StorageEvent("storage",{key:this._holdersKey,oldValue:JSON.stringify(r),newValue:JSON.stringify(n)});return dispatchEvent(i),!0}}return!1},e.prototype._tryResolve=function(){if(ee()){if(ki[this._holdersKey].length<this.numLocks){var e=Oe();return ki[this._holdersKey]=D(D([],ki[this._holdersKey],!0),[e],!1),(n=Ti[this._resolversKey].shift()).resolver(e),!0}}else{var t=this._getLocalHoldersData();if(t.length<this.numLocks){e=Oe();var n=this._localResolversData.shift(),r=this._getLocalResolversData(),i=r.map((function(e){return e.key})).indexOf(n.key);r.splice(i,1),r.length>0?window.localStorage.setItem(this._resolversKey,JSON.stringify(r)):window.localStorage.removeItem(this._resolversKey),window.localStorage.setItem(this._holdersKey,JSON.stringify(D(D([],t,!0),[e],!1))),this._localAcquiredKeys.push(e);var a=new StorageEvent("storage",{key:this._holdersKey,oldValue:JSON.stringify(D([],t,!0)),newValue:JSON.stringify(D(D([],t,!0),[e],!1))});return dispatchEvent(a),(0,n.resolver)(e),!0}}return!1},e.prototype._getLocalHoldersData=function(){var e=window.localStorage[this._holdersKey];return void 0!==e?JSON.parse(e):[]},e.prototype._getLocalResolversData=function(){var e=window.localStorage[this._resolversKey];return void 0!==e?JSON.parse(e):[]},e}(),Oi=3e5,Ui=null,Ri={},Mi=!1,Li=null,Pi=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),Ci();var r=!1;if((n.newInstance||!Ui||Ui&&n.appId!==Ui.getApplicationId()&&Ui.getConnectionState()===Ui.ConnectionState.CLOSED)&&(r=!0,Ui=this),r){try{if(!n.hasOwnProperty("appId"))return $.warn("Must be set appId."),Ui=null,null}catch(e){return $.warn("Must be set appId."),Ui=null,null}var i=Xn.create();Object.defineProperty(this,"_iid",{get:function(){return i}}),Ri[i]=this,this.customApiHost=null,this.customWsHost=null,this.connecting=!1,this.reconnecting=!1,this.isReconnectingOnError=!1,this.connectionCallbacks=[],this.ConnectionManager=new Ee(this),this.GCMPushToken="",this.APNSPushToken="",this.PUSH_TEMPLATE_DEFAULT="default",this.PUSH_TEMPLATE_ALTERNATIVE="alternative",this.currentUser=null,this.isSessionOpened=!1,this.globalTimer,this.loginTimer,this.reconnectTimer,this.loginHandler=null,this.onLoginTimerCancel,this.onReconnectTimerCancel,this.BaseChannel={MessageTypeFilter:Mt.MessageTypeFilter},this.GroupChannelFilter=Zn,this.MessageFilter=tt,this.GroupChannelCollection={GroupChannelOrder:Le},this.MessageCollection={MessageCollectionInitPolicy:ot},this.CollectionEventSource=he,this._currentUserId=null;var a={User:gt,Member:lr,RestrictedUser:cr,GroupChannel:or,OpenChannel:mr,UserMessage:Ar,FileMessage:Tr,AdminMessage:Ir,GroupChannelListQuery:Pr,MemberListQuery:Dr,GroupChannelParams:Wr,OpenChannelParams:Jr,BaseMessageParams:Cr,UserMessageParams:Sr,FileMessageParams:kr,ScheduledUserMessageParams:$r,GroupChannelTotalUnreadMessageCountParams:Zr,GroupChannelTotalUnreadChannelCountParams:ei,MessageRetrievalParams:ti,MessageListParams:ni,ThreadedMessageListParams:ri,MessageChangeLogsParams:ii,GroupChannelChangeLogsParams:ai,MessageMetaArray:Er,UserEventHandler:oi,SessionHandler:be,ChannelHandler:li,ConnectionHandler:si,AppleCriticalAlertOptions:vr},s={SessionManager:Ce,BaseChannel:Mt,BaseMessage:pt,UserListQuery:gi,ApplicationUserListQuery:Ur,BannedUserListQuery:Rr,BlockedUserListQuery:Mr,FriendListQuery:Lr,MutedUserListQuery:xr,OpenChannelListQuery:Fr,OperatorListQuery:Gr,ParticipantListQuery:zr,MessageListQuery:mi,PreviousMessageListQuery:Qr,MessageSearchQuery:Vr,PublicGroupChannelListQuery:Yr,ScheduledUserMessage:wr,ThreadInfo:ci,ThreadInfoUpdateEvent:Or,OGMetaData:di,OGImage:hi,Plugin:fi,Command:Ae,Sender:ur,ReadStatus:ui,Reaction:Nr,ReactionEvent:ut,Emoji:fr,EmojiCategory:hr,EmojiContainer:dr,RestrictionInfo:pi,FileMessageQueue:Gt},o=new j(this._iid,u(u({},a),s));this.BaseMessage={ReplyType:pt.ReplyType,getMessage:o.BaseMessage.getMessage.bind(o.BaseMessage)},Object.keys(o).forEach((function(e){a[e]&&(t[e]=o[e])}));var l={encrypt:function(e){return e},decrypt:function(e){return e}};O.create(i,{appId:n.appId,pinger:new Z(this),apiClient:new ce(this),wsAdapter:new _e(this),commandHandler:new Dt(this),onlineDetector:new Se(this),ackStateMap:{},subscribedUnreadMessageCount:{all:0,custom_types:{},ts:0},maxUnreadCountOfSuperGroupChannel:I.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,nestdb:null,currentUserId:null,localCacheEnabled:"boolean"==typeof n.localCacheEnabled&&n.localCacheEnabled,localCacheLock:new X,debugCache:!1,encryption:l,store:new Fn({encryption:l}),preference:null,auth:new H,appInfo:null,pingInterval:15e3,pongTimeout:5e3,connectedAt:0,extensions:{},supportedExtensionKeys:["sb_uikit","sb_syncmanager","device-os-platform"],getUserAgentWithExtensions:function(e){var t=ee()?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):"";return"".concat(t,"/c").concat(I.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},sessionManager:new o.SessionManager(this),stateChangeEnabled:!0,isInBackground:!1,closedByGoingBackground:!1,isErrorFirstInCallback:!1,autoResendQueue:[],isProcessingAutoResend:!1}),this.userEventHandlers={},this.channelHandlers={},this.connectionHandlers={},this.Options={_useMemberAsMessageSender:!0,get UseMemberAsMessageSender(){return this._useMemberAsMessageSender},set UseMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},get useMemberAsMessageSender(){return this._useMemberAsMessageSender},set useMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},_typingIndicatorThrottle:1e3,get typingIndicatorThrottle(){return this._typingIndicatorThrottle},set typingIndicatorThrottle(e){"number"==typeof e&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},_websocketResponseTimeout:1e4,get websocketResponseTimeout(){return this._websocketResponseTimeout},set websocketResponseTimeout(e){"number"==typeof e&&e>=5e3&&e<=Oi&&(this._websocketResponseTimeout=e)}},pe.of(i).addObserver({onConnect:function(){t.isCacheEnabled&&!t.getIsProcessingAutoResend()&&(0===t.getAutoResendQueue().length?wt._processAutoResendRegisteredPendingMessages(t).then((function(){wt._processNextAutoResend(t)})):wt._processNextAutoResend(t))},onDisconnect:function(){}})}return Ui}return f(e,[{key:"ConnectionState",get:function(){return{CONNECTING:"CONNECTING",OPEN:"OPEN",CLOSED:"CLOSED"}}},{key:"MessageRequestState",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",SUCCEEDED:"succeeded"}}},{key:"MessageSendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"pushTokenRegistrationState",get:function(){return{SUCCESS:"success",PENDING:"pending",ERROR:"error"}}},{key:"PushTriggerOption",get:function(){return{ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"appInfo",get:function(){return O.get(this._iid).container.appInfo}},{key:"isCacheEnabled",get:function(){return O.get(this._iid).container.localCacheEnabled}},{key:"ekey",get:function(){var e=O.get(this._iid).container.auth;return e?e.eKey:""}},{key:"getApplicationId",value:function(){return O.get(this._iid).get("appId")}},{key:"getCurrentUserId",value:function(){return this.currentUser?this.currentUser.userId:null}},{key:"getDebugMode",value:function(){return Mi}},{key:"setDebugMode",value:function(e){Mi=e,$.mode=e?$.Mode.DEBUG:$.Mode.PRODUCTION}},{key:"getErrorFirstCallback",value:function(){return O.get(this._iid).container.isErrorFirstInCallback}},{key:"setErrorFirstCallback",value:function(e){"boolean"==typeof e&&O.get(this._iid).set("isErrorFirstInCallback",e)}},{key:"getAutoResendQueue",value:function(){return O.get(this._iid).container.autoResendQueue}},{key:"getIsProcessingAutoResend",value:function(){return O.get(this._iid).container.isProcessingAutoResend}},{key:"setIsProcessingAutoResend",value:function(e){O.get(this._iid).set("isProcessingAutoResend",e)}},{key:"getCurrentApiHost",value:function(){return this.customApiHost?this.customApiHost:"https://api.sendbird.com"}},{key:"clearCurrentApiHost",value:function(){this.customApiHost=null}},{key:"getCurrentWsHost",value:function(){return this.customWsHost?this.customWsHost:"wss://ws.sendbird.com"}},{key:"clearCurrentWsHost",value:function(){this.customWsHost=null}},{key:"getConnectionState",value:function(){try{var e=O.get(this._iid).container.wsAdapter;return this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:e.client?this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:this.isSessionOpened?e.client.getConnectionState():this.ConnectionState.CLOSED:this.ConnectionState.CLOSED}catch(e){return this.ConnectionState.CLOSED}}},{key:"getPendingGCMToken",value:function(){return this.GCMPushToken}},{key:"getPendingAPNSToken",value:function(){return this.APNSPushToken}},{key:"hasLoggedIn",value:function(){var e=O.get(this._iid);return this.currentUser&&e.get("auth").hasSession()}},{key:"getLastConnectedAt",value:function(){var e=O.get(this._iid);return this.getConnectionState()===this.ConnectionState.OPEN&&this.currentUser?e.get("connectedAt"):0}},{key:"setOnlineListener",value:function(e){O.get(this._iid).container.onlineDetector.setOnlineListener(e)}},{key:"setOfflineListener",value:function(e){O.get(this._iid).container.onlineDetector.setOfflineListener(e)}},{key:"getMemoryStoreForDebugging",value:function(){var e=O.get(this._iid);return e.container.debugCache&&e.container.store instanceof Dn?e.container.store:null}},{key:"useMemoryAsDatabaseForDebugging",value:function(){var e=O.get(this._iid);e.container.debugCache=!0,e.container.store=new Dn}},{key:"useAsyncStorageAsDatabase",value:function(e){var t=O.get(this._iid);t.container.store=new Hn({AsyncStorage:e,encryption:t.container.encryption})}},{key:"useMMKVAsDatabase",value:function(e){var t=O.get(this._iid);t.container.store=new Gn({MMKV:e,encryption:t.container.encryption})}},{key:"initializeDatabase",value:function(e,t){var n=this,r=O.get(this._iid),i=r.container,a=i.appId,s=i.nestdb,o=i.store,l=i.localCacheEnabled;return le(this._iid,(function(t){if(l)if(s)t(null);else{var i=r.container.nestdb=new $n({name:"sendbird=".concat(a,"-").concat(e,".db"),version:1,store:o});i.on("upgrade",(function(e,t){0===e?i.commitSchema([{collectionName:"GroupChannel",keyName:"url",index:[Qe.NAME_ALPHABETICAL,Qe.CHRONOLOGICAL,Qe.LATEST_LAST_MESSAGE]},{collectionName:"SucceededMessage",keyName:"messageId",index:[Ye.LATEST,Ye.CHILD_MESSAGE_FIRST]},{collectionName:"UnsentMessage",keyName:"reqId",index:[Ye.LATEST_UNSENT,Ye.CHILD_MESSAGE_FIRST]}]).then((function(){return t()})).catch((function(e){throw e})):t()})),i.on("error",(function(e){e?e.code===jt.STORE_NOT_AVAILABLE||e.code===jt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING?t(null):($.error("Database initialize failed with an error: ",e),t(e)):t(null)})),i.on("success",(function(){r.container.currentUserId=e,new et({iid:n._iid,collection:i.collection("GroupChannel")}),new lt({iid:n._iid,collections:{succeeded:i.collection("SucceededMessage"),unsent:i.collection("UnsentMessage")}}),$.debug("Database initialize succeeded."),t(null)})),i.open()}else r.container.currentUserId=e,new et({iid:n._iid,collection:null}),new lt({iid:n._iid,collections:{succeeded:null,unsent:null}}),t(null)}),t)}},{key:"clearCachedData",value:function(){var e=O.get(this._iid),t=e.container,n=t.localCacheEnabled,r=t.nestdb;return new Promise((function(t,i){n&&r?(r.close(),r.reset().then((function(){$.debug("Database clear succeeded."),e.container.nestdb=null,t()})).catch((function(e){$.error("Database clear failed with an error: ",e),i(e)}))):t()}))}},{key:"connect",value:function(e,t,n,r,i){var a=this,s=O.get(this._iid),o=s.container,l=o.wsAdapter,u=o.onlineDetector,c=o.localCacheEnabled;wi.removeAllSemaphoreKeys(),u&&u.start();var d=null,h=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||3===e.length}}),new ve({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new ve({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new ve({type:"callback"})]),f=S(h,6);return d=f[0],e=f[1],t=f[2],n=f[3],r=f[4],i=f[5],(n||r)&&$.debug("Please note that apiHost and wsHost are for internal use only."),le(this._iid,(function(i){if(d)i(d,null);else if(a.customApiHost=n,a.customWsHost=r,a.connecting=!0,a.reconnecting=!1,a.isReconnectingOnError=!1,a.reconnectTimer&&(clearTimeout(a.reconnectTimer),a.reconnectTimer=null,a.onReconnectTimerCancel=null),a.getConnectionState()===a.ConnectionState.OPEN&&a.currentUser&&a.currentUser.userId===e)a.connecting=!1,i(null,a.currentUser);else if(c&&(a._currentUserId=e),a.connectionCallbacks.push(i),1===a.connectionCallbacks.length){l.disconnect({clearSession:!0,err:null},null);var o=s.container,u=o.nestdb,h=o.localCacheLock;u?l.connect(e,t).then((function(){if(c)return wt._processNonAutoResendRegisteredPendingMessages(a)})):h.lock((function(n){a.initializeDatabase(e).then((function(){n(),l.connect(e,t)})).then((function(){if(c)return wt._processNonAutoResendRegisteredPendingMessages(a)})).catch((function(e){s.container.localCacheEnabled=!1,n(),i(e,null)}))}))}}),i)}},{key:"reconnect",value:function(){var e=this,t=O.get(this._iid).container,n=t.wsAdapter,r=t.auth,i=t.localCacheLock;if(r.sessionKey&&this.currentUser){var a=!0;return n.reconnectCount>0&&(a=!1),i.lock((function(t){n.disconnect({clearSession:!1,err:new F("Connection has been canceled.",F.CONNECTION_CANCELED)},null),n.reconnectCount=0,n.reconnect(e.currentUser.userId,a),t()})),!0}return!1}},{key:"disconnect",value:function(e){var t=this;return le(this._iid,(function(e){var n=O.get(t._iid).container,r=n.localCacheLock,i=n.wsAdapter,a=n.onlineDetector;a&&a.stop(),r.lock((function(n){i.disconnect({clearSession:!0,err:new F("Connection has been canceled.",F.CONNECTION_CANCELED)},(function(){t.clearCachedData().finally((function(){n(),e(null)}))}))}))}),e)}},{key:"setBackgroundState",value:function(){var e=O.get(this._iid),t=e.container,n=t.wsAdapter,r=t.stateChangeEnabled;!t.isInBackground&&r&&(e.set("isInBackground",!0),this.getConnectionState()!==this.ConnectionState.CLOSED?(e.set("closedByGoingBackground",!0),n.disconnect({clearSession:!1,err:new F("Websocket connection failed as the app goes background.",F.WEBSOCKET_CONNECTION_FAILED)},null),pe.of(this._iid).invokeDisconnect()):e.set("closedByGoingBackground",!1))}},{key:"isInBackground",get:function(){return O.get(this._iid).container.isInBackground}},{key:"setForegroundState",value:function(){var e=O.get(this._iid),t=e.container,n=t.wsAdapter,r=t.stateChangeEnabled,i=t.isInBackground,a=t.closedByGoingBackground;i&&r&&(e.set("isInBackground",!1),a&&this.currentUser&&n.reconnect(this.currentUser.userId,!0))}},{key:"enableStateChange",value:function(){O.get(this._iid).set("enableStateChange",!0)}},{key:"disableStateChange",value:function(){O.get(this._iid).set("enableStateChange",!1)}},{key:"addExtension",value:function(e,t){var n=O.get(this._iid).container,r=n.extensions;n.supportedExtensionKeys.indexOf(e)>-1&&(r[e]=t)}},{key:"createUserListQuery",value:function(e){return new(0,j.get(this._iid).UserListQuery)(e)}},{key:"createApplicationUserListQuery",value:function(){return new(0,j.get(this._iid).ApplicationUserListQuery)}},{key:"createBlockedUserListQuery",value:function(){return new(0,j.get(this._iid).BlockedUserListQuery)}},{key:"createFriendListQuery",value:function(){return new(0,j.get(this._iid).FriendListQuery)}},{key:"createMessageSearchQuery",value:function(e,t){return new(0,j.get(this._iid).MessageSearchQuery)(e,t)}},{key:"sendCommand",value:function(e,t){var n=this;return le(this._iid,(function(t){n.ConnectionManager.ready((function(r,i){if(r)t(r,null);else{var a=O.get(n._iid).container,s=a.wsAdapter,o=a.ackStateMap;if(null==s||null==s.client||s.client.getConnectionState()!==n.ConnectionState.OPEN||n.getConnectionState()!==n.ConnectionState.OPEN)return void t(new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),null);if(e.isAckRequired){var l=e.requestId,u={handler:t,timer:setTimeout((function(){t(new F("Command received no ack.",F.ACK_TIMEOUT),null),delete o[l]}),n.Options.websocketResponseTimeout)};o[l]=u,s.client.send(e,(function(e){e&&(clearTimeout(u.timer),t(e,null))}))}else s.client.send(e,t)}}),!1)}),t).catch((function(e){$.debug(e)}))}},{key:"setSessionHandler",value:function(e){O.get(this._iid).container.sessionManager.setHandler(e)}},{key:"addUserEventHandler",value:function(e,t){t instanceof j.get(this._iid).UserEventHandler&&(this.userEventHandlers[e]=t)}},{key:"removeUserEventHandler",value:function(e){delete this.userEventHandlers[e]}},{key:"removeAllUserEventHandler",value:function(){this.userEventHandlers={}}},{key:"addChannelHandler",value:function(e,t){t instanceof j.get(this._iid).ChannelHandler&&(this.channelHandlers[e]=t)}},{key:"removeChannelHandler",value:function(e){delete this.channelHandlers[e]}},{key:"removeAllChannelHandlers",value:function(){this.channelHandlers={}}},{key:"addConnectionHandler",value:function(e,t){t instanceof j.get(this._iid).ConnectionHandler&&(this.connectionHandlers[e]=t)}},{key:"removeConnectionHandler",value:function(e){delete this.connectionHandlers[e]}},{key:"removeAllConnectionHandlers",value:function(){this.connectionHandlers={}}},{key:"updateCurrentUserInfo",value:function(e,t,n){var r=this,i=null,a=S(ve.parse(arguments,[new ve({type:"string",nullable:!0}),new ve({type:"string",nullable:!0}),new ve({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){if(i)n(i,null);else{var a=O.get(r._iid);a.container.apiClient.updateCurrentUserInfo({nickname:e,profileUrl:t},(function(i,s){var o=null;i||(r.currentUser&&(e&&(r.currentUser.nickname=e),t&&(r.currentUser.plainProfileUrl=t,Object.defineProperty(r.currentUser,"profileUrl",{value:r.currentUser.requireAuth?"".concat(r.currentUser.plainProfileUrl,"?auth=").concat(a.container.auth.eKey):r.currentUser.plainProfileUrl,configurable:!0,writable:!1}))),o=r.currentUser),n(i,o)}))}}),n)}},{key:"updateCurrentUserInfoWithProfileImage",value:function(e,t,n){var r=this,i=null,a=S(ve.parse(arguments,[new ve({type:"string",nullable:!0}),new ve({type:"file",nullable:!0}),new ve({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){if(i)n(i,null);else{var a=O.get(r._iid);a.container.apiClient.updateCurrentUserInfo({nickname:e,profileImage:t},(function(t,i){var s=null;t||(r.currentUser&&(e&&(r.currentUser.nickname=e),i.profile_url&&(r.currentUser.plainProfileUrl=i.profile_url,Object.defineProperty(r.currentUser,"profileUrl",{value:r.currentUser.requireAuth?"".concat(r.currentUser.plainProfileUrl,"?auth=").concat(a.container.auth.eKey):r.currentUser.plainProfileUrl,configurable:!0,writable:!1}))),s=r.currentUser),n(t,s)}))}}),n)}},{key:"updateCurrentUserInfoWithPreferredLanguages",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.updateCurrentUserInfo({preferredLanguages:e},(function(r,i){var a=null;r||(n.currentUser&&e&&(n.currentUser._preferredLanguages=e),a=n.currentUser),t(r,a)}))}),t)}},{key:"registerGCMPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,n.pushTokenRegistrationState.ERROR):n.currentUser?O.get(n._iid).container.apiClient.registerGCMPushToken({token:e},(function(e,r){var i=n.pushTokenRegistrationState.ERROR;e||(n.GCMPushToken="",i=n.pushTokenRegistrationState.SUCCESS),t(e,i)})):(n.GCMPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterGCMPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):n.currentUser?O.get(n._iid).container.apiClient.unregisterGCMPushToken({token:e},(function(e,n){t(e,null)})):(n.GCMPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterGCMPushTokenAllForCurrentUser",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.unregisterAllGCMPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"registerAPNSPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,n.pushTokenRegistrationState.ERROR):n.currentUser?O.get(n._iid).container.apiClient.registerAPNSPushToken({token:e},(function(e,r){var i=n.pushTokenRegistrationState.ERROR;e||(n.APNSPushToken="",i=n.pushTokenRegistrationState.SUCCESS),t(e,i)})):(n.APNSPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterAPNSPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e.length>0}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):n.currentUser?O.get(n._iid).container.apiClient.unregisterAPNSPushToken({token:e},(function(e,n){t(e,null)})):(n.APNSPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterAPNSPushTokenAllForCurrentUser",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.unregisterAllAPNSPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"unregisterPushTokenAllForCurrentUser",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.unregisterAllPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"getMyGroupChannelChangeLogsByToken",value:function(e,t,n,r){var i=this,a=null,s=S(ve.parse(arguments,[new ve({type:"string",nullable:!0}),new ve({type:"array",optional:!0,nullable:!0,defaultValue:null}),new ve({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new ve({type:"callback"})]),5);a=s[0],e=s[1],t=s[2],n=s[3],r=s[4];var o=j.get(this._iid).GroupChannelChangeLogsParams,l=null;if(a){var c=ve.parse(arguments,[new ve({type:"string",nullable:!0}),new ve({type:o,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),d=S(c,4);a=d[0],e=d[1],l=d[2],r=d[3]}else(l=new o).customTypes=t,l.includeEmpty=n,l.includeFrozen=!0;return le(this._iid,(function(t){a?t(a,null):O.get(i._iid).container.apiClient.getMyGroupChannelChangeLogs(u({ts:null,token:e},l)).then((function(e){var n=j.get(i._iid).GroupChannel,r=e.updated.map((function(e){return new n(e)})),a=e.deleted,s=e.has_more,o=e.next;t(null,{updatedChannels:r,deletedChannelUrls:a,hasMore:s,token:o})})).catch((function(e){t(e,null)}))}),r)}},{key:"getMyGroupChannelChangeLogsByTimestamp",value:function(e,t,n,r){var i=this,a=null,s=ve.parse(arguments,[new ve({type:"number",constraint:function(e){return e>=0}}),new ve({type:"array",optional:!0,nullable:!0,defaultValue:null}),new ve({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new ve({type:"callback"})]),o=S(s,5);a=o[0],e=o[1],t=o[2],n=o[3],r=o[4];var l=j.get(this._iid).GroupChannelChangeLogsParams,c=null;if(a){var d=ve.parse(arguments,[new ve({type:"number",constraint:function(e){return e>=0}}),new ve({type:l,constraint:function(e){return e._validate()}}),new ve({type:"callback"})]),h=S(d,4);a=h[0],e=h[1],c=h[2],r=h[3]}else(c=new l).customTypes=t,c.includeEmpty=n,c.includeFrozen=!0;return le(this._iid,(function(t){a?t(a,null):O.get(i._iid).container.apiClient.getMyGroupChannelChangeLogs(u({ts:e,token:null},c)).then((function(e){var n=j.get(i._iid).GroupChannel,r=e.updated.map((function(e){return new n(e)})),a=e.deleted,s=e.has_more,o=e.next;t(null,{updatedChannels:r,deletedChannelUrls:a,hasMore:s,token:o})})).catch((function(e){t(e,null)}))}),r)}},{key:"getChannelInvitationPreference",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getChannelInvitationPreference({},(function(t,n){var r=null;t||(r={autoAccept:n.auto_accept}),e(t,r)}))}),e)}},{key:"setChannelInvitationPreference",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"boolean"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.setChannelInvitationPreference({isAutoAccept:e},(function(e,n){var r=null;e||(r={autoAccept:n.auto_accept}),t(e,r)}))}),t)}},{key:"getDoNotDisturb",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getDoNotDisturb({},(function(t,n){var r=null;t||(r={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone}),e(t,r)}))}),e)}},{key:"setDoNotDisturb",value:function(e,t,n,r,i,a,s){var o=this,l=null,u=ve.parse(arguments,[new ve({type:"boolean"}),new ve({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new ve({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new ve({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new ve({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new ve({type:"string"}),new ve({type:"callback"})]),c=S(u,8);return l=c[0],e=c[1],t=c[2],n=c[3],r=c[4],i=c[5],a=c[6],s=c[7],le(this._iid,(function(s){l?s(l,null):O.get(o._iid).container.apiClient.setDoNotDisturb({doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:i,timezone:a},(function(e,t){var n=null;e||(n={doNotDisturbOn:t.do_not_disturb,startHour:t.start_hour,startMin:t.start_min,endHour:t.end_hour,endMin:t.end_min,timezone:t.timezone}),s(e,n)}))}),s)}},{key:"getSnoozePeriod",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getSnoozePeriod({},(function(t,n){var r=null;t||(r={isSnoozeOn:n.snooze_enabled,startTs:n.snooze_start_ts,endTs:n.snooze_end_ts}),e(t,r)}))}),e)}},{key:"setSnoozePeriod",value:function(e,t,n,r){var i=this,a=null,s=ve.parse(arguments,[new ve({type:"boolean"}),new ve({type:"number",constraint:function(e){return e>0}}),new ve({type:"number",constraint:function(e){return e>0}}),new ve({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):O.get(i._iid).container.apiClient.setSnoozePeriod({snoozeOn:e,startTs:t,endTs:n},(function(e,t){var n=null;e||(n={isSnoozeOn:t.snooze_enabled,startTs:t.snooze_start_ts,endTs:t.snooze_end_ts}),r(e,n)}))}),r)}},{key:"blockUser",value:function(e,t){var n=null,r=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new ve({type:"callback"})]),i=S(r,3);return n=i[0],e=i[1],t=i[2],n?le(this._iid,(function(e){e(n,null)}),t):this.blockUserWithUserId(e.userId,t)}},{key:"blockUserWithUserId",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e&&(!n.currentUser||e!==n.currentUser.userId)}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.blockUser({blockedUserId:e},(function(e,n){var r=null;e||(r=new gt(n)),t(e,r)}))}),t)}},{key:"unblockUser",value:function(e,t){var n=null,r=ve.parse(arguments,[new ve({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new ve({type:"callback"})]),i=S(r,3);return n=i[0],e=i[1],t=i[2],n?le(this._iid,(function(e){e(n,null)}),t):this.unblockUserWithUserId(e.userId,t)}},{key:"unblockUserWithUserId",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"string",constraint:function(e){return e&&(!n.currentUser||e!==n.currentUser.userId)}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.unblockUser({unblockedUserId:e},(function(e,n){t(e,null)}))}),t)}},{key:"getPushTriggerOption",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getPushTriggerOption({},(function(t,n){e(t,n?n.push_trigger_option:null)}))}),e)}},{key:"setPushTriggerOption",value:function(e,t){var n=this;return le(this._iid,(function(t){Object.keys(n.PushTriggerOption).map((function(e){return n.PushTriggerOption[e]})).indexOf(e)>-1?O.get(n._iid).container.apiClient.setPushTriggerOption({pushTriggerOption:e},(function(e,n){t(e,n?n.push_trigger_option:null)})):t(ve.error,null)}),t)}},{key:"getGroupChannelCount",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannel,i=null,a=S(ve.parse(arguments,[new ve({type:r.MemberStateFilter,optional:!0,defaultValue:r.MemberStateFilter.ALL}),new ve({type:"callback"})]),3);return i=a[0],e=a[1],t=a[2],le(this._iid,(function(t){i?t(i,null):O.get(n._iid).container.apiClient.getGroupChannelCount({memberStateFilter:e},(function(e,n){var r=null;e||(r=parseInt(n.group_channel_count)),t(e,r)}))}),t)}},{key:"getTotalUnreadChannelCount",value:function(e,t){var n=this,r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelTotalUnreadChannelCountParams,s=null,o=ve.parse(arguments,[new ve({type:"object",optional:!0,defaultValue:null,constraint:function(e){return e instanceof a}}),new ve({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)t(s,null);else{var r=null,a=i.SuperChannelFilter.ALL;e&&(r=e.channelCustomTypesFilter,a=e.superChannelFilter),O.get(n._iid).container.apiClient.getTotalUnreadChannelCount({customTypesFilter:r,superChannelFilter:a},(function(e,n){var r=null;e||(r=parseInt(n.unread_count)),t(e,r)}))}}),t)}},{key:"getTotalUnreadMessageCount",value:function(e,t){var n=this,r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelTotalUnreadMessageCountParams,s=null,o=ve.parse(arguments,[new ve({type:"object",optional:!0,defaultValue:null,constraint:function(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))||e instanceof a}}),new ve({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)t(s,null);else{var r=i.SuperChannelFilter.ALL;if(e instanceof a){var o=e;e=o.channelCustomTypesFilter,r=o.superChannelFilter}O.get(n._iid).container.apiClient.getTotalUnreadMessageCount({customTypesFilter:e,superChannelFilter:r},(function(e,n){var r=null;e||(r=parseInt(n.unread_count)),t(e,r)}))}}),t)}},{key:"getUnreadItemCount",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.length>0&&e.every((function(e){return Object.keys(or.UnreadItemKey).map((function(e){return or.UnreadItemKey[e]})).indexOf(e)>-1}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){if(r)t(r,null);else{var i=e.filter((function(t,n){return e.indexOf(t)===n}));O.get(n._iid).container.apiClient.getUnreadItemCount({keys:i},(function(e,n){t(e,n)}))}}),t)}},{key:"getSubscribedTotalUnreadMessageCount",value:function(){var e=O.get(this._iid).container.subscribedUnreadMessageCount;return e.all>=0?e.all:0}},{key:"getSubscribedCustomTypeTotalUnreadMessageCount",value:function(){var e=O.get(this._iid).container.subscribedUnreadMessageCount;if(Object.keys(e.custom_types).length>0){var t=0;return Object.keys(e.custom_types).forEach((function(n){t+=e.custom_types[n]})),t}return 0}},{key:"getSubscribedCustomTypeUnreadMessageCount",value:function(e){if(e&&"string"==typeof e){var t=O.get(this._iid).container.subscribedUnreadMessageCount;return t.custom_types.hasOwnProperty(e)?t.custom_types[e]:0}return 0}},{key:"getMyPushTokensByToken",value:function(e,t,n){var r=this,i=null,a=ve.parse(arguments,[new ve({type:"string"}),new ve({type:"string",constraint:function(e){return["gcm","apns","apns_voip"].indexOf(e)>-1}}),new ve({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):O.get(r._iid).container.apiClient.getPushTokens({ts:null,token:e,type:t},(function(e,t){if(e)n(e,null);else{var r=t.type;n(null,{deviceTokens:t.device_tokens,type:r?r.toLowerCase():"unknown",hasMore:t.has_more,token:t.token})}}))}),n)}},{key:"getPushTemplate",value:function(e){var t=this;return le(this._iid,(function(e){O.get(t._iid).container.apiClient.getPushTemplate({},(function(t,n){var r=null;t||(r=n.name.toString()),e(t,r)}))}),e)}},{key:"setPushTemplate",value:function(e,t){var n=this;return le(this._iid,(function(t){[n.PUSH_TEMPLATE_DEFAULT,n.PUSH_TEMPLATE_ALTERNATIVE].indexOf(e)>-1?O.get(n._iid).container.apiClient.setPushTemplate({templateName:e},(function(e,n){var r=null;e||(r=n.name.toString()),t(e,r)})):t(ve.error,null)}),t)}},{key:"markAsReadAll",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid).GroupChannel,r=(new Date).getTime();r-n.markAsReadAllLastSentAt<1e3?e(new F("MarkAsRead rate limit exceeded.",F.MARK_AS_READ_RATE_LIMIT_EXCEEDED),null):(n.markAsReadAllLastSentAt=r,O.get(t._iid).container.apiClient.markAsReadAll({channelUrls:null},(function(i,a){i||Object.keys(n.cachedChannels).forEach((function(e){t.currentUser&&n.cachedChannels[e].updateReadReceipt(t.currentUser.userId,r),n.cachedChannels[e]._setGroupChannelUnreadCount(0,0)})),e(i,null)})))}),e)}},{key:"markAsReadWithChannelUrls",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){if(r)t(r,null);else{var i=(new Date).getTime();O.get(n._iid).container.apiClient.markAsReadAll({channelUrls:e},(function(r,a){r||e.forEach((function(e){or.cachedChannels[e]&&(n.currentUser&&or.cachedChannels[e].updateReadReceipt(n.currentUser.userId,i),or.cachedChannels[e]._setGroupChannelUnreadCount(0,0))})),t(r,null)}))}}),t)}},{key:"markAsDelivered",value:function(e){"string"==typeof e&&j.get(this._iid).GroupChannel.getChannel(e,I.INTERNAL_CALL).then((function(e){return e.markAsDelivered()})).catch((function(e){return $.debug(e)}))}},{key:"getFriendChangeLogsByToken",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string",optional:!0,defaultValue:null}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getFriendChangeLogsByToken({token:e},(function(e,r){var i=null;if(!e){var a=j.get(n._iid).User;i={updatedUsers:r.updated.map((function(e){return new a(e)})),deletedUserIds:r.deleted,hasMore:r.has_more,token:r.next}}t(e,i)}))}),t)}},{key:"uploadFriendDiscoveries",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return e.hasOwnProperty("friendDiscoveryKey")}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.uploadFriendDiscoveries({discoveries:e},(function(e,n){t(e,n)}))}),t)}},{key:"deleteFriendDiscovery",value:function(e,t){var n=null,r=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return n=r[0],e=r[1],t=r[2],n?le(this._iid,(function(e){e(n,null)}),t):this.deleteFriendDiscoveries([e],t)}},{key:"deleteFriendDiscoveries",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.deleteFriendDiscoveries({discoveryKeys:e},(function(e,n){t(e,n)}))}),t)}},{key:"addFriends",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.addFriends({userIds:e},(function(e,r){var i=null;if(!e){var a=j.get(n._iid).User;i=r.users.map((function(e){return new a(e)}))}t(e,i)}))}),t)}},{key:"deleteFriend",value:function(e,t){var n=null,r=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return n=r[0],e=r[1],t=r[2],n?le(this._iid,(function(e){e(n,null)}),t):this.deleteFriends([e],t)}},{key:"deleteFriends",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.deleteFriends({userIds:e},(function(e,n){t(e,n)}))}),t)}},{key:"getAllEmoji",value:function(e){var t=this,n=null,r=S(ve.parse(arguments,[new ve({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):O.get(t._iid).container.apiClient.getAllEmoji((function(n,r){if(n)e(n,null);else{var i=new(0,j.get(t._iid).EmojiContainer)(r);e(null,i)}}))}),e)}},{key:"getEmojiCategory",value:function(e,t){var n=this,r=null,i=ve.parse(arguments,[new ve({type:"number",constraint:function(e){return e>=0}}),new ve({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getEmojiCategory({categoryId:e},(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).EmojiCategory)(r);t(null,i)}}))}),t)}},{key:"getEmoji",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"string"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.getEmoji({emojiKey:e},(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).Emoji)(r);t(null,i)}}))}),t)}},{key:"getAllowFriendDiscovery",value:function(e){var t=this,n=null,r=S(ve.parse(arguments,[new ve({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):O.get(t._iid).container.apiClient.getAllowFriendDiscovery((function(t,n){var r=n.allow_friend_discovery;t?e(t,null):e(null,r)}))}),e)}},{key:"setAllowFriendDiscovery",value:function(e,t){var n=this,r=null,i=S(ve.parse(arguments,[new ve({type:"boolean"}),new ve({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):O.get(n._iid).container.apiClient.setAllowFriendDiscovery({allowFriendDiscovery:e},(function(n,r){n?t(n,null):t(null,e)}))}),t)}},{key:"clearCachedMessages",value:function(e){var t=this,n=lt.of(this._iid);if(n){var r=O.get(this._iid).container.store;return Promise.all(e.map((function(e){return new Promise((function(i,a){n.clearByChannelUrl(e).then((function(){var n=_t(t._currentUserId,e);return r.remove(n)})).then((function(){var n=bt(t._currentUserId,e);return r.remove(n)})).then((function(){i()})).catch((function(e){a(e)}))}))})))}return Promise.resolve([])}},{key:"_getCurrentUserDataKey",value:function(){return"sendbird:".concat(this._currentUserId,"@currentUserData")}},{key:"_populateVaultFromCurrentUserData",value:function(e){var t=O.get(this._iid),n=t.container.auth,r=j.get(this._iid).User,i=e.currentUser,a=e.maxUnreadCountOfSuperGroupChannel,s=e.profileImageEncryption,o=e.sessionKey,l=e.eKey,u=e.appInfo,c=e.connectedAt,d=e.firstConnectedAt,h=e.concurrentCallLimit,f=e.backOffDelay;i&&(this.currentUser=r.buildFromSerializedData(i)),a&&t.set("maxUnreadCountOfSuperGroupChannel",a),s&&t.set("profileImageEncryption",s),n?(o&&(n.sessionKey=o),l&&(n.ekey=l)):$.debug("Auth should have been created when populating current user data."),u&&t.set("appInfo",new Te(u)),c&&t.set("connectedAt",c),d&&t.set("firstConnectedAt",d),h&&t.set("concurrentCallLimit",h),f&&t.set("backOffDelay",f)}}],[{key:"version",get:function(){return I.SDK_VERSION}},{key:"LogLevel",get:function(){return $.supportedLogLevels}},{key:"getInstance",value:function(e){return e?Ri[e]:Ui}},{key:"getLogLevel",value:function(){return $.logLevel}},{key:"setLogLevel",value:function(e){var t=Object.values($.supportedLogLevels);if(t.includes(e))$.logLevel=e;else{$.logLevel=$.defaultLogLevel;var n=t.map((function(e){return"'".concat(e,"'")})).join(", ");$.warn("`logLevel` parameter should be one of","".concat(n,","),"not `'".concat(e,"'`."),"Set to default log level","`".concat($.defaultLogLevel,"`."))}}},{key:"getAppVersion",value:function(){return Li}},{key:"setAppVersion",value:function(e){"string"==typeof e&&ee()&&(Li=e)}}]),e}();return Pi}(n(854),n(778),n(198))},853:(e,t,n)=>{"use strict";e.exports=n(896)},854:(e,t,n)=>{e.exports=n(291)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],u=o+1,c=e[u];if(0>a(l,n))u<i&&0>a(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[o]=n,r=o);else{if(!(u<i&&0>a(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,h=null,f=3,p=!1,g=!1,y=!1,m=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,E="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function C(e){if(y=!1,b(e),!g)if(null!==r(u))g=!0,N||(N=!0,S());else{var t=r(c);null!==t&&R(C,t.startTime-e)}}var S,N=!1,A=-1,k=5,T=-1;function I(){return!!m||!(t.unstable_now()-T<k)}function w(){if(m=!1,N){var e=t.unstable_now();T=e;var n=!0;try{e:{g=!1,y&&(y=!1,v(A),A=-1),p=!0;var a=f;try{t:{for(b(e),h=r(u);null!==h&&!(h.expirationTime>e&&I());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var o=s(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,b(e),n=!0;break t}h===r(u)&&i(u),b(e)}else i(u);h=r(u)}if(null!==h)n=!0;else{var l=r(c);null!==l&&R(C,l.startTime-e),n=!1}}break e}finally{h=null,f=a,p=!1}n=void 0}}finally{n?S():N=!1}}}if("function"===typeof E)S=function(){E(w)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,U=O.port2;O.port1.onmessage=w,S=function(){U.postMessage(null)}}else S=function(){_(w,0)};function R(e,n){A=_((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){m=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(c,e),null===r(u)&&e===r(c)&&(y?(v(A),A=-1):y=!0,R(C,a-s))):(e.sortIndex=o,n(u,e),g||p||(g=!0,N||(N=!0,S()))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},903:(e,t,n)=>{"use strict";var r=n(267);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,a,s){var o=[];o.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),r.isString(i)&&o.push("path="+i),r.isString(a)&&o.push("domain="+a),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},938:(e,t,n)=>{"use strict";var r=n(267),i=n(735),a=n(664),s=n(395),o=n(438),l=n(638),u=n(478),c=u.validators;function d(e){this.defaults=e,this.interceptors={request:new a,response:new a}}d.prototype.request=function(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},(t=o(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&u.assertOptions(n,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var r=[],i=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));var a,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!i){var d=[s,void 0];for(Array.prototype.unshift.apply(d,r),d=d.concat(l),a=Promise.resolve(t);d.length;)a=a.then(d.shift(),d.shift());return a}for(var h=t;r.length;){var f=r.shift(),p=r.shift();try{h=f(h)}catch(g){p(g);break}}try{a=s(h)}catch(g){return Promise.reject(g)}for(;l.length;)a=a.then(l.shift(),l.shift());return a},d.prototype.getUri=function(e){e=o(this.defaults,e);var t=l(e.baseURL,e.url);return i(t,e.params,e.paramsSerializer)},r.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,n){return this.request(o(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(o(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}d.prototype[e]=t(),d.prototype[e+"Form"]=t(!0)})),e.exports=d},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)},973:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},989:(e,t,n)=>{"use strict";var r=n(267),i=n(121),a=n(702),s=n(335),o=n(289),l={"Content-Type":"application/x-www-form-urlencoded"};function u(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c={transitional:s,adapter:function(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(e=n(370)),e}(),transformRequest:[function(e,t){if(i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e))return e;if(r.isArrayBufferView(e))return e.buffer;if(r.isURLSearchParams(e))return u(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var n,a=r.isObject(e),s=t&&t["Content-Type"];if((n=r.isFileList(e))||a&&"multipart/form-data"===s){var l=this.env&&this.env.FormData;return o(n?{"files[]":e}:e,l&&new l)}return a||"application/json"===s?(u(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||c.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(o){if(s){if("SyntaxError"===o.name)throw a.from(o,a.ERR_BAD_RESPONSE,this,null,this.response);throw o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:n(55)},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(l)})),e.exports=c}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".36f1bdc9.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="itivp:";n.l=(r,i,a,s)=>{if(e[r])e[r].push(i);else{var o,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[i];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="./",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=a);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,i[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,a,s=r[0],o=r[1],l=r[2],u=0;if(s.some((t=>0!==e[t]))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);u<s.length;u++)a=s[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkitivp=self.webpackChunkitivp||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e=n(43),t=n(391),r=n(579);const i=t=>{let{messages:n,loading:i=!1,autoSyncing:a=!1}=t;const s=(0,e.useRef)(null),o=(localStorage.getItem("sendbird_user_id"),localStorage.getItem("sendbird_user_nickname")||"");(0,e.useEffect)((()=>{s.current&&s.current.scrollIntoView({behavior:"smooth"})}),[n]);return(0,r.jsxs)("div",{className:"message-list",children:[i?(0,r.jsxs)("div",{className:"loading-messages",children:[(0,r.jsx)("div",{className:"loading-spinner"}),(0,r.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439..."})]}):0===n.length?(0,r.jsx)("div",{className:"no-messages",children:(0,r.jsx)("p",{children:"\u041d\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439. \u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043e\u0431\u0449\u0435\u043d\u0438\u0435!"})}):(0,r.jsxs)(r.Fragment,{children:[a&&(0,r.jsx)("div",{className:"auto-sync-indicator",children:(0,r.jsx)("span",{children:"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u043d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"})}),n.map((e=>{const t=(e=>e.sender===o||"\u0412\u044b"===e.sender)(e),n=(e=>"\u0421\u0438\u0441\u0442\u0435\u043c\u0430"===e.sender)(e);let i="message";return i+=n?" message-system":t?" message-own":" message-others",(0,r.jsxs)("div",{className:i,children:[(0,r.jsxs)("div",{className:"message-header",children:[(0,r.jsx)("span",{className:"message-sender",children:t?`${e.sender} (\u0412\u044b)`:e.sender}),(0,r.jsx)("span",{className:"message-time",children:(a=e.timestamp,a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))})]}),(0,r.jsx)("div",{className:"message-text",children:e.text})]},e.id);var a}))]}),(0,r.jsx)("div",{ref:s})]})},a=t=>{let{onSendMessage:n,disabled:i=!1}=t;const[a,s]=(0,e.useState)(""),[o,l]=(0,e.useState)(!1),[u,c]=(0,e.useState)(!1),d=async e=>{if(e.preventDefault(),o&&!u&&!i){c(!0);try{await n(a),s(""),l(!1)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435:",t)}finally{c(!1)}}};return(0,r.jsxs)("form",{className:"message-input-form",onSubmit:d,children:[(0,r.jsxs)("div",{className:"message-input-container",children:[(0,r.jsx)("textarea",{className:"message-input",value:a,onChange:e=>{const t=e.target.value;s(t),l(t.trim().length>0)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),!o||u||i||d(e))},placeholder:i?"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0430\u0442 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439...":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",disabled:u||i}),(0,r.jsx)("button",{type:"submit",className:"send-button "+(o&&!i?"active":"disabled"),disabled:!o||u||i,children:u?(0,r.jsx)("span",{className:"sending-indicator"}):(0,r.jsx)("span",{className:"send-icon",children:"\u27a4"})})]}),(0,r.jsx)("div",{className:"input-help-text",children:(0,r.jsx)("p",{children:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 Shift+Enter \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0430 \u0441\u0442\u0440\u043e\u043a\u0438"})})]})};var s=n(818);const o=new(n.n(s)())({appId:"D895A94C-429F-4EB3-A361-B91CF467BD94"}),l=(()=>{const e=localStorage.getItem("sendbird_user_id");if(e)return e;const t=`user_${Math.random().toString(36).substring(2,8)}`;return localStorage.setItem("sendbird_user_id",t),t})(),u=(()=>{const e=localStorage.getItem("sendbird_user_nickname");if(e)return e;const t="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c";return localStorage.setItem("sendbird_user_nickname",t),t})();let c=null;const d=async()=>{try{const e=await o.connect(l);console.log("SendBird connected:",e),await o.updateCurrentUserInfo(u,""),c=await h()}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 SendBird:",e),e}},h=async()=>{try{const e=o.GroupChannel.createMyGroupChannelListQuery();e.includeEmpty=!0,e.limit=100;const t=(await e.next()).find((e=>"\u041e\u0431\u0449\u0438\u0439 \u0447\u0430\u0442"===e.name));if(t)return t;const n=new o.GroupChannelParams;n.name="\u041e\u0431\u0449\u0438\u0439 \u0447\u0430\u0442",n.isPublic=!0,n.operatorUserIds=[l],n.customType="general";return await o.GroupChannel.createChannel(n)}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438/\u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043a\u0430\u043d\u0430\u043b\u0430:",e),e}},f=async()=>{try{if(c||await d(),!c)throw new Error("\u041a\u0430\u043d\u0430\u043b \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d");const e=new o.MessageListParams;e.prevResultSize=30,e.isInclusive=!0;return(await c.getMessagesByTimestamp(Date.now(),e)).map((e=>{var t,n;if("user"!==e.messageType)return null;const r=e,i=(null===(t=r.sender)||void 0===t?void 0:t.nickname)||(null===(n=r.sender)||void 0===n?void 0:n.userId)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",a=r.message||"";return{id:r.messageId,text:a,sender:i,timestamp:new Date(r.createdAt)}})).filter(Boolean)}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439:",e),e}},p=e=>{const t=new o.ChannelHandler;t.onMessageReceived=(t,n)=>{if(c&&t.url===c.url)if(console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u043d\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435:",n),"user"===n.messageType){var r,i;const t=n,a=(null===(r=t.sender)||void 0===r?void 0:r.nickname)||(null===(i=t.sender)||void 0===i?void 0:i.userId)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",s=t.message||"",o={id:t.messageId,text:s,sender:a,timestamp:new Date(t.createdAt)};e(o)}else if("admin"===n.messageType){const t=n,r={id:t.messageId,text:t.message||"",sender:"\u0421\u0438\u0441\u0442\u0435\u043c\u0430",timestamp:new Date(t.createdAt)};e(r)}},t.onChannelChanged=e=>{console.log("\u041a\u0430\u043d\u0430\u043b \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0441\u044f:",e)},t.onMessageDeleted=(e,t)=>{console.log("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043e:",t)},t.onMessageUpdated=(e,t)=>{console.log("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e:",t)};const n=`chat_${Date.now()}`;return o.addChannelHandler(n,t),()=>{o.removeChannelHandler(n)}},g=async()=>{try{if(c||await d(),!c)throw new Error("\u041a\u0430\u043d\u0430\u043b \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d");const e=new o.MessageListParams;e.prevResultSize=20,e.isInclusive=!0;return(await c.getMessagesByTimestamp(Date.now(),e)).map((e=>{if("user"===e.messageType){var t,n;const r=e,i=(null===(t=r.sender)||void 0===t?void 0:t.nickname)||(null===(n=r.sender)||void 0===n?void 0:n.userId)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",a=r.message||"";return{id:r.messageId,text:a,sender:i,timestamp:new Date(r.createdAt)}}if("admin"===e.messageType){const t=e;return{id:t.messageId,text:t.message||"",sender:"\u0421\u0438\u0441\u0442\u0435\u043c\u0430",timestamp:new Date(t.createdAt)}}return null})).filter(Boolean)}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439:",e),e}},y=async()=>{try{o.currentUser||await d();const e=o.GroupChannel.createMyGroupChannelListQuery();e.includeEmpty=!0,e.limit=100;return(await e.next()).map((e=>{let t="";return e.lastMessage&&("user"===e.lastMessage.messageType||"admin"===e.lastMessage.messageType)&&(t=e.lastMessage.message||""),{url:e.url,name:e.name,memberCount:e.memberCount,unreadMessageCount:e.unreadMessageCount,lastMessage:t}}))}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u043a\u0430\u043d\u0430\u043b\u043e\u0432:",e),e}},m=t=>{let{onChannelSelect:n,selectedChannelUrl:i,onClose:a}=t;const[s,u]=(0,e.useState)([]),[c,h]=(0,e.useState)(!0),[f,p]=(0,e.useState)(null),[g,m]=(0,e.useState)(!1),[_,v]=(0,e.useState)(""),[E,b]=(0,e.useState)(window.innerWidth<=480);(0,e.useEffect)((()=>{const e=()=>{b(window.innerWidth<=480)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const C=async()=>{h(!0),p(null);try{const e=await y();u(e)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u043a\u0430\u043d\u0430\u043b\u043e\u0432:",e),p("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0442\u043e\u0432. "+(e.message||""))}finally{h(!1)}};(0,e.useEffect)((()=>{C()}),[]);return(0,r.jsxs)("div",{className:"channel-list-container",children:[(0,r.jsxs)("div",{className:"channel-list-header",children:[E&&a&&(0,r.jsx)("button",{className:"close-channel-list",onClick:a,title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0442\u043e\u0432",children:"\u2715"}),(0,r.jsx)("h2",{children:"\u0427\u0430\u0442\u044b"}),(0,r.jsxs)("div",{className:"channel-list-actions",children:[(0,r.jsx)("button",{onClick:()=>{C()},className:"refresh-button",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a",children:"\ud83d\udd04"}),(0,r.jsx)("button",{onClick:()=>m(!0),className:"new-channel-button",children:"\u041d\u043e\u0432\u044b\u0439 \u0447\u0430\u0442"})]})]}),f&&(0,r.jsx)("div",{className:"channel-list-error",children:f}),(0,r.jsx)("div",{className:"channel-list",children:c?(0,r.jsx)("div",{className:"channel-list-loading",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0447\u0430\u0442\u043e\u0432..."}):0===s.length?(0,r.jsxs)("div",{className:"channel-list-empty",children:[(0,r.jsx)("p",{children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0447\u0430\u0442\u043e\u0432"}),(0,r.jsx)("button",{onClick:()=>m(!0),className:"create-first-channel",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0439 \u0447\u0430\u0442"})]}):s.map((e=>(0,r.jsxs)("div",{className:"channel-item "+(e.url===i?"selected":""),onClick:()=>n(e),children:[(0,r.jsx)("div",{className:"channel-name",children:e.name}),(0,r.jsxs)("div",{className:"channel-meta",children:[(0,r.jsxs)("span",{className:"channel-members",children:[e.memberCount," \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"]}),e.unreadMessageCount&&e.unreadMessageCount>0&&(0,r.jsx)("span",{className:"unread-badge",children:e.unreadMessageCount})]}),e.lastMessage&&(0,r.jsx)("div",{className:"channel-last-message",children:e.lastMessage})]},e.url)))}),g&&(0,r.jsx)("div",{className:"create-channel-modal-overlay",children:(0,r.jsxs)("div",{className:"create-channel-modal",children:[(0,r.jsx)("h3",{children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0447\u0430\u0442"}),(0,r.jsx)("input",{type:"text",value:_,onChange:e=>v(e.target.value),placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0447\u0430\u0442\u0430",className:"new-channel-input",autoFocus:!0}),(0,r.jsxs)("div",{className:"create-channel-actions",children:[(0,r.jsx)("button",{className:"cancel-button",onClick:()=>{m(!1),v("")},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,r.jsx)("button",{className:"create-button",onClick:async()=>{if(_.trim())try{const e=await(async e=>{try{o.currentUser||await d();const t=new o.GroupChannelParams;t.name=e,t.isPublic=!0,t.operatorUserIds=[l];const n=await o.GroupChannel.createChannel(t);return{url:n.url,name:n.name,memberCount:n.memberCount,unreadMessageCount:n.unreadMessageCount,lastMessage:""}}catch(f){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043a\u0430\u043d\u0430\u043b\u0430:",f),f}})(_);u((t=>[...t,e])),m(!1),v(""),n(e)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043a\u0430\u043d\u0430\u043b\u0430:",e),p("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0447\u0430\u0442. "+(e.message||""))}},disabled:!_.trim(),children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})]})})]})},_=()=>{const[t,n]=(0,e.useState)([]),[s,l]=(0,e.useState)(!1),[u,h]=(0,e.useState)(null),[_,v]=(0,e.useState)(!1),[E,b]=(0,e.useState)(!1),[C,S]=(0,e.useState)(!1),[N,A]=(0,e.useState)(""),[k,T]=(0,e.useState)(!1),[I,w]=(0,e.useState)(null),[O,U]=(0,e.useState)(!0);(0,e.useEffect)((()=>{const e=localStorage.getItem("sendbird_user_nickname");e&&"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"!==e?A(e):T(!0)}),[]);const R=()=>{N.trim()&&(localStorage.setItem("sendbird_user_nickname",N),T(!1),window.location.reload())},M=async e=>{l(!0),h(null),n([]);try{await(async e=>{try{o.currentUser||await d(),c=await o.GroupChannel.getChannel(e),await c.markAsRead()}catch(u){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a\u0430\u043d\u0430\u043b\u0430:",u),u}})(e.url),w(e);const t=await f();n(t)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a\u0430\u043d\u0430\u043b\u0430:",t),h("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0447\u0430\u0442\u0430. "+(t.message||""))}finally{l(!1)}};(0,e.useEffect)((()=>{const e=async()=>{l(!0),h(null);try{await d(),v(!0);const e=await y();if(e.length>0&&!I)await M(e[0]);else{const e=await f();n(e)}await(async()=>{try{if(c||await d(),!c)throw new Error("\u041a\u0430\u043d\u0430\u043b \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d");return await c.markAsRead(),void console.log("\u041a\u0430\u043d\u0430\u043b \u043e\u0442\u043c\u0435\u0447\u0435\u043d \u043a\u0430\u043a \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0439")}catch(u){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u043d\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u043d\u0430\u043b\u0430:",u),u}})();const t=await g();t.length>0&&n((e=>{const n=new Set(e.map((e=>e.id))),r=t.filter((e=>!n.has(e.id)));return r.length>0?[...e,...r]:e}))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439:",e),h("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430. "+(e.message||""))}finally{l(!1)}};k||e()}),[k]),(0,e.useEffect)((()=>{if(!_)return;let e;try{e=(e=>{let t=Date.now();const n=async()=>{try{if(c||await d(),!c)return void console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e: \u043a\u0430\u043d\u0430\u043b \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d");const n=new o.MessageListParams;n.prevResultSize=10,n.isInclusive=!0,n.customTypes=["admin","user"];const r=(await c.getMessagesByTimestamp(Date.now(),n)).filter((e=>e.createdAt>t)).map((e=>{if("user"===e.messageType){var t,n;const r=e,i=(null===(t=r.sender)||void 0===t?void 0:t.nickname)||(null===(n=r.sender)||void 0===n?void 0:n.userId)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",a=r.message||"";return{id:r.messageId,text:a,sender:i,timestamp:new Date(r.createdAt)}}if("admin"===e.messageType){const t=e;return{id:t.messageId,text:t.message||"",sender:"\u0421\u0438\u0441\u0442\u0435\u043c\u0430",timestamp:new Date(t.createdAt)}}return null})).filter(Boolean);t=Date.now(),r.length>0&&e(r)}catch(u){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438:",u)}},r=setInterval(n,15e3);return n(),()=>{clearInterval(r)}})((e=>{console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u043d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438:",e),S(!0),n((t=>[...t,...e])),setTimeout((()=>S(!1)),2e3)}))}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0430\u0432\u0442\u043e\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438:",r)}const t=p((e=>{console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0435:",e),n((t=>[...t,e]))}));return()=>{t(),e&&e()}}),[_]);const L=()=>{U((e=>!e))};return(0,r.jsxs)("div",{className:"chat-container",children:[k?(0,r.jsx)("div",{className:"nickname-modal-overlay",children:(0,r.jsxs)("div",{className:"nickname-modal",children:[(0,r.jsx)("h2",{children:"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0442\u0435\u0441\u044c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430"}),(0,r.jsx)("p",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f \u0434\u043b\u044f \u0443\u0447\u0430\u0441\u0442\u0438\u044f \u0432 \u0447\u0430\u0442\u0435"}),(0,r.jsx)("input",{type:"text",value:N,onChange:e=>A(e.target.value),placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",className:"nickname-input",autoFocus:!0}),(0,r.jsx)("button",{className:"save-nickname-button",onClick:R,disabled:!N.trim(),children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0432\u043e\u0439\u0442\u0438 \u0432 \u0447\u0430\u0442"})]})}):null,(0,r.jsxs)("div",{className:"chat-layout",children:[O&&(0,r.jsx)(m,{onChannelSelect:M,selectedChannelUrl:null===I||void 0===I?void 0:I.url,onClose:L}),(0,r.jsxs)("div",{className:"chat-main",children:[(0,r.jsxs)("div",{className:"chat-header",children:[(0,r.jsx)("button",{className:"toggle-channel-list",onClick:L,title:O?"\u0421\u043a\u0440\u044b\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0442\u043e\u0432":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0442\u043e\u0432",children:O?"\u2715":"\u2630"}),(0,r.jsxs)("h2",{className:"channel-title",children:[I?I.name:"\u0427\u0430\u0442",I&&(0,r.jsxs)("span",{className:"channel-members-count",children:[" (",I.memberCount,")"]})]}),(0,r.jsx)("div",{className:"chat-actions",children:(0,r.jsx)("button",{className:"sync-button",onClick:async()=>{if(_&&!E){b(!0),h(null);try{const e=await g();n((t=>{const n=new Set(t.map((e=>e.id))),r=e.filter((e=>!n.has(e.id)));return r.length>0?[...t,...r]:t}))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439:",e),h("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f. "+(e.message||""))}finally{b(!1)}}},disabled:E||s,children:E?"\u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f...":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"})})]}),(0,r.jsxs)("div",{className:"chat-content",children:[u&&(0,r.jsx)("div",{className:"error-message",children:u}),(0,r.jsx)(i,{messages:t,loading:s,autoSyncing:C}),(0,r.jsx)(a,{onSendMessage:async e=>{if(e.trim()&&_){h(null);try{const t=localStorage.getItem("sendbird_user_nickname")||"\u0412\u044b",r=await(async(e,t)=>{try{if(c||await d(),!c)throw new Error("\u041a\u0430\u043d\u0430\u043b \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d");const n=await new Promise(((t,n)=>{c?c.sendUserMessage(e,((e,r)=>{r?n(r):t(e)})):n(new Error("\u041a\u0430\u043d\u0430\u043b \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d"))})),r=n.message||"";return{id:n.messageId,text:r,sender:t,timestamp:new Date(n.createdAt)}}catch(u){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f:",u),u}})(e,t);n((e=>[...e,r]))}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f:",t),h("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430. "+(t.message||""))}}},disabled:!_||s||!I})]})]})]})]})};const v=function(){return(0,r.jsx)("div",{className:"App",children:(0,r.jsx)(_,{})})},E=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:s}=t;n(e),r(e),i(e),a(e),s(e)}))};t.createRoot(document.getElementById("root")).render((0,r.jsx)(e.StrictMode,{children:(0,r.jsx)(v,{})})),E()})()})();
//# sourceMappingURL=main.51967fff.js.map